<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <title>Chapter 3 The term structure or risk-free yields | Introduction to Term Structure Models</title>

    <meta name="author" content="Jean-Paul Renne and Alain Monfort" />
  
   <meta name="description" content="This is an introduction to the modelling of dynamic term structures." />
   <meta name="generator" content="placeholder" />
  <meta property="og:title" content="Chapter 3 The term structure or risk-free yields | Introduction to Term Structure Models" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is an introduction to the modelling of dynamic term structures." />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 The term structure or risk-free yields | Introduction to Term Structure Models" />
  
  <meta name="twitter:description" content="This is an introduction to the modelling of dynamic term structures." />
  
  <!-- JS -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script>
  <script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script>
    <script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet" />
    <script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script>
    <script src="libs/bs3compat-0.5.0/transition.js"></script>
    <script src="libs/bs3compat-0.5.0/tabs.js"></script>
    <script src="libs/bs3compat-0.5.0/bs3compat.js"></script>
    <link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet" />
    <script src="libs/bs4_book-1.0.0/bs4_book.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script>

  <!-- CSS -->
  <style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
    <style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
      <link rel="stylesheet" href="my-style.css" />
  
</head>

<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book">
    <a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Introduction to Term Structure Models</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
      </form>

      <nav aria-label="Table of contents">
        <h2>Table of contents</h2>
        <div id="book-toc"></div>

        <div class="book-extra">
          <p><a id="book-repo" href="#">View book source <i class="fab fa-github"></i></a></li></p>
        </div>
      </nav>
    </div>
  </header>

  <main class="col-sm-12 col-md-9 col-lg-7" id="content">
<div id="TSM" class="section level1" number="3">
<h1><span class="header-section-number">Chapter 3</span> The term structure or risk-free yields</h1>
<!-- ```{r extractECB, echo=TRUE, fig.cap="Simulation of a quadratic processes $x_t$.", fig.asp = .6, out.width = "95%", fig.align = 'left-aligned', message=FALSE} -->
<!-- library(ecb) -->
<!-- rates <- get_data( -->
<!--   #"YC.B.U2.EUR.4F.G_N_A.SV_C_YM.SR_10Y", -->
<!--   "FM.M.U2.EUR.4F.BB.R_U2_10Y.YLDA", -->
<!--   filter=list(startPeriod="1991-12")) -->
<!-- plot(as.Date(paste(rates$obstime,"-15",sep="")),rates$obsvalue,type="l") -->
<!-- spf <- get_data( -->
<!--   "SPF.Q.U2.HICP.POINT.LT.Q.AVG", -->
<!--   filter=list(startPeriod="1991-12")) -->
<!-- spf$obstime <- gsub("Q1", "02-15", spf$obstime) -->
<!-- spf$obstime <- gsub("Q2", "05-15", spf$obstime) -->
<!-- spf$obstime <- gsub("Q3", "08-15", spf$obstime) -->
<!-- spf$obstime <- gsub("Q4", "11-15", spf$obstime) -->
<!-- lines(as.Date(paste(spf$obstime,"-15",sep="")),spf$obsvalue,lty=3) -->
<!-- ``` -->
<div id="RFIntroduction" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Introduction</h2>
<p>Risk-free yields are the yields-to-maturity associated with bonds that carry no default and/or liquidity risks. Bonds issued by sovereign entities with top credit quality are usually considered to be risk-free.</p>
<p>An important share of the term-structure literature pertains to the modelling of risk-free yields. Some models involve macro factors in <span class="math inline">\(w_t\)</span> <span class="citation">(<a href="TSM.html#ref-Ang_Piazzesi_2003">Ang and Piazzesi 2003</a>)</span>; some do not <span class="citation">(<a href="TSM.html#ref-Duffie_Singleton_1997">Darrel Duffie and Singleton 1997</a>)</span>. The latter are sometimes called <em>yield-only</em> models.</p>
<p>The basic pricing formula of a risk-free zero coupon bond is (see Eq. <a href="ChapterAffine.html#eq:stdbond">(1.10)</a> in Example <a href="ChapterAffine.html#exm:nominalBth">1.18</a>):
<span class="math display" id="eq:stdbondRFchapter">\[\begin{eqnarray}
B(t,h) &amp;=&amp; \exp(-r_{t}) \mathbb{E}^{\mathbb{Q}}_t \exp(-r_{t+1}-\dots-r_{t+h-1})\\
R(t,h) &amp;=&amp; - \frac{1}{h} \log B(t,h). \tag{3.1}
\end{eqnarray}\]</span></p>
<p>Term structure models are often used to extract <em>term premiums</em> from observed yields-to-maturity. Term premiums are those components of yields that would not exist if investors were not risk-averse.</p>
<p>If agents were not risk averse, i.e., under the <em>Expectation Hypothesis (EH)</em>, we would have <span class="math inline">\(\mathcal{M}_{t,t+1} = \exp(- r_t)\)</span>. We would then have <span class="math inline">\(\mathbb{P} \equiv \mathbb{Q}\)</span> and <span class="math inline">\(B(t,h)\)</span> would become:
<span class="math display" id="eq:stdbondRFchapterP">\[\begin{equation}
\exp(-r_{t}) \mathbb{E}_t \exp(-r_{t+1}-\dots-r_{t+h-1}).\tag{3.2}
\end{equation}\]</span>
And the maturity-<span class="math inline">\(h\)</span> yield-to-maturity would then be:
<span class="math display" id="eq:REH">\[\begin{eqnarray}
R^{EH}(t,h) &amp;=&amp; -\frac{1}{h}\log \left( \mathbb{E}_t \exp(-r_t-\dots-r_{t+h-1})\right)\nonumber\\
&amp;\approx&amp; \frac{1}{h}\mathbb{E}_t(r_t + \dots + r_{t+h-1}).\tag{3.3}
\end{eqnarray}\]</span></p>
<p>The term premium is given by:
<span class="math display" id="eq:TP">\[\begin{eqnarray}
TP_{t,h} &amp;=&amp; \underbrace{- \frac{1}{h} \log  \mathbb{E}^{\mathbb{Q}}_t \exp(-r_{t+1}-\dots-r_{t+h-1})}_{=R(t,h)} - \nonumber \\
&amp;&amp; \underbrace{- \frac{1}{h}  \log  \mathbb{E}_t \exp(-r_{t+1}-\dots-r_{t+h-1}).}_{=R^{EH}(t,h)}\tag{3.4}
\end{eqnarray}\]</span></p>
<p>What is the economic meaning of the term premium? Under EH, investors are willing to buy a maturity-<span class="math inline">\(h\)</span> bond as long as its expected return is—up to Jensen’s inequality—equal to the average of future short-term rates. (Hence the definition of <span class="math inline">\(R^{EH}(t,h)\)</span>, see Eq. <a href="TSM.html#eq:REH">(3.3)</a>.) When <span class="math inline">\(TP_{t,h}&gt;0\)</span>, investors are willing to buy the maturity-<span class="math inline">\(h\)</span> bond only if its return is, on average, higher than expected future short-term rates; this corresponds to a situation where investors consider that long-term bonds tend to lose value in <em>bad states of the world</em> (i.e., states of high marginal utility).</p>
<blockquote>
<p><strong><em>Risk premium:</em></strong> According to Eq. <a href="#eq:Mbasicpricing">(<strong>??</strong>)</a>, the price of any asset <span class="math inline">\(j\)</span> satisfies:
<span class="math display">\[
p_{jt} = \mathbb{E}_t(\mathcal{M}_{t,t+1} p_{j,t+1}).
\]</span>
The previous equation rewrites:
<span class="math display">\[
p_{jt} =  \mathbb{C}ov_t(\mathcal{M}_{t,t+1}, p_{j,t+1}) + \mathbb{E}_t(\mathcal{M}_{t,t+1})\mathbb{E}_t( p_{j,t+1})
\]</span>
or
<span class="math display" id="eq:CovRP">\[\begin{equation}
p_{jt} = \underbrace{\exp(-r_t)\mathbb{E}_t( p_{j,t+1})}_{=p^{EH}_{jt}} + \underbrace{\mathbb{C}ov_t(\mathcal{M}_{t,t+1}, p_{j,t+1})}_{\mbox{Risk premium}}.\tag{3.5}
\end{equation}\]</span>
If investors were not risk-averse, then we would have <span class="math inline">\(p_{jt} = p^{EH}_{jt}\)</span>. The S.D.F. is high (resp. low) in bad (resp. good) states of the world (states of high marginal utility in the equilibrium approach). Hence, we have <span class="math inline">\(p_{jt}&lt; p^{EH}_{jt}\)</span> if asset <span class="math inline">\(j\)</span> tends to pay less in bad states of the world (i.e., if <span class="math inline">\(\mathbb{C}ov_t(\mathcal{M}_{t,t+1}, p_{j,t+1})&lt;0\)</span>).</p>
</blockquote>
<p>Bonds issued by top-rated (Aaa/AAA) countries are often considered to be risk-free. Because of call-margins mechanisms, swap rates are also used as risk-free benchmarks <span class="citation">(<a href="TSM.html#ref-Duffie_Stein_2015">Darrell Duffie and Stein 2015</a>)</span> (see Subsection <a href="#Swaps"><strong>??</strong></a>).</p>
<p>If agents were risk-neutral, we would have:
<span class="math display">\[
B_{t,n} = \exp(-R_{t,m})\mathbb{E}_t(B_{t+m,n-m}).
\]</span>
This would imply:
<span class="math display">\[
-n R_{t,n} = -R_{t,m} + \log \mathbb{E}_t[\exp(-(n-m) R_{t+m,n-m})].
\]</span>
Up to the Jensen inequality, and taking expectations on both sides, we get:
<span class="math display">\[
-n R_{t,n} \approx \mathbb{E}_t(-R_{t,m} -(n-m) R_{t+m,n-m}).
\]</span>
After having reorganized:
<span class="math display" id="eq:CStheo">\[\begin{equation}
\mathbb{E}_t(R_{t+m,n-m}-R_{t,n}) \approx \frac{R_{t,n}-R_{t,m}}{n-m}.\tag{3.6}
\end{equation}\]</span></p>
<p><span class="citation">Campbell and Shiller (<a href="TSM.html#ref-Campbell_Shiller_1991">1991</a>)</span> have used the previous expression to test for the Expectation hypothesis. Formally, they run the following regressions for different values of <span class="math inline">\(n\)</span> and <span class="math inline">\(m\)</span>:
<span class="math display">\[
R_{t+m,n-m}-R_{t,n}) = \phi_n\frac{R_{t,n}-R_{t,m}}{n-m} + \varepsilon_{t+m}
\]</span></p>
<p>According to <a href="TSM.html#eq:CStheo">(3.6)</a>, under the Expectation Hypothesis, we should have <span class="math inline">\(\phi_{n,m} \approx 1\)</span>. But they do find that the <span class="math inline">\(\phi_{n,m}\)</span> are statistically lower than one. Besides, they find that, for a given holding period <span class="math inline">\(m\)</span>, the term structure of the <span class="math inline">\(\phi_{n,m}\)</span> decreases with the maturity <span class="math inline">\(n\)</span>. Figure <a href="TSM.html#fig:CSregressions">3.1</a> shows</p>
<div class="figure" style="text-align: left-aligned"><span style="display:block;" id="fig:CSregressions"></span>
<img src="TSM_files/figure-html/CSregressions-1.png" alt="Regressions as in Campbell and Shiller (1991). Data are at the monthly frequency; they are collected from the FRED database. The estimation period starts in 1990. The figure reports 90% confidence intervals of the $\phi_{n,m}$ parameter estimates (Newey-West robust standard deviations)." width="95%" />
<p class="caption">
Figure 3.1: Regressions as in Campbell and Shiller (1991). Data are at the monthly frequency; they are collected from the FRED database. The estimation period starts in 1990. The figure reports 90% confidence intervals of the <span class="math inline">\(\phi_{n,m}\)</span> parameter estimates (Newey-West robust standard deviations).
</p>
</div>
</div>
<div id="RiskFreeAffine" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> The Affine Case</h2>
<div id="affine-yields" class="section level3" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> Affine yields</h3>
<p>In this subsection, we consider the case where the state vector <span class="math inline">\(w_t\)</span> is affine under both <span class="math inline">\(\mathbb{P}\)</span> and <span class="math inline">\(\mathbb{Q}\)</span>. If the nominal short-term rate is affine in <span class="math inline">\(w_t\)</span>, i.e., if <span class="math inline">\(r_t = \omega_0 + \omega&#39;_1 w_t\)</span>, then:
<span class="math display">\[\begin{eqnarray*}
B(t,h) &amp;=&amp; \mathbb{E}^{\mathbb{Q}}_t \exp (-r_{t}-\dots-r_{t+h-1})\\
&amp;=&amp; \exp(-h\omega_0 - \omega&#39;_1 w_t) \color{blue}{\mathbb{E}^{\mathbb{Q}}_t \exp (- \omega&#39;_1 w_{t+1}-\dots- \omega&#39;_1 w_{t+h-1})}.
\end{eqnarray*}\]</span>
The (blue) expectation is easily computed using the recursive equations of Lemma <a href="ChapterAffine.html#lem:MHLT">1.5</a> (see Example <a href="ChapterAffine.html#exm:nominalBth">1.18</a>), leading to:
<span class="math display" id="eq:RthAB">\[\begin{equation}
R(t,h)= -  \frac{1}{h}   \log   B(t,h) = A_h&#39;w_t + B_h.\tag{3.7}
\end{equation}\]</span>
It is easily seen that we can also get:
<span class="math display" id="eq:RthABEH">\[\begin{equation}
R^{EH}(t,h) = {A^{EH}_h}&#39;w_t + B^{EH}_h.\tag{3.8}
\end{equation}\]</span>
Moreover, if inflation is also affine in <span class="math inline">\(w_t\)</span>, i.e., if <span class="math inline">\(\pi_{t} = \bar\omega_0 + \bar\omega&#39;_1 w_t\)</span>, then real yields are given by:
<span class="math display">\[\begin{eqnarray*}
\bar{B}(t,h) &amp;=&amp; \mathbb{E}^{\mathbb{Q}}_t \exp(-r_{t}-\dots-r_{t+h-1}+\pi_{t+1}+\dots+\pi_{t+h})
\end{eqnarray*}\]</span>
(see Example <a href="ChapterAffine.html#exm:realBth">1.20</a>) which also leads to:
<span class="math display" id="eq:RbarthAB">\[\begin{equation}
\bar{R}(t,h) = -  \frac{1}{h}   \log   \bar{B}(t,h) = \bar{A}_h&#39;w_t + \bar{B}_h.\tag{3.9}
\end{equation}\]</span>
Eqs. <a href="TSM.html#eq:RthAB">(3.7)</a> and <a href="TSM.html#eq:RthABEH">(3.8)</a> imply that term premiums are affine in <span class="math inline">\(w_t\)</span> (see Eq. <a href="TSM.html#eq:TP">(3.4)</a>). Specifically:
<span class="math display">\[
TP(t,h) = R(t,h) - E^{EH}(t,h) = B_h - B_h^{EH} + (A_h - A_h^{EH})&#39;w_t.
\]</span>
Expected excess returns resulting from holding zero-coupon bonds are also affine in <span class="math inline">\(w_t\)</span>. Indeed, holding a maturity-<span class="math inline">\(h\)</span> zero-coupon bond for one period provides the following expected gross return:
<span class="math display">\[
\mathbb{E}_t\left(\frac{B(t+1,h-1)}{B(t,h)}\right) = \mathbb{E}_t\left(\exp(B_{h-1} - B_h + A_{h-1}&#39;w_{t+1} - A_h&#39;w_{t})\right),
\]</span>
which is clearly exponential affine in <span class="math inline">\(w_t\)</span> if <span class="math inline">\(w_t\)</span> is an affine process. Therefore, the expected excess return, that is:
<span class="math display">\[
\log \mathbb{E}_t\left(\frac{B(t+1,h-1)}{B(t,h)}\right) - r_t
\]</span>
is also affine in <span class="math inline">\(w_t\)</span> in this context. The fact that excess returns are affine in this context is exploited in the estimation approach proposed by <span class="citation">Adrian, Crump, and Moench (<a href="TSM.html#ref-Adrian_Crump_Moench_2013">2013</a>)</span>.</p>
<p>Moreover, <em>conditional expectations</em> of future interest rates (real or nominal) and of term premiums are also affine in <span class="math inline">\(w_t\)</span>. In particular:
<span class="math display" id="eq:condmeanRth">\[\begin{equation}
\mathbb{E}_t[R(t+k,h)] = \mathbb{E}_t[{A_h}&#39;w_{t+k} + B_h] = {A_h}&#39;\mathbb{E}_t(w_{t+k}) + B_h,\tag{3.10}
\end{equation}\]</span>
and <span class="math inline">\(\mathbb{E}_t(w_{t+k})\)</span> is affine in <span class="math inline">\(w_t\)</span> (see Eq. <a href="ChapterAffine.html#eq:condmean">(1.15)</a>). This can notably be used at the estimation stage, if one wants to fit survey data (see Section XXX).</p>
<p>Similarly, <em>conditional variances</em> of future interest rates (real or nominal) and of term premiums are affine in <span class="math inline">\(w_t\)</span>. In particular:
<span class="math display" id="eq:condvarRth">\[\begin{equation}
\mathbb{V}ar_t[R(t+k,h)] = \mathbb{V}ar_t[{A_h}&#39;w_{t+k} + B_h] = {A_h}&#39;\mathbb{V}ar_t(w_{t+k})A_h,\tag{3.11}
\end{equation}\]</span>
where the components of <span class="math inline">\(\mathbb{V}ar_t(w_{t+k})\)</span> (and therefore <span class="math inline">\(\mathbb{V}ar_t[R(t+k,h)]\)</span>) is affine in <span class="math inline">\(w_t\)</span> (see Eq. <a href="ChapterAffine.html#eq:condvar">(1.16)</a>). This can also be used at the estimation stage, if one wants to fit (proxies of) conditional variances <span class="citation">(<a href="TSM.html#ref-zarg_2017">Monfort et al. 2017</a>)</span>.</p>
</div>
<div id="maximum-sharpe-ratio" class="section level3" number="3.2.2">
<h3><span class="header-section-number">3.2.2</span> Maximum Sharpe ratio</h3>
<p>In an affine model, the maximum Sharpe ratio is easily computed. This has been noted early by <span class="citation">Duffee (<a href="TSM.html#ref-Duffee_2010">2010</a>)</span> for the Gaussian model; <span class="citation">Gourieroux et al. (<a href="TSM.html#ref-Gourieroux_Monfort_Mouabbi_Renne_2021">2021</a>)</span> and <span class="citation">Pallara and Renne (<a href="TSM.html#ref-Pallara_Renne_2023">2023</a>)</span> use it in more sophisticated affine models.</p>
<p>Let us derive the maximum Sharpe ratio in the context of a genral affine framework. Eq. <a href="TSM.html#eq:CovRP">(3.5)</a> implies that
<span class="math display">\[
\mathbb{E}_t\underbrace{\left(\frac{p_{j,t+1}}{p_{j,t}} - \exp(r_t)\right)}_{=xs_{j,t+1},\mbox{ excess return}} =  - \exp(r_t) \mathbb{C}ov_t\left(\mathcal{M}_{t,t+1},\frac{p_{j,t+1}}{p_{j,t}}\right),
\]</span>
and, using <span class="math inline">\(|\mathbb{C}ov(X,Y)| \le \sqrt{\mathbb{V}ar(X)\mathbb{V}ar(Y)}\)</span>, we get the <span class="citation">Hansen and Jagannathan (<a href="TSM.html#ref-Hansen_Jagannathan_1991">1991</a>)</span> bound:
<span class="math display">\[\begin{equation}
\underbrace{\frac{\mathbb{E}_t(xs_{j,t+1})}{\sqrt{\mathbb{V}ar_t(xs_{j,t+1})}}}_{\mbox{Sharpe ratio}} \le \underbrace{\frac{\sqrt{\mathbb{V}ar_t(\mathcal{M}_{t,t+1})}}{\mathbb{E}_t(\mathcal{M}_{t,t+1})}}_{\mbox{Maximum Sharpe ratio}}.
\end{equation}\]</span></p>
<p>If the S.D.F. is given by <span class="math inline">\(\mathcal{M}_{t,t+1} = \exp[-r_{t}+\alpha&#39;_tw_{t+1}-\psi_t(\alpha_t)]\)</span> (Eq. <a href="pricing-and-risk-neutral-dynamics.html#eq:keySDF">(2.2)</a>), and using that <span class="math inline">\(\mathbb{E}_t(\mathcal{M}_{t,t+1}^2)=\exp(-2r_t+\psi_t(2\alpha_t)-2\psi_t(\alpha_t))\)</span> we get:
<span class="math display">\[
\mbox{Maximum Sharpe ratio} = \sqrt{\exp(\psi_t(2\alpha_t)-2\psi_t(\alpha_t)) - 1}.
\]</span></p>
</div>
</div>
<div id="RiskFreeGaussian" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Gaussian Affine Term Structure Model</h2>
<p>The Gaussian Affine Term Structure Model (GATSM) is a <em>workhorse</em> model, widely used in academic and economic-policy circles. In a GATSM, <span class="math inline">\(w_t\)</span> follows a Gaussian vector autoregressive model, and is therefore affine under <span class="math inline">\(\mathbb{P}\)</span>. The S.D.F. is exponential affine in <span class="math inline">\(w_t\)</span>, which implies that it is also affine under <span class="math inline">\(\mathbb{Q}\)</span> (see Subsection XXX). Since the components of <span class="math inline">\(w_t\)</span> are valued in <span class="math inline">\(\mathbb{R}\)</span>, one can easily introduce macro-factors among the state variables.</p>
<p>Let us be more specific. The state vector <span class="math inline">\(w_t\)</span> follows:
<span class="math display" id="eq:GaussianVAR1">\[\begin{equation}
w_{t+1} = \mu + \Phi w_{t} + \Sigma^{1/2} \varepsilon_{t+1}, \mbox{ where } \varepsilon_{t} \sim  i.i.d. \mathcal{N}(0,Id).\tag{3.12}
\end{equation}\]</span>
(The fact that we consider a VAR(1) process is without loss of generality since a VAR(p) admits a VAR(1) companion representation.)</p>
<p>This implies the following Laplace transform for <span class="math inline">\(w_t\)</span> (see Example <a href="#exm:Gaussian"><strong>??</strong></a>):
<span class="math display">\[
\psi_t(u) = \log \mathbb{E}_t(\exp(u&#39;w_{t+1})|\underline{w_t}) = \color{blue}{u&#39;\mu + u&#39;\Phi w_t + \frac{1}{2}u&#39;\Sigma&#39;u}.
\]</span>
Using the notations of Eq. <a href="pricing-and-risk-neutral-dynamics.html#eq:keySDF">(2.2)</a>, the s.d.f. is defined as:
<span class="math display">\[
\mathcal{M}_{t,t+1} = \exp(- r_t + \alpha_t&#39;w_{t+1} - \psi_t(\alpha_t)), \mbox{ where } \alpha_t = \alpha_0 + \alpha_1&#39;w_t.
\]</span></p>
<p>In that case, using Eq. <a href="pricing-and-risk-neutral-dynamics.html#eq:transfoPQ">(2.4)</a>, we get:
<span class="math display">\[\begin{eqnarray*}
\psi_t^{\mathbb{Q}}(u) &amp;=&amp; \psi_t(u + \alpha_t) - \psi_t(\alpha_t)\\
&amp;=&amp; (u + \alpha_t)&#39;\mu + (u + \alpha_t)&#39;\Phi w_t + \frac{1}{2}(u + \alpha_t)&#39;\Sigma(u + \alpha_t) \\
&amp;&amp; - \left(\alpha_t&#39;\mu + \alpha_t&#39;\Phi w_t + \frac{1}{2}\alpha_t&#39;\Sigma\alpha_t\right) \\
&amp;=&amp; \color{blue}{u&#39; \left(\mu + \Sigma \alpha_0 \right) + u&#39;(\Phi + \Sigma \alpha_1&#39;)w_t  + \frac{1}{2}u&#39;\Sigma&#39;u}.
\end{eqnarray*}\]</span>
The <span class="math inline">\(\mathbb{Q}\)</span>-dynamics of <span class="math inline">\(w_t\)</span> is (from Example <a href="#exm:Gaussian"><strong>??</strong></a>):
<span class="math display">\[
w_{t+1} = \mu + \Sigma  \alpha_0 + (\Phi + \Sigma \alpha_1&#39;)  w_{t} + \Sigma^{1/2} \varepsilon^*_{t+1}, \mbox{ where } \varepsilon^*_{t} \sim  i.i.d. \mathcal{N}^{\mathbb{Q}}(0,Id).
\]</span>
Hence, <span class="math inline">\(w_t\)</span> also follows a VAR process under <span class="math inline">\(\mathbb{Q}\)</span> since the previous equation rewrites:
<span class="math display">\[
w_{t+1} = \mu^{\mathbb{Q}} + \Phi^{\mathbb{Q}} w_{t} + \Sigma^{1/2} \varepsilon^*_{t+1},
\]</span>
where <span class="math inline">\(\mu^{\mathbb{Q}} = \mu + \Sigma \alpha_0\)</span> and <span class="math inline">\(\Phi^{\mathbb{Q}}=\Phi + \Sigma \alpha_1&#39;\)</span>.</p>
<p>With affine specifications of the nominal short term rate (<span class="math inline">\(r_{t} = \omega_0 + \omega&#39;_1 w_t\)</span>) and of the inflation rate (<span class="math inline">\(\pi_{t} = \bar\omega_0 + \bar\omega&#39;_1 w_t\)</span>), we obtain affine formulas for nominal and real yields of any maturity (Eqs. <a href="TSM.html#eq:RthAB">(3.7)</a> and <a href="TSM.html#eq:RbarthAB">(3.9)</a>).</p>
<div class="example">
<p><span id="exm:KimWright" class="example"><strong>Example 3.1  (Kim and Wright (2005)) </strong></span>This model is a three-factor <em>yield-only model</em> (no macro variables, except inflation in one variant of the model), where the short-term rate reads <span class="math inline">\(r_t = \omega_0 + \omega_{1,1} w_{1,t} +\omega_{1,2} w_{2,t} +\omega_{1,3} w_{3,t}\)</span>.</p>
<p>The model estimated by Kalman filter (see Subsection,<a href="#Estimation:KF"><strong>??</strong></a>; the state-space model (Def. <a href="#def:LSSM"><strong>??</strong></a>) includes survey-based variables (see Subsection <a href="#EstimationPersistency"><strong>??</strong></a>).</p>
<p>Outputs are <a href="https://www.federalreserve.gov/pubs/feds/2005/200533/200533abs.html">regularly updated by the Federal Reserve Board</a>.</p>
<p>Monthly data on the 6-month and 12-month-ahead forecasts of the three-month T-Bill yield from Blue Chip Financial Forecasts and semiannual data on the average expected three-month T-Bill yield from 6 to 11 years.</p>
<div class="figure" style="text-align: left-aligned"><span style="display:block;" id="fig:fredKW"></span>
<img src="TSM_files/figure-html/fredKW-1.png" alt="Kim and Wright (2005) outputs." width="95%" />
<p class="caption">
Figure 3.2: Kim and Wright (2005) outputs.
</p>
</div>
</div>
<div class="example">
<p><span id="exm:AngPiazzesi" class="example"><strong>Example 3.2  (Ang and Piazzesi (2003)) </strong></span><span class="citation">Ang and Piazzesi (<a href="TSM.html#ref-Ang_Piazzesi_2003">2003</a>)</span> propose one of the first paper mixing latent and macrovariables. The set up is also of the form Eq. <a href="TSM.html#eq:GaussianVAR1">(3.12)</a>, except that the VAR features several lags.<a href="#fn7" class="footnote-ref" id="fnref7"><sup>7</sup></a> In their model, <span class="math inline">\(w_t = [f^{o}_{1,t},f^{o}_{2,t},f^{u}_{1,t},f^{u}_{2,t},f^{u}_{3,t}]&#39;\)</span> where:</p>
<ul>
<li><span class="math inline">\(f^{o}_{1,t}\)</span> is the first Principal Component of a set of 3 price indexes (growth rates)</li>
<li><span class="math inline">\(f^{o}_{2,t}\)</span> is the first Principal Component of a set of 4 real activity proxies (HELP, EMPLOY, IP, UE).</li>
<li><span class="math inline">\(f^{u}_{i,t}\)</span> are unobserved, or latent, factors.</li>
</ul>
<p>The nominal short-term rate follows a Taylor rule. And latent factors are estimated via <em>inversion techniques</em> (Subsection <a href="#EstimationInversion"><strong>??</strong></a>).</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:figAngPiazzesi"></span>
<img src="figures/AngPiazzesi1.png" alt="Source: Ang and Piazzesi (1998). Impulse response functions." width="95%" />
<p class="caption">
Figure 3.3: Source: Ang and Piazzesi (1998). Impulse response functions.
</p>
</div>
</div>
<div class="example">
<p><span id="exm:JPS" class="example"><strong>Example 3.3  (Joslin, Priebsch and Singleton (2014)) </strong></span><span class="citation">Joslin, Priebsch, and Singleton (<a href="TSM.html#ref-Joslin_Priebsch_Singleton_2014">2014</a>)</span> first note that affine models stating that the short term rate is affine in macro factors imply that macro-factors are <em>spanned</em> by the yield curve: macro-factors should be perfectly explained by yields of different maturities. Further, they show that this is not the case in the data. (That is, regressing macro factors on yields provides <span class="math inline">\(R^2\)</span> that are far from one.)</p>
<p>They propose a model where macro factors are unspanned by the yield curve, but can still help predict yields. In their model, <span class="math inline">\(w_t = [\mathcal{P}_t&#39;,M_t&#39;]&#39;\)</span>, where <span class="math inline">\(\mathcal{P}_t\)</span> are yield factors (<span class="math inline">\(\approx\)</span> principal components) and <span class="math inline">\(M_t\)</span> are macro factors. The model is as follows:
<span class="math display">\[\begin{eqnarray*}
r_t &amp;=&amp; \omega_{0} + \omega_{\mathcal{P}}&#39;\mathcal{P}_t \\
\left[\begin{array}{c}\mathcal{P}_t \\ M_t \end{array}\right]
&amp;=&amp;
\left[\begin{array}{cc}\Phi_{\mathcal{P}\mathcal{P}}&amp;\Phi_{\mathcal{P}M} \\
\Phi_{M\mathcal{P}}&amp;\Phi_{MM} \end{array}\right]
\left[\begin{array}{c}\mathcal{P}_{t-1} \\ M_{t-1} \end{array}\right] + \Sigma \varepsilon_t \\
\left[\begin{array}{c}\mathcal{P}_t \\ M_t \end{array}\right] &amp;=&amp; \mu +
\left[\begin{array}{cc}\Phi^{\mathbb{Q}}_{\mathcal{P}\mathcal{P}}&amp;{\color{red}0} \\
\Phi^{\mathbb{Q}}_{M\mathcal{P}}&amp;\Phi^{\mathbb{Q}}_{MM} \end{array}\right]
\left[\begin{array}{c}\mathcal{P}_{t-1} \\ M_{t-1} \end{array}\right] + \Sigma \varepsilon^{\mathbb{Q}}_t,
\end{eqnarray*}\]</span>
where <span class="math inline">\(\varepsilon_t\)</span> and <span class="math inline">\(\varepsilon^{\mathbb{Q}}_t\)</span> are <span class="math inline">\(\mathcal{N}(0,Id)\)</span> under <span class="math inline">\(\mathbb{P}\)</span> and <span class="math inline">\(\mathbb{Q}\)</span>, respectively.</p>
<p><span class="math inline">\(M_t\)</span> does Granger-cause <span class="math inline">\(\mathcal{P}_t\)</span> under <span class="math inline">\(\mathbb{Q}\)</span> and <span class="math inline">\(r_t\)</span> is affine in <span class="math inline">\(\mathcal{P}_t\)</span> (only).</p>
<p>In this context, yields <span class="math inline">\(R(t,h)\)</span> are affine in <span class="math inline">\(\mathcal{P}_t\)</span> (only). However <span class="math inline">\(M_t\)</span> does Granger-cause <span class="math inline">\(\mathcal{P}_t\)</span> under <span class="math inline">\(\mathbb{P}\)</span>, that is, macro-shocks affect the yield curve.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:JPSIRF"></span>
<img src="figures/JPS_IRF.png" alt="Source: Joslin, Priebsch, and Singleton (2014). Impulse response functions." width="95%" />
<p class="caption">
Figure 3.4: Source: Joslin, Priebsch, and Singleton (2014). Impulse response functions.
</p>
</div>
</div>
<div class="example">
<p><span id="exm:Angetal2011" class="example"><strong>Example 3.4  (Ang, Boivin, Dong and Loo-Kung (2011)) </strong></span><span class="citation">Ang et al. (<a href="TSM.html#ref-Ang_Boivin_Dong_LooKung_2011">2011</a>)</span> propose a macro-finance model based on a quadratic framework. The short-term rate follows a Taylor rule with time-varying parameters:
<span class="math display">\[
r_t = \omega_0 + a_t g_t + b_t \pi_t,
\]</span>
where <span class="math inline">\(x_t=(g_t,\pi_t,a_t,b_t)&#39;\)</span> follows a Gaussian VAR. This is the context described in Example <a href="ChapterAffine.html#exm:QGVAR1">1.7</a>. The previous equation shows that <span class="math inline">\(r_t\)</span> is linear in <span class="math inline">\(w_t = (x_t,vec(x_t x_t&#39;)&#39;)&#39;\)</span>. Specifically:
<span class="math display">\[
r_t = \omega_0 + \omega_1&#39;w_t,
\]</span>
with <span class="math inline">\(\omega_1 = [v,vec(V)]&#39;\)</span>, where
<span class="math display">\[
v = \left[
\begin{array}{c}
0\\
0\\
0\\
0
\end{array}
\right] \quad \mbox{and} \quad V = \left[
\begin{array}{cccc}
0 &amp; 0&amp; 1/2&amp;0\\
0&amp; 0&amp; 0&amp;1/2\\
1/2&amp; 0&amp; 0&amp;0\\
0&amp;1/2 &amp;0 &amp;0
\end{array}
\right].
\]</span></p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:AngBoivin"></span>
<img src="figures/Ang_Boivin_loadings.png" alt="Source: Ang, Boivin, Dong, Loo-Kung (2011). Estimated factor loadings ($a_t$ and $b_t$)." width="70%" />
<p class="caption">
Figure 3.5: Source: Ang, Boivin, Dong, Loo-Kung (2011). Estimated factor loadings (<span class="math inline">\(a_t\)</span> and <span class="math inline">\(b_t\)</span>).
</p>
</div>
</div>
</div>
<div id="RiskFreeNonNegative" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Non-Negative Affine Term Structure Model</h2>
<p>In the presence of physical currency, absence of arbitrage opportunity and of storing cost of cash, nominal interest rates should be nonnegative. Many standard models (e.g. Gaussian ATSM) are non consistent with non-negative nominal yields. The period of extremely low interest rates challenged these models. Against this backdrop, approaches have been developed to accommodate zero (or effective) lower bounds. We provide two examples; only the second is an affine model.</p>
<div id="the-shadow-rate-approach" class="section level3" number="3.4.1">
<h3><span class="header-section-number">3.4.1</span> The shadow-rate approach</h3>
<p>The shadow-rate model is originally due to <span class="citation">Black (<a href="TSM.html#ref-Black_1995">1995</a>)</span>. In this model, the short term rate is given by:
<span class="math display" id="eq:SRSTR">\[\begin{equation}
r_t = \max(s_t,\underline{r}),\tag{3.13}
\end{equation}\]</span>
where <span class="math inline">\(s_t\)</span> is the shadow short-term interest rate and <span class="math inline">\(\underline{r}\)</span> is the effective lower bound (<span class="math inline">\(\le 0\)</span>). While <span class="math inline">\(s_t\)</span> can be real-valued, the short term rate is nonnegative under <a href="TSM.html#eq:SRSTR">(3.13)</a>. In shadow-rate models, the shadow rate <span class="math inline">\(s_t\)</span> is usually a linear combination of a vector <span class="math inline">\(w_t\)</span> that follows a Gaussian auto-regressive model. While <span class="math inline">\(s_t\)</span> is a linear combination of components of an affine process, this is not the case for <span class="math inline">\(r_t\)</span>. As a result, pricing formula are not available in closed-form. Approximation formula have been proposed by, e.g., <span class="citation">Krippner (<a href="TSM.html#ref-Krippner_2013">2013</a>)</span>, <span class="citation">Priebsch (<a href="TSM.html#ref-Priebsch_2013">2013</a>)</span>, <span class="citation">Wu and Xia (<a href="TSM.html#ref-Wu_Xia_2016">2016</a>)</span>.</p>
<p>Let us describe the latter approach <span class="citation">(<a href="TSM.html#ref-Wu_Xia_2016">Wu and Xia 2016</a>)</span>. As in Subsection <a href="TSM.html#RiskFreeGaussian">3.3</a>, the S.D.F. is defined as:
<span class="math display">\[
\mathcal{M}_{t,t+1} = \exp(- r_t + \alpha_t&#39;w_{t+1} - \psi_t(\alpha_t)), \mbox{ where } \alpha_t = \alpha_0 + \alpha_1&#39;w_t,
\]</span>
(this is Eq. <a href="pricing-and-risk-neutral-dynamics.html#eq:keySDF">(2.2)</a>), but the short-term rate <span class="math inline">\(r_t\)</span> is given by <span class="math inline">\(r_t = \max(s_t,0)\)</span>, with
<span class="math display">\[
s_t = \delta_0 + \delta_1&#39; w_t.
\]</span></p>
<p>The approximation approach proposed by <span class="citation">Wu and Xia (<a href="TSM.html#ref-Wu_Xia_2016">2016</a>)</span> is based on an approximation to the conditional expectations of forward rates. Using the results of Subsection <a href="#FWD"><strong>??</strong></a>, we have (Eq. <a href="#eq:forward">(<strong>??</strong>)</a>):
<span class="math display">\[
f_{n-1,n,t} = n R_{t,n} - (n-1) R_{t,n-1}.,
\]</span>
for <span class="math inline">\(n&gt;0\)</span> (and using <span class="math inline">\(R_{t,0}=0\)</span>). This implies that:
<span class="math display">\[
R_{t,h} =  \frac{1}{h}(f_{t,0,1}+f_{t,1,2}+\dots+f_{t,h-1,h}).
\]</span></p>
<p>The approximation of <span class="citation">Wu and Xia (<a href="TSM.html#ref-Wu_Xia_2016">2016</a>)</span> consists in finding approximations of the forward rates <span class="math inline">\(f_{t,n-1,n}\)</span> (denoted by <span class="math inline">\(\tilde{f}_{t,n-1,n}\)</span>, say) and to use them in the previous equation to get:
<span class="math display" id="eq:RapproxSR">\[\begin{equation}
\boxed{R_{t,h} \approx  \frac{1}{h}\left(\tilde{f}_{t,0,1}+\tilde{f}_{t,1,2}+\dots+\tilde{f}_{t,h-1,h}\right).}\tag{3.14}
\end{equation}\]</span></p>
<p>Using that, for any random variable <span class="math inline">\(Z\)</span>, we have <span class="math inline">\(\log(\mathbb{E}[e^Z]) \approx \mathbb{E}[Z] + \frac{1}{2} \mathbb{V}ar[Z]\)</span> (based on a second order Taylor expansion), <span class="citation">Wu and Xia (<a href="TSM.html#ref-Wu_Xia_2016">2016</a>)</span> further show that:
<span class="math display">\[\begin{eqnarray}
f_{t,n,n+1} &amp;=&amp; -\log\left(\mathbb{E}_t^{\mathbb{Q}}\left(e^{-\sum_{j=0}^n r_{t+j}}\right)\right) + \log\left(\mathbb{E}_t^{\mathbb{Q}}\left(e^{-\sum_{j=0}^{n-1} r_{t+j}}\right)\right)\\
&amp;\approx&amp; \mathbb{E}_t^{\mathbb{Q}}[r_{t+n}] - \frac{1}{2}\left(\mathbb{V}ar_t^{\mathbb{Q}}\left(\sum_{j=0}^n r_{t+j}\right)-\mathbb{V}ar_t^{\mathbb{Q}}\left(\sum_{j=0}^{n-1} r_{t+j}\right)\right).
\end{eqnarray}\]</span></p>
<p>The expectation can be computed analytically:
<span class="math display">\[
\mathbb{E}_t^{\mathbb{Q}}[r_{t+n}] = \underline{r} + \sigma_n^{\mathbb{Q}}g\left(\frac{\bar{a}_n + b_n&#39;X_t - \underline{r}}{\sigma_n^{\mathbb{Q}}}\right),
\]</span>
where <span class="math inline">\(g(x)= x\Phi(x)-\phi(x)\)</span>, <span class="math inline">\(\Phi\)</span> and <span class="math inline">\(\phi\)</span> being the c.d.f. and p.d.f. of the standard normal distribution, respectively, and where
<span class="math display">\[\begin{eqnarray*}
\bar{a}_n &amp;=&amp; \delta_0 + \delta_1&#39;\left(\sum_{j=0}^{n-1} \left[\Phi^{\mathbb{Q}}\right]^j\right)\mu^{\mathbb{Q}}\\
b_n&#39; &amp;=&amp; \delta_1&#39;\left(\Phi^{\mathbb{Q}}\right)^n.
\end{eqnarray*}\]</span>
They also show that
<span class="math display">\[
\frac{1}{2}\left(\mathbb{V}ar_t^{\mathbb{Q}}\left(\sum_{j=0}^n r_{t+j}\right)-\mathbb{V}ar_t^{\mathbb{Q}}\left(\sum_{j=0}^{n-1} r_{t+j}\right)\right) \approx \Phi\left(\frac{\bar{a}_n + b_n&#39;X_t - \underline{r}}{\sigma_n^{\mathbb{Q}}}\right)\times(\bar{a}_n - a_n),
\]</span>
where
<span class="math display">\[
a_n = \bar{a}_n - \frac{1}{2}\sigma_n^{\mathbb{Q}},
\]</span>
with
<span class="math display">\[
\sigma_n^{\mathbb{Q}} := \mathbb{V}ar^{\mathbb{Q}}_t\left(s_{t+n}\right)= \delta_1&#39;\left(\sum_{j=0}^{n-1} \left[\Phi^{\mathbb{Q}}\right]^j\right)\Sigma \Sigma&#39; \left(\sum_{j=0}^{n-1} \left[\Phi^{\mathbb{Q}}\right]^j\right)&#39;\delta_1.
\]</span>
They finally obtain:
<span class="math display">\[
\boxed{f_{t,n,n+1} \approx \tilde{f}_{t,n,n+1} = \underline{r} + \sigma_n^{\mathbb{Q}}g\left(\frac{a_n + b_n&#39;X_t - \underline{r}}{\sigma_n^{\mathbb{Q}}}\right),}
\]</span>
which is used in <a href="TSM.html#eq:RapproxSR">(3.14)</a> to obtain an approximation to <span class="math inline">\(R_{t,h}\)</span>.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="TSM.html#cb7-1" tabindex="-1"></a><span class="fu">library</span>(TSModels)</span>
<span id="cb7-2"><a href="TSM.html#cb7-2" tabindex="-1"></a><span class="co"># Specify model:</span></span>
<span id="cb7-3"><a href="TSM.html#cb7-3" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="co"># number of factors</span></span>
<span id="cb7-4"><a href="TSM.html#cb7-4" tabindex="-1"></a>rho <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,n,n)</span>
<span id="cb7-5"><a href="TSM.html#cb7-5" tabindex="-1"></a><span class="fu">diag</span>(rho) <span class="ot">&lt;-</span> .<span class="dv">97</span></span>
<span id="cb7-6"><a href="TSM.html#cb7-6" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,n,<span class="dv">1</span>)</span>
<span id="cb7-7"><a href="TSM.html#cb7-7" tabindex="-1"></a>Sigma <span class="ot">&lt;-</span> <span class="fu">diag</span>(n)</span>
<span id="cb7-8"><a href="TSM.html#cb7-8" tabindex="-1"></a>delta<span class="fl">.0</span> <span class="ot">&lt;-</span> <span class="dv">0</span>;delta<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">rep</span>(.<span class="dv">01</span>,n)</span>
<span id="cb7-9"><a href="TSM.html#cb7-9" tabindex="-1"></a>r.bar <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co"># r = max(s,r.bar) [i.e., r.bar=0 in standard model]</span></span>
<span id="cb7-10"><a href="TSM.html#cb7-10" tabindex="-1"></a>Model <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">rho =</span> rho,<span class="at">mu =</span> mu,<span class="at">Sigma =</span> Sigma,</span>
<span id="cb7-11"><a href="TSM.html#cb7-11" tabindex="-1"></a>              <span class="at">delta.0 =</span> delta<span class="fl">.0</span>,<span class="at">delta.1 =</span> delta<span class="fl">.1</span>,<span class="at">r.bar =</span> r.bar)</span>
<span id="cb7-12"><a href="TSM.html#cb7-12" tabindex="-1"></a><span class="co"># Simulate model and compute shadow rate:</span></span>
<span id="cb7-13"><a href="TSM.html#cb7-13" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">simul.var</span>(Model,<span class="at">nb.sim =</span> <span class="dv">200</span>) <span class="co"># simulated path</span></span>
<span id="cb7-14"><a href="TSM.html#cb7-14" tabindex="-1"></a>s <span class="ot">&lt;-</span> delta<span class="fl">.0</span> <span class="sc">+</span> X <span class="sc">%*%</span> delta<span class="fl">.1</span></span>
<span id="cb7-15"><a href="TSM.html#cb7-15" tabindex="-1"></a><span class="co"># Compute yields:</span></span>
<span id="cb7-16"><a href="TSM.html#cb7-16" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">compute.price.WX</span>(Model,X,<span class="at">max.H=</span><span class="dv">100</span>)</span>
<span id="cb7-17"><a href="TSM.html#cb7-17" tabindex="-1"></a><span class="co"># Prepare plots:</span></span>
<span id="cb7-18"><a href="TSM.html#cb7-18" tabindex="-1"></a><span class="fu">par</span>(<span class="at">plt=</span><span class="fu">c</span>(.<span class="dv">1</span>,.<span class="dv">95</span>,.<span class="dv">2</span>,.<span class="dv">75</span>))</span>
<span id="cb7-19"><a href="TSM.html#cb7-19" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>))</span>
<span id="cb7-20"><a href="TSM.html#cb7-20" tabindex="-1"></a><span class="fu">plot</span>(s,<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;time&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;&quot;</span>,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">main=</span><span class="st">&quot;(a) Shadow rate&quot;</span>)</span>
<span id="cb7-21"><a href="TSM.html#cb7-21" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="dv">50</span> <span class="co">#t &lt;- which(s==min(s))</span></span>
<span id="cb7-22"><a href="TSM.html#cb7-22" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span>t,<span class="at">col=</span><span class="st">&quot;dark grey&quot;</span>,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">lty=</span><span class="dv">3</span>)</span>
<span id="cb7-23"><a href="TSM.html#cb7-23" tabindex="-1"></a><span class="fu">plot</span>(res<span class="sc">$</span>vec.f[t,],<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;maturity&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;&quot;</span>,</span>
<span id="cb7-24"><a href="TSM.html#cb7-24" tabindex="-1"></a>     <span class="at">lwd=</span><span class="dv">2</span>,<span class="at">main=</span><span class="st">&quot;(b) yields and forward rates&quot;</span>)</span>
<span id="cb7-25"><a href="TSM.html#cb7-25" tabindex="-1"></a><span class="fu">lines</span>(res<span class="sc">$</span>vec.y[t,],<span class="at">col=</span><span class="st">&quot;red&quot;</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb7-26"><a href="TSM.html#cb7-26" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, </span>
<span id="cb7-27"><a href="TSM.html#cb7-27" tabindex="-1"></a>       <span class="fu">c</span>(<span class="st">&quot;forward rates&quot;</span>,<span class="st">&quot;yields to maturity&quot;</span>),<span class="at">lwd=</span><span class="fu">c</span>(<span class="dv">2</span>),<span class="at">lty=</span><span class="dv">1</span>,</span>
<span id="cb7-28"><a href="TSM.html#cb7-28" tabindex="-1"></a>       <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;black&quot;</span>,<span class="st">&quot;red&quot;</span>),<span class="at">bg =</span> <span class="st">&quot;white&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:WuXia"></span>
<img src="TSM_files/figure-html/WuXia-1.png" alt="bla bla bla." width="95%" />
<p class="caption">
Figure 3.6: bla bla bla.
</p>
</div>
</div>
<div id="the-auto-regressive-gamma-approach" class="section level3" number="3.4.2">
<h3><span class="header-section-number">3.4.2</span> The auto-regressive gamma approach</h3>
<p><span class="citation">Monfort et al. (<a href="TSM.html#ref-zarg_2017">2017</a>)</span> introduce an affine framework where the short-term rate can stay at zero for a prolonged period of time and with a stochastic lift-off probability.</p>
<p>Under <span class="math inline">\(\mathbb{P}\)</span> and <span class="math inline">\(\mathbb{Q}\)</span>, the state vector <span class="math inline">\(w_t\)</span> follows a multi-variate auto-regressive gamma (VARG) process—a multivariate extension of Example <a href="ChapterAffine.html#exm:ARG1">1.8</a>. Conditionally on <span class="math inline">\(\underline{w_t}\)</span>, the <span class="math inline">\(n\)</span> components of <span class="math inline">\(w_{t+1}\)</span> are independent and distributed as follows:
<span class="math display" id="eq:VARG">\[\begin{equation}
\frac{w_{i,t+1}}{\mu_i} \sim \gamma(\nu_i+z_{i,t}) \quad \mbox{where} \quad z_{i,t} \sim {\mathcal P} \left( \alpha_i + \beta_i&#39; w_t \right).\tag{3.15}
\end{equation}\]</span>
If <span class="math inline">\(\mu = (\mu_1,\dots,\mu_n)&#39;\)</span>, <span class="math inline">\(\alpha = (\alpha_1,\dots,\alpha_n)&#39;\)</span>, <span class="math inline">\(\nu = (\nu_1,\dots,\nu_n)&#39;\)</span> and <span class="math inline">\(\beta = (\beta_1,\dots,\beta_n)\)</span>, then
<span class="math display">\[\begin{eqnarray*}
\varphi_t(u) &amp;=&amp; \exp\left[\left(\frac{u \odot \mu}{1 - u \odot \mu}\right)&#39;\beta&#39; w_t \right.\\
&amp;&amp; \left. + \alpha&#39;\left(\frac{u \odot \mu}{1 - u \odot \mu}\right) - \nu&#39;\log(1 - u \odot \mu)\right],
\end{eqnarray*}\]</span>
where <span class="math inline">\(\odot\)</span> denotes the element-by-element multiplication and, where, with abuse of notation, the division and log operators work element-by-element when applied to vectors.</p>
<p>In their baseline model, <span class="citation">Monfort et al. (<a href="TSM.html#ref-zarg_2017">2017</a>)</span> use four factors. They set <span class="math inline">\(\nu_1 = \nu_2 = 0\)</span>, implying that <span class="math inline">\(w_{1,t}\)</span> and <span class="math inline">\(w_{2,t}\)</span> can stay at zero (see Example <a href="ChapterAffine.html#exm:ARG1">1.8</a>). The short-term rate <span class="math inline">\(r_t\)</span> is posited to be an affine combination of <span class="math inline">\(w_{1,t}\)</span> and <span class="math inline">\(w_{2,t}\)</span>, that is:
<span class="math display">\[
r_t = \omega&#39;w_t = \omega_{1} w_{1,t} + \omega_{2} w_{2,t},
\]</span>
hence, it can stay at zero.</p>
<p>Factors <span class="math inline">\(w_{3,t}\)</span> and <span class="math inline">\(w_{4,t}\)</span> Granger-cause <span class="math inline">\(w_{1,t}\)</span> and <span class="math inline">\(w_{2,t}\)</span>, thereby causing <span class="math inline">\(r_t\)</span>. As a result, for <span class="math inline">\(h \ge 2\)</span>, <span class="math inline">\(R(t,h)\)</span> is a non-zero combination of the four components of <span class="math inline">\(w_t\)</span>.</p>
<p>For the same reason, when <span class="math inline">\(r_t=0\)</span>, the lift-off probability depends on <span class="math inline">\(w_{3,t}\)</span> and <span class="math inline">\(w_{4,t}\)</span>. The framework offers closed-form solutions for lift-off probabilities. Indeed, using Lemma <a href="#lemma:mass"><strong>??</strong></a>:
<span class="math display">\[
\mathbb{P}_t(\alpha&#39;w_{t+h}=0) = \lim_{u \rightarrow -\infty} \varphi_{t,h}(0,\dots,0,u\alpha),
\]</span>
where <span class="math inline">\(\varphi_{t,h}\)</span> is the multi-horizon Laplace transform defined in Eq. <a href="ChapterAffine.html#eq:multiLT">(1.8)</a>, which can be computed using Proposition <a href="ChapterAffine.html#prp:reverseMLT">1.5</a>. We have:
<span class="math display">\[\begin{equation}
\left\{
\begin{array}{l}
\mathbb{P}_t(r_{t+h}&gt;0) = 1 - \lim_{u \rightarrow -\infty} \varphi_{t,h}(0,\dots,0,u\omega) \\ \\
\mathbb{P}_t(r_{t+1}=0,\dots,r_{t+h}=0) = \lim_{u \rightarrow -\infty} \varphi_{t,h}(u\omega,\dots,u\omega,u\omega) \equiv p_{h}\\ \\
\mathbb{P}_t(r_{t+1}=0,\dots,r_{t+h-1}=0,r_{t+h}&gt;0) = p_{h-1} - p_h.
\end{array}
\right.
\end{equation}\]</span>
Other lift-off probabilities, of the type <span class="math inline">\(\mathbb{P}_t[R(t+h,k)&gt;threshold]\)</span>, can be derived from Eq. <a href="ChapterAffine.html#eq:DPS">(1.18)</a>.</p>
<p><span class="citation">Monfort et al. (<a href="TSM.html#ref-zarg_2017">2017</a>)</span> esitmate this model by means of Kalman filtering techniques (see Subsection <a href="#EstimationKF"><strong>??</strong></a>). Observed variables include (levels of) yields, as well as survey-based forecasts of yields (see Subsection <a href="#EstimationPersistency"><strong>??</strong></a> and (e-GARCH-based) proxies of conditional variances (see Eq. <a href="ChapterAffine.html#eq:condvar">(1.16)</a>).</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fitZarg"></span>
<img src="figures/Figure_fit_ZARG.png" alt="Source: Monfort et al. (2017). Model fit of conditional variances and surveys of professional forecasters." width="95%" />
<p class="caption">
Figure 3.7: Source: Monfort et al. (2017). Model fit of conditional variances and surveys of professional forecasters.
</p>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:liftOff"></span>
<img src="figures/Figure_LiftOff.png" alt="Source: Monfort et al. (2017). Lift-off probabilities." width="95%" />
<p class="caption">
Figure 3.8: Source: Monfort et al. (2017). Lift-off probabilities.
</p>
</div>

<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Adrian_Crump_Moench_2013" class="csl-entry">
Adrian, Tobias, Richard K. Crump, and Emanuel Moench. 2013. <span>“<span class="nocase">Pricing the Term Structure with Linear Regressions</span>.”</span> <em>Journal of Financial Economics</em> 110 (1): 110–38. <a href="https://doi.org/10.1016/j.jfineco.2013.04.009">https://doi.org/10.1016/j.jfineco.2013.04.009</a>.
</div>
<div id="ref-Ang_Boivin_Dong_LooKung_2011" class="csl-entry">
Ang, Andrew, Jean Boivin, Sen Dong, and Rudy Loo-Kung. 2011. <span>“<span class="nocase">Monetary Policy Shifts and the Term Structure</span>.”</span> <em>Review of Economic Studies</em> 78 (2): 429–57. <a href="https://doi.org/10.1093/restud/rdq006">https://doi.org/10.1093/restud/rdq006</a>.
</div>
<div id="ref-Ang_Piazzesi_2003" class="csl-entry">
Ang, Andrew, and Monika Piazzesi. 2003. <span>“<span class="nocase">A No-Arbitrage Vector Autoregression of Term Structure Dynamics with Macroeconomic and Latent Variables</span>.”</span> <em>Journal of Monetary Economics</em> 50 (4): 745–87. <a href="https://doi.org/10.1016/S0304-3932(03)00032-1">https://doi.org/10.1016/S0304-3932(03)00032-1</a>.
</div>
<div id="ref-Black_1995" class="csl-entry">
Black, Fischer. 1995. <span>“<span class="nocase">Interest Rates as Options</span>.”</span> <em>The Journal of Finance</em> 50 (5): 1371–76. <a href="https://doi.org/10.2307/2329320">https://doi.org/10.2307/2329320</a>.
</div>
<div id="ref-Campbell_Shiller_1991" class="csl-entry">
Campbell, John Y., and Robert J. Shiller. 1991. <span>“<span class="nocase">Yield Spreads and Interest Rate Movements: A Bird’s Eye View</span>.”</span> <em>The Review of Economic Studies</em> 58 (3): 495–514. <a href="http://www.jstor.org/stable/2298008">http://www.jstor.org/stable/2298008</a>.
</div>
<div id="ref-Chikhani_Renne_2022" class="csl-entry">
Chikhani, Pauline, and Jean-Paul Renne. 2023. <span>“<span class="nocase">An Analytical Framework to Price Long-Dated Climate-Exposed Assets</span>.”</span> University of Lausanne working paper. University of Lausanne. <a href="https://papers.ssrn.com/sol3/papers.cfm?abstract_id=3881262">https://papers.ssrn.com/sol3/papers.cfm?abstract_id=3881262</a>.
</div>
<div id="ref-Christensen_Diebold_Rudebusch_2009" class="csl-entry">
Christensen, Jens H. E., Francis X. Diebold, and Glenn D. Rudebusch. 2009. <span>“<span class="nocase">An Arbitrage-free Generalized Nelson–Siegel Term Structure Model</span>.”</span> <em>The Econometrics Journal</em> 12 (3): C33–64. <a href="https://doi.org/10.1111/j.1368-423X.2008.00267.x">https://doi.org/10.1111/j.1368-423X.2008.00267.x</a>.
</div>
<div id="ref-Duffee_2010" class="csl-entry">
Duffee, Greg. 2010. <span>“<span class="nocase">Sharpe Ratios in Term Structure Models</span>.”</span> Economics Working Paper Archive 575. The Johns Hopkins University,Department of Economics. <a href="http://www.econ2.jhu.edu/REPEC/papers/wp575.pdf">http://www.econ2.jhu.edu/REPEC/papers/wp575.pdf</a>.
</div>
<div id="ref-Duffie_Pan_Singleton_2000" class="csl-entry">
Duffie, Darrell, Jun Pan, and Kenneth Singleton. 2000. <span>“<span class="nocase">Transform Analysis and Asset Pricing for Affine Jump-Diffusions</span>.”</span> <em>Econometrica</em> 68 (6): 1343–76. <a href="https://doi.org/10.1111/1468-0262.00164">https://doi.org/10.1111/1468-0262.00164</a>.
</div>
<div id="ref-Duffie_Stein_2015" class="csl-entry">
Duffie, Darrell, and Jeremy C. Stein. 2015. <span>“<span class="nocase">Reforming LIBOR and Other Financial Market Benchmarks</span>.”</span> <em>Journal of Economic Perspectives</em> 29 (2): 191–212. <a href="https://www.aeaweb.org/articles?id=10.1257/jep.29.2.191">https://www.aeaweb.org/articles?id=10.1257/jep.29.2.191</a>.
</div>
<div id="ref-Duffie_Singleton_1997" class="csl-entry">
Duffie, Darrel, and Kenneth J. Singleton. 1997. <span>“<span class="nocase">An Econometric Model of the Term Structure of Interest-Rate Swap Yields</span>.”</span> <em>The Journal of Finance</em> 52 (4): 1287–1321. <a href="https://doi.org/10.1111/j.1540-6261.1997.tb01111.x">https://doi.org/10.1111/j.1540-6261.1997.tb01111.x</a>.
</div>
<div id="ref-Gourieroux_Jasiak_2006" class="csl-entry">
Gourieroux, Christian, and Joann Jasiak. 2006. <span>“<span>Autoregressive Gamma Processes</span>.”</span> <em>Journal of Forecasting</em> 25 (2): 129–52. <a href="https://doi.org/10.1002/for.978">https://doi.org/10.1002/for.978</a>.
</div>
<div id="ref-Gourieroux_Monfort_Mouabbi_Renne_2021" class="csl-entry">
Gourieroux, Christian, Alain Monfort, Sarah Mouabbi, and Jean-Paul Renne. 2021. <span>“<span>Disastrous Defaults</span>.”</span> <em>Review of Finance</em> 25 (6): 1727–72. <a href="https://doi.org/10.1093/rof/rfaa042">https://doi.org/10.1093/rof/rfaa042</a>.
</div>
<div id="ref-Gourieroux_Monfort_Pegoraro_Renne_2014" class="csl-entry">
Gourieroux, Christian, Alain Monfort, Fulvio Pegoraro, and Jean-Paul Renne. 2014. <span>“<span class="nocase">Regime Switching and Bond Pricing</span>.”</span> <em>The Journal of Financial Econometrics</em> 12 (2): 237–77. <a href="https://doi.org/10.1093/jjfinec/nbt019">https://doi.org/10.1093/jjfinec/nbt019</a>.
</div>
<div id="ref-Hansen_Jagannathan_1991" class="csl-entry">
Hansen, Lars Peter, and Ravi Jagannathan. 1991. <span>“<span class="nocase">Implications of Security Market Data for Models of Dynamic Economies</span>.”</span> <em>Journal of Political Economy</em> 99 (2): 225–62. <a href="https://doi.org/10.1086/261749">https://doi.org/10.1086/261749</a>.
</div>
<div id="ref-Joslin_Priebsch_Singleton_2014" class="csl-entry">
Joslin, Scott, Marcel Priebsch, and Kenneth J. Singleton. 2014. <span>“<span class="nocase">Risk Premiums in Dynamic Term Structure Models with Unspanned Macro Risks</span>.”</span> <em>The Journal of Finance</em> 69 (3): 1197–1233. <a href="https://doi.org/10.1111/jofi.12131">https://doi.org/10.1111/jofi.12131</a>.
</div>
<div id="ref-Krippner_2013" class="csl-entry">
Krippner, Leo. 2013. <span>“<span class="nocase">A Tractable Framework for Zero Lower Bound Gaussian Term Structure Models</span>.”</span> Reserve Bank of New Zealand Discussion Paper Series DP2013/02. Reserve Bank of New Zealand. <a href="https://ideas.repec.org/p/nzb/nzbdps/2013-02.html">https://ideas.repec.org/p/nzb/nzbdps/2013-02.html</a>.
</div>
<div id="ref-zarg_2017" class="csl-entry">
Monfort, Alain, Fulvio Pegoraro, Jean-Paul Renne, and Guillaume Roussellet. 2017. <span>“<span class="nocase">Staying at Zero with Affine Processes: An Application to Term Structure Modelling</span>.”</span> <em>Journal of Econometrics</em> 201 (2): 348–66. <a href="https://doi.org/10.1016/j.jeconom.2017.08.013">https://doi.org/10.1016/j.jeconom.2017.08.013</a>.
</div>
<div id="ref-Pallara_Renne_2023" class="csl-entry">
Pallara, Kevin, and Jean-Paul Renne. 2023. <span>“<span class="nocase">Fiscal Limits and the Pricing of Eurobonds</span>.”</span> <em>Management Science</em> 0 (0): null. <a href="https://doi.org/10.1287/mnsc.2023.4740">https://doi.org/10.1287/mnsc.2023.4740</a>.
</div>
<div id="ref-Priebsch_2013" class="csl-entry">
Priebsch, Marcel A. 2013. <span>“<span class="nocase">Computing Arbitrage-Free Yields in Multi-Factor Gaussian Shadow-Rate Term Structure Models</span>.”</span> Finance and Economics Discussion Series 2013-63. Board of Governors of the Federal Reserve System (U.S.). <a href="https://www.federalreserve.gov/pubs/feds/2013/201363/201363pap.pdf">https://www.federalreserve.gov/pubs/feds/2013/201363/201363pap.pdf</a>.
</div>
<div id="ref-Wu_Xia_2016" class="csl-entry">
Wu, Jing Cynthia, and Fan Dora Xia. 2016. <span>“<span class="nocase">Measuring the Macroeconomic Impact of Monetary Policy at the Zero Lower Bound</span>.”</span> <em>Journal of Money, Credit and Banking</em> 48 (2-3): 253–91. <a href="https://doi.org/10.1111/jmcb.12300">https://doi.org/10.1111/jmcb.12300</a>.
</div>
</div>
</div>
</div>
</div>








































<div class="footnotes">
<hr />
<ol start="7">
<li id="fn7"><p>Note that a VAR with <span class="math inline">\(p\)</span> lags (i.e., a VAR(<span class="math inline">\(p\)</span>)) admits a VAR(1) companion form.<a href="TSM.html#fnref7" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </main>

  <div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page">
      <h2>On this page</h2>
      <div id="book-on-this-page"></div>

      <div class="book-extra">
        <ul class="list-unstyled">
          <li><a id="book-source" href="#">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="#">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
      </div>
    </nav>
  </div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5">
  <div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Introduction to Term Structure Models</strong>" was written by Jean-Paul Renne and Alain Monfort. It was last built on 2024-01-30.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
<script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>

</html>
