<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 6 Forward, futures, dividends, commodity pricing, and convenience yields | Introduction to Term Structure Models</title>
<meta name="author" content="Alain Monfort and Jean-Paul Renne">
<meta name="description" content="6.1 Derivatives written on stocks or commodities  6.1.1 Forward contracts Let us denote by \(\underline{w_{t}}\) the information available at \(t\), i.e., \(\underline{w_{t}}=...">
<meta name="generator" content="bookdown 0.34 with bs4_book()">
<meta property="og:title" content="Chapter 6 Forward, futures, dividends, commodity pricing, and convenience yields | Introduction to Term Structure Models">
<meta property="og:type" content="book">
<meta property="og:description" content="6.1 Derivatives written on stocks or commodities  6.1.1 Forward contracts Let us denote by \(\underline{w_{t}}\) the information available at \(t\), i.e., \(\underline{w_{t}}=...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 6 Forward, futures, dividends, commodity pricing, and convenience yields | Introduction to Term Structure Models">
<meta name="twitter:description" content="6.1 Derivatives written on stocks or commodities  6.1.1 Forward contracts Let us denote by \(\underline{w_{t}}\) the information available at \(t\), i.e., \(\underline{w_{t}}=...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.5.0/transition.js"></script><script src="libs/bs3compat-0.5.0/tabs.js"></script><script src="libs/bs3compat-0.5.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="my-style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Introduction to Term Structure Models</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Introduction to Term Structure Models</a></li>
<li><a class="" href="ChapterAffine.html"><span class="header-section-number">1</span> Affine processes</a></li>
<li><a class="" href="PandQ.html"><span class="header-section-number">2</span> Pricing and risk-neutral dynamics</a></li>
<li><a class="" href="TSModels.html"><span class="header-section-number">3</span> The term structure of risk-free yields</a></li>
<li><a class="" href="Structural.html"><span class="header-section-number">4</span> A detour through structural approaches</a></li>
<li><a class="" href="Estimation.html"><span class="header-section-number">5</span> Estimation of affine asset-pricing models</a></li>
<li><a class="active" href="forward-futures-dividends-commodity-pricing-and-convenience-yields.html"><span class="header-section-number">6</span> Forward, futures, dividends, commodity pricing, and convenience yields</a></li>
<li><a class="" href="CreditLiRisks.html"><span class="header-section-number">7</span> Credit and liquidity risks</a></li>
<li><a class="" href="references.html"><span class="header-section-number">8</span> References</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="forward-futures-dividends-commodity-pricing-and-convenience-yields" class="section level1" number="6">
<h1>
<span class="header-section-number">6</span> Forward, futures, dividends, commodity pricing, and convenience yields<a class="anchor" aria-label="anchor" href="#forward-futures-dividends-commodity-pricing-and-convenience-yields"><i class="fas fa-link"></i></a>
</h1>
<div id="derivatives-written-on-stocks-or-commodities" class="section level2" number="6.1">
<h2>
<span class="header-section-number">6.1</span> Derivatives written on stocks or commodities<a class="anchor" aria-label="anchor" href="#derivatives-written-on-stocks-or-commodities"><i class="fas fa-link"></i></a>
</h2>
<div id="FCFPForwards" class="section level3" number="6.1.1">
<h3>
<span class="header-section-number">6.1.1</span> Forward contracts<a class="anchor" aria-label="anchor" href="#FCFPForwards"><i class="fas fa-link"></i></a>
</h3>
<p>Let us denote by <span class="math inline">\(\underline{w_{t}}\)</span> the information available at <span class="math inline">\(t\)</span>, i.e., <span class="math inline">\(\underline{w_{t}}= \{w_t,w_{t-1},\dots\}\)</span>.</p>
<p>A Forward contract is defined as an agreement, signed at <span class="math inline">\(t\)</span>, to buy/sell an asset (a commodity) at a given delivery date <span class="math inline">\(T&gt;t\)</span> at a price <span class="math inline">\(\Phi_{t,T}\)</span>, called <em>delivery price</em> or <em>forward price</em>, decided at <span class="math inline">\(t\)</span>. We denote by <span class="math inline">\(S_T\)</span> the value of the asset (commodity) at <span class="math inline">\(T\)</span>; this is a function of <span class="math inline">\(\underline{w_{T}}\)</span>. For the buyer, the payoff of the contract at <span class="math inline">\(T\)</span> is <span class="math inline">\(S_T - \Phi_{t,T}\)</span>.</p>
<p>In this chapter, we denote by <span class="math inline">\(r_t\)</span> the interest rate between <span class="math inline">\(t\)</span> and <span class="math inline">\(t+1\)</span> (known at <span class="math inline">\(t\)</span>), it is assumed to be a function of <span class="math inline">\(\underline{w_{t}}\)</span>. We also denote by <span class="math inline">\(B(t_1,t_2-t_1)\)</span> the date-<span class="math inline">\(t_1\)</span> price of a zero-coupon bond whose value is 1 on <span class="math inline">\(t_2\)</span>.</p>
<p>The following proposition provides an expression for the forward price <span class="math inline">\(\Phi_{t,T}\)</span>:</p>
<div class="proposition">
<p><span id="prp:fwd" class="proposition"><strong>Proposition 6.1  (Forward price) </strong></span>We have:
<span class="math display">\[\begin{eqnarray*}
\Phi_{t,T} &amp; = &amp; \frac{\mathbb{E}_t (\mathcal{M}_{t,t+1}, \ldots, \mathcal{M}_{t-1,T} S_T)}{B(t,T-t)}\\
&amp; = &amp; \frac{\mathbb{E}^{\mathbb{Q}}_t [\exp (-r_t - \ldots - r_{T-1}) S_T]}{B(t,T-t)}.
\end{eqnarray*}\]</span></p>
</div>
<div class="proof">
<p><span id="unlabeled-div-22" class="proof"><em>Proof</em>. </span>The price at <span class="math inline">\(t\)</span> of <span class="math inline">\(S_T - \Phi_{t,T}\)</span> is zero. Therefore:
<span class="math inline">\(\mathbb{E}_t (\mathcal{M}_{t,t+1}, \ldots, \mathcal{M}_{t-1,T} S_T) - \Phi_{t,T} \mathbb{E}_t (\mathcal{M}_{t,t+1} \ldots \mathcal{M}_{t-1,T}) = 0\)</span>, which gives the result.</p>
</div>
<p>If processes <span class="math inline">\((r_t)\)</span> and <span class="math inline">\((S_t)\)</span> are <span class="math inline">\(\mathbb{Q}\)</span>-independent, then we have
<span class="math display">\[
\Phi_{t,T} = \mathbb{E}^{\mathbb{Q}}_t (S_T),
\]</span>
and <span class="math inline">\(\Phi_{t,T}\)</span> therefore is a <span class="math inline">\(\mathbb{Q}\)</span>-martingale.</p>
<p>If the asset does not generate any payoff before <span class="math inline">\(T\)</span> (in the case of shares, there is no dividends), then
<span class="math display">\[
\Phi_{t,T} = \frac{S_t}{B(t,T-t)}.
\]</span>
The price at <span class="math inline">\(s\)</span>, with <span class="math inline">\(t&lt;s&lt;T\)</span>, of a forward contract signed at <span class="math inline">\(t\)</span> is:
<span class="math display">\[
(\Phi_{s,T} - \Phi_{t,T}) B (s,T-s),
\]</span>
since the payoff <span class="math inline">\(S_T - \Phi_{t,T}\)</span> at <span class="math inline">\(T\)</span> has this price at <span class="math inline">\(s\)</span>.</p>
<p>How are these formulas affected by the presence of dividends? To investigate that, let us introduce additional notations. Denote by <span class="math inline">\(\tilde{S}_t\)</span> the ex-dividend price at <span class="math inline">\(t\)</span>, and by <span class="math inline">\(S_t\)</span>: the cum-dividend price at <span class="math inline">\(t\)</span>. We have <span class="math inline">\(S_t = \tilde{S}_t \exp (\delta_t)\)</span>, where <span class="math inline">\(\delta_t\)</span> is the dividend yield (or rate), observed on date <span class="math inline">\(t\)</span>. We get:
<span class="math display">\[\begin{eqnarray*}
\tilde{S}_{T-1} &amp; = &amp; \mathbb{E}_{T-1} (\mathcal{M}_{t-1,T} S_T) \\
\mbox{or } \\
S_{T-1} &amp; = &amp; \mathbb{E}_{T-1} [\mathcal{M}_{t-1,T} \exp (\delta_{T-1})
S_T],
\end{eqnarray*}\]</span>
and, recursively:
<span class="math display">\[\begin{eqnarray*}
S_t &amp; = &amp; \mathbb{E}_t [\mathcal{M}_{t,t+1} \ldots \mathcal{M}_{t-1,T} \exp (\delta_t + \ldots + \delta_{T-1}) S_T] \\
&amp;=&amp; \mathbb{E}^{\mathbb{Q}}_t [\exp (-r_t \ldots - r_{T-1} + \delta_t + \ldots + \delta_{T-1}) S_T].
\end{eqnarray*}\]</span>
This shows that the formulas are as in the non-dividend case, except that <span class="math inline">\(r_t\)</span> is replaced by <span class="math inline">\(r_t - \delta_t\)</span>.</p>
<p>Replacing <span class="math inline">\(S_t\)</span> by <span class="math inline">\(\tilde{S} \exp(\delta_t)\)</span> and <span class="math inline">\(S_T\)</span> by <span class="math inline">\(\tilde{S}_T \exp (\delta_T)\)</span>, we get
<span class="math display">\[
\tilde{S}_t = \mathbb{E}^{\mathbb{Q}}_t [\exp (-r_t -\ldots-r_{T-1} + \delta_{t+1} + \ldots + \delta_T) \tilde{S}_T.
\]</span>
When the dividend rate <span class="math inline">\(\delta_t\)</span> is deterministic, we have:
<span class="math display">\[
\Phi_{t,T} = \frac{S_t \exp (-\delta_t - \ldots - \delta_{T-1})}{B(t,T-t)}.
\]</span>
And if <span class="math inline">\(r_t\)</span> is deterministic too, we have:
<span class="math display">\[
\Phi_{t,T} = S_t \exp   (r_t + \ldots + r_{T-1} - \delta_t - \ldots - \delta_{T-1}).
\]</span></p>
</div>
<div id="FCFPFutures" class="section level3" number="6.1.2">
<h3>
<span class="header-section-number">6.1.2</span> Futures contracts, futures prices<a class="anchor" aria-label="anchor" href="#FCFPFutures"><i class="fas fa-link"></i></a>
</h3>
<p>A futures contract is an agreement, signed at <span class="math inline">\(t\)</span>, to buy/sell an asset (a commodity) at given delivery date <span class="math inline">\(T&gt;t\)</span> at a price <span class="math inline">\(F_{t,T}\)</span>, called <em>futures price</em>, decided at <span class="math inline">\(t\)</span>. The difference with forward contract is that both counterparties are required to deposit into a <em>margin account</em>, at every trading day <span class="math inline">\(s&gt;t\)</span>, the resettlement payment (<em>margin call</em>). The latter is equal to:
<span class="math display">\[
\Delta_{s,T} = F_{s,T} - F_{s-1,T} \quad \mbox{(for the buyer)}.
\]</span></p>
<p>Hence, a futures contract is actually closed out after every day, starts afresh the next day. Its value therefore is zero.</p>
<p>The following proposition values a futures contract.</p>
<div class="proposition">
<p><span id="prp:future" class="proposition"><strong>Proposition 6.2  (Pricing futures) </strong></span>We have:
<span class="math display">\[
F_{t,T} = \mathbb{E}^{\mathbb{Q}}_t (S_T),
\]</span>
that is <span class="math inline">\(F_{t,T}\)</span> is a <span class="math inline">\(\mathbb{Q}\)</span>-martingale, and <span class="math inline">\(\Delta_{t,T}\)</span> is a <span class="math inline">\(\mathbb{Q}\)</span>-martingale difference.</p>
</div>
<div class="proof">
<p><span id="unlabeled-div-23" class="proof"><em>Proof</em>. </span>At each date <span class="math inline">\(s\ge t\)</span>, after the deposit of the resettlement payment, there is a new contract valued zero and paying <span class="math inline">\(F_{s+1,T} - F_{s,T}\)</span> at <span class="math inline">\(s+1\)</span> (and providing another zero valued contract at <span class="math inline">\(s+1\)</span>). Therefore <span class="math inline">\(0 = \mathbb{E}^{\mathbb{Q}}_s [\exp (-r_s) (F_{s+1,T} - F_{s,T})]\)</span>, and <span class="math inline">\(0 = \mathbb{E}^{\mathbb{Q}}_s (F_{s+1,T} - F_{s,T})\)</span> since <span class="math inline">\(\exp (-r_s)\)</span> is known at <span class="math inline">\(s\)</span>. Hence <span class="math inline">\(F_{s,T} = \mathbb{E}^{\mathbb{Q}}_s (F_{s+1,T})\)</span>, and the results follows from <span class="math inline">\(F_{T,T} = S_T\)</span>.</p>
</div>
<div class="proposition">
<p><span id="prp:FFdeviation" class="proposition"><strong>Proposition 6.3  (Forward-Futures deviation) </strong></span>We have:
<span class="math display">\[
\Phi_{t,T} - F_{t,T} = \frac{\mathbb{C}ov^{\mathbb{Q}}_t \left[\prod^{T-1}_{s=t} \exp (-r_s), S_T\right]}{B(t,T-t)}.
\]</span></p>
</div>
<div class="proof">
<p><span id="unlabeled-div-24" class="proof"><em>Proof</em>. </span>We have:
<span class="math display">\[\begin{eqnarray*}
\Phi_{t,T} - F_{t,T} &amp; = &amp; \mathbb{E}^{\mathbb{Q}}_t \left[\frac{\prod^{T-1}_{s=t} \exp (-r_s) S_T }{B(t,T-t)}- S_T\right] \\
&amp;=&amp; \frac{\mathbb{E}^{\mathbb{Q}}_t \left[\prod^{T-1}_{s=t} \exp (-r_s) S_T\right] - \mathbb{E}^{\mathbb{Q}}_t \left[\prod^{T-1}_{s=t} \exp (-r_s)\right] \mathbb{E}^{\mathbb{Q}}_t (S_T)}{B(t,T-t)} \\
&amp;=&amp;\frac{cov^{\mathbb{Q}}_t \left[\prod^{T-1}_{s=t} \exp (-r_s), S_T)\right]}{B(t,T-t)}. \end{eqnarray*}\]</span></p>
</div>
<p>Hence, <span class="math inline">\(\Phi_{t,T} = F_{t,T}\)</span> if, and only if, <span class="math inline">\(\prod^{T-1}_{s=t} \exp (-r_s)\)</span> and <span class="math inline">\(S_T\)</span> are conditionally uncorrelated under <span class="math inline">\(\mathbb{Q}\)</span>. It is true, in particular, in the case of deterministic short rates.</p>
</div>
<div id="FCFPConvenience" class="section level3" number="6.1.3">
<h3>
<span class="header-section-number">6.1.3</span> Convenience yields<a class="anchor" aria-label="anchor" href="#FCFPConvenience"><i class="fas fa-link"></i></a>
</h3>
<p>A convenience yield is defined as the net benefit associated with holding a physical asset (rather than a forward or futures contract). It is <em>net</em> in the sense that it is equal to the positive gain of holding minus potential storage costs.</p>
<p>The notion of convenience yield is relevant only for storable commodities (not, e.g., for electricity). It can be positive or negative. The notion of convenience yield is mathematically similar to that of a dividend yield (but can be <span class="math inline">\(&lt;0\)</span>, and is often latent).</p>
<p>In the following, we denote the convenience yield by <span class="math inline">\(c_t\)</span>. The price is here the cum-convenience yield price.</p>
<p>Let us first consider the case where <span class="math inline">\(r_t\)</span> and <span class="math inline">\(c_t\)</span> are deterministic. We have:
<span class="math display">\[
\Phi_{t,T} = F_{t,T} = S_t \exp (r_t + \ldots + r_{T-1} - c_t - \ldots - c_{T-1}).
\]</span>
Moreover, if <span class="math inline">\(r_t\)</span> and <span class="math inline">\(c_t\)</span> are time independent, we get:
<span class="math display">\[
\Phi_{t,T} = F_{t,T} = S_t \exp [(T-t)(r-c)].
\]</span>
If <span class="math inline">\(r&gt;c\)</span>, the forward curve is an increasing function of matuerity <span class="math inline">\(T\)</span>; this is known as a situation of <em>contango</em>. If <span class="math inline">\(r&lt;c\)</span>, the forward curve is a decreasing function of maturity <span class="math inline">\(T\)</span>, know as a situation of <em>backwardation</em>.</p>
<p>Let us turn to the situation where <span class="math inline">\(c_t\)</span> is stochastic. We have:
<span class="math display" id="eq:convenience3">\[\begin{eqnarray}
\Phi_{t,T} &amp;=&amp; \mathbb{E}^{\mathbb{Q}}_t [\exp (-r_t - \ldots - r_{T-1}) S_T]/B(t,T-t) \tag{6.1}\\
F_{t,T} &amp;=&amp; \mathbb{E}^{\mathbb{Q}}_t (S_T) \tag{6.2}\\
S_t &amp;=&amp; \mathbb{E}^{\mathbb{Q}}_t [\exp (-r_t - \ldots - r_{T-1} + c_t + \ldots + c_{T-1}) S_T] \tag{6.3}.
\end{eqnarray}\]</span>
Going further necessitates a joint modelling—at least under <span class="math inline">\(\mathbb{Q}\)</span>—of <span class="math inline">\(S_t\)</span> (or <span class="math inline">\(s_t = \log S_t\)</span>), <span class="math inline">\(c_t\)</span> (convenience yield), and <span class="math inline">\(r_t\)</span> (short rate).</p>
<blockquote>
<p>In the case of a <strong>nonstorable commodity</strong>, there is no convenience yield. If, moreover <span class="math inline">\(r_t\)</span> deterministic, <span class="math inline">\(\Phi_{t,T} = F_{t,T} = \mathbb{E}^{\mathbb{Q}}_t (S_T)\)</span>, but since <a href="forward-futures-dividends-commodity-pricing-and-convenience-yields.html#eq:convenience3">(6.3)</a> is not valid we do not have <span class="math inline">\(S_t = B(t,T) \mathbb{E}^{\mathbb{Q}}_t (S_T)\)</span> and therefore we do not have <span class="math inline">\(\Phi_{t,T} = S_t / B(t,T)\)</span>.</p>
</blockquote>
<blockquote>
<p>In the case of a <strong>storable commodity</strong>, the price ex-convenience yield at <span class="math inline">\(t\)</span>, i.e. <span class="math inline">\(S_t \exp (-c_t)\)</span>, is the price at <span class="math inline">\(t\)</span> of <span class="math inline">\(S_{t+1}\)</span>:
<span class="math display" id="eq:convenience4">\[\begin{eqnarray}
S_t \exp (-c_t) &amp;=&amp; \exp (-r_t) \mathbb{E}^{\mathbb{Q}}_t (S_{t+1}) \nonumber\\
\mathbb{E}^{\mathbb{Q}}_t (S_{t+1}) &amp; = &amp; S_t \exp (r_t - c_t) \tag{6.4} \\
\mathbb{E}^{\mathbb{Q}}_t \exp (s_{t+1}) &amp;=&amp; \exp(s_t+r_t-c_t). \nonumber
\end{eqnarray}\]</span>
Or if <span class="math inline">\(y_{t+1} = \log \frac{S_{t+1}}{S_t}\)</span> denotes the (geometric) return, then:
<span class="math display">\[
\mathbb{E}^{\mathbb{Q}}_t \exp (y_{t+1}) = \exp (r_t - c_t).
\]</span>
Eq. <a href="forward-futures-dividends-commodity-pricing-and-convenience-yields.html#eq:convenience3">(6.3)</a> is automatically satisfied (using <a href="forward-futures-dividends-commodity-pricing-and-convenience-yields.html#eq:convenience4">(6.4)</a> recursively).</p>
</blockquote>
</div>
<div id="FCFPPricingRN" class="section level3" number="6.1.4">
<h3>
<span class="header-section-number">6.1.4</span> Pricing with affine models<a class="anchor" aria-label="anchor" href="#FCFPPricingRN"><i class="fas fa-link"></i></a>
</h3>
<p>In this section, we consider a storable commodity. The state vector is as follows:
<span class="math display">\[
w_t = (s_t, c_t, r_t, x'_t)',
\]</span>
where <span class="math inline">\(s_t = \log S_t\)</span>, and where <span class="math inline">\(x_t\)</span> is a vector of additional factors. We further assume that <span class="math inline">\(w_t\)</span> is a <span class="math inline">\(\mathbb{Q}\)</span>-affine process, that is:
<span class="math display">\[
\mathbb{E}^{\mathbb{Q}}_t \exp (u' w_{t+1}) = \exp [a' (u) w_t + b(u)].
\]</span>
Since <span class="math inline">\(S_{t+1} = \exp (e_1' w_{t+1})\)</span>, Internal Consistency Constraints (ICCs) apply (see Subsection <a href="PandQ.html#DirectModeling">2.3.1</a>), and we have:
<span class="math display">\[\begin{eqnarray*}
&amp;&amp;\mathbb{E}^{\mathbb{Q}}_t \exp (s_{t+1}) = \exp (s_t-c_t+r_t)\\
&amp;\Leftrightarrow&amp; \mathbb{E}^{\mathbb{Q}}_t \exp (e_1' w_{t+1}) = \exp [(e_1 - e_2 + e_3)' w_t]\\
&amp;\Leftrightarrow&amp; \left\{\begin{array}{lcl}
a(e_1) &amp;=&amp; e_1 - e_2 + e_3 \\
b(e_1) &amp;=&amp;0.
\end{array} \right.
\end{eqnarray*}\]</span></p>
<blockquote>
<p>If the commodity is non-storable, there are no <span class="math inline">\(c_t\)</span>, and no ICCs.</p>
</blockquote>
<p>Eqs. <a href="forward-futures-dividends-commodity-pricing-and-convenience-yields.html#eq:convenience1">(6.1)</a> and <a href="forward-futures-dividends-commodity-pricing-and-convenience-yields.html#eq:convenience2">(6.2)</a> give:
<span class="math display">\[\begin{eqnarray*}
\Phi_{t,T} &amp; = &amp; \frac{\mathbb{E}^{\mathbb{Q}}_t [\exp (-r_t - \ldots - r_{t-1} + s_T)]}{\mathbb{E}^{\mathbb{Q}}_t [\exp (-r_t - \ldots - r_{T-1})]} \\
F_{t,T} &amp; = &amp; \mathbb{E}^{\mathbb{Q}}_t [\exp (s_T)].
\end{eqnarray*}\]</span>
Using the multi-horizon Laplace transforms of <span class="math inline">\(w_t = (s_t, c_t, r_t, x^{'}_t)'\)</span>, we get quasi explicit formulas for these prices (as they are exponential affine in future values of <span class="math inline">\(w_t\)</span>, which is an affine process).</p>
</div>
<div id="historical-dynamics" class="section level3" number="6.1.5">
<h3>
<span class="header-section-number">6.1.5</span> Historical dynamics<a class="anchor" aria-label="anchor" href="#historical-dynamics"><i class="fas fa-link"></i></a>
</h3>
<p>Using the notation of Subsection <a href="PandQ.html#PricingAffine">2.1.2</a>, assume the SDF is of the form:
<span class="math display">\[
\mathcal{M}_{t,t+1} (\underline{w_{t+1}}) = \exp \left[-r_t + \alpha'_t w_{t+1} + \psi^{\mathbb{Q}}_t (-\alpha_t)\right],
\]</span>
such that
<span class="math display">\[
\mathbb{E}^{\mathbb{Q}}_t (\mathcal{M}_{t,t+1}^{-1}) = \exp (r_t).
\]</span></p>
<p>The historical dynamics of <span class="math inline">\(w_t\)</span> is defined through:
<span class="math display">\[
\psi_t (u) = \psi^{\mathbb{Q}}_t (u-\alpha_t) - \psi^{\mathbb{Q}}_t(-\alpha_t).
\]</span></p>
<blockquote>
<p>There is no constraint on <span class="math inline">\(\alpha_t\)</span>, which can be used, e.g., to specify some forms of seasonality (see Example <a href="forward-futures-dividends-commodity-pricing-and-convenience-yields.html#exm:FCFPGaussian">6.1</a>).</p>
</blockquote>
<div class="example">
<p><span id="exm:FCFPGaussian" class="example"><strong>Example 6.1  (A Gaussian VAR model) </strong></span>Consider the state vector <span class="math inline">\(w_t = (s_t, c_t, r_t)'\)</span>, whose R.N. dynamics reads:
<span class="math display">\[
w_{t+1} = A_0 + A_1 w_t + \varepsilon_{t+1}, \quad \varepsilon_{t+1} \sim  i.i.d. \mathcal{N}(0,\Sigma) \mbox{ under }\mathbb{Q}.
\]</span>
We then have (see Example <a href="ChapterAffine.html#exm:GAR1">1.5</a>):
<span class="math display">\[\begin{eqnarray*}
\mathbb{E}_t \exp (u' w_{t+1}) &amp;=&amp; \exp \left[u' (A_0 + A_1 w_t) + \frac{1}{2} u' \Sigma u\right] \\
\Rightarrow &amp;&amp;
\left\{
\begin{array}{ccl}
a(u) &amp;=&amp;A^{'}_1 u \\
b(u) &amp; =&amp; A'_0 u + \frac{1}{2} u' \Sigma u. \end{array} \right.
\end{eqnarray*}\]</span>
Decompose <span class="math inline">\(A_0\)</span> and <span class="math inline">\(A_1\)</span> as follows:
<span class="math display">\[\begin{eqnarray*}
A_0 &amp;=&amp; \left(
\begin{array}{c} A_{01} \\ \tilde{A}_0
\end{array}
\right), \quad A_1 = \left(
\begin{array}{c} A_{11} \\
\tilde{A}_1
\end{array}
\right).
\end{eqnarray*}\]</span>
If the considered commodity is storable, we have the following ICCs (no constraint otherwise):
<span class="math display">\[
\left\{
\begin{array}{ccl}
a (e_1) &amp; = &amp; e_1 - e_2 + e_3 \\
b (e_1) &amp;=&amp; 0. \end{array}
\right.
\]</span>
Therefore, the first row of <span class="math inline">\(A_1\)</span> is <span class="math inline">\(A_{11} = e_1'- e_2' + e_3'\)</span>, the first element of <span class="math inline">\(A_0\)</span> is <span class="math inline">\(A_{01} = -\frac{1}{2}\sigma^2_1\)</span> (<span class="math inline">\(\sigma^2_1\)</span> being the conditional variance of <span class="math inline">\(s_{t+1}\)</span>).</p>
<p>In other words the <span class="math inline">\(\mathbb{Q}\)</span>-VAR is:
<span class="math display">\[
\left\{\begin{array}{cclcc} s_{t+1} &amp; = &amp; -\frac{1}{2}
\sigma^2_1 + s_t - c_t + r_t &amp;+&amp; \varepsilon_{1,t+1} \\
\left(\begin{array}{c} c_{t+1} \\ r_{t+1} \end{array} \right) &amp; = &amp;
\tilde{A}_0 + \tilde{A}_1 w_t &amp;+&amp; \left(\begin{array}{c} \varepsilon_{2,t+1} \\
\varepsilon_{3,t+1} \end{array} \right),
\end{array} \right.
\]</span>
where <span class="math inline">\(\tilde{A}_0\)</span> and <span class="math inline">\(\tilde{A}_1\)</span> are not constrained.</p>
<p>Noting <span class="math inline">\(y_{t+1} = \log (S_{t+1}/S_t) = s_{t+1} - s_t\)</span>, this implies that
<span class="math display">\[
\mathbb{E}^{\mathbb{Q}}_t y_{t+1} = r_t - c_t - \frac{1}{2} \sigma^2_1.
\]</span>
Hence, <span class="math inline">\(y_{t+1} - r_t + c_t + \frac{1}{2} \sigma^2_1\)</span> is a <span class="math inline">\(\mathbb{Q}\)</span>-martingale difference.</p>
<p>The historical dynamics of the state vector is as follows:
<span class="math display">\[
\begin{array}{lcl}
\psi_t (u) &amp; = &amp; \psi^{\mathbb{Q}}_t (u-\alpha_t) - \psi^{\mathbb{Q}}_t (- \alpha_t) \\
&amp;=&amp; u' (A_0 + A_1 w_t) + \frac{1}{2} (u-\alpha_t)' \Sigma (u-\alpha_t)- \frac{1}{2} \alpha'_t
\Sigma \alpha_t \\
&amp;=&amp;u' (A_0 + A_1 w_t) - u' \Sigma \alpha_t + \frac{1}{2} u' \Sigma u.
\end{array}
\]</span>
If we take <span class="math inline">\(\alpha_t = \alpha_0 + \alpha_1 w_t\)</span>, we get:
<span class="math display">\[\begin{eqnarray*}
\psi_t (u) &amp;=&amp; u' [A_0 - \Sigma \alpha_0 + (A_1 - \Sigma \alpha_1) w_t] + \frac{1}{2} u' \Sigma u \\
\Rightarrow  w_{t+1} &amp;=&amp; A_0 - \Sigma \alpha_0 + (A_1 - \Sigma \alpha_1) w_t + \xi_t,\\
&amp;&amp; \xi_t \sim  i.i.d.   \mathcal{N}(0,\Sigma)\; \mbox{under}\;\mathbb{P}.
\end{eqnarray*}\]</span>
Hence, any VAR(1), with same <span class="math inline">\(\Sigma\)</span>, can be reached.</p>
<p>We can also take a time-varying specification for <span class="math inline">\(\alpha_t\)</span>, of the form <span class="math inline">\(\alpha_t = \alpha_{0t} + \alpha_1 w_t\)</span>. We then get the historical dynamics:
<span class="math display">\[
w_{t+1} = A_{0} - \Sigma \alpha_{0t} + (A_1 - \Sigma \alpha_1) w_t + \xi_{t+1}
\]</span>
We can for instance choose <span class="math inline">\(\alpha_{0t}\)</span> such that: <span class="math inline">\(A_{0} - \Sigma \alpha_{0t} = \left( \begin{array}{c} \mu_{1t} \\ \mu_2 \\ \mu_3 \end{array}\right)\)</span>, where <span class="math inline">\(\mu_{1t}\)</span>, <span class="math inline">\(\mu_2\)</span>, and <span class="math inline">\(\mu_3\)</span> are given.
In particular:
<span class="math display">\[\begin{eqnarray*}
s_{t+1} &amp; = &amp; \mu_{1t} + (A_{11} - \Sigma_1 \alpha_1) w_t + \xi_{1,t+1} \\
&amp; = &amp; \mu_{1t} + \bar{A}_{11} w_t + \xi_{1,t+1}\; \mbox{(say)}, \;
\end{eqnarray*}\]</span>
where <span class="math inline">\(\bar{A}_{11}\)</span> is not constrained, or:
<span class="math display">\[
s_{t+1} - \nu_{t+1} = \mu_1 + \bar{A}_{11,1} (s_t - \nu_t) + \bar{A}_{11,2} c_t + \bar{A}_{11,3} r_t + \xi_{1,t+1}
\]</span>
with
<span class="math display">\[
\mu_{1t} = \mu_1 + \nu_{t+1} - \bar{A}_{11,1} \nu_t.
\]</span>
In other words any historical seasonal function <span class="math inline">\(\nu_t\)</span> can be reached by choosing <span class="math inline">\(\mu_{1t}\)</span>, i.e., <span class="math inline">\(\alpha_{0t}\)</span>.</p>
</div>
<div class="example">
<p><span id="exm:Schwartz1997" class="example"><strong>Example 6.2  (Schwartz (1997)) </strong></span><span class="citation">Schwartz (<a href="references.html#ref-Schwartz_1997">1997</a>)</span> proposes three models whose discrete-time versions are:</p>
<ul>
<li>
<strong>Model 1</strong>:
<span class="math display">\[\begin{eqnarray*}
\mathbb{P}&amp;:&amp; s_{t+1} = a_0 + a_1 s_t + \sigma \varepsilon_{t+1}, \; \; \; \varepsilon_t \stackrel{\mathbb{P}}{\sim}  i.i.d. \mathcal{N}(0,1) \\
\mathbb{Q} &amp;:&amp; s_{t+1} = a^*_0 + a_1 s_t + \sigma \xi_{t+1}, \; \; \; \xi_{t} \stackrel{\mathbb{Q}}{\sim}  i.i.d. \mathcal{N}(0,1).
\end{eqnarray*}\]</span>
</li>
<li>
<strong>Model 2</strong>:
<span class="math display">\[\begin{eqnarray*}
\mathbb{P}&amp;:&amp; s_{t+1} = a_{10} + s_t - c_t + \sigma_1 \varepsilon_{1,t+1}\\
&amp;&amp; c_{t+1} = a_{20} + a_{21} c_t + \sigma_2 \varepsilon_{2,t+1}\hspace{1cm} corr (\varepsilon_{1t}, \varepsilon_{2,t}) = \rho \\
\mathbb{Q}&amp;:&amp; s_{t+1} = r - \frac{\sigma^2_1}{2} + s_t - c_t + \sigma_1  \xi_{1,t+1} \\
&amp;&amp; c_{t+1} = a^*_{20} + a_{21} c_t + \sigma_2 \xi_{2,t+1} \hspace{1cm} corr (\xi_{1t}, \xi_{2t}) = \rho.
\end{eqnarray*}\]</span>
</li>
<li>
<strong>Model 3</strong>:
<span class="math display">\[\begin{eqnarray*}
\mathbb{P}&amp;:&amp; s_{t+1} = a_{10} + s_t - c_t + r_t + \sigma_1 \varepsilon_{1,t+1} \\
&amp;&amp; c_{t+1}= a_{20} + a_{21} c_t + \sigma_2 \varepsilon_{2,t+1} \\
&amp;&amp; r_{r+1} = a_{30} + a_{31} r_t + \sigma_3 \varepsilon_{3,t+1} \\
\mathbb{Q}&amp;:&amp; s_{t+1} = -\frac{\sigma^2_1}{2} + s_t - c_t + r_t + \sigma_1 \xi_{1,t+1}\\
&amp;&amp;c_{t+1} = a^*_{20} + a_{21} c_t + \sigma_2 \xi_{2,t+1} \\
&amp;&amp;r_{t+1} = a_{30} + a_{31} r_t + \sigma_3 \xi_{3,t+1},
\end{eqnarray*}\]</span>
with <span class="math inline">\(\mathbb{C}orr(\varepsilon_{1t}, \varepsilon_{2t}) = \rho_1\)</span>, <span class="math inline">\(\mathbb{C}orr(\varepsilon_{2t}, \varepsilon_{3t}) = \rho_2\)</span>, <span class="math inline">\(\mathbb{C}orr(\varepsilon_{1t}, \varepsilon_{3t}) = \rho_3\)</span>, and idem for the <span class="math inline">\(\xi_{it}\)</span>’s. (All shocks are <span class="math inline">\(\mathcal{N}(0,1)\)</span>.)</li>
</ul>
<p>In these models, <span class="math inline">\(\log F_{t,T}\)</span> is an affine function of <span class="math inline">\(\{s_t, c_t, r_t\}\)</span>.</p>
<p>From an estimation point of view, <span class="math inline">\(s_t\)</span> and <span class="math inline">\(c_t\)</span> are latent. The parameters are estimated by the ML method, the likelihood functions being computed by the Kalman filter (see Subsection <a href="Estimation.html#Estimation:KF">5.2</a>). The state variable is <span class="math inline">\(s_t\)</span> in Model 1, and <span class="math inline">\(\{s_t, c_t\}\)</span> in Models 2 and 3. (The <span class="math inline">\(\mathbb{P}\)</span> and <span class="math inline">\(\mathbb{Q}\)</span> dynamics of <span class="math inline">\(r_t\)</span> are estimated separately.)</p>
<p>As can be seen in the previous equations, constraints are imposed between the <span class="math inline">\(\mathbb{P}\)</span> and <span class="math inline">\(\mathbb{Q}\)</span> parameters; this is to help the identification of the model parameters.</p>
<!-- ```{r Schwartz1, fig.align = 'center', out.width = "95%", fig.cap = "Source: Schwartz (1997).", echo=FALSE} -->
<!-- knitr::include_graphics("figures/Tab1_Schwartz.png") -->
<!-- ``` -->
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:Schwartz2"></span>
<img src="figures/Tab2_Schwartz.png" alt="Out of sample means for maturities not used at the  estimation stage. F1 contract : the closest to maturity F2 : the second contract to maturity and so one. Source: Schwartz (1997)." width="95%"><p class="caption">
Figure 6.1: Out of sample means for maturities not used at the estimation stage. F1 contract : the closest to maturity F2 : the second contract to maturity and so one. Source: Schwartz (1997).
</p>
</div>
</div>
</div>
</div>
<div id="interest-rate-swaps-and-forward-contracts" class="section level2" number="6.2">
<h2>
<span class="header-section-number">6.2</span> Interest-rate swaps and forward contracts<a class="anchor" aria-label="anchor" href="#interest-rate-swaps-and-forward-contracts"><i class="fas fa-link"></i></a>
</h2>
<div id="Swaps" class="section level3" number="6.2.1">
<h3>
<span class="header-section-number">6.2.1</span> Swap rates<a class="anchor" aria-label="anchor" href="#Swaps"><i class="fas fa-link"></i></a>
</h3>
<div class="definition">
<p><span id="def:swap" class="definition"><strong>Definition 6.1  (Interest Rate Swap (IRS)) </strong></span>In an Interest Rate Swap (IRS), a <em>fixed-rate payer</em> agrees to provide the <em>fixed-rate receiver</em> with a sequence of cash flows that are determined at the negotiation date of the swap, and at predetermined dates. These cash flows constitute the <em>fixed leg</em> of the swap. Conversely, the fixed-rate receiver provides the fixed-rate payer with cash-flows that depend on future values of a reference rate; this is the <em>floating rate</em> of the swap.</p>
<p>More precisely, the dates of payment are of the form <span class="math inline">\(t+ \tau\)</span>, <span class="math inline">\(t + 2\tau\)</span>, , <span class="math inline">\(t + n\tau\)</span>, where <span class="math inline">\(\tau\)</span> is a period expressed in years (typically 1/2 or 1/4) and <span class="math inline">\(n\)</span> is the number of payments. The maturity, or <em>tenor</em>, of the swap contract is <span class="math inline">\(h = n \tau\)</span>.</p>
<p>The payoffs of the fixed leg are <span class="math inline">\(\tau S\)</span>, where <span class="math inline">\(S\)</span> is the annualized payment (or <em>swap rate</em>). On date <span class="math inline">\(t+j\tau\)</span>, the payoff of the floating leg is <span class="math inline">\(\tau L(t+(j-1)\tau,\tau)\)</span>, where <span class="math inline">\(L\)</span>, the annualized linear rate is given by:
<span class="math display">\[
L(t+(j-1)\tau,\tau) = \frac{1 - B(t+(j-1)\tau,\tau)}{\tau B(t+(j-1)\tau,\tau)},
\]</span>
where <span class="math inline">\(B(t+(j-1)\tau,\tau)\)</span> is the price, at date <span class="math inline">\(t+(j-1)\tau\)</span> of a bond of maturity <span class="math inline">\(\tau\)</span>.</p>
<p>On the negotiation date, the values of the fixed and floating legs are identical, so that the value of the swap is zero.</p>
</div>
<div class="proposition">
<p><span id="prp:swap" class="proposition"><strong>Proposition 6.4  (Swap rate formula) </strong></span>The swap rate <span class="math inline">\(S(t,h)\)</span>, as defined in Def. <a href="forward-futures-dividends-commodity-pricing-and-convenience-yields.html#def:swap">6.1</a> satisfies:
<span class="math display" id="eq:swap">\[\begin{equation}
\boxed{S(t,h) = \frac{1 - B(t,h)}{\tau \sum_{j=1}^{h/\tau}  B(t,j\tau)}.}\tag{6.5}
\end{equation}\]</span></p>
</div>
<div class="proof">
<p><span id="unlabeled-div-25" class="proof"><em>Proof</em>. </span>At <span class="math inline">\(t\)</span>, the price of the fixed leg is:
<span class="math display">\[
\sum_{j=1}^n \tau S B(t,j\tau).
\]</span>
Let us turn to the price of the floating leg. The payoff at date <span class="math inline">\(t+j\tau\)</span>, that is <span class="math inline">\(\frac{1 - B(t+(j-1)\tau,\tau)}{B(t+(j-1)\tau,\tau)}\)</span> is known on date <span class="math inline">\(t+(j-1)\tau\)</span>, so its price at date <span class="math inline">\(t+(j-1)\tau\)</span> is <span class="math inline">\(1 - B(t+(j-1)\tau,\tau)\)</span>, and its price at <span class="math inline">\(t\)</span> therefore is <span class="math inline">\(B(t,(j-1)\tau) - B(t,j\tau)\)</span>. Summing over <span class="math inline">\(j=1,\dots,n\)</span>, the date-<span class="math inline">\(t\)</span> price of the floating leg is <span class="math inline">\(1 - B(t,n\tau)\)</span> (independent of the payment dates).</p>
<p>Since the price of the contract is zero at date <span class="math inline">\(t\)</span> (by definition of the swap), we must have:
<span class="math display">\[
\sum_{j=1}^n \tau S B(t,j\tau) = 1 - B(t,n\tau),
\]</span>
which gives <a href="forward-futures-dividends-commodity-pricing-and-convenience-yields.html#eq:swap">(6.5)</a>.</p>
</div>
<blockquote>
<p>Note that all the terms appearing in the previous formula are available in closed-form in the context of an affine model (see Example <a href="ChapterAffine.html#exm:nominalBth">1.18</a>).</p>
</blockquote>
<blockquote>
<p>Eq. <a href="forward-futures-dividends-commodity-pricing-and-convenience-yields.html#eq:swap">(6.5)</a> also shows that we have <span class="math inline">\(100\% = B(t,h) + S(t,h) \tau \sum_{j=1}^{h/\tau} B(t,j\tau)\)</span>. This equation means that the swap rate <span class="math inline">\(S(t,h)\)</span> is homogenous to the yield-to-maturity of a bond valued at par (<span class="math inline">\(100\%\)</span>), whose coupons are equal to <span class="math inline">\(S(t,h) \tau\)</span>. (The coupons are paid on <span class="math inline">\(\{t+\tau,\dots,t+n\tau\}\)</span>.)</p>
</blockquote>
</div>
<div id="FWD" class="section level3" number="6.2.2">
<h3>
<span class="header-section-number">6.2.2</span> Forward rates<a class="anchor" aria-label="anchor" href="#FWD"><i class="fas fa-link"></i></a>
</h3>
<div class="definition">
<p><span id="def:FWD" class="definition"><strong>Definition 6.2  (Forward Rate Agreement (FRA)) </strong></span>An interest rate forward contract is a contract in which the rate to be paid or received on a specific obligation for a set period, beginning in the future, is set at contract initiation.</p>
<p>Denote by <span class="math inline">\(f(t,h_1,h_2)\)</span> the forward interest rate, set on date <span class="math inline">\(t\)</span>, for the period between <span class="math inline">\(t+h_1\)</span> and <span class="math inline">\(t+h_2\)</span>. One of the two counterparties will pay <span class="math inline">\(\exp(-f(t,h_1,h_2)(h_2 - h_1))\)</span> on date <span class="math inline">\(t+h_1\)</span>, and receive one on date <span class="math inline">\(t+h_2\)</span>.</p>
</div>
<div class="proposition">
<p><span id="prp:fwd" class="proposition"><strong>Proposition 6.1  (Forward rate formula) </strong></span>The forward rate defined in Def. <a href="forward-futures-dividends-commodity-pricing-and-convenience-yields.html#def:FWD">6.2</a> satisfies:
<span class="math display" id="eq:forward">\[\begin{equation}
\boxed{f(t,h_1,h_2) = \frac{h_2 R(t,h_2) - h_1 R(t,h_1)}{h_2 - h_1},}\tag{6.6}
\end{equation}\]</span>
where <span class="math inline">\(R_{t,h}\)</span> denotes the date-<span class="math inline">\(t\)</span> continuously-compounded yield of maturity <span class="math inline">\(h\)</span>.</p>
</div>
<div class="proof">
<p><span id="unlabeled-div-26" class="proof"><em>Proof</em>. </span>Consider two strategies (decided on date <span class="math inline">\(t\)</span>):</p>
<ol style="list-style-type: decimal">
<li>Buy a zero-coupon bond of maturity <span class="math inline">\(h_2\)</span> (price <span class="math inline">\(B(t,h_2)\)</span>) and sell zero-coupon bonds of maturity <span class="math inline">\(h_1\)</span> for the same amount (yielding a payoff of <span class="math inline">\(B(t,h_2)/B(t,h_1)\)</span> on date <span class="math inline">\(t+h_1\)</span>).</li>
<li>Enter a forward rate agreement between dates <span class="math inline">\(t+h_1\)</span> and <span class="math inline">\(t+h_2\)</span>, whereby you receive 1 on date <span class="math inline">\(t+h_2\)</span>.</li>
</ol>
<p>These two strategies deliver the same payoffs on date <span class="math inline">\(t\)</span> (the payoff is zero) and on date <span class="math inline">\(t+h_2\)</span> (the payoff is 1). By absence of arbitrage, the payoffs on date <span class="math inline">\(t+h_1\)</span> have to be the same. Therefore
<span class="math display">\[\begin{eqnarray*}
\exp(-(h_2 - h_1)f(t,h_1,h_2)) &amp;=&amp; B(t,h_2)/B(t,h_1) \\
\Rightarrow f(t,h_1,h_2) &amp;=&amp; \frac{1}{h_2 - h_1}(\log[B(t,h_1)] - \log[B(t,h_2)]),
\end{eqnarray*}\]</span>
which gives <a href="forward-futures-dividends-commodity-pricing-and-convenience-yields.html#eq:forward">(6.6)</a>.</p>
</div>
<blockquote>
<p>In an affine model (where <span class="math inline">\(R(t,h)\)</span> is an affine function of the state vector <span class="math inline">\(w_t\)</span>), forward rates are linear in the state vector <span class="math inline">\(w_t\)</span>.</p>
</blockquote>

</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="Estimation.html"><span class="header-section-number">5</span> Estimation of affine asset-pricing models</a></div>
<div class="next"><a href="CreditLiRisks.html"><span class="header-section-number">7</span> Credit and liquidity risks</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#forward-futures-dividends-commodity-pricing-and-convenience-yields"><span class="header-section-number">6</span> Forward, futures, dividends, commodity pricing, and convenience yields</a></li>
<li>
<a class="nav-link" href="#derivatives-written-on-stocks-or-commodities"><span class="header-section-number">6.1</span> Derivatives written on stocks or commodities</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#FCFPForwards"><span class="header-section-number">6.1.1</span> Forward contracts</a></li>
<li><a class="nav-link" href="#FCFPFutures"><span class="header-section-number">6.1.2</span> Futures contracts, futures prices</a></li>
<li><a class="nav-link" href="#FCFPConvenience"><span class="header-section-number">6.1.3</span> Convenience yields</a></li>
<li><a class="nav-link" href="#FCFPPricingRN"><span class="header-section-number">6.1.4</span> Pricing with affine models</a></li>
<li><a class="nav-link" href="#historical-dynamics"><span class="header-section-number">6.1.5</span> Historical dynamics</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#interest-rate-swaps-and-forward-contracts"><span class="header-section-number">6.2</span> Interest-rate swaps and forward contracts</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#Swaps"><span class="header-section-number">6.2.1</span> Swap rates</a></li>
<li><a class="nav-link" href="#FWD"><span class="header-section-number">6.2.2</span> Forward rates</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Introduction to Term Structure Models</strong>" was written by Alain Monfort and Jean-Paul Renne. It was last built on 2024-02-04.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
