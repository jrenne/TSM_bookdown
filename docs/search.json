[{"path":"index.html","id":"intro","chapter":"Introduction to Term Structure Models","heading":"Introduction to Term Structure Models","text":"Modeling dynamic term structures serves practical indispensable tool realm finance. enables investors, institutions, policymakers make informed decisions, manage risk effectively, allocate resources wisely. understanding interest rates yields evolve time, models offer clear lens assess market trends price financial instruments accurately.course developed Jean-Paul Renne Alain Monfort. illustrated R codes using various packages can obtained CRAN. TSModels package available GitHub. install , one need employ devtools library:Useful (R) links:Download R:\nR software: https://cran.r-project.org (basic R software)\nRStudio: https://www.rstudio.com (convenient R editor)\nDownload R:R software: https://cran.r-project.org (basic R software)RStudio: https://www.rstudio.com (convenient R editor)Tutorials:\nRstudio: https://dss.princeton.edu/training/RStudio101.pdf (Oscar Torres-Reyna)\nR: https://cran.r-project.org/doc/contrib/Paradis-rdebuts_en.pdf (Emmanuel Paradis)\ntutorial: https://jrenne.shinyapps.io/Rtuto_publiShiny/\nTutorials:Rstudio: https://dss.princeton.edu/training/RStudio101.pdf (Oscar Torres-Reyna)R: https://cran.r-project.org/doc/contrib/Paradis-rdebuts_en.pdf (Emmanuel Paradis)tutorial: https://jrenne.shinyapps.io/Rtuto_publiShiny/","code":"\ninstall.packages(\"devtools\") # in case this library has not been loaded yet\nlibrary(devtools)\ninstall_github(\"jrenne/TSModels\")\nlibrary(AEC)"},{"path":"ChapterAffine.html","id":"ChapterAffine","chapter":"1 Affine processes","heading":"1 Affine processes","text":"","code":""},{"path":"ChapterAffine.html","id":"Information","chapter":"1 Affine processes","heading":"1.1 Information in the Economy: The “factors”","text":"date \\(t=1,2,\\dots,T\\), agents receive new information observing factors, also called states. denote (\\(K\\)-dimensional) vector factors \\(w_t\\). Vector \\(w_t\\) usually random. date \\(t\\), vector \\(w_t\\) supposed perfectly observed agents (investors), can partially observed, unobserved econometrician.Naturally, \\(w_t\\) can decomposed different sub-vectors different natures. instance, can \\(w_t = (y_t', z_t')'\\) \n* \\(y_t\\): observable vector (geometric) returns,\n* \\(z_t\\): regime, unobserved econometrician.components \\(w_t\\) can prices. instance, one component short-term rate, stock return, exchange rate. can also include macroeconomic variables (inflation, GDP growth), agent-specific variables.","code":""},{"path":"ChapterAffine.html","id":"Dynamic","chapter":"1 Affine processes","heading":"1.2 Dynamic models and Laplace transform (L.T.)","text":"objective dynamic model describe random changes \\(w_t\\). dynamics can historical risk-neutral (see Chapter ??). dynamics consider parametric, sense conditional distribution \\(w_{t+1}|\\underline{w_t}\\) (\\(\\underline{w_t}=\\{w_t,w_{t-1},\\dots\\}\\)) depends vector parameters \\(\\theta\\). practice, may case \\(\\theta\\) unknown econometrician (see Chapter ??). choice (estimation) conditional distribution equivalent choice (estimation) conditional Laplace transforms:\n\\[\\begin{equation}\n\\varphi(u|\\underline{w_t},\\theta) =\n\\mathbb{E}_{\\theta}[\\exp(u'w_{t+1})|\\underline{w_t}], \\quad u \\\\mathbb{R}^K,\\tag{1.1}\n\\end{equation}\\]\nconditional log Laplace transforms:\n\\[\n\\psi(u|\\underline{w_t},\\theta) =\n\\log\\{\\mathbb{E}_{\\theta}[\\exp(u'w_{t+1})|\\underline{w_t}]\\}, \\quad u \\\n\\mathbb{R}^K.\n\\]Example 1.1  (Conditionally Bernoulli process) \\(w_{t+1}|\\underline{w_t} \\sim {\\mathcal{}} [p(\\underline{w_t},\\theta)]\\), :\n\\[\n\\varphi(u|w_t)=\n\\mathbb{E}[\\exp(u w_{t+1}) \\mid \\underline{w_t}] = p_t \\exp(u) + 1-p_t\n\\]\n\\(p_t = p(\\underline{w_t}, \\theta)\\).Example 1.2  (Conditionally Binomial process) \\(w_{t+1}|\\underline{w_t} \\{\\mathcal{B}}(n, p_t)\\), :\n\\[\n\\varphi(u|w_t)=[p_t   \\exp(u) + 1-p_t]^n.\n\\]Example 1.3  (Conditionally Poisson process) \\(w_{t+1}|\\underline{w_t} \\sim {\\mathcal{P}}(\\lambda_t)\\), :\n\\[\\begin{eqnarray*}\n\\varphi(u|w_t) & =&   \\sum^\\infty_{j=0}  \\dfrac{1}{j!}  \\exp(-\\lambda_t) \\lambda^j_t   \\exp(uj)  = \\exp(-\\lambda_t) exp[\\lambda_t \\exp(u)] \\\\\n& =& \\exp\\{\\lambda_t[\\exp(u)-1]\\}.\n\\end{eqnarray*}\\]Example 1.4  (Conditionally normal (Gaussian) process) \\(w_{t+1}|\\underline{w_t} \\sim \\mathcal{N}\\left(m(\\underline{w_t},\\theta), \\Sigma(\\underline{w_t},\\theta)\\right)\\), :\\[\nu'w_{t+1}|\\underline{w_t} \\sim \\mathcal{N}\\left(u'm(\\underline{w_t},\\theta), u'\\Sigma(\\underline{w_t},\\theta)u\\right).\n\\]\\[\n\\Rightarrow\n\\left\\{\n\\begin{array}{ccc}\n\\varphi(u|\\underline{w_t},\\theta) &=& \\exp\\left[\n\\begin{array}{l} u'm(\\underline{w_t},\\theta)+\n\\frac{1}{2} u'\\Sigma(\\underline{w_t},\\theta)u\\end{array}\n\\right]\\\\\n\\psi(u|\\underline{w_t},\\theta) &=&\nu'm(\\underline{w_t},\\theta) +  \\frac{1}{2}\nu'\\Sigma(\\underline{w_t},\\theta)u.\n\\end{array}\n\\right.\n\\]","code":""},{"path":"ChapterAffine.html","id":"AffineLaplace","chapter":"1 Affine processes","heading":"1.3 Laplace Transform and moments/cumulants","text":"properties Laplace transform (Eq. (1.1)):\\(\\varphi(0|\\underline{w_t},\\theta) = 1\\) \\(\\psi(0|\\underline{w_t},\\theta)=0\\).defined convex set \\(E\\) (containing \\(0\\)).interior \\(E\\) non empty, (conditional) moments exist.mentioned , knowing (conditional) Laplace transform equivalent knowing (conditional) moments—exist. scalar case, :moment order \\(n\\) closely relates \\(n^{th}\\) derivatives \\(\\varphi\\):\n\\[\n\\left[ \\begin{array}{l}  \\dfrac{\\partial^n\n\\varphi(u|\\underline{w_t},\\theta)}{\\partial u^n}\n\\end{array} \\right]_{u=0} = \\mathbb{E}_{\\theta}[w^n_{t+1}|\\underline{w_t}],\n\\]cumulant order \\(n\\) closely relates \\(n^{th}\\) derivatives \\(\\psi\\):\n\\[\n\\left[ \\begin{array}{l}  \\dfrac{\\partial^n\n\\psi(u|\\underline{w_t},\\theta)}{\\partial u^n}\n\\end{array} \\right]_{u=0} = K_n(\\underline{w_t},\\theta).\n\\]particular, precedes implies :\n\\[\n\\left\\{\n\\begin{array}{ccc}\nK_1(\\underline{w_t},\\theta) &=& \\mathbb{E}_{\\theta}[w_{t+1}|\\underline{w_t}]\\\\\nK_2(\\underline{w_t}, \\theta) &=& \\mathbb{V}ar_{\\theta}[w_{t+1}|\\underline{w_t}].\n\\end{array}\n\\right.\n\\]Accordingly, \\(\\varphi\\) \\(\\psi\\) respectively called conditional moment cumulant generating function.multivariate case, :\n\\[\\begin{eqnarray*}\n\\left[\\begin{array}{l}  \\dfrac{\\partial \\psi}{\\partial\nu} (u|\\underline{w_t},\\theta)  \\end{array} \\right]_{u=0} &=& \\mathbb{E}_{\\theta}[w_{t+1}|\\underline{w_t}] \\\\\n\\left[\\begin{array}{l}  \\dfrac{\\partial^2\n\\psi}{\\partial u\\partial u'} (u|\\underline{w_t},\\theta)  \\end{array}\n\\right]_{u=0} &=& \\mathbb{V}ar_{\\theta}[w_{t+1}|\\underline{w_t}].\n\\end{eqnarray*}\\]Example 1.4  (Conditionally normal (Gaussian) process) Consider Example 1.4. Applying previous formula, , scalar case:\\(\\psi(u|\\underline{w_t},\\theta)=u m(\\underline{w_t},\\theta) + \\frac{1}{2}u^2\\sigma^2(\\underline{w_t},\\theta)\\).\\(\\left[\\begin{array}{l} \\dfrac{\\partial \\psi}{\\partial u} (u|\\underline{w_t},\\theta) \\end{array} \\right]_{u=0} = m(\\underline{w_t},\\theta)\\).\\(\\left[\\begin{array}{l} \\dfrac{\\partial^2 \\psi}{\\partial u^2} (u|\\underline{w_t},\\theta) \\end{array} \\right]_{u=0} = \\sigma^2(\\underline{w_t},\\theta)\\)., multidimensional normal case:\\(\\psi(u|\\underline{w_t},\\theta)=u' m(\\underline{w_t},\\theta) + \\frac{1}{2}u'\\Sigma(\\underline{w_t},\\theta)u\\).\\(\\left[\\begin{array}{l} \\dfrac{\\partial \\psi}{\\partial u} (u|\\underline{w_t},\\theta) \\end{array} \\right]_{u=0} = m(\\underline{w_t},\\theta)\\).\\(\\left[\\begin{array}{l} \\dfrac{\\partial^2 \\psi}{\\partial u\\partial u'} (u|\\underline{w_t},\\theta) \\end{array} \\right]_{u=0} = \\Sigma(\\underline{w_t},\\theta)\\).cases, cumulants order \\(>2\\) equal \\(0\\).","code":""},{"path":"ChapterAffine.html","id":"additional-properties-of-the-laplace-transform","chapter":"1 Affine processes","heading":"1.4 Additional properties of the Laplace transform","text":"additional properties multivariate Laplace transform:\\(w_t=(w'_{1t},w'_{2t})'\\) \\(, u=(u'_1, u'_2)'\\):\n\\[\\begin{eqnarray*}\n\\mathbb{E}_{\\theta}[\\exp(u'_1 w_{1,t+1}|\\underline{w_t})&=&\\varphi(u_1,0|\\underline{w_t},\\theta)] \\\\\n\\mathbb{E}_{\\theta}[\\exp(u'_2 w\n_{2,t+1}|\\underline{w_t})&=&\\varphi(0,u_2|\\underline{w_t},\\theta)].\n\\end{eqnarray*}\\]\\(w_t=(w'_{1t},w'_{2t})'\\) \\(, u=(u'_1, u'_2)'\\):\n\\[\\begin{eqnarray*}\n\\mathbb{E}_{\\theta}[\\exp(u'_1 w_{1,t+1}|\\underline{w_t})&=&\\varphi(u_1,0|\\underline{w_t},\\theta)] \\\\\n\\mathbb{E}_{\\theta}[\\exp(u'_2 w\n_{2,t+1}|\\underline{w_t})&=&\\varphi(0,u_2|\\underline{w_t},\\theta)].\n\\end{eqnarray*}\\]\\(w_t=(w'_{1t},w'_{2t})'\\), \\(w_{1t}\\) \\(w_{2t}\\) conditionally independent:\n\\[\\begin{eqnarray*}\n\\varphi(u|\\underline{w_t},\\theta) &=&\n\\varphi(u_1,0|\\underline{w_t},\\theta)\\times\\varphi(0,u_2|\\underline{w_t},\\theta) \\\\\n\\psi(u|\\underline{w_t},\\theta) &=&\n\\psi(u_1,0|\\underline{w_t},\\theta)+\\psi(0,u_2|\\underline{w_t},\\theta).\n\\end{eqnarray*}\\]\\(w_t=(w'_{1t},w'_{2t})'\\), \\(w_{1t}\\) \\(w_{2t}\\) conditionally independent:\n\\[\\begin{eqnarray*}\n\\varphi(u|\\underline{w_t},\\theta) &=&\n\\varphi(u_1,0|\\underline{w_t},\\theta)\\times\\varphi(0,u_2|\\underline{w_t},\\theta) \\\\\n\\psi(u|\\underline{w_t},\\theta) &=&\n\\psi(u_1,0|\\underline{w_t},\\theta)+\\psi(0,u_2|\\underline{w_t},\\theta).\n\\end{eqnarray*}\\]\\(w_{1t}\\) \\(w_{2t}\\) size \n\\[\n\\varphi(u_1, u_2|\\underline{w_t},\\theta) = \\mathbb{E}_\\theta[\\exp(u'_1 w_{1, t+1} + u'_2 w_{2,t+1}|\\underline{w_t}],\n\\]\nconditional Laplace transform \\(w_{1, t+1} + w_{2, t+1}\\) given\n\\(\\underline{w_t}\\) \\(\\varphi(u, u|\\underline{w_t},\\theta)\\).\nparticular, \\(w_{1t}\\) \\(w_{2t}\\) conditionally independent \nsize, conditional Laplace transform Log-Laplace\ntransform \\(w_{1,t+1}+w_{2,t+1}\\) respectively:\n\\[\n\\varphi(u,0|\\underline{w_t},\\theta)\\times \\varphi(0,\nu|\\underline{w_t},\\theta), \\quad \\mbox{}\\quad \\psi(u,0|\\underline{w_t},\\theta)+ \\psi(0,\nu|\\underline{w_t},\\theta).\n\\]\\(w_{1t}\\) \\(w_{2t}\\) size \n\\[\n\\varphi(u_1, u_2|\\underline{w_t},\\theta) = \\mathbb{E}_\\theta[\\exp(u'_1 w_{1, t+1} + u'_2 w_{2,t+1}|\\underline{w_t}],\n\\]\nconditional Laplace transform \\(w_{1, t+1} + w_{2, t+1}\\) given\n\\(\\underline{w_t}\\) \\(\\varphi(u, u|\\underline{w_t},\\theta)\\).\nparticular, \\(w_{1t}\\) \\(w_{2t}\\) conditionally independent \nsize, conditional Laplace transform Log-Laplace\ntransform \\(w_{1,t+1}+w_{2,t+1}\\) respectively:\n\\[\n\\varphi(u,0|\\underline{w_t},\\theta)\\times \\varphi(0,\nu|\\underline{w_t},\\theta), \\quad \\mbox{}\\quad \\psi(u,0|\\underline{w_t},\\theta)+ \\psi(0,\nu|\\underline{w_t},\\theta).\n\\]Lemma 1.1  (Conditional zero probability non-negative processes) \\(w_t\\) univariate nonnegative (conditional)\nLaplace transform \\(\\varphi_t(u) = \\mathbb{E}_t[\\exp(u w_{t+1})]\\) defined\n\\(u \\leq 0\\) \n\\[\n\\mathbb{P}_t(w_{t+1} = 0) = \\lim_{u\\rightarrow - \\infty} \\varphi_t(u).\n\\]Proof. \\(\\varphi_t(u) = \\mathbb{P}_t(w_{t+1} = 0) + \\int_{w_{t+1}> 0} \\exp(u w_{t+1}) d\\mathbb{P}_t(w_{t+1})\\). Lebesgue theorem ensures last integral converges zero \\(u\\) goes \\(-\\infty\\).Lemma 1.2  (Conditional zero probability non-negative multivariate processes) Assume :\\(w_{1,t}\\) valued \\(\\mathbb{R}^{d}\\) (\\(d \\geq 1\\)),\\(w_{2,t}\\) valued \\(\\mathbb{R}^+ = [0, + \\infty )\\),\\(\\mathbb{E}_t \\left[ \\exp \\left( u_1 ' w_{1,t+1} + u_2 w_{2,t+1} \\right) \\right]\\) exists given \\(u_1\\) \\(u_2 \\leq 0\\)., :\n\\[\\begin{equation}\n\\mathbb{E}_t \\left[ \\exp( u_1 ' w_{1,t+1})  \\textbf{1}_{\\{w_{2,t+1} = 0 \\}} \\right] =  \\underset{u_2 \\rightarrow -\\infty}{\\lim} \\mathbb{E}_t \\left[ \\exp( u_1 ' w_{1,t+1} + u_2   w_{2,t+1} )  \\right].\\tag{1.2}\n\\end{equation}\\]Proof. \n\\[\\begin{eqnarray*}\n&&\\underset{u_2 \\rightarrow -\\infty}{\\lim} \\mathbb{E}_t \\left[ \\exp( u_1 ' w_{1,t+1} + u_2   w_{2,t+1} )  \\right] \\\\\n&=& \\mathbb{E}_t \\left[ \\exp( u_1 ' w_{1,t+1})   \\textbf{1}_{\\{w_{2,t+1} = 0 \\}} \\right] +\\\\\n&& \\underset{u_2 \\rightarrow -\\infty}{\\lim}   \\mathbb{E}_t \\left[ \\exp( u_1 ' w_{1,t+1} + u_2   w_{2,t+1} )  \\textbf{1}_{\\{w_{2,t+1} > 0 \\}}  \\right] ,\n\\end{eqnarray*}\\]\nsince second term right-hand side \\(\\exp(u_2 w_{2,t+1}) \\textbf{1}_{\\{w_{2,t+1} > 0 \\}} \\rightarrow 0\\) \\(u_2 \\rightarrow -\\infty\\), Eq. (1.2) consequence Lebesgue theorem.","code":""},{"path":"ChapterAffine.html","id":"AffineCar","chapter":"1 Affine processes","heading":"1.5 Affine (or Car) processes","text":"term structure applications, often consider affine processes (Definitions 1.1 1.2). processes indeed multi-horizon Laplace transform simple compute (Lemma 1.5 Proposition 1.5), key compute bond prices.","code":""},{"path":"ChapterAffine.html","id":"car-processes-of-order-one","chapter":"1 Affine processes","heading":"1.5.1 Car processes of order one","text":"definition compound auto-regressive (Car) process order one:Definition 1.1  (Affine process order 1) multivariate process \\(w_{t+1}\\) Affine order 1 [\\(Car(1)\\)] \n\\[\n\\varphi_t(u)=\\mathbb{E}_t[\\exp(u'w_{t+1})]=\\exp[(u)'w_t+b(u)]\n\\]\nfunctions \\((.)\\) \\(b(.)\\). functions univariate \\(w_{t+1}\\) (therefore \\(u\\)) scalar.Note \\((.)\\) \\(b(.)\\) may deterministic functions time (e.g., Chikhani Renne (2023)).first key example Gaussian auto-regressive processes:Example 1.5  (Univariate AR(1) Gaussian process) \\(w_{t+1}|\\underline{w_t} \\sim \\mathcal{N}(\\nu+\\rho w_t, \\sigma^2)\\), :\n\\[\n\\varphi_t(u) = \\exp\\left(\n\\begin{array}{l}\nu \\rho w_t + u \\nu + u^2  \\frac{\\sigma^2}{2}\n\\end{array}\n\\right) = \\exp[(u)'w_t+b(u)],\n\\]\n\\[\n\\mbox{}\\left\\{\n\\begin{array}{ccc}\n(u) &=& u \\rho\\\\\nb(u) &=& u \\nu + u^2  \\dfrac{\\sigma^2}{2}.\n\\end{array}\n\\right.\n\\]Example 1.6  (Gaussian VAR) \\(w_{t+1}|\\underline{w_t} \\sim \\mathcal{N}(\\mu+\\Phi w_t, \\Sigma)\\), :\n\\[\n\\varphi_t(u) = \\exp\\left(\n\\begin{array}{l}\nu' (\\mu + \\Phi  w_t)  +  \\frac{1}{2} u' \\Sigma u\n\\end{array}\n\\right) = \\exp[(u)'w_t+b(u)],\n\\]\n\\[\n\\mbox{}\\left\\{\n\\begin{array}{ccl}\n(u) &=& \\Phi'u\\\\\nb(u) &=& u' \\mu +  \\frac{1}{2} u' \\Sigma u = u' \\mu + \\frac{1}{2}(u \\otimes u)' vec(\\Sigma).\n\\end{array}\n\\right.\n\\]Example 1.7  (Quadratic Gaussian process) Consider vector \\(w_t = (x'_t,vec(x_t x_t')')'\\), \\(x_t\\) \\(n\\)-dimensional vector following Gaussian VAR(1), .e.\n\\[\nx_{t+1}|\\underline{w_t} \\sim \\mathcal{N}(\\mu+\\Phi x_t, \\Sigma).\n\\]\nProposition 1.2 shows \\(u = (v,V)\\) \\(v \\\\mathbb{R}^n\\) \\(V\\) square symmetric matrix size \\(n\\), :\n\\[\\begin{eqnarray*}\n\\varphi_t(u) &=& \\mathbb{E}_t\\big\\{\\exp\\big[(v',vec(V)')\\times w_{t+1}\\big]\\big\\} \\\\\n& =& \\exp \\left\\{a_1(v,V)'x_t +vec(a_2(v,V))' vec(x_t'x_t) + b(v,V) \\right\\},\n\\end{eqnarray*}\\]\n:\n\\[\\begin{eqnarray*}\na_2(u) & = & \\Phi'V (I_n - 2\\Sigma V)^{-1} \\Phi \\nonumber \\\\\na_1(u) & = & \\Phi'\\left[(I_n-2V\\Sigma)^{-1}(v+2V\\mu)\\right] \\nonumber \\\\\nb(u) & = & u'(I_n - 2 \\Sigma V)^{-1}\\left(\\mu + \\frac{1}{2} \\Sigma v\\right) +\\\\\n&& \\mu'V(I_n - 2 \\Sigma V)^{-1}\\mu - \\frac{1}{2}\\log\\big|I_n - 2\\Sigma V\\big|.\\tag{1.3}\n\\end{eqnarray*}\\]Quadratic processes can used construct positive process. Indeed, one can determine linear combinations components \\(w_t\\) (\\(\\alpha'w_t\\), say) \\(\\alpha'w_t \\ge 0\\). instance, \\(x_t\\) scalar, \\(\\alpha'w_t = x_t^2\\) \\(\\alpha = (0,1)'\\). illustrated Figure 1.1.\nFigure 1.1: Simulation quadratic processes \\(x_t\\).\nAnother example nonnegative process auto-regressive Gamma process (Gourieroux Jasiak 2006) extension (Monfort et al. 2017).Example 1.8  (Autoregressive gamma process, ARG(1)) ARG process defined follows:\n\\[\n\\frac{w_{t+1}}{\\mu} \\sim \\gamma(\\nu+z_t) \\quad \\mbox{} \\quad z_t \\sim \\mathcal{P} \\left( \\frac{\\rho w_t}{\\mu} \\right),\n\\]\n\\(\\nu\\), \\(\\mu\\), \\(\\rho > 0\\). (Alternatively \\(z_t \\sim {\\mathcal{P}}(\\beta w_t)\\), \\(\\rho = \\beta \\mu\\).)Proposition 1.3 shows \\(\\varphi_t(u) = \\exp[(u)'w_t+b(u)]\\) \n\\[\n\\left\\{\n\\begin{array}{ccc}\n(u) &=&  \\dfrac{\\rho u}{1-u \\mu}\\\\\nb(u) &=& -\\nu  \n\\log(1-u \\mu).\n\\end{array}\n\\right.\n\\]One can simulate ARG processes using web-interface (select “ARG” panel).can shown :\n\\[\n\\left\\{\n\\begin{array}{ccc}\n\\mathbb{E}(w_{t+1}|\\underline{w_t}) &=& \\nu \\mu + \\rho w_t \\\\\n\\mathbb{V}ar(w_{t+1}|\\underline{w_t}) &=& \\nu \\mu^2 + 2 \\mu \\rho w_t.\n\\end{array}\n\\right.\n\\]\n:\n\\[\nw_{t+1}=\\nu\\mu+\\rho w_t+\\varepsilon_{t+1},\n\\]\n\\(\\varepsilon_{t+1}\\) martingale difference \\(\\Rightarrow\\) \\(w_{t+1}\\) weak \\(AR(1)\\).Monfort et al. (2017) porpose extended ARG process ARG\\(_0\\) process. latter \\(\\nu = 0\\) \\(\\beta w_t\\) replaced \\(\\alpha + \\beta w_t\\), .e.:\n\\[\\begin{equation}\n\\frac{w_{t+1}}{\\mu} \\sim \\gamma(z_t),\\quad z_t \\sim {\\mathcal{P}}(\\alpha + \\beta w_t).\\tag{1.4}\n\\end{equation}\\]\neasily seen :\n\\[\n\\varphi_t(u) = exp \\left[\\frac{\\beta \\mu u}{1-u \\mu} w_t + \\frac{\\alpha \\mu u}{1-u \\mu}\n\\right].\n\\]\nARG\\(_0\\) process features point mass zero, conditional probability \\(exp(-\\alpha - \\beta w_t)\\). Note 0 absorbing \\(\\alpha = 0\\).Figure 1.2 displays simulated path ARG\\(_0\\) process (since set \\(\\nu\\) zero). Note function simul.ARG included TSModels package.\nFigure 1.2: Simulation ARG0 processes.\nCertain affine processes valued specific sets (e.g., integers). case compound Poisson proceses:Example 1.9  (Compound Poisson process) compound Poisson process defined follows (\\(\\gamma > 0\\), \\(0 < \\pi< 1\\), \\(\\lambda > 0\\)):\n\\[\\frac{w_{t+1}}{\\gamma} = z_{t+1} + \\varepsilon_{t+1},\n\\]\n\\(z_{t+1}\\) \\(\\varepsilon_{t+1}\\) conditionally independent, \n\\(z_{t+1} \\sim {\\mathcal B} \\left(\\frac{w_t}{\\gamma},\\pi\\right)\\), \\(\\varepsilon_{t+1} \\sim {\\mathcal P}(\\lambda)\\).process valued \\(\\{j \\gamma, j \\\\mathbb{N}, \\gamma \\\\mathbb{R}^+\\}\\) :\n\\[\n\\varphi_t(u) = \\exp\\left\\{\n\\begin{array}{l}\n\\dfrac{w_t}{\\gamma}   \\log[\\pi\n\\exp(u\\gamma)+1-\\pi]-\\lambda[1-\\exp(u \\gamma)]\n\\end{array}\n\\right\\},\n\\]\n.e., \\(\\varphi_t(u) = \\exp\\left((u)w_t+b(u)\\right)\\) \n\\[\n\\left\\{\n\\begin{array}{ccl}\n(u)&=& \\frac{1}{\\gamma}   \\log[\\pi   \\exp(u\n\\gamma)+1-\\pi],\\\\\nb(u) &=& -\\lambda[1-\\exp(u \\gamma)].\n\\end{array}\n\\right.\n\\]also : \\(w_{t+1} = \\pi w_t + \\lambda \\gamma + \\eta_{t+1}\\), \\(\\eta_{t+1}\\) \nmartingale difference.One can simulate processes using web-interface (select “Compound Poisson” panel). Figure 1.3 makes use function simul.compound.poisson (package TSModels) simulate compound Poisson process.\nFigure 1.3: Simulation Compound Poisson process.\n","code":"\nT <- 200\nphi <- .9;sigma <- 1\nx.t <- 0; x <- NULL\nfor(t in 1:T){\n  x.t <- phi*x.t + sigma*rnorm(1)\n  x <- c(x,x.t)}\npar(mfrow=c(1,2),plt=c(.1,.95,.15,.85))\nplot(x,type=\"l\",xlab=\"\",ylab=\"\",main=\"x_t\")\nplot(x^2,type=\"l\",xlab=\"\",ylab=\"\",main=\"x_t^2\")\nlibrary(TSModels)\nW <- simul.ARG(300,mu=.5,nu=0,rho=.9,alpha=.1)\nplot(W,type=\"l\")\nlibrary(TSModels)\nW <- simul.compound.poisson(100,Gamma=.5,Pi=0.5,lambda=.9)\nplot(W,type=\"l\")"},{"path":"ChapterAffine.html","id":"SubCarp","chapter":"1 Affine processes","heading":"1.5.2 Car processes of order \\(p\\)","text":"Let us now define Car processes order \\(p\\):Definition 1.2  (Affine process order p) multivariate process \\(w_{t+1}\\) affine order \\(p\\) [\\(Car(p)\\)] exist functions \\(a_1(.),\\dots,a_p(.)\\), \\(b(.)\\) :\n\\[\n\\varphi_t(u)=\\mathbb{E}_t[\\exp(u' w_{t+1})]=\\exp[a_1(u)'w_t+\\dots+a_p(u)'w_{t+1-p}+b(u)].\n\\]can seen \\(w_t\\) \\(Car(p)\\), \\(W_t = [w_t', w_{t-1}',\\dots,w_{t-p+1}']'\\) \\(Car(1)\\).1 Therefore, without loss generality can assume \\(p = 1\\).standard Car(\\(p\\)) processes auto-regressive processes order \\(p\\). processes satisfy definition index affine processes:Definition 1.3  (Univariate index affine process order p) Let \\(\\exp[(u)w_t+b(u)]\\) conditional Laplace transform univariate affine process order 1, process \\(w_{t+1}\\) index-affine process order \\(p\\) :\n\\[\n\\varphi_t(u)=\\mathbb{E}_t[\\exp(u w_{t+1})]=\\exp[(u)(\\beta_1 w_t+\\dots+\\beta_p\nw_{t+1-p})+b(u)].\n\\]Examples 1.10 1.11 two examples index affine processes.Example 1.10  (Gaussian AR(p) process) example extends Example 1.5. Consider Gaussian AR(p) process \\(w_t\\); :\n\\[\nw_{t+1} = \\nu + \\varphi_1 w_t +\\dots+ \\varphi_p w_{t+1-p}+\\sigma \\varepsilon_{t+1},\\quad \\varepsilon_{t+1} \\sim ..d. \\mathcal{N}(0,1).\n\\]\n:\n\\[\n\\varphi_t(u) = \\exp \\left[ u \\rho (\\beta_1 w_t+\\dots+\\beta_p w_{t+1-p})+u\\nu + u^2  \\frac{\\sigma^2}{2}\\right]\n\\]\n\\(\\varphi_i = \\rho \\beta_i\\).Example 1.11  (ARG(p) process (positive)) example extends Example 1.8.\nARG process order \\(p\\) defined follows:\n\\[\n\\frac{w_{t+1}}{\\mu} \\sim \\gamma(\\nu+z_t) \\quad \\mbox{} \\quad z_t \\sim \\mathcal{P} \\left( \\beta_1 w_t+\\dots+\\beta_p w_{t+1-p} \\right),\n\\]\n\\(\\nu\\), \\(\\mu\\), \\(\\beta_i > 0\\). :\n\\[\n\\varphi_t(u) = \\exp\\left[\\frac{\\rho u}{1-u \\mu} (\\beta_1 w_t+\\dots+\\beta_p w_{t+1-p})-\\nu  \\log(1-u\\mu)\\right],\n\\]\nProcess \\(w_t\\) admits following AR(\\(p\\)) representation:\n\\[\nw_{t+1} = \\nu\\mu + \\varphi_1 w_t +\\dots+ \\varphi_p w_{t+1-p}+\\varepsilon_{t+1},\n\\]\n\\(\\varphi_i = \\beta_i\\mu\\) \\(\\varepsilon_{t+1}\\) martingale difference.","code":""},{"path":"ChapterAffine.html","id":"Markov","chapter":"1 Affine processes","heading":"1.6 Markov chains","text":"subsection, show family affine processes includes () regime-switching models. consider time-homogeneous Markov chain \\(z_t\\), valued set columns \\(Id_J\\), identity matrix dimension \\(J \\times J\\). transition probabilities denoted \\(\\pi(e_i, e_j)\\), \\(\\pi(e_i, e_j) = \\mathbb{P}(z_{t+1}=e_j | z_t=e_i)\\). notations:\n\\[\n\\mathbb{E}[\\exp(v'z_{t+1})|z_t=e_i,\\underline{z_{t-1}}] = \\sum^J_{j=1} \\exp(v'e_j)\\pi (e_i, e_j).\n\\]\nHence, :\n\\[\n\\varphi_t(v) = \\exp[a_z(v)'z_t],\n\\]\n\n\\[\na_z(v)= \\left[ \\begin{array}{c} \\log \\left(\\sum^J_{j=1} \\exp(v'e_j)  \\pi(e_1,e_j)\\right)\\\\\n\\vdots\\\\\n\\log \\left(\\sum^J_{j=1} \\exp(v'e_j)  \\pi(e_J,e_j)\\right)\n\\end{array}\\right].\n\\]\nproves \\(z_t\\) affine process.One can simulate two-regime Markov chain using web-interface (select “Markov-Switching” panel).","code":""},{"path":"ChapterAffine.html","id":"WAR","chapter":"1 Affine processes","heading":"1.7 Wishart autoregressive (WAR) processes","text":"WAR matrix processes, valued space \\((L \\times L)\\) symmetric positive\ndefinite matrices.Definition 1.4  (Wishart autoregressive (WAR) processes) Let \\(W_{t+1}\\) \\(WAR_L(K, M, \\Omega)\\) process. defined :\n\\[\\begin{eqnarray}\n&&\\mathbb{E}[\\exp   Tr(\\Gamma W_{t+1})|\\underline{W_t}] \\tag{1.5}\\\\\n&=& \\exp\\left\\{Tr[M'\\Gamma(Id-2\\Omega \\Gamma)^{-1}M W_t]  -  \\frac{K}{2}   \\log [det(Id-2\\Omega \\Gamma)]\\right\\}, \\nonumber\n\\end{eqnarray}\\]\n\\(\\Gamma\\) symmetric matrix,2 \\(K\\) positive scalar, \\(M\\) \\((L \\times L)\\) matrix, \\(\\Omega\\) \\((L \\times L)\\) symmetric positive definite matrix.\\(K\\) integer, Proposition 1.4 (appendix) shows \\(W_{t+1}\\) can obtained :\n\\[\\begin{eqnarray*}\n\\left\\{\n\\begin{array}{ccl}\nW_{t+1} & =&  \\sum^K_{k=1} x_{k,t+1} x'_{k,t+1}\\\\\n&&\\\\\nx_{k,t+1} & =& M x_{k,t} + \\varepsilon_{k,t+1},\\quad k \\\\{1,\\dots,K\\},\n\\end{array}\n\\right.\n\\end{eqnarray*}\\]\n\\(\\varepsilon_{k,t+1} \\sim ..d. \\mathcal{N}(0, \\Omega)\\) (independent across \\(k\\)’s).\nproposition also shows :\n\\[\n\\mathbb{E}(W_{t+1}|\\underline{W_t}) = MW_tM'+K \\Omega,\n\\]\n.e. \\(W_t\\) follows matrix weak AR(1) process.particular case, \\(L=1\\) (univariate case), :\n\\[\\begin{eqnarray*}\n\\mathbb{E}[\\exp(u W_{t+1})|\\underline{W_t}] = \\exp\\left[\n\\frac{u m^2}{1-2\\omega u}W_t -\n\\frac{K}{2}   \\log(1-2\\omega u)\\right].\n\\end{eqnarray*}\\]\nHence, \\(L=1\\), Wishart process boils \\(ARG(1)\\) process (Example 1.8) \\(\\rho = m^2\\), \\(\\mu = 2\\omega\\), \\(\\nu = \\frac{K}{2}\\).","code":""},{"path":"ChapterAffine.html","id":"building","chapter":"1 Affine processes","heading":"1.8 Building affine processes","text":"","code":""},{"path":"ChapterAffine.html","id":"stoch","chapter":"1 Affine processes","heading":"1.8.1 Univariate affine processes with stochastic parameters","text":"univariate affine processes can extended satisfy certain conditions. Specifically, consider univariate affine process whose conditional L.T. form:\n\\[\\begin{equation}\n\\mathbb{E}_t   \\exp(u y_{t+1}) = \\exp[a_0(u)y_t+b_0(u)\\delta],\\tag{1.6}\n\\end{equation}\\]\n\\(\\delta = (\\delta_1,\\dots,\\delta_m)' \\\\mathcal{D}\\). process can generalized making \\(\\delta\\) stochastic (staying affine family). precisely assume :\n\\[\n\\mathbb{E}[\\exp(u y_{t+1})|\\underline{y_t}, \\underline{z_{t+1}}] = \\exp[a_0(u)y_t+b_0(u)'\\Lambda z_{t+1}],\n\\]\n\\(\\Lambda\\) \\((m\\times k)\\) matrix, \\(\\Lambda z_{t+1} \\\\mathcal{D}\\). case, :\n\\[\n\\mathbb{E}[\\exp(v' z_{t+1})|\\underline{y_t}, \\underline{z_{t}}] = \\exp[a_1(v)'z_t+b_1(v)],\n\\]\n\\(w_{t+1} = (y_{t+1}, z'_{t+1})'\\) affine.3Example 1.12  (Gaussian AR(p)) Using notation Example 1.10, comes AR(p) processes satisfies Eq. (1.6) \\(b_0(u) = \\left(u, \\; \\frac{u^2}{2}\\right)'\\) \\(\\delta = (\\nu,\\sigma^2)' \\\\mathcal{D}=\\mathbb{R} \\times \\mathbb{R}^+\\). case, \\(\\delta\\) (vector conditional mean variance) can replaced …\\(\\left( \\begin{array}{l} z_{1,t+1} \\\\ z_{2,t+1} \\end{array} \\right)\\), \\(z_{1,t+1}\\) \\(z_{2,t+1}\\) independent AR(1) (see Example 1.5) ARG(1) (see Example 1.8) processes, respectively.\\(\\left( \\begin{array}{ll} \\lambda'_1 & 0 \\\\ 0 & \\lambda'_2 \\end{array} \\right)\\)\\(\\left( \\begin{array}{l} z_{1,t+1} \\\\ z_{2,t+1} \\end{array} \\right)\\), \\(z_{1,t+1}\\) \\(z_{2,t+1}\\) independent Markov chains.\\(\\left( \\begin{array}{l} \\lambda'_1 \\\\ \\lambda'_2 \\end{array}\\right)z_{t+1}\\), \\(z_{t+1}\\) Markov chain.Example 1.11  (ARG(p) model) \\(b_0(u)= - \\nu \\log(1-u\\mu)\\), \\(\\delta=\\nu\\).\\(\\nu\\) (\\(\\ge 0\\)) can specified instance Markov chain ARG.","code":""},{"path":"ChapterAffine.html","id":"buildingmulti","chapter":"1 Affine processes","heading":"1.8.2 Multivariate affine processes","text":"One can construct multivariate affine processes employing -called recursive approach. Let us illustrate considering bivariate case. (multivariate generalization straightforward.) Consider \\(w_t = \\left(\\begin{array}{c} w_{1,t}\\\\ w_{2,t} \\end{array} \\right)\\),assume :\n\\[\\begin{eqnarray*}\n&&\\mathbb{E}[\\exp(u_1 w_{1,t+1}|\\underline{w_{1,t}}, \\underline{w_{2,t}})]\\\\\n&=& \\exp[a_{11}(u_1)w_{1,{\\color{red}{t}}}+a_{12}(u_1)w_{2,{\\color{red}{t}}}+b_{1}(u_1)],\n\\end{eqnarray*}\\]\n:\n\\[\\begin{eqnarray*}\n&& \\mathbb{E}[\\exp(u_2 w_{2,t+1}|\\underline{w_{1,t+1}}, \\underline{w_{2,t}})]\\\\\n&= & \\exp[a_0(u_2)w_{1,{\\color{red}{t+1}}}+a_{21}(u_2)w_{1,{\\color{red}{t}}}+a_{22}(u_2)w_{2,{\\color{red}{t}}}+b_2(u_2)].\n\\end{eqnarray*}\\]\n\\(w_t\\) affine process.4\ndynamics two components \\(w_t\\) form:\n\\[\\begin{eqnarray*}\nw_{1,t+1} &=& \\alpha_1 \\hspace{1.55cm} + \\alpha_{11}w_{1,t} + \\alpha_{12}w_{2,t} + \\varepsilon_{1,t+1} \\\\\nw_{2,t+1} &=& \\alpha_2 + \\alpha_{0}w_{1,t+1} + \\alpha_{21}w_{1,t} + \\alpha _{22} w_{2,t} + \\varepsilon_{2,t+1}\n\\end{eqnarray*}\\]\nNote \\(\\varepsilon_{1,t+1}\\) \\(\\varepsilon_{2,t+1}\\) non-correlated martingale differences. general case, conditionally heteroskedastic. precedes play \\(VAR\\) model; Monfort et al. (2017) employ approach build vector auto-regressive gamma (VARG) processes.","code":""},{"path":"ChapterAffine.html","id":"extending-multivariate-stochastic-processes","chapter":"1 Affine processes","heading":"1.8.3 Extending multivariate stochastic processes","text":"Consider framework Section 1.8.1 \\(y_t\\) \\(n\\)-dimensional vector. , replace Eq. (1.6) :\n\\[\\begin{equation}\n\\mathbb{E}_t   \\exp(u' y_{t+1}) = \\exp[a_0(u)'y_t+b_0(u)\\delta],\\tag{1.7}\n\\end{equation}\\]\nassume \\(\\delta\\) stochastic depends \\(z_t\\), :\n\\[\n\\mathbb{E}[\\exp(u y_{t+1})|\\underline{y_t}, \\underline{z_{t+1}}] = \\exp[a_0(u)y_t+b_0(u)'\\Lambda z_{t+1}],\n\\]\n\\(\\Lambda\\) \\((m\\times k)\\) matrix, \\(\\Lambda z_{t+1} \\\\mathcal{D}\\). case, :\n\\[\n\\mathbb{E}[\\exp(v' z_{t+1})|\\underline{y_t}, \\underline{z_{t}}] = \\exp[a_1(v)'z_t+b_1(v)],\n\\]\n\\(w_{t+1} = (y_{t+1}, z'_{t+1})'\\) affine.Example 1.13  (Stochastic parameters Gaussian VAR(1)) example extends Example 1.6. Using notations latter example 1.6, \n\\[\nb_0(u) = \\left(u', \\frac{1}{2} (u \\otimes u)'\\right)' \\quad \\mbox{} \\quad\\delta = (\\mu', vec(\\Sigma)')' \\\\mathbb{R}^n \\times vec(\\mathcal{S}),\n\\]\n\\(\\mathcal{S}\\) set symmetric positive semi-definite matrices. Vector \\(\\delta\\) can replaced :\n\\[\n\\left( \\begin{array}{l} z_{1,t+1}\n\\\\ z_{2,t+1}\n\\end{array} \\right),\n\\]\n\\(z_{1,t+1}\\) , instance, Gaussian VAR process.\\(z_{2,t+1}\\) isobtained applying \\(vec\\) operator Wishart process,replaced \\(\\Lambda_2 z_{2,t+1}\\), \\(\\Lambda_2\\) \\((n^2 \\times J)\\) matrix whose columns \\(vec(\\Sigma_j)\\), \\(j \\\\{1,\\dots,J\\}\\), \\(\\Sigma_j\\) \\((n \\times n)\\) positive semi-definite,standardized \\(J\\)-dimensional VARG process (multivariate extension Example 1.8).Example 1.14  (Regime-switching VAR(1)) One can also use approach construct (affine) regime-switching VAR processes (another extension Example 1.6. , replace \\(\\delta\\) \\(\\left( \\begin{array}{ll} \\Lambda_1 & 0 \\\\ 0 & \\Lambda_2 \\end{array} \\right)\\)\\(\\left( \\begin{array}{l} z_{1,t+1} \\\\ z_{2,t+1} \\end{array} \\right)\\), \\(\\Lambda_1\\) \\((n \\times J_1)\\) matrix \\(z_{1,t+1}\\) Markov chain valued set selection vectors size \\(J_1\\) (see Subsection 1.6), \\(\\Lambda_2\\) matrix Example 1.13 \\(z_{2,t+1}\\) Markov chain valued set selection vectors size \\(J_2\\).\\(\\left( \\begin{array}{l} \\Lambda_1 \\\\ \\Lambda_2 \\end{array}\\right)z_{t+1}\\), \\(\\Lambda_1\\) \\(\\Lambda_2\\) matrices \\(J_1=J_2=J\\), \\(z_{t+1}\\) Markov chain valued set selection vectors size \\(J\\).","code":""},{"path":"ChapterAffine.html","id":"AffineExtended","chapter":"1 Affine processes","heading":"1.8.4 Extended affine processes","text":"processes affine, may sub-components affine process. can useful compute conditional moments multi-horizon Laplace transform (one can use formulas presented , using enlarged—affine—vector).Let us formally define extended affine process:Definition 1.5  (Extended Affine Processes) process \\(w_{1,t}\\) extended affine exists process \\(w_{2,t} = g(\\underline{w_{1,t}})\\) \\((w'_{1,t}, w'_{2,t})'\\) affine (order 1).extended affine processes, \\(\\varphi_{1,t}(u) = \\mathbb{E}[\\exp(u'w_{1,t+1})|\\underline{w_{1,t}}]\\) can obtained :\n\\[\\begin{eqnarray*}\n\\varphi_t(u_1, u_2) &=& \\mathbb{E}[\\exp(u'_1w_{1,t+1}+u'_2 w_{2,t+1)}|\\underline{w_{1,t}}, \\underline{w_{2,t}}] \\\\\n&=& \\exp['_1(u_1,u_2)w_{1,t} + '_2(u_1,u_2)w_{2,t}+b(u_1,u_2)]\n\\end{eqnarray*}\\]\n:\n\\[\n\\varphi_{1,t}(u) = \\varphi_t(u, 0) = \\exp['_1(u,0)w_{1,t}+'_2(u,0)g(\\underline{w_{1,t}}) + b(u, 0)].\n\\]\nparticular \\(w_{1,t}\\) may non-Markovian.Similarly multi-horizon Laplace transform (see Section 1.9)\n\\[\n\\mathbb{E}[\\exp(\\gamma'_{1}w_{1,t+1}+\\dots+\\gamma'_{h}w_{1,t+h})|\\underline{w_{1,t}}]\n\\]\ncan obtained knowledge extended multi-horizon Laplace transform:\n\\[\\begin{eqnarray*}\n&&\\mathbb{E}_t[\\exp(\\{\\gamma'_{1,1}w_{1,t+1}+\\gamma'_{2,1}w_{2,t+1}\\}+\\dots+ \\{\\gamma'_{1,h}w_{1,t+h}+\\gamma'_{2,h}w_{2,t+h}\\}] \\\\\n&=& \\exp['_{1,t,h}(\\gamma^h_1, \\gamma^h_2)w_{1,t}+'_{2,t,h}(\\gamma^h_1, \\gamma^h_2)w_{2,t}+B_{t,h}(\\gamma^h_1, \\gamma^h_2)],\n\\end{eqnarray*}\\]\n(\\(\\gamma^h_1 = (\\gamma'_{1,1},\\dots, \\gamma'_{1,h})'\\), \\(\\gamma^h_2 = (\\gamma'_{2,1},\\dots, \\gamma'_{2,h})'\\)). indeed :\n\\[\\begin{eqnarray*}\n&& \\mathbb{E}[\\exp(\\gamma'_{1}w_{1,t+1}+\\dots+\\gamma'_{h}w_{1,t+h})|\\underline{w_{1,t}}]\\\\\n&=& \\exp['_{1,t,h}(\\gamma^h,0) w_{1,t} + '_{2,t,h}(\\gamma^h,0)g (\\underline{w_{1,t}}) + B_{t,h}(\\gamma^h,0)],\n\\end{eqnarray*}\\]\n\\(\\gamma^h = (\\gamma_1',\\dots,\\gamma_h')'\\).Example 1.15  (Affine process order p) \\(\\{w_{1,t}\\}\\) affine order \\(p>1\\), \\((w_{1,t},\\dots,w_{1,t-p+1})\\) affine order 1, \\(\\{w_{1,t}\\}\\) affine. , case, \\(w_{2,t} = (w'_{1,t-1}, \\dots.w'_{1,t-p+1})'\\).kind extreme case since \\(w_{2,t}\\) belongs information \\(t-1\\), implies \\(a_2(u_1, u_2) = u_2\\).Example 1.16  (Gaussian ARMA process) Consider \\(ARMA(1,1)\\) process\n\\[\nw_{1,t} - \\varphi w_{1,t-1} = \\varepsilon_t-\\theta \\varepsilon_{t-1},\n\\]\n\\(|\\varphi | < 1\\), \\(|\\theta| < 1\\), \\(\\varepsilon_t \\sim ..d. \\mathcal{N}(0, \\sigma^2)\\).\\(w_{1,t}\\) Markovian. Now, take \\(w_{2,t} = \\varepsilon_t = (1-\\theta L)^{-1}(1-\\varphi L)w_{1,t}\\). :\n\\[\n\\left(\n\\begin{array}{l}\nw_{1,t+1} \\\\\nw_{2,t+1}\n\\end{array}\n\\right) =\n\\left(\n\\begin{array}{ll}\n\\varphi & -\\theta \\\\\n0 &      0\n\\end{array}\n\\right)\n\\left(\n\\begin{array}{l}\nw_{1,t} \\\\\nw_{2,t}\n\\end{array}\n\\right) +\n\\left(\n\\begin{array}{l}\n1 \\\\\n1\n\\end{array}\n\\right) \\varepsilon_{t+1}.\n\\]\nHence \\((w_{1,t}, w_{2,t})'\\) Gaussian \\(VAR(1)\\), , therefore, affine order 1.easily extended \\(ARMA(p,q)\\) \\(VARMA(p,q)\\) processes.Example 1.17  (GARCH type process) Consider process \\(w_{1,t}\\), defined :\n\\[\nw_{1,t+1}  = \\mu + \\varphi w_{1,t} + \\sigma_{t+1} \\varepsilon_{t+1},\n\\]\n\\(|\\varphi| < 1\\) \\(\\varepsilon_t \\sim ..d. \\mathcal{N}(0,1)\\), \n\\[\n\\sigma^2_{t+1} = \\omega + \\alpha \\varepsilon^2_t + \\beta \\sigma^2_t,\n\\]\n\\(0 < \\beta < 1\\).Consider \\(w_{2,t} = \\sigma^2_{t+1}\\) (non-linear function \\(\\underline{w_{1,t}}\\)). Proposition 1.7 shows :\n\\[\\begin{eqnarray*}\n&& \\mathbb{E}\\left[\\exp(u_1 w_{1,t+1} + u_2 w_{2,t+1})|\\underline{w_{1,t}}\\right] \\\\\n&=& \\exp\\left[u_1 \\mu + u_2 \\omega - \\frac{1}{2}   \\log(1-2 u_2 \\alpha) \\right. \\\\\n&&\\left. +  u_1 \\varphi w_{1,t} + (u_2\\beta +  \\frac{u^2_1}{2(1-2u_2\\alpha)}) w_{2,t}\\right],\n\\end{eqnarray*}\\]\nexponential affine \\((w_{1,t}, w_{2,t})\\).","code":""},{"path":"ChapterAffine.html","id":"MHLT","chapter":"1 Affine processes","heading":"1.9 Multi-horizon Laplace transform","text":"","code":""},{"path":"ChapterAffine.html","id":"recursive-computation-and-direct-pricing-implications","chapter":"1 Affine processes","heading":"1.9.1 Recursive computation and direct pricing implications","text":"subsection, show multi-horizon Laplace transforms affine processes can calculated recursively. Various examples show can exploited price long-dated financial instruments.Let us consider multivariate process \\(w_{t}\\), affine order one. (explained Subsection 1.5.2, includes case order \\(p\\) case.) sake generality, consider case functions \\((.)\\), \\(b(.)\\) possibly deterministic functions time, denoted case \\(a_{t+1}(.)\\) \\(b_{t+1}(.)\\):\n\\[\n\\mathbb{E}_t \\exp[(u'w_{t+1})] = \\exp['_{t+1}(u)w_t+b_{t+1}(u)].\n\\]\nmulti-horizon Laplace transform associated date \\(t\\) horizon \\(h\\) defined :\n\\[\\begin{equation}\n\\varphi_{t,h}(\\gamma_1,\\dots,\\gamma_h) = \\mathbb{E}_t[\\exp(\\gamma'_1w_{t+1}+\\dots+\\gamma'_h w_{t+h})].\\tag{1.8}\n\\end{equation}\\]Lemma 1.5 (appendix) shows :\n\\[\n\\varphi_{t,h}(\\gamma_1,\\dots,\\gamma_h) = \\exp('_{t,h} w_t + B_{t,h}),\n\\]\n\\(A_{t,h} = ^h_{t,h}\\) \\(B_{t,h} = B^h_{t,h}\\), \\(^h_{t,}, B^h_{t,}\\) \\(= 1,\\dots,h\\), given recursively :\n\\[\n\\left\\{\n\\begin{array}{ccl}\n^h_{t,} &=& a_{t+h+1-}(\\gamma_{h+1-} + ^h_{t,-1}), \\\\\nB^h_{t,} &=& b_{t+h+1-}(\\gamma_{h+1-} + ^h_{t,-1}) + B^h_{t,-1}, \\\\\n^h_{t,0} &=& 0, B^h_{t,0} = 0.\n\\end{array}\n\\right.\n\\]functions \\(a_{t}\\) \\(b_{t}\\) depend \\(t\\), recursive formulas depend \\(t\\), get \\(\\varphi_{t,h}(\\gamma_1,\\dots,\\gamma_h)\\), \\(t\\), one recursion \\(h\\).Moreover, functions \\(a_{t}\\) \\(b_{t}\\) depend \\(t\\), different sequences \\((\\gamma^h_1,\\dots,\\gamma^h_h), h=1,\\dots,H\\) (say) satisfy \\(\\gamma^h_{h+1-} = u_i\\), \n\\(=1,\\dots,h\\), \\(h \\leq H\\), want compute (reverse-order case):\n\\[\\begin{equation}\n\\varphi_{t,h}(u_h,\\dots,u_1)=\\mathbb{E}_t[\\exp(u'_{{\\color{red}h}} w_{{\\color{red}t+1}}+\\dots+u'_{{\\color{red}1}} w_{{\\color{red}t+h}})],\n\\quad h=1,\\dots,H,\\tag{1.9}\n\\end{equation}\\]\nProposition 1.5 (appendix) shows can compute \\(\\varphi_{t,h}(u_h,\\dots,u_1)\\) \\(t\\) \\(h \\leq H\\) one recursion. \\(\\varphi_{t,h}(u_h,\\dots,u_1)=\\exp('_hw_t+B_h)\\) :\n\\[\\begin{equation*}\n\\left\\{\n\\begin{array}{ccl}\nA_{h} &=& (u_{h} + A_{h-1}), \\\\\nB_{h} &=& b(u_{h} + A_{h-1}) + B_{h-1}, \\\\\nA_{0} &=& 0,\\quad  B_{0} = 0.\n\\end{array}\n\\right.\n\\end{equation*}\\]mentioned , precedes useful implications price long-dated financial instruments nominal real bonds (Examples 1.18 1.20, respectively), futures (Example 1.21).Example 1.18  (Nominal interest rates) Let \\(B(t,h)\\) denote date-\\(t\\) price nominal zero-coupon bond maturity \\(h\\). :\n\\[\\begin{equation}\nB(t,h) = \\mathbb{E}^{\\mathbb{Q}}_t exp (-r_{t}-\\dots-r_{t+h-1}),\\tag{1.10}\n\\end{equation}\\]\n\\(r_{t}\\) nominal short rate \\(t\\) \\(t+1\\) (observed \\(t\\)), associated (continuously-compounded) yield--maturity given :\n\\[\\begin{equation}\nR(t,h) = -  \\frac{1}{h}   \\log   B(t,h), \\quad   h=1,\\dots,H.\n\\end{equation}\\]\n\\(r_t = \\omega'w_t\\) (say), :\n\\[\nB(t,h) = \\exp(-r_{t}) \\mathbb{E}^{\\mathbb{Q}}_t \\exp(-\\omega' w_{t+1} - \\dots - \\omega' w_{t+h-1}).\n\\]\nOne can price bond directly employing Eq. (1.9), \\(u_1 = 0\\) \\(u_i = - \\omega\\), \\(= 2,\\dots, H\\).\nprice \\(B(t,h)\\) exponential affine \\(w_t\\), associated yield--maturity \\(R(t,h)=-1/h\\log B(t,h)\\) affine \\(w_t\\).Example 1.19  (-arbitrage Nelson-Siegel model) example, employ results Example 1.18 context described Christensen, Diebold, Rudebusch (2009). Specifically, consider three factor model following Gaussian VAR (see Example 1.6):\n\\[\nw_t = \\left[\\begin{array}{c}X_{1,t}\\\\X_{2,t}\\\\X_{3,t}\\end{array}\\right] =\n\\left[\\begin{array}{ccc}\n1 & 0 & 0\\\\\n0&1-\\lambda&\\lambda\\\\\n0&0&1-\\lambda\\end{array}\\right]\n\\left[\\begin{array}{c}X_{1,t-1}\\\\X_{2,t-1}\\\\X_{2,t-1}\\end{array}\\right] +\n\\left[\\begin{array}{ccc}\n\\sigma_{11} & 0 & 0\\\\\n\\sigma_{21}&\\sigma_{22}&0\\\\\n\\sigma_{31}&\\sigma_{32}&\\sigma_{33}\\end{array}\\right]\n\\left[\\begin{array}{c}\\varepsilon_{1,t}\\\\\\varepsilon_{2,t}\\\\\\varepsilon_{3,t}\\end{array}\\right],\n\\]\n\\(\\left[\\begin{array}{c}\\varepsilon_{1,t}\\\\\\varepsilon_{2,t}\\\\\\varepsilon_{3,t}\\end{array}\\right] \\sim \\,..d.\\, \\mathcal{N}(0,Id)\\).nominal short-term rate given \\(r_t = X_{1,t}+X_{2,t}\\). case, can use results Example 1.18 \\(\\omega = (-1,-1,0)'\\). following lines code :\nFigure 1.4: Factor loadings context -arbitrage nelson-Siegel model (Christensen, Diebold Rudebusch, 2009). first factor (black solid line) level factor. second third factors (red dashed line blue dotted line, respectively) slope factors.\nprevious example, note use function reverse.MHLT (package TSModels), notably takes L.T. argument (psi). previous example, consider Gaussian VAR, therefore assign psi.GaussianVAR psi. need provide function reverse.MHLT arguments psi function. arguments provided form list (input psi.parameterization).Example 1.20  (Real interest rates) Denote \\(q_t\\) price index date \\(t\\) \\(\\pi_{t+1} = \\log \\dfrac{q_{t+1}}{q_t}\\) inflation rate date \\(t+1\\). :\n\\[\\begin{eqnarray*}\n\\bar{R}(t,h) & =& -   \\frac{1}{h}   \\log   \\bar{B}(t,h), \\quad h=1,\\dots,H \\\\    \\\\\n\\bar{B}(t,h) & =&  \\mathbb{E}^{\\mathbb{Q}}_t   \\exp(-r_{t}-\\dots-r_{t+h-1} + \\pi_{t+1}+\\dots+\\pi_{t+h}),  \\\\      \\\\\n& =& \\exp(-r_{t}) \\times \\\\\n&& \\mathbb{E}^{\\mathbb{Q}}_t \\exp(-r_{t+1}-\\dots-r_{t+h-1}+\\pi_{t+1}+\\dots+\\pi_{t+h})\n\\end{eqnarray*}\\]\n\\(r_t = \\omega'w_t\\) \\(\\pi_t = \\bar\\omega'w_t\\), \\(\\bar{B}(t,h)\\) given :\n\\[\\begin{eqnarray*}\n\\exp(-r_{t}) \\mathbb{E}^{\\mathbb{Q}}_t exp[(\\bar\\omega-\\omega)'w_{t+1}+\\dots+(\\bar\\omega-\\omega)'w_{t+h-1}+\\bar\\omega'\nw_{t+h}]\n\\end{eqnarray*}\\]\nOne can price bond directly employing Eq. (1.9), \\(u_1 = \\bar\\omega\\) \\(u_i = \\bar\\omega-\\omega\\), \\(= 2,\\dots, H\\).Example 1.21  (Futures) Denote \\(F(t,h)\\) date-\\(t\\) price future maturity \\(h\\) (see Section XXX). \\(F(t,h) = \\mathbb{E}^{\\mathbb{Q}}_t (S_{t+h})\\), \\(h=1,\\dots,H\\), \\(S_t\\) date-\\(t\\) price underlying asset.\\(w_t = (\\log S_t, x'_t)'\\) \\(F(t,h) = \\mathbb{E}^{\\mathbb{Q}}_t \\exp(e'_1 w_{t+h})\\). can calculated using Eq. (1.9) \\(u_1 = e_1\\), \\(u_i = 0\\), \\(=2,\\dots,H\\).\\(w_t = (\\log S_t, x'_t)'\\) \\(F(t,h) = \\mathbb{E}^{\\mathbb{Q}}_t \\exp(e'_1 w_{t+h})\\). can calculated using Eq. (1.9) \\(u_1 = e_1\\), \\(u_i = 0\\), \\(=2,\\dots,H\\).\\(w_t = (y_t, x'_t)'\\) \\(y_t = \\log\\frac{S_t}{S_{t-1}}\\), \\(F(t,h) = S_t \\mathbb{E}^{\\mathbb{Q}}_t \\exp(e'_1 w_{t+1}+\\dots+e'_1 w_{t+h})\\). can calculated using Eq. (1.9) \\(u_i = e'_1\\), \\(=1,\\dots,H\\).\\(w_t = (y_t, x'_t)'\\) \\(y_t = \\log\\frac{S_t}{S_{t-1}}\\), \\(F(t,h) = S_t \\mathbb{E}^{\\mathbb{Q}}_t \\exp(e'_1 w_{t+1}+\\dots+e'_1 w_{t+h})\\). can calculated using Eq. (1.9) \\(u_i = e'_1\\), \\(=1,\\dots,H\\).","code":"\nlibrary(TSModels)\nlambda <- .05\nPhi <- diag(c(1,1-lambda,1-lambda));Phi[2,3] <- lambda\nSigma <- .0005 * diag(3)\npsi.parameterization=list(mu=matrix(0,3,1),Phi=Phi,Sigma=Sigma)\nu1 <- matrix(0,3,1)\nu2 <- matrix(c(-1,-1,0),ncol=1)\nH <- 20\nAB <- reverse.MHLT(psi.GaussianVAR,u1 = u1,u2 = u2,H = H,\n                   psi.parameterization = psi.parameterization)\nAB$A[1:2,,] <- AB$A[1:2,,] - 1 # add terms corresponding to exp(-r_t)\na.yield <- - AB$A / array((1:H) %x% rep(1,3),c(3,1,H))\nb.yield <- - AB$B / array((1:H) %x% rep(1,3),c(1,1,H))\nplot(a.yield[1,,],type=\"l\",lwd=2,ylim=c(0,1),\n     xlab=\"Maturity\",ylab=\"Factor loadings\")\nlines(a.yield[2,,],col=\"red\",lwd=2,lty=2)\nlines(a.yield[3,,],col=\"blue\",lwd=2,lty=3)"},{"path":"ChapterAffine.html","id":"ExponentialPayoff","chapter":"1 Affine processes","heading":"1.9.2 Exponential payoff","text":"Consider asset providing payoff \\(\\exp(\\nu' w_{t+h})\\) date \\(t+h\\). price given :\n\\[\nP(t,h;\\nu) = \\mathbb{E}^{\\mathbb{Q}}_t[\\exp(-r_{t}-\\dots-r_{t+h-1}) \\exp(\\nu' w_{t+h})].\n\\]\n\\(r_t = \\omega'w_t\\), :\n\\[\nP(t,h;\\nu) = \\exp(-r_{t})\\mathbb{E}^{\\mathbb{Q}}_t \\left(exp[-\\omega' w_{t+1}-\\dots-\\omega' w_{t+h-1}+ \\nu' w_{t+h}]\\right),\n\\]\ncan calculated Eq. (1.9), \\(u_1 = \\nu\\) \\(u_i = -\\omega\\) \\(= 2,\\dots,H\\).precedes can extended case payoff (settled date \\(t+h\\)) form:\n\\[\n(\\nu_1'w_{t+h}) \\exp(\\nu_2' w_{t+h}).\n\\]\nIndeed, \n\\[\n\\left[\\frac{\\partial \\exp[(s \\nu_1+ \\nu_2)'w_{t+h}]}{\\partial s}\\right]_{s=0} = (\\nu_1'w_{t+h}) \\exp(\\nu_2' w_{t+h}).\n\\]\nTherefore:\n\\[\\begin{eqnarray}\n&&\\mathbb{E}_t^{\\mathbb{Q}}[\\exp(-r_t - \\dots - r_{t+h-1})(\\nu_1'w_{t+h}) \\exp(\\nu_2' w_{t+h})] \\nonumber\\\\\n&=& \\left[\n\\frac{\\partial P(t,h;s \\nu_1 + \\nu_2)}{\\partial s}\n\\right]_{s=0}.\\tag{1.11}\n\\end{eqnarray}\\]\nmethod easily extended price payoffs form \\((\\nu_1'w_{t+h})^k \\exp(\\nu_2' w_{t+h})\\), \\(k \\\\mathbb{N}\\).","code":""},{"path":"ChapterAffine.html","id":"var-representation-and-conditional-moments","chapter":"1 Affine processes","heading":"1.10 VAR representation and conditional moments","text":"important property affine processes dynamics can written vector-autoregressive process. useful compute conditional moments process.Proposition 1.1  (VAR representation affine process' dynamics) \\(w_t\\) affine process whose Laplace transform defined Def. 1.1, dynamics admits following vectorial autoregressive representation:\n\\[\\begin{equation}\nw_{t+1} = \\mu + \\Phi w_{t} + \\Sigma^{\\frac{1}{2}}(w_t) \\varepsilon_{t+1},\\tag{1.12}\n\\end{equation}\\]\n\\(\\varepsilon_{t+1}\\) difference martingale sequence whose conditional covariance matrix identity matrix \\(\\mu\\), \\(\\Phi\\) \\(\\Sigma(w_t) = \\Sigma^{\\frac{1}{2}}(w_t){\\Sigma^{\\frac{1}{2}}(w_t)}'\\) satisfy:\n\\[\\begin{equation}\n\\mu =  \\left[\\frac{\\partial }{\\partial u}b(u)\\right]_{u=0}, \\quad \\Phi= \\left[\\frac{\\partial }{\\partial u}(u)'\\right]_{u=0}\\tag{1.13}\n\\end{equation}\\]\n\\[\\begin{equation}\n\\Sigma(w_t) =  \\left[\\frac{\\partial }{\\partial u\\partial u'}b(u)\\right]_{u=0} + \\left[\\frac{\\partial }{\\partial u\\partial u'}(u)'w_t\\right]_{u=0}.\\tag{1.14}\n\\end{equation}\\]Proof. \\(w_t\\) affine, (conditional) cumulant generating function form \\(\\psi(u)=(u)'w_t+b(u)\\). result directly follows formulas given Section 1.3.Proposition 1.6 (appendix) shows conditional means variances \\(w_t\\) given :\n\\[\\begin{eqnarray}\n\\mathbb{E}_t(w_{t+h}) &=& (- \\Phi)^{-1}(- \\Phi^h)\\mu + \\Phi^h w_t \\tag{1.15}\\\\\n\\mathbb{V}ar_t(w_{t+h}) &=& \\Sigma(\\mathbb{E}_t(w_{t+h-1}))+\\Phi \\Sigma(\\mathbb{E}_t(w_{t+h-2}))\\Phi' + \\nonumber \\\\\n&& \\dots + \\Phi^{h-1} \\Sigma(w_{t}){\\Phi^{h-1}}'. \\tag{1.16}\n\\end{eqnarray}\\]\nEq. (1.16) notably implies \\(\\mathbb{V}ar_t(w_{t+h})\\) affine function \\(w_t\\). Indeed \\(\\Sigma(.)\\) affine function, conditional expectations \\(\\mathbb{E}_t(w_{t+h})\\) affine \\(w_t\\), shown Eq. (1.15).unconditional means variances given :\n\\[\\begin{equation}\n\\left\\{\n\\begin{array}{ccl}\n\\mathbb{E}(w_t) &=& (- \\Phi)^{-1}\\mu\\\\\nvec[\\mathbb{V}ar(w_t)] &=& (I_{n^2} - \\Phi \\otimes \\Phi)^{-1} vec\\left(\\Sigma[(- \\Phi)^{-1}\\mu]\\right).\n\\end{array}\n\\right.\\tag{1.17}\n\\end{equation}\\]","code":""},{"path":"ChapterAffine.html","id":"TransfAna","chapter":"1 Affine processes","heading":"1.11 Truncated Laplace transforms of affine processes","text":"section, show one can employ Fourier transforms compute truncated conditional moments affine processes. , let us introduce following notation:\n\\[\nw_{t+1,T} = (w'_{t+1}, w'_{t+2},\\dots, w'_T)'\n\\]\n\\(w_t\\) affine \\(n\\)-dimensional process.want compute:\n\\[\n\\tilde{\\varphi}_t(u ; v, \\gamma) = \\mathbb{E}_t[\\exp(u'w_{t+1,T})\\textbf{1}_{\\{v'w_{t+1,T}<\\gamma\\}}].\n\\]Consider complex untruncated conditional Laplace transform:\n\\[\n\\varphi_t(z) = \\mathbb{E}_t[\\exp(z'w_{t+1,T})],\\quad  z \\\\mathbb{C}^{nT},\n\\]\ncomputed using recursive algorithm real case (see Section 1.9).Darrell Duffie, Pan, Singleton (2000) shown (see also Proposition 1.8 appendix):\n\\[\\begin{equation}\n\\tilde{\\varphi}_t(u ; v, \\gamma) =  \\frac{\\varphi_t(u)}{2} - \\frac{1}{\\pi}\n\\int^\\infty_0 \\frac{Im[\\varphi_t(u+ivx) \\exp(-\\gamma x)]}{x} dx.\\tag{1.18}\n\\end{equation}\\]\n\\(Im\\) means imaginary part.Note integral Eq. (1.18) one dimensional (whatever dimension \\(w_t\\)). shown following example, can exploited price options.Example 1.22  (Option pricing) Pricing calls puts amounts conditional expectations type (\\(k > 0\\)):\n\\[\\begin{eqnarray*}\n&& \\mathbb{E}_t\\left([\\exp(u'_1 w_{t+1,T})-k   \\exp(u'_2 w_{t+1,T})]^+\\right) \\\\\n&= &  \\mathbb{E}_t\\left([\\exp(u'_1 w_{t+1,T})-k   \\exp(u'_2 w_{t+1,T})]\\textbf{1}_{\\{[\\exp(u_1-u_2)'w_{t+1,T}] > k \\}}\\right) \\\\\n&= & \\tilde{\\varphi}_t(u_1 ; u_2-u_1, - \\log   k) - k \\tilde{\\varphi}_t(u_2 ; u_2-u_1, - \\log   k).\n\\end{eqnarray*}\\]Example 1.23  (Exogenous short rate) Consider asset whose date-\\(t\\) price \\(p_t\\). Denote geometric asset return \\(y_t\\), .e., \\(y_t = \\log(p_t/p_{t-1})\\). Consider option written asset, strike equal \\(k p_t\\).interest rates deterministic, option price, maturity \\(h\\), given :\n\\[\np_t   \\exp(-r_{t}-\\dots-r_{t+h-1}) \\mathbb{E}^{\\mathbb{Q}}_t[\\exp   u'_1 w_{t+1, t+h} - k]^+\n\\]\n\\(u_1 = e \\otimes e_1\\), \\(e\\) \\(h\\)-dimensional vector components equal 1, \\(e_1\\) \\(n\\)-vector selecting 1st component (\\(y_t\\) 1st component \\(w_t\\), say).Example 1.24  (Endogenous short rate) Consider context Example 1.23, stochastic (endogenous) short-term rate. instance, assume \\(r_{t+1} = \\omega_0 + \\omega'_1 w_t\\). option price :\n\\[\\begin{eqnarray*}\n&& p_t \\mathbb{E}^{\\mathbb{Q}}_t  \\left[ \\exp(-\\omega_0 - \\omega'_1 w_t-\\dots- \\omega_0 - \\omega'_1 w_{t+h-1}) [\\exp(u'_1 w_{t+1,t+h})-k]^+ \\right]\\\\\n&= & p_t   \\exp(-h \\omega_0 - \\omega'_1 w_t)\\mathbb{E}^{\\mathbb{Q}}_t\\left(\\left[\\exp(\\tilde{u}'_1w_{t+1,t+h})-k   \\exp(u_2 w_{t+1, t+h})\\right]^+\\right),\n\\end{eqnarray*}\\]\n\\(\\tilde{u}'_1 = u_1 + u_2\\), [\\(u_1 = e \\otimes e_1\\) ], \\(u_2 = (-\\omega'_1,\\dots, -\\omega'_1, 0)'\\).Example 1.25  (Numerical example: Conditional cumulated distribution function (c.d.f.)) Let us use model used Example 1.19. Suppose want compute conditional distribution average interest rate next \\(H\\) periods, .e., \\(\\frac{1}{H}(r_{t+1}+\\dots+r_{t+H})\\). Hence, want compute \\(\\mathbb{E}_t[\\textbf{1}_{\\{v'w_{t+1,T}<\\gamma\\}}]\\) \\(v'w_{t+1,T}=\\frac{1}{H}(r_{t+1}+\\dots+r_{t+H})\\).\nFigure 1.5: Conditional cumulated distribution function (c.d.f.) \\(\\frac{1}{H}(r_{t+1}+\\dots+r_{t+H})\\).\n","code":"\nH  <- 10\nX  <- matrix(c(0.01,.02,0),3,1)\nx  <- exp(seq(-10,10,length.out=1000))\nu1 <- matrix(c(1/H,1/H,0),3,1) %*% matrix(1i*x,nrow=1);u2 <- u1\nAB <- reverse.MHLT(psi.GaussianVAR,u1 = u1,u2 = u2,H = H,\n                   psi.parameterization = psi.parameterization)\ns1 <- matrix(exp(t(X) %*% AB$A[,,H] + AB$B[,,H]),ncol=1)\ndx <- matrix(x-c(0,x[1:length(x)-1]),length(x),1)\ngamma <- seq(-.2,.3,length.out=1000)\nfx <- outer(x,gamma,function(r,c){Im(s1[,1]*exp(-1i*r*c))/r})*dx[,1]\nf  <- 1/2 - 1/pi * apply(fx,2,sum)\nplot(gamma,f,type=\"l\",xlab=\"\",lwd=2)"},{"path":"ChapterAffine.html","id":"appendices","chapter":"1 Affine processes","heading":"1.12 Appendices","text":"Lemma 1.3  \\(\\mu \\\\mathbb{R}^L\\) \\(Q\\) \\((L \\times L)\\) matrix symmetric positive definite, :\n\\[\n\\int_{\\mathbb{R}^{L}} \\exp(-u'Q u + \\mu'u)du =\n\\frac{\\pi^{L/2}}{(det   Q)^{1/2}} exp \\left(\n\\begin{array}{l}  \\frac{1}{4} \\mu'Q^{-1}\\mu \\end{array} \\right).\n\\]Proof. integral :\n\\[\\begin{eqnarray*}\n&& \\int_{\\mathbb{R}^{L}} exp \\left[ \\begin{array}{l} - (u -\n\\frac{1}{2}  Q^{-1} \\mu)'  Q (u -\n\\frac{1}{2} Q^{-1} \\mu)'\n\\end{array}\n\\right] exp\\left(\n\\begin{array}{l}  \\frac{1}{4} \\mu'Q^{-1}\\mu \\end{array}\n\\right)du \\\\\n&=&  \\frac{\\pi^{L/2}}{(det Q)^{1/2}} exp\\left(\n\\begin{array}{l}  \\frac{1}{4} \\mu'Q^{-1}\\mu \\end{array}\n\\right)\n\\end{eqnarray*}\\]\n[using formula unit mass \\(\\mathcal{N}( 0.5Q^{-1}\\mu,(2Q)^{-1})\\)].Lemma 1.4  \\(\\varepsilon_{t+1} \\sim \\mathcal{N}(0,Id)\\), \n\\[\n\\mathbb{E}_t \\left(\\exp[\\lambda'\\varepsilon_{t+1}+\\varepsilon'_{t+1} V \\varepsilon_{t+1}]\\right) =  \\frac{1}{[\\det(-2V)]^{1/2}} \\exp\\left[\n\\frac{1}{2} \\lambda'(-2V)^{-1}\\lambda\n\\right].\n\\]Proof. \n\\[\n\\mathbb{E}_t   \\exp(\\lambda'\\varepsilon_{t+1}+\\varepsilon'_{t+1}V\\varepsilon_{t+1})\n=  \\frac{1}{(2\\pi)^{n/2}}  \\int_{\\mathbb{R}^{n}} \\exp\\left[\n\\begin{array}{l}\n-u'\\left(\n\\begin{array}{l}\n\\frac{1}{2} -V\n\\end{array}\n\\right)u+\\lambda'u\n\\end{array}\n\\right]du\n\\]\nLemma 1.3, \\(u\\\\mathbb{R}^n\\), \n\\[\n\\int_{\\mathbb{R}^{n}} \\exp(-u' Q u+\\mu'u) du =\n\\frac{\\pi^{n/2}}{(\\det Q)^{1/2}} \\exp\\left(\n\\begin{array}{l}\n\\frac{1}{4} \\mu'Q^{-1}\\mu\n\\end{array}\n\\right).\n\\]\nTherefore:\n\\[\n\\begin{array}{l}\n\\mathbb{E}_t   \\exp(\\lambda'\\varepsilon_{t+1}+\\varepsilon'_{t+1}V\\varepsilon_{t+1}) \\\\\n=  \\frac{1}{2^{n/2}\n\\left[\n\\begin{array}{l}\n\\det \\left(\n\\begin{array}{l}\n\\frac{1}{2} -V\n\\end{array}\n\\right)\n\\end{array}\n\\right]^{1/2}\n}\n\\exp\\left[\n\\begin{array}{l}\n\\frac{1}{4}  \\lambda'\\left(\n\\begin{array}{l}\n\\frac{1}{2} -V\n\\end{array}\n\\right)^{-1}\\lambda\n\\end{array}\n\\right].\n\\end{array}\n\\]Proposition 1.2  (Quadratic Gaussian process) Consider vector \\(w_t = (x'_t,vec(x_t x_t')')'\\), \\(x_t\\) \\(n\\)-dimensional vector following Gaussian VAR(1), .e.\n\\[\nx_{t+1}|\\underline{w_t} \\sim \\mathcal{N}(\\mu+\\Phi x_t, \\Sigma).\n\\]\n\\(u = (v,V)\\) \\(v \\\\mathbb{R}^n\\) \\(V\\) square symmetric matrix size \\(n\\), :\n\\[\\begin{eqnarray*}\n\\varphi_t(u) &=& \\mathbb{E}_t\\big\\{\\exp\\big[(v',vec(V)')\\times w_{t+1}\\big]\\big\\} \\\\\n& =& \\exp \\left\\{a_1(v,V)'x_t +vec(a_2(v,V))' vec(x_t'x_t) + b(v,V) \\right\\},\n\\end{eqnarray*}\\]\n:\n\\[\\begin{eqnarray*}\na_2(u) & = & \\Phi'V (I_n - 2\\Sigma V)^{-1} \\Phi \\nonumber \\\\\na_1(u) & = & \\Phi'\\left[(I_n-2V\\Sigma)^{-1}(v+2V\\mu)\\right] \\nonumber \\\\\nb(u) & = & u'(I_n - 2 \\Sigma V)^{-1}\\left(\\mu + \\frac{1}{2} \\Sigma v\\right) +\\\\\n&& \\mu'V(I_n - 2 \\Sigma V)^{-1}\\mu - \\frac{1}{2}\\log\\big|I_n - 2\\Sigma V\\big|.\\tag{1.3}\n\\end{eqnarray*}\\]Proof. :\n\\[\\begin{eqnarray*}\n&&\\mathbb{E}_t(\\exp(v' x_{t+1} + vec(V)'vec(x_{t+1} x_{t+1}'))) \\\\\n&=& \\mathbb{E}_t[\\exp(v' (\\mu + \\Phi x_t + \\Sigma^{1/2}\\varepsilon_{t+1}) + \\\\\n&& vec(V)'vec((\\mu + \\Phi x_t + \\Sigma^{1/2}\\varepsilon_{t+1}) (\\mu + \\Phi x_t + \\Sigma^{1/2}\\varepsilon_{t+1})'))] \\\\\n&=& \\exp[v' (\\mu + \\Phi x_t) + vec(V)'vec\\{(\\mu + \\Phi x_t)(\\mu + \\Phi x_t)'\\}] \\times \\\\\n&& \\mathbb{E}_t[\\exp(v'\\Sigma^{1/2}\\varepsilon_{t+1} +2\\underbrace{ vec(V)' vec\\{(\\mu + \\Phi x_t)(\\varepsilon_{t+1}'{\\Sigma^{1/2}}')\\}}_{=(\\mu + \\Phi x_t)'V\\Sigma^{1/2}\\varepsilon_{t+1}} +\\\\\n&& \\underbrace{vec(V)'vec\\{(\\Sigma^{1/2}\\varepsilon_{t+1})(\\Sigma^{1/2}\\varepsilon_{t+1})'}_{=\\varepsilon_{t+1}'{\\Sigma^{1/2}}'V\\Sigma^{1/2}\\varepsilon_{t+1}}\\}]\n\\end{eqnarray*}\\]\nLemma 1.4 can used compute previous conditional expectation, \\(\\lambda = {\\Sigma^{1/2}}'(v + 2 V'(\\mu + \\Phi x_t))\\). algebra leads result.Proposition 1.3  () Consider following auto-regressive gamma process:\n\\[\n\\frac{w_{t+1}}{\\mu} \\sim \\gamma(\\nu+z_t) \\quad \\mbox{} \\quad z_t \\sim \\mathcal{P} \\left( \\frac{\\rho w_t}{\\mu} \\right),\n\\]\n\\(\\nu\\), \\(\\mu\\), \\(\\rho > 0\\). (Alternatively \\(z_t \\sim {\\mathcal{P}}(\\beta w_t)\\), \\(\\rho = \\beta \\mu\\).):\n\\(\\varphi_t(u) = exp \\left[ \\begin{array}{l} \\dfrac{\\rho u}{1-u \\mu} w_t - \\nu \\log(1-u \\mu)\\end{array} \\right], \\mbox{ } u < \\dfrac{1}{\\mu}\\).Proof. Given \\(\\underline{w_t}\\), \\(z_t \\sim {\\mathcal P}\\left( \\begin{array}{l} \\frac{\\rho w_t} {\\mu} \\end{array}\\right)\\). :\n\\[\\begin{eqnarray*}\n\\mathbb{E}[\\exp(u w_{t+1})|\\underline{w_t}] &=& \\mathbb{E}\\left\\{\\mathbb{E}\\left[\\exp \\left(u \\mu  \\frac{w_{t+1}}{\\mu}\\right)|\\underline{w_t}, \\underline{z}_t\\right]\\underline{w_t}\\right\\}\\\\\n&=& \\mathbb{E}[(1-u\\mu)^{-(\\nu+z_t)}|\\underline{w_t}] \\\\\n&=& (1-u\\mu)^{-\\nu}\\mathbb{E}\\{\\exp[-z_t   \\log(1-u\\mu)]|\\underline{w_t}\\} \\\\\n&=& (1-u\\mu)^{-\\nu} \\exp \\left\\{\\frac{\\rho w_t}{\\mu}[\\exp(-\\log(1-u\\mu)] -  \\frac{\\rho w_t}{\\mu}\\right\\}\\\\\n&=& \\exp\\left[ \\begin{array}{l}  \\frac{\\rho u w_t}{1-u\\mu} - \\nu   \\log(1-u\\mu)  \\end{array}\\right],\n\\end{eqnarray*}\\]\nusing fact L.T. \\(\\gamma(\\nu)\\) \\((1-u)^{-\\nu}\\)\nL.T. \\({\\mathcal P}(\\lambda)\\) \\(\\exp[\\lambda(\\exp(u)-1)]\\).Proposition 1.4  (Dynamics WAR process) \\(K\\) integer, \\(W_{t+1}\\) can obtained :\n\\[\\begin{eqnarray*}\n\\left\\{\n\\begin{array}{ccl}\nW_{t+1} & =&  \\sum^K_{k=1} x_{k,t+1} x'_{k,t+1}\\\\\n&&\\\\\nx_{k,t+1} & =& M x_{k,t} + \\varepsilon_{k,t+1},\\quad k \\\\{1,\\dots,K\\},\n\\end{array}\n\\right.\n\\end{eqnarray*}\\]\n\\(\\varepsilon_{k,t+1} \\sim ..d. \\mathcal{N}(0, \\Omega)\\) (independent across \\(k\\)’s).\nparticular, :\n\\[\n\\mathbb{E}(W_{t+1}|\\underline{W_t}) = MW_tM'+K \\Omega,\n\\]\n.e. \\(W_t\\) follows matrix weak AR(1) process.Proof. \\(K=1\\), \\(W_{t+1}=x_{t+1} x'_{t+1}\\), \\(x_{t+1} = M x_t + \\Omega^{1/2} u_{t+1}\\) \\(u_{t+1} \\sim ..d. \\mathcal{N}(0,Id_L)\\). :\n\\[\n\\mathbb{E}[\\exp(Tr \\Gamma W_{t+1})|\\underline{w_t}] = \\mathbb{E}\\{\\mathbb{E}[\\exp(Tr \\Gamma x_{t+1} x'_{t+1})|\\underline{x}_t]|\\underline{w_t}\\}\n\\]\n:\n\\[\\begin{eqnarray*}\n&& \\mathbb{E}[\\exp(Tr \\Gamma x_{t+1}x'_{t+1})|\\underline{x}_t] = \\mathbb{E}[\\exp(x'_{t+1}\\Gamma x_{t+1}|\\underline{x}_t] \\\\\n&=& \\mathbb{E}[\\exp(M x_t + \\Omega^{1/2} u_{t+1})'\\Gamma(M x_t + \\Omega^{1/2} u_{t+1})/x_t] \\\\\n&=& \\exp(x'_tM'\\Gamma M x_t)\\mathbb{E}[\\exp(2 x'_t M'\\Gamma \\Omega^{1/2}\nu_{t+1}+u'_{t+1}\\Omega^{1/2} \\Gamma \\Omega^{1/2} u_{t+1})/x_t] \\\\\n&=&  \\frac{exp(x'_tM'\\Gamma M x_t)}{(2\\pi)^{L/2}} \\times \\\\\n&& \\int_{\\mathbb{R}^L} \\exp\\left[2x'_tM'\\Gamma\n\\Omega^{1/2}u_{t+1}-u'_{t+1}\\left(\n\\frac{1}{2} Id_L-\\Omega^{1/2} \\Gamma \\Omega^{1/2}\\right)u_{t+1}\\right]  du_{t+1}.\n\\end{eqnarray*}\\]\nUsing Lemma 1.3 \\(\\mu' = 2 x'_t M'\\Gamma \\Omega^{1/2}, Q = \\frac{1}{2} Id_L-\\Omega^{1/2}\\Gamma\\Omega^{1/2}\\) \\\nalgebra, RHS becomes:\n\\[\n\\frac{exp[x'_tM'\\Gamma(Id_L-2\\Omega\\Gamma)^{-1}M\nx_t]}{det[Id_L-2\\Omega^{1/2}\\Gamma\\Omega^{1/2}]} =  \\frac{exp Tr[M'\\Gamma(Id_L-2\\Omega^{-1}]M\nW_t]}{det[Id_L-2\\Omega \\Gamma]^{1/2}},\n\\]\ndepends \\(x_t\\) \\(W_t\\), gives result \n\\(K=1\\); result \\(K\\) integer follows.Lemma 1.5  :\n\\[\n\\varphi_{t,h}(\\gamma_1,\\dots,\\gamma_h) = \\exp('_{t,h} w_t + B_{t,h}),\n\\]\n\\(A_{t,h} = ^h_{t,h}\\) \\(B_{t,h} = B^h_{t,h}\\), \\(^h_{t,}, B^h_{t,}\\) \\(= 1,\\dots,h\\), given recursively :\n\\[\n() \\left\\{\n\\begin{array}{ccl}\n^h_{t,} &=& a_{t+h+1-}(\\gamma_{h+1-} + ^h_{t,-1}), \\\\\nB^h_{t,} &=& b_{t+h+1-}(\\gamma_{h+1-} + ^h_{t,-1}) + B^h_{t,-1}, \\\\\n^h_{t,0} &=& 0, B^h_{t,0} = 0.\n\\end{array}\n\\right.\n\\]Proof. \\(j=1,\\dots,h\\) :\n\\[\n\\varphi_{t,h}(\\gamma_1,\\dots,\\gamma_h) = \\mathbb{E}_t[\\exp(\\gamma'_1 w_{t+1}+\\dots\\gamma'_j w_{t+j}+^{h'}_{t,h-j}w_{t+j}+B^h_{t,h-j})]\n\\]\n:\n\\[\n(ii) \\left\\{\n\\begin{array}{l}\n^h_{t,h-j+1} = a_{t+j}(\\gamma_{j} + ^h_{t,h-j}), \\\\\nB^h_{t,h-j+1} = b_{t+j}(\\gamma_{j} + ^h_{t,h-j}) + B^h_{t,h-j}, \\\\\n^h_{t,0} = 0, B^h_{t,0} = 0.\n\\end{array}\n\\right.\n\\]\nSince true \\(j=h\\), true \\(j\\), get:\n\\[\n\\begin{array}{ll}\n\\varphi_{t,h}(\\gamma_1,\\dots,\\gamma_h) & = \\mathbb{E}_t [\\exp(\\gamma'_1 w_{t+1}+\\dots+\\gamma'_{j-1}w_{t+j-1}+'_{t+j}(\\gamma_j+^h_{t,h-j})w_{t+j-1} \\\\\n& + b_{t+j}(\\gamma_j+^h_{t,h-j})+B^h_{t,h-j}],\n\\end{array}\n\\]\n, therefore, true \\(j-1\\), \\(^h_{t,h-j+1}\\) \\(B^h_{t,h-j+1}\\) given formulas (ii) .\\(j=1\\) get:\n\\[\\begin{eqnarray*}\n\\varphi_{t,h}(\\gamma_1,\\dots,\\gamma_h) &=& \\mathbb{E}_t \\exp(\\gamma'_1 w_{t+1}+^{h'}_{t,h-1}w_{t+1}+B^h_{t,h-1}) \\\\\n&=& \\exp('_{t,h} w_t+B_{t,h}),\n\\end{eqnarray*}\\]Finally note put \\(h-j+1 = \\), formulas (ii) become ().Proposition 1.5  (Reverse-order multi-horizon Laplace transform) functions \\(a_{t}\\) \\(b_{t}\\) depend \\(t\\), different sequences \\((\\gamma^h_1,\\dots,\\gamma^h_h), h=1,\\dots,H\\) (say) satisfy \\(\\gamma^h_{h+1-} = u_i\\), \n\\(=1,\\dots,h\\), \\(h \\leq H\\), want compute (“reverse order” case):\n\\[\n\\varphi_{t,h}(u_h,\\dots,u_1)=\\mathbb{E}_t[\\exp(u'_{{\\color{red}h}} w_{{\\color{red}t+1}}+\\dots+u'_{{\\color{red}1}} w_{{\\color{red}t+h}})],\n\\quad h=1,\\dots,H,\n\\]\ncan compute \\(\\varphi_{t,h}(u_h,\\dots,u_1)\\) \\(t\\) \\(h \\leq H\\), one recursion, .e. \\(\\varphi_{t,h}(u_h,\\dots,u_1)=\\exp('_hw_t+B_h)\\) :\n\\[\\begin{equation}\n\\left\\{\n\\begin{array}{ccl}\nA_{h} &=& (u_{h} + A_{h-1}), \\\\\nB_{h} &=& b(u_{h} + A_{h-1}) + B_{h-1}, \\\\\nA_{0} &=& 0,\\quad  B_{0} = 0.\n\\end{array}\n\\right.\\tag{1.19}\n\\end{equation}\\]Proof. According Lemma 1.5, , case:\n\\[\n\\left\\{\n\\begin{array}{ccl}\n^h_{} &=& (u_{} + ^h_{-1}), \\\\\nB^h_{} &=& b(u_{} + ^h_{-1}) + B^h_{-1}, \\\\\n^h_{0} &=& 0, \\quad B^h_{0} = 0.\n\\end{array}\n\\right.\n\\]\nprevious sequences dependent \\(h\\) given Eq. (1.19).Proposition 1.6  (Conditional means variances affine process) Consider affine process \\(w_t\\). Using notation Proposition 1.1, :\n\\[\\begin{eqnarray}\n\\mathbb{E}_t(w_{t+h}) &=& (- \\Phi)^{-1}(- \\Phi^h)\\mu + \\Phi^h w_t \\tag{1.20}\\\\\n\\mathbb{V}ar_t(w_{t+h}) &=& \\Sigma(\\mathbb{E}_t(w_{t+h-1}))+\\Phi \\Sigma(\\mathbb{E}_t(w_{t+h-2}))\\Phi' + \\nonumber \\\\\n&& \\dots + \\Phi^{h-1} \\Sigma(w_{t}){\\Phi^{h-1}}'. \\tag{1.21}\n\\end{eqnarray}\\]\nEq. (1.21) notably shows \\(\\mathbb{V}ar_t(w_{t+h})\\) affine function \\(w_t\\). Indeed \\(\\Sigma(.)\\) affine function, conditional expectations \\(\\mathbb{E}_t(w_{t+h})\\) affine \\(w_t\\), shown Eq. (1.20).unconditional mean variance \\(w_t\\) given :\n\\[\\begin{equation}\n\\left\\{\n\\begin{array}{ccl}\n\\mathbb{E}(w_t) &=& (- \\Phi)^{-1}\\mu\\\\\nvec[\\mathbb{V}ar(w_t)] &=& (I_{n^2} - \\Phi \\otimes \\Phi)^{-1} vec\\left(\\Sigma[(- \\Phi)^{-1}\\mu]\\right).\n\\end{array}\n\\right.\\tag{1.22}\n\\end{equation}\\]Proof. Eq. (1.20) easily deduced Eq. (1.12), using \\(\\mathbb{E}_t(\\varepsilon_{t+k})=0\\) \\(k>0\\).regards Eq. (1.21):\n\\[\\begin{eqnarray*}\n\\mathbb{V}ar_t(w_{t+h}) &=& \\mathbb{V}ar_t\\left(\\Sigma(w_{t+h-1})^{\\frac{1}{2}}\\varepsilon_{t+h}+\\dots + \\Phi^{h-1} \\Sigma(w_{t})^{\\frac{1}{2}}\\varepsilon_{t+1} \\right).\n\\end{eqnarray*}\\]\nconditional expectation \\(t\\) terms sum equal zero since, \\(\\ge 1\\):\n\\[\n\\mathbb{E}_t\\left[\\Sigma(w_{t+-1})^{\\frac{1}{2}}\\varepsilon_{t+}\\right] = \\mathbb{E}_t[\\underbrace{\\mathbb{E}_{t+-1}\\{\\Sigma(w_{t+-1})^{\\frac{1}{2}}\\varepsilon_{t+}\\}}_{=\\Sigma(w_{t+-1})^{\\frac{1}{2}}\\mathbb{E}_{t+-1}\\{\\varepsilon_{t+}\\}=0}\\}],\n\\]\n\\(\\forall <j\\),\n\\[\n\\mathbb{C}ov_t\\left[\\Sigma(w_{t+-1})^{\\frac{1}{2}}\\varepsilon_{t+},\\Sigma(w_{t+j-1})^{\\frac{1}{2}}\\varepsilon_{t+j}\\right] = \\mathbb{E}_t\\left[\\Sigma(w_{t+-1})^{\\frac{1}{2}}\\varepsilon_{t+}\\varepsilon_{t+j}'\\Sigma'(w_{t+j-1})^{\\frac{1}{2}}\\right],\n\\]\ncan seen equal zero conditioning information available date \\(t+j-1\\).Using conditioning, obtain :\n\\[\\begin{eqnarray*}\n\\mathbb{V}ar_t\\left[\\Phi^{h-j}\\Sigma(w_{t+j-1})^{\\frac{1}{2}}\\varepsilon_{t+j}\\right] &=& \\mathbb{E}_t\\left[\\Phi^{h-j}\\Sigma(w_{t+j-1})^{\\frac{1}{2}}\\varepsilon_{t+j}\\varepsilon_{t+j}'\\Sigma'(w_{t+j-1})^{\\frac{1}{2}}{\\Phi^{h-j}}'\\right] \\\\\n&=&  \\mathbb{E}_t\\left[\\Phi^{h-j}\\Sigma(w_{t+j-1})^{\\frac{1}{2}} \\mathbb{E}_{t+j-1}(\\varepsilon_{t+j}\\varepsilon_{t+j}')\\Sigma'(w_{t+j-1})^{\\frac{1}{2}}{\\Phi^{h-j}}'\\right] \\\\\n&=&  \\Phi^{h-j}\\mathbb{E}_t[\\Sigma(w_{t+j-1})]{\\Phi^{h-j}}' \\\\\n&=&  \\Phi^{h-j}\\Sigma(\\mathbb{E}_t[w_{t+j-1}]){\\Phi^{h-j}}',\n\\end{eqnarray*}\\]\nlast equality results fact fact \\(\\Sigma(.)\\) affine (see Eq. (1.14)).Proposition 1.7  (Affine property GARCH-type process) process \\(w_t = (w_{1,t}, w_{2,t})\\) defined :\n\\[\n\\left\\{\n\\begin{array}{ccl}\nw_{1, t+1} &=& \\mu + \\varphi w_{1,t} + \\sigma_{t+1} \\varepsilon_{t+1}    \\mid \\varphi \\mid < 1 \\\\\n\\sigma^2_{t+1} &=& \\omega + \\alpha \\varepsilon^2_t + \\beta \\sigma^2_t      0 < \\beta < 1, \\alpha > 0, \\omega > 0    \\\\\nw_{2,t} &=& \\sigma^2_{t+1}, \\quad \\varepsilon_t \\sim   ..d.   \\mathcal{N}(0,1)\n\\end{array}\n\\right.\n\\]\naffine.Proof. Note \\(w_{2,t}\\) function \\(\\underline{w_{1,t}}\\)\n\\[\\begin{eqnarray*}\n&& \\mathbb{E}[\\exp(u_1 w_{1, t+1} + u_2 w_{2, t+1})|\\underline{w_{1,t}}] \\\\\n&= & \\exp(u_1 \\mu + u_1 \\varphi w_{1,t} + u_2 \\omega + u_2 \\beta w_{2,t})  \\mathbb{E}[\\exp(u_1 \\sigma_{t+1} \\varepsilon_{t+1} + u_2 \\alpha \\varepsilon^2_{t+1})|\\underline{w_{1,t}}]\n\\end{eqnarray*}\\]\n, using Lemma 1.4:\n\\[\\begin{eqnarray*}\n&&\\mathbb{E}[\\exp(u_1 w_{1, t+1} + u_2 w_{2, t+1})|\\underline{w_{1,t}}] \\\\\n&= & \\exp(u_1 \\mu + u_1 \\varphi w_{1,t} + u_2 \\omega + u_2 \\beta w_{2t})  \\exp \\left[ -   \\frac{1}{2}   \\log(1-2 u_2 \\alpha) +\n\\frac{u^2_1 w_{2,t}}{2(1-2 u_2 \\alpha)} \\right]\\\\\n&= & \\exp \\left[ u_1 \\mu + u_2 \\omega -  \\frac{1}{2}   \\log(1-2u_2\\alpha)+  u_1 \\varphi w_{1,t} + \\left(u_2 \\beta +  \\frac{u^2_1}{2(1-2u_2\\alpha)}\\right)\nw_{2,t}\\right],\n\\end{eqnarray*}\\]\nexponential affine \\((w_{1,t}, w_{2,t})\\).Proposition 1.8  (Computation truncated conditional moments) \\(\\varphi(z)=\\mathbb{E}[exp(z'w)]\\), :\n\\[\\begin{equation}\n\\mathbb{E}[\\exp(u'w)\\textbf{1}_{(v'w<\\gamma})] = \\frac{\\varphi(u)}{2} -  \\frac{1}{\\pi} \\int^\\infty_o\n\\frac{{\\mathcal }m[\\varphi(u+ivx)\\exp(-\\gamma x)]}{x}dx.\\tag{1.23}\n\\end{equation}\\]Proof. want compute \\(\\tilde{\\varphi}_t(u;v,\\gamma) = \\mathbb{E}_t[\\exp(u'w)\\textbf{1}_{(v'w<\\gamma})]\\). Let us first note , given \\(u\\) \\(v\\), \\(\\tilde{\\varphi}_t(u;v,\\gamma)\\) positive increasing bounded function \\(\\gamma\\) therefore can seen c.d.f. positive finite measure \\(\\mathbb{R}\\), Fourier transform :\n\\[\n\\int_{\\mathbb{R}} \\exp(\\gamma x)d\\tilde{\\varphi}(u;v,\\gamma) = \\mathbb{E} \\int_{\\mathbb{R}} \\exp(\\gamma x)d\\tilde{\\varphi}_w(u;v,\\gamma),\n\\]\n, given \\(w, \\tilde{\\varphi}_w(u;v,\\gamma)\\) c.d.f. mass point \\(\\exp(u'w)\\) \\(v'w\\). get:\n\\[\\begin{eqnarray*}\n\\int_{\\mathbb{R}} \\exp(\\gamma x) d\\tilde{\\varphi}(u;v,\\gamma) &=& \\mathbb{E}[\\exp(ixv'w)exp(u'w)] \\\\\n& =& \\mathbb{E}[\\exp(u+ivx)'w] \\\\\n& =& \\varphi(u+ivx).\n\\end{eqnarray*}\\]\nLet us now compute \\((x_0,\\lambda)\\) real number \\(\\lambda\\), :\n\\[\\begin{eqnarray*}\n&&(x_0,\\lambda) \\\\\n&=&  \\frac{1}{2\\pi} \\int^{x_0}_{-x_0}\n\\frac{\\exp(\\lambda x)\\varphi(u-ivx)-\\exp(-\\lambda)\\varphi(u+ivx)}{ix}dx \\\\\n&=&  \\frac{1}{2\\pi} \\int^{x_0}_{-x_0}\\left[ \\begin{array}{l}  \\int_{\\mathbb{R}}\n\\frac{\\exp[-ix(\\gamma-\\lambda)]-\\exp[ix(\\gamma-\\lambda)]}{ix}d\\tilde{\\varphi}(u;v,\\gamma)\n\\end{array} \\right]dx \\\\\n&=&  \\frac{1}{2\\pi}  \\int_{\\mathbb{R}}\n\\left[ \\begin{array}{l}   \\int^{x_0}_{-x_0}   \\frac{\\exp[-ix(\\gamma-\\lambda)]\n-\\exp[ix(\\gamma-\\lambda)]}{ix}dx \\end{array} \\right]d\\tilde{\\varphi}(u;v,\\gamma).\n\\end{eqnarray*}\\]\nNow :\n\\[\\begin{eqnarray*}\n\\frac{1}{2\\pi} \\int^{x_o}_{-x_o}\n\\frac{\\exp[-ix(\\gamma-\\lambda)]\n-\\exp[ix(\\gamma-\\lambda)]}{ix}dx \\\\ =  \\frac{-sign(\\gamma-\\lambda)}{\\pi}\n\\int^{x_o}_{-x_o} \\frac{sin(x\\mid\\gamma-\\lambda\\mid)}{x}dx\n\\end{eqnarray*}\\]\ntends \\(-sign(\\gamma-\\lambda)\\) \\(x_0\\rightarrow\\infty\\) (\\(sign(\\omega)=1\\) \\(\\omega>0\\), \\(sign(\\omega)=0\\) \\(\\omega=0\\), \\(sign(\\omega)=-1\\) \\(\\omega<0\\)).\nTherefore:\n\\[\n(\\infty,\\lambda) = -  \\int_{\\mathbb{R}} sign(\\gamma-\\lambda)d\\tilde{\\varphi}(u;v,\\gamma) = -\\mathbb{E}  \\int_{\\mathbb{R}} sign(\\gamma-\\lambda)d\\tilde{\\varphi}_w(u;\\theta,\\gamma),\n\\]\n\\(\\tilde{\\varphi}_w(u;v,\\gamma)\\) c.d.f. mass point \\(\\exp(u'w)\\) \\(v'w\\) \n\\[\n\\int_{\\mathbb{R}} \\mbox{sign}(\\gamma-\\lambda)d\\tilde{\\varphi}_w(u;v,\\gamma)=\n\\left\\{\n\\begin{array}{ccc}\n\\exp(u'w) & \\mbox{} & \\lambda < v'w \\\\\n0 & \\mbox{}& \\lambda = v'w \\\\\n-\\exp(u'w) & \\mbox{} & \\lambda > v'w.\n\\end{array}\n\\right.\n\\]\nTherefore, :\n\\[\\begin{eqnarray*}\n(\\infty,\\lambda) & =& - \\mathbb{E}[\\exp(u'w)(1-\\textbf{1}_{(v'w<\\lambda)})-\\exp(u'w)\\textbf{1}_{(v'w<\\lambda)}] \\\\\n& =& - \\varphi(u) + 2\\tilde{\\varphi}(u;v,\\lambda)\n\\end{eqnarray*}\\]\n, ,:\n\\[\n\\tilde{\\varphi}(u;,v,\\gamma) =  \\frac{\\varphi(u)}{2} +  \\frac{1}{2} (\\infty,\\gamma),\n\\]\n\n\\[\\begin{eqnarray*}\n\\frac{1}{2} (\\infty,\\gamma) & =&  \\frac{1}{4\\pi} \\int^{\\infty}_{-\\infty}  \\frac{\\exp(\\gamma x)\\varphi(u-ivx)-\\exp(-\\gamma x)\\varphi(u+ivx)}{ix} dx \\\\\n& =&  \\frac{1}{2\\pi} \\int^{\\infty}_{o}  \\frac{\\exp(\\gamma x)\\varphi(u-ivx)-\\exp(-\\gamma x)\\varphi(u+ivx)}{ix} dx \\\\\n& =& -  \\frac{1}{\\pi} \\int^{\\infty}_{o}  \\frac{{\\mathcal }m[\\exp(-\\gamma x)\\varphi(u+ivx)]}{x}dx,\n\\end{eqnarray*}\\]\nleads Eq. (1.23).","code":""},{"path":"pricing-and-risk-neutral-dynamics.html","id":"pricing-and-risk-neutral-dynamics","chapter":"2 Pricing and risk-neutral dynamics","heading":"2 Pricing and risk-neutral dynamics","text":"brief: bla bla bla bla.","code":""},{"path":"pricing-and-risk-neutral-dynamics.html","id":"PricingEquilibrium","chapter":"2 Pricing and risk-neutral dynamics","heading":"2.1 Consumption-based Capital Asset Pricing Model (CCAPM) and stochastic discount factor (SDF)","text":"Consider economy featuring single good, whose date-\\(t\\) price \\(q_t\\). representative agent external income \\(R_t\\) \\(t\\), portfolio assets, allocation vector \\(\\alpha_{t-1}\\) (decided \\(t-1\\)). vector date-\\(t\\) prices \\(p_t\\). date \\(t+j\\), \\(j=0,1,...\\), agent face budget constraint:\n\\[\nq_{t+j}C_{t+j}+\\alpha'_{t+j}p_{t+j} = R_{t+j} +\n\\alpha'_{t+j-1}p_{t+j},\n\\]\n\\(C_{t+j}\\)consumption date \\(t+j\\). representative agent maximizes expected utility time-separable preferences \\(\\mathbb{E}_t \\sum^\\infty_{j=0} \\delta^j U(C_{t+j})\\) subject budget constraints \\(t+j\\), \\(j= 0,1,\\dots\\), \\(U\\) utility function \\(\\delta\\)time discount factor subjective discount factor. Note latter different SDF.Replacing \\(C_{t+j}\\) \\([R_{t+j}-(\\alpha'_{t+j}-\\alpha'_{t+j-1})p_{t+j}]/q_{t+j}\\), objective function becomes:\n\\[\n\\mathbb{E}_t  \\sum^\\infty_{j=0} \\delta^j U\n[R_{t+j}/q_{t+j}-(\\alpha'_{t+j}-\\alpha'_{t+j-1})p_{t+j}/q_{t+j}].\n\\]\nvector allocation \\(\\alpha_t\\) appears first two terms:\n\\[\nU[R_t/q_t-(\\alpha'_t-\\alpha'_{t-1})p_t/q_t] + \\delta \\mathbb{E}_t\nU[R_{t+1}/q_{t+1}-(\\alpha'_{t+1}-\\alpha'_t)p_{t+1}/q_{t+1}].\n\\]\nresult, first order condition associated vector \\(\\alpha_t\\) reads\n\\[\n\\frac{p_t}{q_t}  \\frac{d U(C_t)}{dC} = \\delta \\mathbb{E}_t \\left[\n\\begin{array}{l}\n\\frac{p_{t+1}}{q_{t+1}}  \\frac{dU(C_{t+1})}{dC}\n\\end{array}\n\\right],\n\\]\n\n\\[\\begin{equation}\np_t = \\mathbb{E}_t(p_{t+1} \\mathcal{M}_{t,t+1}),\\tag{2.1}\n\\end{equation}\\]\n\\(\\mathcal{M}_{t,t+1}\\) strictly positive scalar called stochastic discount factor (SDF) dates \\(t\\) \\(t+1\\). :\n\\[\n\\mathcal{M}_{t,t+1} \\equiv \\delta  \\frac{q_t}{q_{t+1}}\n\\frac{  \\frac{dU(C_{t+1})}{dC}} {\n\\frac{dU(C_t)}{dC}}.\n\\]Example 2.1  (Power utility function) standard case one power utility \\(U(C) = \\frac{C^{1-\\gamma}-1}{1-\\gamma}\\), \\(\\gamma>0\\) coefficient relative risk aversion.\\(U'(C) = C^{-\\gamma} > 0\\) \\(U''(C) = - \\gamma C^{-\\gamma-1} < 0\\). result, stochastic discount factor \n\\[\\begin{eqnarray}\n&& \\mathcal{M}_{t,t+1} \\nonumber \\\\\n&=&  \\frac{q_t}{q_{t+1}} \\delta \\left(\n\\frac{C_{t+1}}{C_t} \\right)^{-\\gamma} \\nonumber\\\\\n&=& \\exp(\\log\n\\delta + \\log q_t + \\gamma \\log  C_t - \\log  q_{t+1} - \\gamma\n\\log  C_{t+1}).\\tag{2.2}\n\\end{eqnarray}\\]\nvector prices \\(p_t\\) satisfies:\n\\[\np_t = \\delta q_t C^\\gamma_t \\mathbb{E}_t \\left(\n\\begin{array}{l}\n\\frac{C^{-\\gamma}_{t+1}}{q_{t+1}} p_{t+1}\n\\end{array}\n\\right),\n\\]\n(Euler equation):\n\\[\n\\mathbb{E}_t\\left[\n\\begin{array}{l}\n\\delta\\left(\n\\begin{array}{l}\n\\frac{C_{t+1}}{C_t}\n\\end{array}\n\\right)^{-\\gamma}  \\frac{q_t}{q_{t+1}}\n\\frac{p_{t+1}}{p_t} - 1\n\\end{array}\n\\right] = 0.\n\\]According Eq. (2.1), asset \\(j\\):\n\\[\\begin{equation}\np_{j,t} = \\mathbb{E}_t(\\mathcal{M}_{t,t+1} p_{j,t+1}).\\tag{2.3}\n\\end{equation}\\]\nUsing \\(p_{j,t+1} = \\mathbb{E}_t(\\mathcal{M}_{t+1,t+2} p_{j,t+2})\\), get:\n\\[\\begin{eqnarray*}\np_{j,t} &=& \\mathbb{E}_t[\\mathbb{E}_{t+1}(p_{j,t+2}\\mathcal{M}_{t+1,t+2})\\mathcal{M}_{t,t+1}] \\\\\n&=& \\mathbb{E}_t(\\mathcal{M}_{t,t+1} \\mathcal{M}_{t+1,t+2}p_{j,t+2}).\n\\end{eqnarray*}\\]\ncan generalized follows:\n\\[\np_{j,t} = \\mathbb{E}_t[\\mathcal{M}_{t,t+1} \\dots \\mathcal{M}_{t+h-1,t+h}p_{j,t+h}], \\; \\forall h.\n\\]","code":""},{"path":"pricing-and-risk-neutral-dynamics.html","id":"recursive-utilities","chapter":"2 Pricing and risk-neutral dynamics","heading":"2.2 Recursive utilities","text":"XXXX","code":""},{"path":"pricing-and-risk-neutral-dynamics.html","id":"PricingAAO","chapter":"2 Pricing and risk-neutral dynamics","heading":"2.3 SDF: Absence of Arbitrage Approach","text":"Consider period interest \\({\\mathcal T} = \\{0,1,2,...,T^*\\}\\). Chapter 1, vector \\(w_t\\) constitutes new information economy \\(t\\). historical, physical, dynamics \\(w_t\\), \\(f(\\underline{w_t})\\), defined \\(f(w_{t+1}|\\underline{w_t})\\). physical probability denoted \\(\\mathbb{P}\\). \\(L_{2t}, t \\{\\mathcal T}\\), (Hilbert) space square integrate functions \\(g(\\underline{w_t})\\), \\(L_{2t} \\subset L_{2s}, t< s\\).","code":""},{"path":"pricing-and-risk-neutral-dynamics.html","id":"existence-and-unicity-of-the-sdf","chapter":"2 Pricing and risk-neutral dynamics","heading":"2.3.1 Existence and unicity of the SDF","text":"Hypothesis 2.1  (Price existence uniqueness) \\(\\underline{w_t}\\), exists unique \\(p_t[g(\\underline{w_s})]\\),\nfunction \\(\\underline{w_t}\\), price \\(t\\) payoff\n\\(g(\\underline{w_s})\\) delivered \\(s, \\forall t \\le s\\).Hypothesis 2.2  (Linearity continuity) \\(t < s\\), \\(\\underline{w_t}\\), \\(g_1\\), \\(g_2\\), \\(p_t[\\lambda_1 g_1(\\underline{w_s}) + \\lambda_2g_2(\\underline{w_s})] = \\lambda_1p_t[g_1(\\underline{w_s})]+\\lambda_2 p_t[g_2(\\underline{w_s})]\\),\\(g_n(\\underline{w_s}) \\overset{L_{2s}}{\\underset{n\\rightarrow\\infty}{\\longrightarrow}} 0\\), \\(p_t[g_n(\\underline{w_s})] \\underset{n\\rightarrow\\infty}{\\longrightarrow} 0\\).Hypothesis 2.3  (Absence Arbitrage Opportunity (AAO)) \\(t\\), impossible constitute portfolio future payoffs, possibly modified subsequent dates, :price portfolio \\(t\\) zero,payoffs subsequent dates \\(\\ge 0\\),least one subsequent date \\(s\\) net payoff \\(s\\) strictly positive non zero conditional probability \\(t\\).Theorem 2.1  (Riesz representation theorem) Assumptions 2.1 2.2, \\(\\underline{w_t}\\), \\(s > t\\), exists \\(\\mathcal{M}_{t,s}(\\underline{w_s}) \\L_{2s}\\), unique , \\(\\forall g(\\underline{w_s}) \\L_{2s}\\),\n\\[\np_t[g(\\underline{w_s})] = \\mathbb{E}[\\mathcal{M}_{t,s}(\\underline{w_s})g(\\underline{w_s})|\\underline{w_t}].\n\\]\nparticular price \\(t\\) zero coupon bond maturing \\(s\\) \\(\\mathbb{E}(\\mathcal{M}_{t,s}|\\underline{w_t})\\).Proposition 2.1  (Positivity M) Assumption 2.3 satisfied, \\(t\\) \\(s\\), \\(\\mathbb{P}(\\mathcal{M}_{t,s}>0|\\underline{w_t})=1\\).Proof. \\(\\Leftarrow\\) obvious. \\(\\Rightarrow\\) true, payoff\n\\(\\textbf{1}_{\\{\\mathcal{M}_{t,s} \\le 0\\}}\\), \\(s\\), :\n\\(\\mathbb{P}[\\textbf{1}_{\\{\\mathcal{M}_{t,s} \\le 0\\}}=1|\\underline{w_t}] > 0\\) \\(p_t[\\textbf{1}_{\\{\\mathcal{M}_{t,s} \\le 0\\}}] = \\mathbb{E}_t[\\mathcal{M}_{t,s}\\textbf{1}_{\\{\\mathcal{M}_{t,s} \\le 0\\}}] \\le 0\\).Proposition 2.2  (Time consistency) \\(t < r < s\\), \\(\\mathcal{M}_{t,s} = \\mathcal{M}_{t,r} \\mathcal{M}_{r,s}\\), implies:\\(\\mathcal{M}_{t,s} = \\mathcal{M}_{t,t+1} \\mathcal{M}_{t+1,t+2}\\dots\\mathcal{M}_{s-1,s}\\)\\(\\mathcal{M}_{0,t} = \\Pi^{t-1}_{j=0} \\mathcal{M}_{j,j+1}\\) (\\(\\mathcal{M}_{0,t}\\) called pricing kernel).Proof. Using Lemma 2.1 :\n\\[\\begin{eqnarray*}\np_t(g_s) &=& \\mathbb{E}(\\mathcal{M}_{t,s}g_s|\\underline{w_t}) = \\mathbb{E}(\\mathcal{M}_{t,r} p_r(g_s)|\\underline{w_t}) \\\\\n&=& \\mathbb{E}[\\mathcal{M}_{t,r}\\mathbb{E}(\\mathcal{M}_{r,s} g_s|\\underline{w_r})|\\underline{w_t}] = \\mathbb{E}(\\mathcal{M}_{t,r} \\mathcal{M}_{r,s} g_s|\\underline{w_t}), \\forall g, \\forall \\underline{w}_{t}\n\\end{eqnarray*}\\]\n, therefore, \\(\\mathcal{M}_{t,s} = \\mathcal{M}_{t,r}\\mathcal{M}_{r,s}\\).Lemma 2.1  payoff \\(g_s\\) \\(s, p_t(g_s) = p_t[p_r(g_s)]\\).Proof. true, construct sequence portfolios strictly positive payoff \\(s\\) zero payoff future date price zero \\(t\\), contradicting Assumption 2.3. Indeed, assuming, instance, \\(p_t(g_s) > p_t[p_r(g_s)]\\), payoff \\(s\\) defined following strategy: () \\(t\\): buy \\(p_r(g_s)\\), (short) sell \\(g_s\\), buy\n\\(\\frac{p_t(g_s)-p_t[p_r(g_s)]}{\\mathbb{E}(\\mathcal{M}_{t,s}|\\underline{w_t})}\\) zero-coupon bonds maturing \\(s\\), global price zero, (ii) \\(r\\): buy \\(g_s\\) sell \\(p_r(g_s)\\), generating zero net payoff, (iii) \\(s\\), net payoff : \\(g_s-g_s+\\frac{p_t(g_s)-p_t[p_r(g_s)]}{\\mathbb{E}(\\mathcal{M}_{t,s}|\\underline{w_t})} > 0\\).Consider asset whose payoff, date \\(s\\), \\(g(\\underline{w_s})\\). , \\(\\forall t < s\\):\n\\[\\begin{equation}\n\\boxed{p_t[g(\\underline{w_s})] = \\mathbb{E}_t[\\mathcal{M}_{t,t+1}...\\mathcal{M}_{s-1,s}g(\\underline{w_s})].}\\tag{2.4}\n\\end{equation}\\]\nparticular, since \\(L_{2,t+1}\\) contains 1, price \\(t\\) zero-coupon residual maturity one given :\n\\[\nB(t,1) := \\mathbb{E}_t [\\mathcal{M}_{t,t+1}].\n\\]\nDenoting \\(r_t\\) continously-compounded interest rate, defined \\(B(t,1)=\\exp(-r_{t})\\), get\n\\[\nr_{t}=-\\log \\mathbb{E}_t [\\mathcal{M}_{t,t+1}].\n\\]Definition 2.1  (Bank account) bank account process \\(R_t\\) defined \\(R_{t} \\equiv \\exp(r_0+...+r_{t-1}) = \\frac{1}{\\mathbb{E}_0[ \\mathcal{M}_{0,1}]\\times ... \\times \\mathbb{E}_{t-1} [\\mathcal{M}_{t-1,t}]}\\).\\(R_t\\) price investment initiated date 0, worth one dollar, invested date risk-free rate (one period).price process \\(p_t\\), \\(p_t = \\mathbb{E}_t(\\mathcal{M}_{t,s} p_s)\\) (\\(s>t\\)), \\(\\mathcal{M}_{0,t} p_t = \\mathbb{E}_t(\\mathcal{M}_{0,s}p_s)\\). , \\(\\mathcal{M}_{0,t} p_t\\) martingale. particular \\(\\mathcal{M}_{0,t} R_t\\) martingale.","code":""},{"path":"pricing-and-risk-neutral-dynamics.html","id":"PricingAffine","chapter":"2 Pricing and risk-neutral dynamics","heading":"2.3.2 Exponential Affine SDF","text":"specific (tractable) case exponential affine SDF. Assume \n\\[\n\\mathcal{M}_{t,t+1}(\\underline{w_{t+1}}) = \\exp[\\alpha_t(\\underline{w_t})'w_{t+1}+\\beta_t(\\underline{w_t})]\n\\]\n\\(\\alpha_t\\) defines prices risk sensitivity vector. Using \\(\\mathbb{E}_t[\\mathcal{M}_{t,t+1}]=\\exp(-r_{t})=\\exp[\\psi_t(\\alpha_t)+\\beta_t]\\), get:\n\\[\\begin{equation}\n\\mathcal{M}_{t,t+1} = \\exp[-r_{t}+\\alpha'_tw_{t+1}-\\psi_t(\\alpha_t)].\\tag{2.5}\n\\end{equation}\\]Example 2.2  (CCAPM/Power utility case) CCAPM-power-utility case (see Example 2.1), (Eq. (2.2)):\n\\[\n\\mathcal{M}_{t,t+1} = \\exp(\\log \\delta + \\log q_t + \\gamma \\log   C_t - \\log   q_{t+1} - \\gamma  \\log   C_{t+1}),\n\\]\n\\(q_t\\) price consumption good, \\(C_t\\) quantity consumed \\(t\\) \\(\\delta\\) intertemporal discount rate.Hence, case, \\(\\mathcal{M}_{t,t+1}\\) exponential affine \\(w_{t+1} = (\\log q_{t+1}, \\log C_{t+1})'\\) (first lag).","code":""},{"path":"pricing-and-risk-neutral-dynamics.html","id":"PricingRN","chapter":"2 Pricing and risk-neutral dynamics","heading":"2.4 The risk-neutral (R.N.) dynamics","text":"historical Dynamics characterized \\(f(\\underline{w_{T^*}})\\), \nsequence conditional p.d.f. \\(f_{t+1}(w_{t+1}|\\underline{w_t})\\), \n\\(f_{t+1}(w_{t+1})\\), respect (w.r.t.) measure \\(\\mu\\).define conditional risk-neutral p.d.f. w.r.t. conditional historical probability. , employ Radon-Nikodym derivative \\(d^{\\mathbb{Q}}_{t+1}(w_{t+1}|\\underline{w_t})\\):5\n\\[\nd^{\\mathbb{Q}}_{t+1}(w_{t+1}|\\underline{w_t}) =\n\\frac{\\mathcal{M}_{t,t+1}(\\underline{w_{t+1}})}{\\mathbb{E}[\\mathcal{M}_{t,t+1}(\\underline{w_{t+1}})|\\underline{w_t}]},\n\\]\n\n\\[\nd^{\\mathbb{Q}}_{t+1}(w_{t+1})=\n\\frac{\\mathcal{M}_{t,t+1}}{\\mathbb{E}_t(\\mathcal{M}_{t,t+1})}=\\exp(r_{t}) \\mathcal{M}_{t,t+1}.\n\\]\ncontext, risk neutral conditional p.d.f. :\n\\[\\begin{eqnarray}\nf^{\\mathbb{Q}}_{t+1}(w_{t+1}) &=& f_{t+1}(w_{t+1})d^{\\mathbb{Q}}_{t+1}(w_{t+1}) \\nonumber \\\\\n&=&f_{t+1} (w_{t+1}) \\mathcal{M}_{t,t+1} (\\underline{w_{t+1}}) \\exp [r_{t} (\\underline{w_t})].\\tag{2.6}\n\\end{eqnarray}\\]p.d.f. \\(\\mathbb{Q}\\) w.r.t. historical dynamics \\(\\mathbb{P}\\) :\n\\[\n\\xi_{T^*} =  \\frac{d\\mathbb{Q}}{d\\mathbb{P}} =\n\\Pi^{T^{*}-1}_{t=0} d^{\\mathbb{Q}}_{t+1}(w_{t+1}) =\n\\Pi^{T^{*}-1}_{t=0} \\exp(r_{t}) \\mathcal{M}_{t,t+1},\n\\]\np.d.f. R.N. distribution \\(\\underline{w_t}\\), w.r.t. corresponding historical distribution :\n\\[\n\\xi_t= \\Pi^{t-1}_{\\tau=1}\nd^{\\mathbb{Q}}_{\\tau+1}(w_{\\tau+1})=\\mathbb{E}_t\\left(\\frac{d\\mathbb{Q}}{d\\mathbb{P}}\\right) = \\mathbb{E}_t\\xi_{T^*}.\n\\]\nTherefore, \\(\\xi_t\\) \\(\\mathbb{P}\\)-martingale.6Consider date-\\(t\\) price payoff \\(g(\\underline{w_s})\\) time \\(s>t\\). equivalent form pricing formula (2.4) :\n\\[\\begin{eqnarray*}\np_t[g(\\underline{w_s})] &=& \\mathbb{E}_t[\\mathcal{M}_{t,t+1}...\\mathcal{M}_{s-1,s}g(\\underline{w_s})] \\\\\n&=& \\mathbb{E}^{\\mathbb{Q}}_t[\\exp(-r_{t}-...-r_{s-1})g(\\underline{w_s})],\n\\end{eqnarray*}\\]\n, simpler notations:\n\\[\np_t = \\mathbb{E}^{\\mathbb{Q}}_t[\\exp(-r_{t}-...-r_{s-1})p_s] = \\mathbb{E}^{\\mathbb{Q}}_t\\left(\\frac{R_t}{R_s} p_s\\right),\n\\]\n\\(R_t\\) bank account.also \\(p_t/R_t = \\mathbb{E}^{\\mathbb{Q}}_t\\left( p_s/R_s\\right)\\), , \\(p_t/R_t\\) \\(\\mathbb{Q}\\)-martingale. particular \\(p_t = \\exp(-r_{t})\\mathbb{E}^{\\mathbb{Q}}_t(p_{t+1})\\), , using arithmetic return payoff \\((p_{t+1}-p_t)/p_t\\), arithmetic return riskless asset \\(r_{,t+1}=\\exp(r_{t})-1\\), get:\n\\[\n\\mathbb{E}^{\\mathbb{Q}}_t\\left(\\frac{p_{t+1}-p_t}{p_t}\\right)=r_{,t}.\n\\]\nMoreover excess arithmetic return process \\((p_{t+1}-p_t)/p_t-r_{,t}\\) \\(\\mathbb{Q}\\)-martingale difference , therefore, \\(\\mathbb{Q}\\)-serially uncorrelated.Let us consider case exponential affine SDF \\(\\mathcal{M}_{t,t+1}=\\exp(\\alpha'_t w_{t+1}+\\beta_t)\\):\n\\[\nd^{\\mathbb{Q}}_{t+1}(w_{t+1}) = \\frac{\\mathcal{M}_{t,t+1}}{\\mathbb{E}_t(\\mathcal{M}_{t,t+1})} = \\frac{\\exp(\\alpha'_t\nw_{t+1}+\\beta_t)}{\\exp[\\psi_t(\\alpha_t)+\\beta_t]} = \\exp[\\alpha'_t w_{t+1}-\\psi_t(\\alpha_t)]\n\\]\n\\(d^{\\mathbb{Q}}_{t+1}(w_{t+1})\\) also exponential affine. Moreover:\n\\[\nf^{\\mathbb{Q}}_{t+1} (w_{t+1}) = \\frac{f_{t+1} (w_{t+1}) \\exp (\\alpha'_t w_{t+1})}{\\varphi_t (\\alpha_t)}.\n\\]\nprevious equation shows \\(f^{\\mathbb{Q}}_{t+1}\\) Esscher transform \\(f_{t+1}\\) evaluated \\(\\alpha_t\\).Let us know consider Laplace transform conditional R.N. probability, \\(\\varphi^{\\mathbb{Q}}_t(u|\\underline{w_t})\\), also denoted \\(\\varphi^{\\mathbb{Q}}_t(u)\\). :\n\\[\\begin{eqnarray*}\n\\varphi^{\\mathbb{Q}}_t(u) &=& \\mathbb{E}^{\\mathbb{Q}}_t \\exp(u' w_{t+1}) \\\\\n&=& \\mathbb{E}_t \\exp[(u+\\alpha_t)'w_{t+1}-\\psi_t(\\alpha_t)] \\\\\n&=& \\exp[\\psi_t(u+\\alpha_t)-\\psi_t(\\alpha_t)] =\n\\frac{\\varphi_t(u+\\alpha_t)}{\\varphi_t(\\alpha_t)}.\n\\end{eqnarray*}\\]\nHence:\n\\[\\begin{equation}\n\\boxed{\\psi^{\\mathbb{Q}}_t(u) = \\psi_t(u+\\alpha_t)-\\psi_t(\\alpha_t).}\\tag{2.7}\n\\end{equation}\\]\ncheck , \\(\\alpha_t=0\\), \\(\\psi^{\\mathbb{Q}}_t=\\psi_t\\) (since \\(\\psi_t(0)=0)\\).Moreover, putting \\(u=-\\alpha_t\\) expression \n\\(\\psi^{\\mathbb{Q}}_t(u)\\) get \\(\\psi^{\\mathbb{Q}}_t(-\\alpha_t)=-\\psi_t(\\alpha_t)\\),\n, replacing \\(u\\) \\(u-\\alpha_t\\), get:\n\\[\n\\boxed{\\psi_t(u) = \\psi^{\\mathbb{Q}}_t(u-\\alpha_t)-\\psi^{\\mathbb{Q}}_t(-\\alpha_t).}\n\\]\nAlso:\n\\[\\begin{equation*}\n\\left\\{\n\\begin{array}{ccl}\nd_{t+1}(w_{t+1}) &=& \\exp[-\\alpha'_t(w_{t+1})-\\psi^{\\mathbb{Q}}_t(-\\alpha_t)] \\\\\nd^{\\mathbb{Q}}_{t+1}(w_{t+1}) &=& \\exp[\\alpha'_t(w_{t+1})+\\psi^{\\mathbb{Q}}_t(-\\alpha_t)].\n\\end{array}\n\\right.\n\\end{equation*}\\]","code":""},{"path":"pricing-and-risk-neutral-dynamics.html","id":"PricingTypology","chapter":"2 Pricing and risk-neutral dynamics","heading":"2.5 Typology of Econometric Asset Pricing Models","text":"Definition 2.2  (Econometric Asset Pricing Model (EAPM)) Econometric Asset Pricing Model (EAPM) defined following functions:\\(r_{t}(\\underline{w_t})\\),\\(f(w_{t+1}|\\underline{w_t}))\\) [\\(\\psi_t(u)\\)],\\(\\mathcal{M}_{t,t+1}(\\underline{w_{t+1}})\\),\\(f^{\\mathbb{Q}}(w_{t+1}|\\underline{w_t})\\) [\\(\\psi^{\\mathbb{Q}}_t(u)\\)].previous functions specified parameterized. linked :\n\\[\nf^{\\mathbb{Q}}(w_{t+1}|\\underline{w_t}) = f(w_{t+1}|\\underline{w_t}) \\mathcal{M}_{t,t+1}(\\underline{w_{t+1}}) \\exp[r_{t}(\\underline{w_t}))].\n\\]following, present three ways specifying EAPM:direct modelling,R.N.-constrained direct modelling (mixed modelling),back modelling.focus case \\(\\mathcal{M}_{t,t+1}\\) exponential affine, Eq. (2.5):\n\\[\n\\mathcal{M}_{t,t+1} (\\underline{w_{t+1}}) = \\exp\\left\\{ -r_{t} (\\underline{w_t}) + \\alpha'_t(\\underline{w_t})w_{t+1} - \\psi_t [\\alpha_t (w_t)]\\right\\}.\n\\]\nshort-term rate function \\(r_{t}(\\underline{w_t})\\) specified, specify \\(\\psi_t\\), \\(\\alpha_t\\), \\(\\psi^{\\mathbb{Q}}_t\\), linked Eq. (2.7).approaches, specify status short rate. short rate \\(r_{t}\\) function \\(\\underline{w_t}\\), function may known unknown econometrician. known two cases: () \\(r_{t}\\) exogenous (\\(r_{t}(\\underline{w_t})\\) depend \\(\\underline{w_t}\\)) (b) \\(r_{t}\\) component \\(w_t\\). contrast, function \\(r_{t} (\\underline{w_t})\\) unknown, specified parametrically:\n\\[\n\\left\\{ r_{t} (\\underline{w_t}, \\tilde{\\theta}), \\tilde{\\theta}\\\\tilde{\\Theta} \\right\\},\n\\]\n\\(r_{t}(\\bullet,\\bullet)\\) known function.Let us now detail three steps three ways defining EAPM based.","code":""},{"path":"pricing-and-risk-neutral-dynamics.html","id":"the-direct-modelling","chapter":"2 Pricing and risk-neutral dynamics","heading":"2.5.1 The Direct Modelling","text":"Step 1 – Specification historical dynamics. choose parametric family conditional historical Log-Laplace transform \\(\\psi_t(u|\\underline{w_t})\\): \\(\\left\\{ \\psi_t (u|\\underline{w_t} ; \\theta_1), \\theta_1 \\\\Theta_1 \\right\\}\\).Step 2 – Specification SDF. Considering affine specification Eq. (2.5), :\n\\[\n\\mathcal{M}_{t,t+1} (\\underline{w_{t+1}}) = \\exp\\left\\{ -r_{t}(\\underline{w_t}, \\tilde{\\theta}) + \\alpha'_t(\\underline{w_t})w_{t+1} - \\psi_t [\\alpha_t (w_t)|\\underline{w_t} ; \\theta_1]\\right\\},\n\\]\nneed specifiy functions \\(r_{t}(\\underline{w_t}, \\tilde{\\theta})\\) \\(\\alpha_t(\\underline{w_t})\\). Assume \\(\\alpha_t(\\underline{w_t})\\) belongs parametric family: \\(\\left\\{ \\alpha_t (\\underline{w_t} ; \\theta_2),\\theta_2 \\\\Theta_2 \\right\\}\\).\n:\n\\[\\begin{eqnarray*}\n\\mathcal{M}_{t,t+1}(\\underline{w_{t+1}}, \\theta) &=& \\exp \\left\\{ - r_{t}\n(\\underline{w_t}, \\tilde{\\theta}) + \\alpha'_t (\\underline{w_t},\\theta_2) w_{t+1} - \\psi_{t} \\left[ \\alpha_t (\\underline{w_t},\n\\theta_2) | \\underline{w_t} ; \\theta_1 \\right] \\right\\},\n\\end{eqnarray*}\\]\n\\(\\theta = (\\tilde{\\theta}', \\theta'_1,\\theta'_2)' \\\\tilde{\\Theta}\\times \\Theta_1 \\times \\Theta_2 = \\Theta\\).Step 3 – Internal consistency conditions (ICC). payoff \\(g(\\underline{w_s})\\) settled \\(s>t\\), price \\(p(\\underline{w_t})\\) \\(t\\) known function \n\\(\\underline{w_t}\\), must :\n\\[\\begin{equation*}\np(\\underline{w_t}) = \\mathbb{E} \\left\\{\\mathcal{M}_{t,t+1} (\\theta) \\dots \\mathcal{M}_{s-1,s} (\\theta) g(\\underline{w_s})  |  \\underline{w_t},\n\\theta_1 \\right\\}    \\forall \\; \\underline{w_t}, \\theta.\\tag{2.8}\n\\end{equation*}\\]\nICC pricing conditions may imply strong constraints \\(\\theta\\). instance, components \\(w_t\\) returns assets: \\(w_{1,t} = \\log(p_{1,t}/p_{1,t-1})\\), must \\(\\mathbb{E}_t [\\mathcal{M}_{t,t+1} \\exp (e'_1 w_{t+1})]= 1\\) (Euler equation). , case interest rates various maturities: \\(w_{1,t} = -1/h\\log B(t,h)\\), must \\(e'_1 w_{t} = - 1/h \\log \\mathbb{E}_t (\\mathcal{M}_{t,t+1}\\times \\dots \\times \\mathcal{M}_{t+h-1,t+h})\\).previous three steps imply specification R.N. dynamics (according Eq. (2.7)):\n\\[\\begin{equation*}\n\\psi^{\\mathbb{Q}} (u | \\underline{w_t}, \\theta_1, \\theta_2) =\n\\psi_t \\left[ u + \\alpha_t (\\underline{w_t}, \\theta_2) |\n\\underline{w_t}, \\theta_1 \\right] - \\psi_t \\left[ \\alpha_t\n(\\underline{w_t}, \\theta_2) | \\underline{w_t}, \\theta_1\n\\right].\n\\end{equation*}\\]","code":""},{"path":"pricing-and-risk-neutral-dynamics.html","id":"the-r.n.-constrained-direct-modelling-or-mixed-modelling","chapter":"2 Pricing and risk-neutral dynamics","heading":"2.5.2 The R.N.-constrained direct modelling (or mixed modelling)","text":"Step 1 – Specification physical dynamics. select family \\(\\{ \\psi_t (u | \\underline{w_t},\\theta_1), \\theta_1 \\\\Theta_1 \\}\\).Step 2 – Specification risk-neutral dynamics. select family \\(\\{\\psi^{\\mathbb{Q}}_t (u | \\underline{w_t}, \\theta^*),\\theta^* \\\\Theta^* \\}\\) , possibly, \\(\\{r_{t}(\\underline{w_t},\\tilde{\\theta}),\\tilde{\\theta}\\\\tilde{\\Theta}\\}\\).Step 3 – Internal Consistency Conditions (ICC). parameterization \\((\\tilde{\\theta}, \\theta_1, \\theta^*) \\\\tilde{\\Theta} \\times \\Theta^*_1\\) defined, ICCs may imposed. instance, \\(w_{1,t} = \\log(p_{1,t}/p_{1,t-1})\\), must \\(\\exp(-r_t)\\mathbb{E}^{\\mathbb{Q}}_t \\exp (e_{1}' w_{t+1}) = 1\\). \\(w_{1,t} = B(t,h)\\), \\(e_{1}' w_{t} = \\mathbb{E}_t^{\\mathbb{Q}} \\exp(-r_t - \\dots - r_{t+h-1})\\).SDF -product. want exponential affine SDF, pair \\((\\psi^{\\mathbb{Q}}_t, \\psi_t)\\) belonging families, must exist unique function \\(\\alpha_t (\\underline{w_t})\\) denoted \\(\\alpha_t (w_t ; \\theta_1, \\theta^*)\\), satisfying:\n\\[\\begin{equation*}\n\\psi^{\\mathbb{Q}}_t (u | \\underline{w_t}) = \\psi_t \\left[ u +\n\\alpha_t (w_t) | \\underline{w_t} \\right] - \\psi_t \\left[\n\\alpha_t (\\underline{w_t}) | \\underline{w_t} \\right].\n\\end{equation*}\\]","code":""},{"path":"pricing-and-risk-neutral-dynamics.html","id":"the-back-modelling-based-on-three-steps","chapter":"2 Pricing and risk-neutral dynamics","heading":"2.5.3 The Back Modelling (based on three steps)","text":"Step 1 – Specification R.N. dynamics, possibly \\(r_{t}(\\underline{w_t})\\)]: \\(\\psi^{\\mathbb{Q}}_t (u | \\underline{w_t}; \\theta^*_1)\\).Step 2 – Internal consistency conditions (ICC), relevant, taken account:\n\\[\\begin{equation*}\n\\begin{array}{lll}\n&& p(\\underline{w_t}) = \\mathbb{E}^{\\mathbb{Q}}_t \\left[ \\exp (-r_{t} (\\underline{w_t},\\tilde{\\theta}) - \\dots - r_{s-1} (\\underline{w_s}, \\tilde{\\theta}))g(\\underline{w_s}) | \\underline{w_t} , \\theta^*_1\\right] ,\\\\\n&& \\forall    \\underline{w_t} , \\tilde{\\theta} , \\theta^*_1.\n\\end{array}\n\\end{equation*}\\]Step 3 – Choice specification prices risk. One chooses function \\(\\alpha_t(\\underline{w_t})\\) without constraint; amounts defining family \\(\\{ \\alpha_t (\\underline{w_t}, \\theta^*_2), \\theta^*_2\\\\Theta^*_2 \\}\\).historical dynamics obtained -product. Indeed:\n\\[\\begin{equation*}\n\\psi_t(u | \\underline{w_t} ; \\theta^*_1, \\theta^*_2) = \\psi_t^{\\mathbb{Q}}\\left[ u -\\alpha_t (\\underline{w_t}, \\theta^*_2)|\\underline{w_t} ; \\theta^*_1 \\right] -\\psi^{\\mathbb{Q}}_t \\left[- \\alpha_t (\\underline{w_t}, \\theta^*_2) | \\underline{w_t},\\theta^*_1 \\right].\n\\end{equation*}\\]","code":""},{"path":"the-term-structure-or-risk-free-yields.html","id":"the-term-structure-or-risk-free-yields","chapter":"3 The term structure or risk-free yields","heading":"3 The term structure or risk-free yields","text":"","code":""},{"path":"the-term-structure-or-risk-free-yields.html","id":"RFIntroduction","chapter":"3 The term structure or risk-free yields","heading":"3.1 Introduction","text":"Risk-free yields yields--maturity associated bonds carry default /liquidity risks. Bonds issued sovereign entities top credit quality usually considered risk-free.important share term-structure literature pertains modelling risk-free yields. models involve macro factors \\(w_t\\) (Ang Piazzesi 2003); (Darrel Duffie Singleton 1997). latter sometimes called yield-models.basic pricing formula risk-free zero coupon bond (see Eq. (1.10) Example 1.18):\n\\[\\begin{eqnarray}\nB(t,h) &=& \\exp(-r_{t}) \\mathbb{E}^{\\mathbb{Q}}_t \\exp(-r_{t+1}-\\dots-r_{t+h-1})\\\\\nR(t,h) &=& - \\frac{1}{h} \\log B(t,h). \\tag{3.1}\n\\end{eqnarray}\\]Term structure models often used extract term premiums observed yields--maturity. Term premiums components yields exist investors risk-averse.agents risk averse, .e., Expectation Hypothesis (EH), \\(\\mathcal{M}_{t,t+1} = \\exp(- r_t)\\). ``\\(\\mathbb{P} \\equiv \\mathbb{Q}\\)’’ \\(B(t,h)\\) become:\n\\[\\begin{equation}\n\\exp(-r_{t}) \\mathbb{E}_t \\exp(-r_{t+1}-\\dots-r_{t+h-1}).\\tag{3.2}.\n\\end{equation}\\]\nmaturity-\\(h\\) yield--maturity :\n\\[\\begin{eqnarray}\nR^{EH}(t,h) &=& -\\frac{1}{h}\\log \\left( \\mathbb{E}_t \\exp(-r_t-\\dots-r_{t+h-1})\\right)\\nonumber\\\\\n&\\approx& \\frac{1}{h}\\mathbb{E}_t(r_t + \\dots + r_{t+h-1}).\\tag{3.3}\n\\end{eqnarray}\\]term premium given :\n\\[\\begin{eqnarray}\nTP_{t,h} &=& \\underbrace{- \\frac{1}{h} \\log  \\mathbb{E}^{\\mathbb{Q}}_t \\exp(-r_{t+1}-\\dots-r_{t+h-1})}_{=R(t,h)} - \\nonumber \\\\\n&& \\underbrace{- \\frac{1}{h}  \\log  \\mathbb{E}_t \\exp(-r_{t+1}-\\dots-r_{t+h-1}).}_{=R^{EH}(t,h)}\\tag{3.4}\n\\end{eqnarray}\\]economic meaning term premium? EH, investors willing buy maturity-\\(h\\) bond long expected return —Jensen’s inequality—equal average future short-term rates. (Hence definition \\(R^{EH}(t,h)\\), see Eq. (3.3).) \\(TP_{t,h}>0\\), investors willing buy maturity-\\(h\\) bond return , average, higher expected future short-term rates; corresponds situation investors consider long-term bonds tend lose value bad states world (.e., states high marginal utility).Risk premium: According Eq. (2.3), price asset \\(j\\) satisfies:\n\\[\np_{jt} = \\mathbb{E}_t(\\mathcal{M}_{t,t+1} p_{j,t+1}).\n\\]\nprevious equation rewrites:\n\\[\np_{jt} =  \\mathbb{C}ov_t(\\mathcal{M}_{t,t+1}, p_{j,t+1}) + \\mathbb{E}_t(\\mathcal{M}_{t,t+1})\\mathbb{E}_t( p_{j,t+1})\n\\]\n\n\\[\\begin{equation}\np_{jt} = \\underbrace{\\exp(-r_t)\\mathbb{E}_t( p_{j,t+1})}_{=p^{EH}_{jt}} + \\underbrace{\\mathbb{C}ov_t(\\mathcal{M}_{t,t+1}, p_{j,t+1})}_{\\mbox{Risk premium}}.\\tag{3.5}\n\\end{equation}\\]\ninvestors risk-averse, \\(p_{jt} = p^{EH}_{jt}\\). S.D.F. high (resp. low) bad (resp. good) states world (states high marginal utility equilibrium approach). Hence, \\(p_{jt}< p^{EH}_{jt}\\) asset \\(j\\) tends pay less bad states world (.e., \\(\\mathbb{C}ov_t(\\mathcal{M}_{t,t+1}, p_{j,t+1})<0\\)).","code":""},{"path":"the-term-structure-or-risk-free-yields.html","id":"swap-rates-and-forward-rates","chapter":"3 The term structure or risk-free yields","heading":"3.2 Swap rates and forward rates","text":"","code":""},{"path":"the-term-structure-or-risk-free-yields.html","id":"swap-rates","chapter":"3 The term structure or risk-free yields","heading":"3.2.1 Swap rates","text":"Bonds issued top-rated (Aaa/AAA) countries often considered risk-free. call-margins mechanisms, swap rates also used risk-free benchmarks (Darrell Duffie Stein 2015).Definition 3.1  (Interest Rate Swap (IRS)) Interest Rate Swap (IRS), fixed-rate payer agrees provide fixed-rate receiver sequence cash flows determined negotiation date swap, predetermined dates. cash flows constitute fixed leg swap. Conversely, fixed-rate receiver provides fixed-rate payer cash-flows depend future values reference rate; floating rate swap.precisely, dates payment form \\(t+ \\tau\\), \\(t + 2\\tau\\), , \\(t + n\\tau\\), \\(\\tau\\) period expressed years (typically 1/2 1/4) \\(n\\) number payments. maturity, tenor, swap contract \\(h = n \\tau\\).payoffs fixed leg \\(\\tau S\\), \\(S\\) annualized payment (swap rate). date \\(t+j\\tau\\), payoff floating leg \\(\\tau L(t+(j-1)\\tau,\\tau)\\), \\(L\\), annualized linear rate given :\n\\[\nL(t+(j-1)\\tau,\\tau) = \\frac{1 - B(t+(j-1)\\tau,\\tau)}{\\tau B(t+(j-1)\\tau,\\tau)},\n\\]\n\\(B(t+(j-1)\\tau,\\tau)\\) price, date \\(t+(j-1)\\tau\\) bond maturity \\(\\tau\\).negotiation date, values fixed floating legs identical, value swap zero.\\(t\\), price fixed leg :\n\\[\n\\sum_{j=1}^n \\tau S B(t,j\\tau).\n\\]\nLet us turn price floating leg. payoff date \\(t+j\\tau\\), \\(\\frac{1 - B(t+(j-1)\\tau,\\tau)}{B(t+(j-1)\\tau,\\tau)}\\) known date \\(t+(j-1)\\tau\\), price date \\(t+(j-1)\\tau\\) \\(1 - B(t+(j-1)\\tau,\\tau)\\), price \\(t\\) therefore \\(B(t,(j-1)\\tau) - B(t,j\\tau)\\). Summing \\(j=1,\\dots,n\\), date-\\(t\\) price floating leg \\(1 - B(t,n\\tau)\\) (independent payment dates).Since price contract zero date \\(t\\) (definition swap), must :\n\\[\n\\sum_{j=1}^n \\tau S B(t,j\\tau) = 1 - B(t,n\\tau) \\Rightarrow S = \\frac{1 - B(t,n\\tau)}{ \\tau \\sum_{j=1}^n  B(t,j\\tau)},\n\\]\n\n\\[\n\\boxed{S(t,h) = \\frac{1 - B(t,h)}{\\tau \\sum_{j=1}^{h/\\tau}  B(t,j\\tau)}.}\n\\]Note terms appearing previous formula available closed-form context affine model (see Example 1.18).","code":""},{"path":"the-term-structure-or-risk-free-yields.html","id":"forward-rates","chapter":"3 The term structure or risk-free yields","heading":"3.2.2 Forward rates","text":"Definition 3.2  (Forward Rate Agreement (FRA)) interest rate forward contract contract rate paid received specific obligation set period, beginning future, set contract initiation.Denote \\(f(t,h_1,h_2)\\) forward interest rate, set date \\(t\\), period \\(t+h_1\\) \\(t+h_2\\). Let us relate \\(f(t,h_1,h_2)\\) bond rates. , consider two strategies (decided date \\(t\\)):Buy zero-coupon bond maturity \\(h_2\\) (price \\(B(t,h_2)\\)) sell zero-coupon bonds maturity \\(h_1\\) amount (yielding payoff \\(B(t,h_2)/B(t,h_1)\\) date \\(t+h_1\\)).Enter forward rate agreement dates \\(t+h_1\\) \\(t+h_2\\), whereby receive 1 date \\(t+h_2\\).two strategies deliver payoffs date \\(t\\) (payoff zero) date \\(t+h_2\\) (payoff 1). absence arbitrage, payoffs date \\(t+h_1\\) . Therefore\n\\[\\begin{eqnarray*}\n\\exp(-(h_2 - h_1)f(t,h_1,h_2)) &=& B(t,h_2)/B(t,h_1) \\\\\n\\Rightarrow f(t,h_1,h_2) &=& \\frac{1}{h_2 - h_1}(\\log[B(t,h_1)] - \\log[B(t,h_2)]),\n\\end{eqnarray*}\\]\ngives:\n\\[\n\\boxed{f(t,h_1,h_2) = \\frac{h_2 R(t,h_2) - h_1 R(t,h_1)}{h_2 - h_1}.}\n\\]\naffine model (\\(R(t,h)\\) affine function state vector \\(w_t\\)), forward rates linear state vector \\(w_t\\).","code":""},{"path":"the-term-structure-or-risk-free-yields.html","id":"RiskFreeAffine","chapter":"3 The term structure or risk-free yields","heading":"3.3 The Affine Case","text":"","code":""},{"path":"the-term-structure-or-risk-free-yields.html","id":"affine-yields","chapter":"3 The term structure or risk-free yields","heading":"3.3.1 Affine yields","text":"subsection, consider case state vector \\(w_t\\) affine \\(\\mathbb{P}\\) \\(\\mathbb{Q}\\). nominal short-term rate affine \\(w_t\\), .e., \\(r_t = \\omega_0 + \\omega'_1 w_t\\), :\n\\[\\begin{eqnarray*}\nB(t,h) &=& \\mathbb{E}^{\\mathbb{Q}}_t \\exp (-r_{t}-\\dots-r_{t+h-1})\\\\\n&=& \\exp(-h\\omega_0 - \\omega'_1 w_t) \\color{blue}{\\mathbb{E}^{\\mathbb{Q}}_t \\exp (- \\omega'_1 w_{t+1}-\\dots- \\omega'_1 w_{t+h-1})}.\n\\end{eqnarray*}\\]\n(blue) expectation easily computed using recursive equations Lemma 1.5 (see Example 1.18), leading :\n\\[\\begin{equation}\nR(t,h)= -  \\frac{1}{h}   \\log   B(t,h) = A_h'w_t + B_h.\\tag{3.6}\n\\end{equation}\\]\neasily seen can also get:\n\\[\\begin{equation}\nR^{EH}(t,h) = {^{EH}_h}'w_t + B^{EH}_h.\\tag{3.7}\n\\end{equation}\\]\nMoreover, inflation also affine \\(w_t\\), .e., \\(\\pi_{t} = \\bar\\omega_0 + \\bar\\omega'_1 w_t\\), real yields given :\n\\[\\begin{eqnarray*}\n\\bar{B}(t,h) &=& \\mathbb{E}^{\\mathbb{Q}}_t \\exp(-r_{t}-\\dots-r_{t+h-1}+\\pi_{t+1}+\\dots+\\pi_{t+h})\n\\end{eqnarray*}\\]\n(see Example 1.20) also leads :\n\\[\\begin{equation}\n\\bar{R}(t,h) = -  \\frac{1}{h}   \\log   \\bar{B}(t,h) = \\bar{}_h'w_t + \\bar{B}_h.\\tag{3.8}\n\\end{equation}\\]\nEqs. (3.6) (3.7) imply term premiums affine \\(w_t\\) (see Eq. (3.4)). Specifically:\n\\[\nTP(t,h) = R(t,h) - E^{EH}(t,h) = B_h - B_h^{EH} + (A_h - A_h^{EH})'w_t.\n\\]\nExpected excess returns resulting holding zero-coupon bonds also affine \\(w_t\\). Indeed, holding maturity-\\(h\\) zero-coupon bond one period provides following expected gross return:\n\\[\n\\mathbb{E}_t\\left(\\frac{B(t+1,h-1)}{B(t,h)}\\right) = \\mathbb{E}_t\\left(\\exp(B_{h-1} - B_h + A_{h-1}'w_{t+1} - A_h'w_{t})\\right),\n\\]\nclearly exponential affine \\(w_t\\) \\(w_t\\) affine process. Therefore, expected excess return, :\n\\[\n\\log \\mathbb{E}_t\\left(\\frac{B(t+1,h-1)}{B(t,h)}\\right) - r_t\n\\]\nalso affine \\(w_t\\) context. fact excess returns affine context exploited estimation approach proposed Adrian, Crump, Moench (2013).Moreover, conditional expectations future interest rates (real nominal) term premiums also affine \\(w_t\\). particular:\n\\[\\begin{equation}\n\\mathbb{E}_t[R(t+k,h)] = \\mathbb{E}_t[{A_h}'w_{t+k} + B_h] = {A_h}'\\mathbb{E}_t(w_{t+k}) + B_h,\\tag{3.9}\n\\end{equation}\\]\n\\(\\mathbb{E}_t(w_{t+k})\\) affine \\(w_t\\) (see Eq. (1.15)). can notably used estimation stage, one wants fit survey data (see Section XXX).Similarly, conditional variances future interest rates (real nominal) term premiums affine \\(w_t\\). particular:\n\\[\\begin{equation}\n\\mathbb{V}ar_t[R(t+k,h)] = \\mathbb{V}ar_t[{A_h}'w_{t+k} + B_h] = {A_h}'\\mathbb{V}ar_t(w_{t+k})A_h,\\tag{3.10}\n\\end{equation}\\]\ncomponents \\(\\mathbb{V}ar_t(w_{t+k})\\) (therefore \\(\\mathbb{V}ar_t[R(t+k,h)]\\)) affine \\(w_t\\) (see Eq. (1.16)). can also used estimation stage, one wants fit (proxies ) conditional variances (Monfort et al. 2017).","code":""},{"path":"the-term-structure-or-risk-free-yields.html","id":"maximum-sharpe-ratio","chapter":"3 The term structure or risk-free yields","heading":"3.3.2 Maximum Sharpe ratio","text":"affine model, maximum Sharpe ratio easily computed. noted early Duffee (2010) Gaussian model; Gourieroux et al. (2021) Pallara Renne (2023) use sophisticated affine models.Let us derive maximum Sharpe ratio context genral affine framework. Eq. (3.5) implies \n\\[\n\\mathbb{E}_t\\underbrace{\\left(\\frac{p_{j,t+1}}{p_{j,t}} - \\exp(r_t)\\right)}_{=xs_{j,t+1},\\mbox{ excess return}} =  - \\exp(r_t) \\mathbb{C}ov_t\\left(\\mathcal{M}_{t,t+1},\\frac{p_{j,t+1}}{p_{j,t}}\\right),\n\\]\n, using \\(|\\mathbb{C}ov(X,Y)| \\le \\sqrt{\\mathbb{V}ar(X)\\mathbb{V}ar(Y)}\\), get Hansen Jagannathan (1991) bound:\n\\[\\begin{equation}\n\\underbrace{\\frac{\\mathbb{E}_t(xs_{j,t+1})}{\\sqrt{\\mathbb{V}ar_t(xs_{j,t+1})}}}_{\\mbox{Sharpe ratio}} \\le \\underbrace{\\frac{\\sqrt{\\mathbb{V}ar_t(\\mathcal{M}_{t,t+1})}}{\\mathbb{E}_t(\\mathcal{M}_{t,t+1})}}_{\\mbox{Maximum Sharpe ratio}}.\n\\end{equation}\\]S.D.F. given \\(\\mathcal{M}_{t,t+1} = \\exp[-r_{t}+\\alpha'_tw_{t+1}-\\psi_t(\\alpha_t)]\\) (Eq. (2.5)), using \\(\\mathbb{E}_t(\\mathcal{M}_{t,t+1}^2)=\\exp(-2r_t+\\psi_t(2\\alpha_t)-2\\psi_t(\\alpha_t))\\) get:\n\\[\n\\mbox{Maximum Sharpe ratio} = \\sqrt{\\exp(\\psi_t(2\\alpha_t)-2\\psi_t(\\alpha_t)) - 1}.\n\\]","code":""},{"path":"the-term-structure-or-risk-free-yields.html","id":"RiskFreeGaussian","chapter":"3 The term structure or risk-free yields","heading":"3.4 Gaussian Affine Term Structure Model","text":"Gaussian Affine Term Structure Model (GATSM) Workhorse model, widely used academic economic-policy circles. GATSM, \\(w_t\\) follows Gaussian vector autoregressive model, therefore affine \\(\\mathbb{P}\\). S.D.F. exponential affine \\(w_t\\), implies also affine \\(\\mathbb{Q}\\) (see Subsection XXX). Since components \\(w_t\\) valued \\(\\mathbb{R}\\), one can easily introduce macro-factors among state variables.Let us specific. state vector \\(w_t\\) follows:\n\\[\\begin{equation}\nw_{t+1} = \\mu + \\Phi w_{t} + \\Sigma^{1/2} \\varepsilon_{t+1}, \\mbox{ } \\varepsilon_{t} \\sim  ..d. \\mathcal{N}(0,Id).\\tag{3.11}\n\\end{equation}\\]\n(fact consider VAR(1) process without loss generality since VAR(p) admits VAR(1) companion representation.)implies following Laplace transform \\(w_t\\) (see Example ??):\n\\[\n\\psi_t(u) = \\log \\mathbb{E}_t(\\exp(u'w_{t+1})|\\underline{w_t}) = \\color{blue}{u'\\mu + u'\\Phi w_t + \\frac{1}{2}u'\\Sigma'u}.\n\\]\nUsing notations Eq. (2.5), s.d.f. defined :\n\\[\n\\mathcal{M}_{t,t+1} = \\exp(- r_t + \\alpha_t'w_{t+1} - \\psi_t(\\alpha_t)), \\mbox{ } \\alpha_t = \\alpha_0 + \\alpha_1'w_t.\n\\]case, using Eq. (2.7), get:\n\\[\\begin{eqnarray*}\n\\psi_t^{\\mathbb{Q}}(u) &=& \\psi_t(u + \\alpha_t) - \\psi_t(\\alpha_t)\\\\\n&=& (u + \\alpha_t)'\\mu + (u + \\alpha_t)'\\Phi w_t + \\frac{1}{2}(u + \\alpha_t)'\\Sigma(u + \\alpha_t) \\\\\n&& - \\left(\\alpha_t'\\mu + \\alpha_t'\\Phi w_t + \\frac{1}{2}\\alpha_t'\\Sigma\\alpha_t\\right) \\\\\n&=& \\color{blue}{u' \\left(\\mu + \\Sigma \\alpha_0 \\right) + u'(\\Phi + \\Sigma \\alpha_1')w_t  + \\frac{1}{2}u'\\Sigma'u}.\n\\end{eqnarray*}\\]\n\\(\\mathbb{Q}\\)-dynamics \\(w_t\\) (Example ??):\n\\[\nw_{t+1} = \\mu + \\Sigma  \\alpha_0 + (\\Phi + \\Sigma \\alpha_1')  w_{t} + \\Sigma^{1/2} \\varepsilon^*_{t+1}, \\mbox{ } \\varepsilon^*_{t} \\sim  ..d. \\mathcal{N}^{\\mathbb{Q}}(0,Id).\n\\]\nHence, \\(w_t\\) also follows VAR process \\(\\mathbb{Q}\\) since previous equation rewrites:\n\\[\nw_{t+1} = \\mu^{\\mathbb{Q}} + \\Phi^{\\mathbb{Q}} w_{t} + \\Sigma^{1/2} \\varepsilon^*_{t+1},\n\\]\n\\(\\mu^{\\mathbb{Q}} = \\mu + \\Sigma \\alpha_0\\) \\(\\Phi^{\\mathbb{Q}}=\\Phi + \\Sigma \\alpha_1'\\).affine specifications nominal short term rate (\\(r_{t} = \\omega_0 + \\omega'_1 w_t\\)) inflation rate (\\(\\pi_{t} = \\bar\\omega_0 + \\bar\\omega'_1 w_t\\)), obtain affine formulas nominal real yields maturity (Eqs. (3.6) (3.8)).Example 3.1  (Kim Wright (2005)) model three-factor yield-model (macro variables, except inflation one variant model), short-term rate reads \\(r_t = \\omega_0 + \\omega_{1,1} w_{1,t} +\\omega_{1,2} w_{2,t} +\\omega_{1,3} w_{3,t}\\).model estimated Kalman filter (see Subsection,??; state-space model (Def. ??) includes survey-based variables (see Subsection ??).Outputs regularly updated Federal Reserve Board.Monthly data 6-month 12-month-ahead forecasts three-month T-Bill yield Blue Chip Financial Forecasts semiannual data average expected three-month T-Bill yield 6 11 years.\nFigure 3.1: Kim Wright (2005) outputs.\nExample 3.2  (Ang Piazzesi (2003)) Ang Piazzesi (2003) propose one first paper mixing latent macrovariables. set also form Eq. (3.11), except VAR features several lags.7 model, \\(w_t = [f^{o}_{1,t},f^{o}_{2,t},f^{u}_{1,t},f^{u}_{2,t},f^{u}_{3,t}]'\\) :\\(f^{o}_{1,t}\\) first Principal Component set 3 price indexes (growth rates)\\(f^{o}_{2,t}\\) first Principal Component set 4 real activity proxies (HELP, EMPLOY, IP, UE).\\(f^{u}_{,t}\\) unobserved, latent, factors.nominal short-term rate follows Taylor rule. latent factors estimated via inversion techniques (Subsection ??).\nFigure 3.2: Source: Ang Piazzesi (1998). Impulse response functions.\nExample 3.3  (Joslin, Priebsch Singleton (2014)) Joslin, Priebsch, Singleton (2014) first note affine models stating short term rate affine macro factors imply macro-factors spanned yield curve: macro-factors perfectly explained yields different maturities. , show case data. (, regressing macro factors yields provides \\(R^2\\) far one.)propose model macro factors unspanned yield curve, can still help predict yields. model, \\(w_t = [\\mathcal{P}_t',M_t']'\\), \\(\\mathcal{P}_t\\) yield factors (\\(\\approx\\) principal components) \\(M_t\\) macro factors. model follows:\n\\[\\begin{eqnarray*}\nr_t &=& \\omega_{0} + \\omega_{\\mathcal{P}}'\\mathcal{P}_t \\\\\n\\left[\\begin{array}{c}\\mathcal{P}_t \\\\ M_t \\end{array}\\right]\n&=&\n\\left[\\begin{array}{cc}\\Phi_{\\mathcal{P}\\mathcal{P}}&\\Phi_{\\mathcal{P}M} \\\\\n\\Phi_{M\\mathcal{P}}&\\Phi_{MM} \\end{array}\\right]\n\\left[\\begin{array}{c}\\mathcal{P}_{t-1} \\\\ M_{t-1} \\end{array}\\right] + \\Sigma \\varepsilon_t \\\\\n\\left[\\begin{array}{c}\\mathcal{P}_t \\\\ M_t \\end{array}\\right] &=& \\mu +\n\\left[\\begin{array}{cc}\\Phi^{\\mathbb{Q}}_{\\mathcal{P}\\mathcal{P}}&{\\color{red}0} \\\\\n\\Phi^{\\mathbb{Q}}_{M\\mathcal{P}}&\\Phi^{\\mathbb{Q}}_{MM} \\end{array}\\right]\n\\left[\\begin{array}{c}\\mathcal{P}_{t-1} \\\\ M_{t-1} \\end{array}\\right] + \\Sigma \\varepsilon^{\\mathbb{Q}}_t,\n\\end{eqnarray*}\\]\n\\(\\varepsilon_t\\) \\(\\varepsilon^{\\mathbb{Q}}_t\\) \\(\\mathcal{N}(0,Id)\\) \\(\\mathbb{P}\\) \\(\\mathbb{Q}\\), respectively.\\(M_t\\) Granger-cause \\(\\mathcal{P}_t\\) \\(\\mathbb{Q}\\) \\(r_t\\) affine \\(\\mathcal{P}_t\\) ().context, yields \\(R(t,h)\\) affine \\(\\mathcal{P}_t\\) (). However \\(M_t\\) Granger-cause \\(\\mathcal{P}_t\\) \\(\\mathbb{P}\\), , macro-shocks affect yield curve.\nFigure 3.3: Source: Joslin, Priebsch, Singleton (2014). Impulse response functions.\nExample 3.4  (Ang, Boivin, Dong Loo-Kung (2011)) Ang et al. (2011) propose macro-finance model based quadratic framework. short-term rate follows Taylor rule time-varying parameters:\n\\[\nr_t = \\omega_0 + a_t g_t + b_t \\pi_t,\n\\]\n\\(x_t=(g_t,\\pi_t,a_t,b_t)'\\) follows Gaussian VAR. context described Example 1.7. previous equation shows \\(r_t\\) linear \\(w_t = (x_t,vec(x_t x_t')')'\\). Specifically:\n\\[\nr_t = \\omega_0 + \\omega_1'w_t,\n\\]\n\\(\\omega_1 = [v,vec(V)]'\\), \n\\[\nv = \\left[\n\\begin{array}{c}\n0\\\\\n0\\\\\n0\\\\\n0\n\\end{array}\n\\right] \\quad \\mbox{} \\quad V = \\left[\n\\begin{array}{cccc}\n0 & 0& 1/2&0\\\\\n0& 0& 0&1/2\\\\\n1/2& 0& 0&0\\\\\n0&1/2 &0 &0\n\\end{array}\n\\right].\n\\]\nFigure 3.4: Source: Ang, Boivin, Dong, Loo-Kung (2011). Estimated factor loadings (\\(a_t\\) \\(b_t\\)).\n","code":""},{"path":"the-term-structure-or-risk-free-yields.html","id":"RiskFreeNonNegative","chapter":"3 The term structure or risk-free yields","heading":"3.5 Non-Negative Affine Term Structure Model","text":"presence physical currency, absence arbitrage opportunity storing cost cash, nominal interest rates nonnegative. Many standard models (e.g. Gaussian ATSM) non consistent non-negative nominal yields. period extremely low interest rates challenged models. backdrop, approaches developed accommodate zero (effective) lower bounds. provide two examples; second affine model.","code":""},{"path":"the-term-structure-or-risk-free-yields.html","id":"the-shadow-rate-approach","chapter":"3 The term structure or risk-free yields","heading":"3.5.1 The shadow-rate approach","text":"shadow-rate model originally due Black (1995). model, short term rate given :\n\\[\\begin{equation}\nr_t = \\max(s_t,0),\\tag{3.12}\n\\end{equation}\\]\n\\(s_t\\) shadow short-term interest rate. latter can real-valued, short term rate nonnegative (3.12). shadow-rate models, shadow rate \\(s_t\\) usually linear combination vector \\(x_t\\) follows Gaussian auto-regressive model. \\(s_t\\) linear combination components affine process, case \\(r_t\\). result, pricing formula available closed-form. Approximation formula proposed , e.g., Krippner (2013), Priebsch (2013), Wu Xia (2016).Let us consider XXX.","code":""},{"path":"the-term-structure-or-risk-free-yields.html","id":"the-auto-regressive-gamma-approach","chapter":"3 The term structure or risk-free yields","heading":"3.5.2 The auto-regressive gamma approach","text":"Monfort et al. (2017) introduce affine framework short-term rate can stay zero prolonged period time stochastic lift-probability.Example 3.5  (Monfort, Pegoraro, Renne Roussellet (2017)) Vectorial Auto-Regressive Gamma (VARG): Multivariate extension Example 1.8.Conditionally \\(\\underline{w_t}\\), \\(n\\) components \\(w_{t+1}\\) independent distributed follows:\n\\[\\begin{equation}\n\\frac{w_{,t+1}}{\\mu_i} \\sim \\gamma(\\nu_i+z_{,t}) \\quad \\mbox{} \\quad z_{,t} \\sim {\\mathcal P} \\left( \\alpha_i + \\beta_i' w_t \\right).\\tag{3.13}\n\\end{equation}\\]\n* \\(\\mu = (\\mu_1,\\dots,\\mu_n)'\\), \\(\\alpha = (\\alpha_1,\\dots,\\alpha_n)'\\), \\(\\nu = (\\nu_1,\\dots,\\nu_n)'\\) \\(\\beta = (\\beta_1,\\dots,\\beta_n)\\), \n\\[\\begin{eqnarray*}\n\\varphi_t(u) &=& \\exp\\left[\\left(\\frac{u \\odot \\mu}{1 - u \\odot \\mu}\\right)'\\beta' w_t \\right.\\\\\n&& \\left. + \\alpha'\\left(\\frac{u \\odot \\mu}{1 - u \\odot \\mu}\\right) - \\nu'\\log(1 - u \\odot \\mu)\\right],\n\\end{eqnarray*}\\]\n\\(\\odot\\) denotes element--element multiplication , , abuse notation, division log operators work element--element applied vectors.\n* Four factors. \\(\\nu_1 = \\nu_2 = 0 \\Rightarrow\\) \\(w_{1,t}\\) \\(w_{2,t}\\) can stay zero.\n* short-term rate \\(r_t\\) affine combination \\(w_{1,t}\\) \\(w_{2,t}\\) , hence can stay zero. Specification: \\(r_t = \\omega'w_t = \\omega_{1} w_{1,t} + \\omega_{2} w_{2,t}\\).\n* \\(w_{3,t}\\) \\(w_{4,t}\\) Granger-cause \\(r_t\\) (cause \\(w_{1,t}\\) \\(w_{2,t}\\)) \\(\\Rightarrow\\) \\(h \\ge 2\\) \\(R(t,h)\\) non-zero combination four components \\(w_t\\).\n* (\\(r_t=0\\)) lift-probability depends \\(w_{3,t}\\) \\(w_{4,t}\\).\n* Closed-form solutions lift-probabilities. Based Lemma @ref(lemma:mass}:\n\\[\n\\mathbb{P}_t(\\alpha'w_{t+h}=0) = \\lim_{u \\rightarrow -\\infty} \\varphi_{t,h}(0,\\dots,0,u\\alpha),\n\\]\n\\(\\varphi_{t,h}\\) multi-horizon Laplace transform defined Eq. (1.8), can computed explained Remark XXX. :\n\\[\\begin{equation}\n\\left\\{\n\\begin{array}{l}\n\\mathbb{P}_t(r_{t+h}>0) = 1 - \\lim_{u \\rightarrow -\\infty} \\varphi_{t,h}(0,\\dots,0,u\\omega) \\\\ \\\\\n\\mathbb{P}_t(r_{t+1}=0,\\dots,r_{t+h}=0) = \\lim_{u \\rightarrow -\\infty} \\varphi_{t,h}(u\\omega,\\dots,u\\omega,u\\omega) \\equiv p_{h}\\\\ \\\\\n\\mathbb{P}_t(r_{t+1}=0,\\dots,r_{t+h-1}=0,r_{t+h}>0) = p_{h-1} - p_h.\n\\end{array}\n\\right.\n\\end{equation}\\]\n* lift-probabilities, type \\(\\mathbb{P}_t[R(t+h,k)>threshold]\\), can derived Eq. (1.18).Model estimated Kalman filtering techniques (see Subsection ??).Measurement equations: (levels ) yields, also measurement equations involving:survey-based forecasts yields (see Subsection ?? (e-GARCH-based) proxies conditional variances (see Eq. (1.16)).","code":""}]
