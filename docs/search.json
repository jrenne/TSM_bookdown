[{"path":"index.html","id":"intro","chapter":"Introduction to Term Structure Models","heading":"Introduction to Term Structure Models","text":"Modeling dynamic term structures serves practical indispensable tool realm finance. enables investors, institutions, policymakers make informed decisions, manage risk effectively, allocate resources wisely. understanding interest rates yields evolve time, models offer clear lens assess market trends price financial instruments accurately.course developed Jean-Paul Renne. illustrated R codes using various packages can obtained CRAN. AEC package available GitHub. install , one need employ devtools library:Useful (R) links:Download R:\nR software: https://cran.r-project.org (basic R software)\nRStudio: https://www.rstudio.com (convenient R editor)\nDownload R:R software: https://cran.r-project.org (basic R software)RStudio: https://www.rstudio.com (convenient R editor)Tutorials:\nRstudio: https://dss.princeton.edu/training/RStudio101.pdf (Oscar Torres-Reyna)\nR: https://cran.r-project.org/doc/contrib/Paradis-rdebuts_en.pdf (Emmanuel Paradis)\ntutorial: https://jrenne.shinyapps.io/Rtuto_publiShiny/\nTutorials:Rstudio: https://dss.princeton.edu/training/RStudio101.pdf (Oscar Torres-Reyna)R: https://cran.r-project.org/doc/contrib/Paradis-rdebuts_en.pdf (Emmanuel Paradis)tutorial: https://jrenne.shinyapps.io/Rtuto_publiShiny/","code":"\ninstall.packages(\"devtools\") # in case this library has not been loaded yet\nlibrary(devtools)\ninstall_github(\"jrenne/AEC\")\nlibrary(AEC)"},{"path":"affine-processes.html","id":"affine-processes","chapter":"1 Affine processes","heading":"1 Affine processes","text":"","code":""},{"path":"affine-processes.html","id":"Information","chapter":"1 Affine processes","heading":"1.1 Information in the Economy: The “Factors”","text":"New information date \\(t=1,2,\\dots,T\\): \\(K\\)-dimensional factor \\(w_t\\), state.Information available \\(t\\): \\(\\underline{w_t} = (w_t,w_{t-1},\\dots,w_1)\\).\\(w_t\\): random vector, observable, partially observable, unobservable econometrician.Example 1.1  (Stock option pricing) Stock option pricing: \\(w_t = (y_t, z_t)\\) \n\\(y_t\\): observable vector (geometric) returns,\n\\(z_t\\): regime, unobservable econometrician.\n\\(y_t\\): observable vector (geometric) returns,\\(z_t\\): regime, unobservable econometrician.Term structure interest rates:\\(w_t\\): unobservable factor observable vector yields spreads, macroeconomic variables.","code":""},{"path":"affine-processes.html","id":"Dynamic","chapter":"1 Affine processes","heading":"1.2 Dynamic Models","text":"Aim: modelling dynamics \\(w_t\\) (historical risk-neutral, see Chapter @ref(section:PandQ}).Parametric modelling:\n* Choice family conditional probability density functions \\(f(w_{t+1}|\\underline{w_t},\\theta)\\), \\(\\theta\\) unknown vector \\(\\\\Theta\\).\n* Equivalently, choice conditional Laplace transforms:\n\\[\n\\varphi(u|\\underline{w_t},\\theta) =\n\\mathbb{E}_{\\theta}[\\exp(u'w_{t+1})|\\underline{w_t}], \\quad u \\\\mathbb{R}^K,\n\\]\nconditional log Laplace transforms:\n\\[\n\\psi(u|\\underline{w_t},\\theta) =\n\\log\\{\\mathbb{E}_{\\theta}[\\exp(u'w_{t+1})|\\underline{w_t}]\\}, \\quad u \\\n\\mathbb{R}^K.\n\\]Example 1.2  (Conditionally Bernoulli process) \\(w_{t+1}|\\underline{w_t} \\sim {\\mathcal{}} [p(\\underline{w_t},\\theta)]\\), :\n\\[\n\\varphi(u|w_t)=\n\\mathbb{E}[\\exp(u w_{t+1}) \\mid \\underline{w_t}] = p_t \\exp(u) + 1-p_t\n\\]\n\\(p_t = p(w_t, \\theta)\\).Example 1.3  (Conditionally Bernoulli process) \\(w_{t+1}|\\underline{w_t} \\{\\mathcal{B}}(n, p_t)\\), :\n\\[\n\\varphi(u|w_t)=[p_t   \\exp(u) + 1-p_t]^n.\n\\]Example 1.4  (Conditionally Poisson process) \\(w_{t+1}|\\underline{w_t} \\sim {\\mathcal{P}}(\\lambda_t)\\), :\n\\[\\begin{eqnarray*}\n\\varphi(u|w_t) & =&   \\sum^\\infty_{j=0}  \\dfrac{1}{j!}  \\exp(-\\lambda_t) \\lambda^j_t   \\exp(uj)  = \\exp(-\\lambda_t) exp[\\lambda_t \\exp(u)] \\\\\n& =& \\exp\\{\\lambda_t[\\exp(u)-1]\\}.\n\\end{eqnarray*}\\]Example 1.5  (Conditionally normal (Gaussian) process) \\(w_{t+1}|\\underline{w_t} \\sim \\mathcal{N}\\left(m(\\underline{w_t},\\theta), \\Sigma(\\underline{w_t},\\theta)\\right)\\), :\\[\nu'w_{t+1}|\\underline{w_t} \\sim \\mathcal{N}\\left(u'm(\\underline{w_t},\\theta), u'\\Sigma(\\underline{w_t},\\theta)u\\right).\n\\]\\[\n\\Rightarrow\n\\left\\{\n\\begin{array}{ccc}\n\\varphi(u|\\underline{w_t},\\theta) &=& \\exp\\left[\n\\begin{array}{l} u'm(\\underline{w_t},\\theta)+\n\\frac{1}{2} u'\\Sigma(\\underline{w_t},\\theta)u\\end{array}\n\\right]\\\\\n\\psi(u|\\underline{w_t},\\theta) &=&\nu'm(\\underline{w_t},\\theta) +  \\frac{1}{2}\nu'\\Sigma(\\underline{w_t},\\theta)u.\n\\end{array}\n\\right.\n\\]","code":""},{"path":"affine-processes.html","id":"AffineLaplace","chapter":"1 Affine processes","heading":"1.3 Some Properties of the Laplace Transform","text":"\\(\\varphi(0|\\underline{w_t},\\theta) = 1\\) \\(\\psi(0|\\underline{w_t},\\theta)=0\\).\\(\\varphi(0|\\underline{w_t},\\theta) = 1\\) \\(\\psi(0|\\underline{w_t},\\theta)=0\\).Defined convex set \\(E\\) (containing \\(0\\)).Defined convex set \\(E\\) (containing \\(0\\)).interior \\(E\\) non empty, (conditional) moments exist.interior \\(E\\) non empty, (conditional) moments exist.Scalar case:Scalar case:Moment order \\(n\\):\n\\[\n\\left[ \\begin{array}{l}  \\dfrac{\\partial^n\n\\varphi(u|\\underline{w_t},\\theta)}{\\partial u^n}\n\\end{array} \\right]_{u=0} = \\mathbb{E}_{\\theta}[w^n_{t+1}|\\underline{w_t}].\n\\]Moment order \\(n\\):\n\\[\n\\left[ \\begin{array}{l}  \\dfrac{\\partial^n\n\\varphi(u|\\underline{w_t},\\theta)}{\\partial u^n}\n\\end{array} \\right]_{u=0} = \\mathbb{E}_{\\theta}[w^n_{t+1}|\\underline{w_t}].\n\\]Cumulant order \\(n\\):\n\\[\n\\left[ \\begin{array}{l}  \\dfrac{\\partial^n\n\\psi(u|\\underline{w_t},\\theta)}{\\partial u^n}\n\\end{array} \\right]_{u=0} = K_n(\\underline{w_t},\\theta).\n\\]Cumulant order \\(n\\):\n\\[\n\\left[ \\begin{array}{l}  \\dfrac{\\partial^n\n\\psi(u|\\underline{w_t},\\theta)}{\\partial u^n}\n\\end{array} \\right]_{u=0} = K_n(\\underline{w_t},\\theta).\n\\]particular:\n\\[\n\\left\\{\n\\begin{array}{ccc}\nK_1(\\underline{w_t},\\theta) &=& \\mathbb{E}_{\\theta}[w_{t+1}|\\underline{w_t}]\\\\\nK_2(\\underline{w_t}, \\theta) &=& \\mathbb{V}ar_{\\theta}[w_{t+1}|\\underline{w_t}].\n\\end{array}\n\\right.\n\\]particular:\n\\[\n\\left\\{\n\\begin{array}{ccc}\nK_1(\\underline{w_t},\\theta) &=& \\mathbb{E}_{\\theta}[w_{t+1}|\\underline{w_t}]\\\\\nK_2(\\underline{w_t}, \\theta) &=& \\mathbb{V}ar_{\\theta}[w_{t+1}|\\underline{w_t}].\n\\end{array}\n\\right.\n\\]$ \\(\\psi\\) respectively called conditional moment cumulant generating function.Multivariate case:\n\\[\\begin{eqnarray*}\n\\left[\\begin{array}{l}  \\dfrac{\\partial \\psi}{\\partial\nu} (u|\\underline{w_t},\\theta)  \\end{array} \\right]_{u=0} &=& \\mathbb{E}_{\\theta}[w_{t+1}|\\underline{w_t}] \\\\\n\\left[\\begin{array}{l}  \\dfrac{\\partial^2\n\\psi}{\\partial u\\partial u'} (u|\\underline{w_t},\\theta)  \\end{array}\n\\right]_{u=0} &=& \\mathbb{V}ar_{\\theta}[w_{t+1}|\\underline{w_t}].\n\\end{eqnarray*}\\]Example 1.5  (Conditionally normal (Gaussian) process) See Example 1.5Scalar caseScalar case\\(\\psi(u|\\underline{w_t},\\theta)=u m(\\underline{w_t},\\theta) +  \\frac{1}{2}u^2\\sigma^2(\\underline{w_t},\\theta)\\).\\(\\psi(u|\\underline{w_t},\\theta)=u m(\\underline{w_t},\\theta) +  \\frac{1}{2}u^2\\sigma^2(\\underline{w_t},\\theta)\\).\\(\\left[\\begin{array}{l} \\dfrac{\\partial \\psi}{\\partial u} (u|\\underline{w_t},\\theta) \\end{array} \\right]_{u=0} = m(\\underline{w_t},\\theta)\\).\\(\\left[\\begin{array}{l} \\dfrac{\\partial \\psi}{\\partial u} (u|\\underline{w_t},\\theta) \\end{array} \\right]_{u=0} = m(\\underline{w_t},\\theta)\\).\\(\\left[\\begin{array}{l} \\dfrac{\\partial^2 \\psi}{\\partial u^2} (u|\\underline{w_t},\\theta) \\end{array} \\right]_{u=0} = \\sigma^2(\\underline{w_t},\\theta)\\).\\(\\left[\\begin{array}{l} \\dfrac{\\partial^2 \\psi}{\\partial u^2} (u|\\underline{w_t},\\theta) \\end{array} \\right]_{u=0} = \\sigma^2(\\underline{w_t},\\theta)\\).Multidimensional caseMultidimensional case\\(\\psi(u|\\underline{w_t},\\theta)=u' m(\\underline{w_t},\\theta) +  \\frac{1}{2}u'\\Sigma(\\underline{w_t},\\theta)u\\).\\(\\psi(u|\\underline{w_t},\\theta)=u' m(\\underline{w_t},\\theta) +  \\frac{1}{2}u'\\Sigma(\\underline{w_t},\\theta)u\\).\\(\\left[\\begin{array}{l} \\dfrac{\\partial \\psi}{\\partial u} (u|\\underline{w_t},\\theta) \\end{array} \\right]_{u=0} = m(\\underline{w_t},\\theta)\\).\\(\\left[\\begin{array}{l} \\dfrac{\\partial \\psi}{\\partial u} (u|\\underline{w_t},\\theta) \\end{array} \\right]_{u=0} = m(\\underline{w_t},\\theta)\\).\\(\\left[\\begin{array}{l} \\dfrac{\\partial^2 \\psi}{\\partial u\\partial u'} (u|\\underline{w_t},\\theta) \\end{array} \\right]_{u=0} = \\Sigma(\\underline{w_t},\\theta)\\).\\(\\left[\\begin{array}{l} \\dfrac{\\partial^2 \\psi}{\\partial u\\partial u'} (u|\\underline{w_t},\\theta) \\end{array} \\right]_{u=0} = \\Sigma(\\underline{w_t},\\theta)\\).cases, cumulants order \\(>2\\) equal \\(0\\).cases, cumulants order \\(>2\\) equal \\(0\\).\\(w_t=(w'_{1t},w'_{2t})'\\) \\(, u=(u'_1, u'_2)'\\):\n\\[\\begin{eqnarray*}\n\\mathbb{E}_{\\theta}[\\exp(u'_1 w_{1,t+1}|\\underline{w_t})&=&\\varphi(u_1,0|\\underline{w_t},\\theta)] \\\\\n\\mathbb{E}_{\\theta}[\\exp(u'_2 w\n_{2,t+1}|\\underline{w_t})&=&\\varphi(0,u_2|\\underline{w_t},\\theta)].\n\\end{eqnarray*}\\]\\(w_t=(w'_{1t},w'_{2t})'\\) \\(, u=(u'_1, u'_2)'\\):\n\\[\\begin{eqnarray*}\n\\mathbb{E}_{\\theta}[\\exp(u'_1 w_{1,t+1}|\\underline{w_t})&=&\\varphi(u_1,0|\\underline{w_t},\\theta)] \\\\\n\\mathbb{E}_{\\theta}[\\exp(u'_2 w\n_{2,t+1}|\\underline{w_t})&=&\\varphi(0,u_2|\\underline{w_t},\\theta)].\n\\end{eqnarray*}\\]\\(w_t=(w'_{1t},w'_{2t})'\\), \\(w_{1t}\\) \\(w_{2t}\\) conditionally independent:\n\\[\\begin{eqnarray*}\n\\varphi(u|\\underline{w_t},\\theta) &=&\n\\varphi(u_1,0|\\underline{w_t},\\theta)\\times\\varphi(0,u_2|\\underline{w_t},\\theta) \\\\\n\\psi(u|\\underline{w_t},\\theta) &=&\n\\psi(u_1,0|\\underline{w_t},\\theta)+\\psi(0,u_2|\\underline{w_t},\\theta).\n\\end{eqnarray*}\\]\\(w_t=(w'_{1t},w'_{2t})'\\), \\(w_{1t}\\) \\(w_{2t}\\) conditionally independent:\n\\[\\begin{eqnarray*}\n\\varphi(u|\\underline{w_t},\\theta) &=&\n\\varphi(u_1,0|\\underline{w_t},\\theta)\\times\\varphi(0,u_2|\\underline{w_t},\\theta) \\\\\n\\psi(u|\\underline{w_t},\\theta) &=&\n\\psi(u_1,0|\\underline{w_t},\\theta)+\\psi(0,u_2|\\underline{w_t},\\theta).\n\\end{eqnarray*}\\]\\(w_{1t}\\) \\(w_{2t}\\) size \n\\[\n\\varphi(u_1, u_2|\\underline{w_t},\\theta) = \\mathbb{E}_\\theta[\\exp(u'_1 w_{1, t+1} + u'_2 w_{2,t+1}|\\underline{w_t}],\n\\]\nconditional Laplace transform \\(w_{1, t+1} + w_{2, t+1}\\) given\n\\(\\underline{w_t}\\) \\(\\varphi(u, u|\\underline{w_t},\\theta)\\).\n\\(w_{1t}\\) \\(w_{2t}\\) conditionally independent,\nsize, conditional Laplace transform Log-Laplace\ntransform \\(w_{1,t+1}+w_{2,t+1}\\) respectively:\n\\[\n\\varphi(u,0|\\underline{w_t},\\theta)\\times \\varphi(0,\nu|\\underline{w_t},\\theta)\n\\]\n\n\\[\n\\psi(u,0|\\underline{w_t},\\theta)+ \\psi(0,\nu|\\underline{w_t},\\theta).\n\\]\n\\(w_{1t}\\) \\(w_{2t}\\) size \n\\[\n\\varphi(u_1, u_2|\\underline{w_t},\\theta) = \\mathbb{E}_\\theta[\\exp(u'_1 w_{1, t+1} + u'_2 w_{2,t+1}|\\underline{w_t}],\n\\]\nconditional Laplace transform \\(w_{1, t+1} + w_{2, t+1}\\) given\n\\(\\underline{w_t}\\) \\(\\varphi(u, u|\\underline{w_t},\\theta)\\).\\(w_{1t}\\) \\(w_{2t}\\) conditionally independent,\nsize, conditional Laplace transform Log-Laplace\ntransform \\(w_{1,t+1}+w_{2,t+1}\\) respectively:\n\\[\n\\varphi(u,0|\\underline{w_t},\\theta)\\times \\varphi(0,\nu|\\underline{w_t},\\theta)\n\\]\n\n\\[\n\\psi(u,0|\\underline{w_t},\\theta)+ \\psi(0,\nu|\\underline{w_t},\\theta).\n\\]Lemma 1.1  (Conditional zero probability non-negative processes) \\(w_t\\) univariate nonnegative (conditional)\nLaplace transform \\(\\varphi_t(u) = \\mathbb{E}_t[\\exp(u w_{t+1})]\\) defined\n\\(u \\leq 0\\) \n\\[\n\\mathbb{P}_t(w_{t+1} = 0) = \\lim_{u\\rightarrow - \\infty} \\varphi_t(u).\n\\]Proof. \\(\\varphi_t(u) = \\mathbb{P}_t(w_{t+1} = 0) + \\int_{w_{t+1}> 0} \\exp(u w_{t+1}) d\\mathbb{P}_t(w_{t+1})\\). Lebesgue theorem ensures last integral converges zero \\(u\\) goes \\(-\\infty\\).Lemma 1.2  (Conditional zero probability non-negative multivariate processes) Assume :\n* \\(w_{1,t}\\) valued \\(\\mathbb{R}^{d}\\) (\\(d \\geq 1\\)),\n* \\(w_{2,t}\\) valued \\(\\mathbb{R}^+ = [0, + \\infty )\\),\n* \\(\\mathbb{E}_t \\left[ \\exp \\left( u_1 ' w_{1,t+1} + u_2 w_{2,t+1} \\right) \\right]\\) exists given \\(u_1\\) \\(u_2 \\leq 0\\)., :\n\\[\\begin{equation}\n\\mathbb{E}_t \\left[ \\exp( u_1 ' w_{1,t+1})  \\textbf{1}_{\\{w_{2,t+1} = 0 \\}} \\right] =  \\underset{u_2 \\rightarrow -\\infty}{\\lim} \\mathbb{E}_t \\left[ \\exp( u_1 ' w_{1,t+1} + u_2   w_{2,t+1} )  \\right].\\tag{1.1}\n\\end{equation}\\]Proof. \n\\[\\begin{eqnarray*}\n&&\\underset{u_2 \\rightarrow -\\infty}{\\lim} \\mathbb{E}_t \\left[ \\exp( u_1 ' w_{1,t+1} + u_2   w_{2,t+1} )  \\right] \\\\\n&=& \\mathbb{E}_t \\left[ \\exp( u_1 ' w_{1,t+1})   \\textbf{1}_{\\{w_{2,t+1} = 0 \\}} \\right] +\\\\\n&& \\underset{u_2 \\rightarrow -\\infty}{\\lim}   \\mathbb{E}_t \\left[ \\exp( u_1 ' w_{1,t+1} + u_2   w_{2,t+1} )  \\textbf{1}_{\\{w_{2,t+1} > 0 \\}}  \\right] ,\n\\end{eqnarray*}\\]\nsince second term right-hand side \\(\\exp(u_2 w_{2,t+1}) \\textbf{1}_{\\{w_{2,t+1} > 0 \\}} \\rightarrow 0\\) \\(u_2 \\rightarrow -\\infty\\), relation (1.1) consequence Lebesgue theorem.","code":""},{"path":"affine-processes.html","id":"AffineCar","chapter":"1 Affine processes","heading":"1.4 Affine (or Car) Processes","text":"Definition 1.1  (Affine process order 1) multivariate process \\(w_{t+1}\\) Affine order 1 [\\(Car(1)\\)] \n\\[\n\\varphi_t(u)=\\mathbb{E}_t[\\exp(u'w_{t+1})]=\\exp[(u)'w_t+b(u)]\n\\]\nfunctions \\((.)\\) \\(b(.)\\). functions univariate \\(w_{t+1}\\) (therefore \\(u\\)) scalar.Car stands Compound auto-regressive.\\((.)\\) b(.) may deterministic functions time.Example 1.6  (Univariate AR(1) Gaussian process) \\(w_{t+1}|\\underline{w_t} \\sim \\mathcal{N}(\\nu+\\rho w_t, \\sigma^2)\\), :\n\\[\n\\varphi_t(u) = \\exp\\left(\n\\begin{array}{l}\nu \\rho w_t + u \\nu + u^2  \\frac{\\sigma^2}{2}\n\\end{array}\n\\right) = \\exp[(u)'w_t+b(u)],\n\\]\n\\[\n\\mbox{}\\left\\{\n\\begin{array}{ccc}\n(u) &=& u \\rho\\\\\nb(u) &=& u \\nu + u^2  \\dfrac{\\sigma^2}{2}.\n\\end{array}\n\\right.\n\\]Example 1.7  (Gaussian VAR) \\(w_{t+1}|\\underline{w_t} \\sim \\mathcal{N}(\\mu+\\Phi w_t, \\Sigma)\\), :\n\\[\n\\varphi_t(u) = \\exp\\left(\n\\begin{array}{l}\nu' (\\mu + \\Phi  w_t)  +  \\frac{1}{2} u' \\Sigma u\n\\end{array}\n\\right) = \\exp[(u)'w_t+b(u)],\n\\]\n\\[\n\\mbox{}\\left\\{\n\\begin{array}{ccl}\n(u) &=& \\Phi'u\\\\\nb(u) &=& u' \\mu +  \\frac{1}{2} u' \\Sigma u = u' \\mu + \\frac{1}{2}(u \\otimes u)' vec(\\Sigma).\n\\end{array}\n\\right.\n\\]Example 1.8  (Quadratic Gaussian process) Consider \\(w_t = (x'_t,vec(x_t x_t')')'\\), \\(x_t\\) \\(n\\)-dimensional vector following Gaussian VAR(1), .e.\n\\[\nx_{t+1}|\\underline{w_t} \\sim \\mathcal{N}(\\mu+\\Phi x_t, \\Sigma).\n\\]\n\\(u = (v,V)\\) \\(v \\\\mathbb{R}^n\\) \\(V\\) square symmetric matrix size \\(n\\), :\n\\[\\begin{eqnarray*}\n  \\varphi_t(u) &=& \\mathbb{E}_t\\big\\{\\exp\\big[(v',vec(V)')\\times w_{t+1}\\big]\\big\\} \\\\\n  & =& \\exp \\left\\{a_1(v,V)'x_t +vec(a_2(v,V))' vec(x_t'x_t) + b(v,V) \\right\\},\n  \\end{eqnarray*}\\]\n:\n\\[\\tag{1.2}y*}(#eq:laplaceZ)\n      a_2(u) & = & \\Phi'V (I_n - 2\\Sigma V)^{-1} \\Phi \\nonumber \\\\\n      a_1(u) & = & \\Phi'\\left[(I_n-2V\\Sigma)^{-1}(v+2V\\mu)\\right] \\nonumber \\\\\n      b(u) & = & u'(I_n - 2 \\Sigma V)^{-1}\\left(\\mu + \\frac{1}{2} \\Sigma v\\right) +\\\\\n      && \\mu'V(I_n - 2 \\Sigma V)^{-1}\\mu - \\frac{1}{2}\\log\\big|I_n - 2\\Sigma V\\big|.\n  \\end{eqnarray*}\\]\n\\(u = (v,V)\\) \\(v \\\\mathbb{R}^n\\) \\(V\\) square symmetric matrix size \\(n\\), :\n\\[\\begin{eqnarray*}\n  \\varphi_t(u) &=& \\mathbb{E}_t\\big\\{\\exp\\big[(v',vec(V)')\\times w_{t+1}\\big]\\big\\} \\\\\n  & =& \\exp \\left\\{a_1(v,V)'x_t +vec(a_2(v,V))' vec(x_t'x_t) + b(v,V) \\right\\},\n  \\end{eqnarray*}\\]\n:\n\\[\\tag{1.2}y*}(#eq:laplaceZ)\n      a_2(u) & = & \\Phi'V (I_n - 2\\Sigma V)^{-1} \\Phi \\nonumber \\\\\n      a_1(u) & = & \\Phi'\\left[(I_n-2V\\Sigma)^{-1}(v+2V\\mu)\\right] \\nonumber \\\\\n      b(u) & = & u'(I_n - 2 \\Sigma V)^{-1}\\left(\\mu + \\frac{1}{2} \\Sigma v\\right) +\\\\\n      && \\mu'V(I_n - 2 \\Sigma V)^{-1}\\mu - \\frac{1}{2}\\log\\big|I_n - 2\\Sigma V\\big|.\n  \\end{eqnarray*}\\]Proof. :\n\\[\\begin{eqnarray*}\n&&\\mathbb{E}_t(\\exp(v' x_{t+1} + vec(V)'vec(x_{t+1} x_{t+1}'))) \\\\\n&=& \\mathbb{E}_t[\\exp(v' (\\mu + \\Phi x_t + \\Sigma^{1/2}\\varepsilon_{t+1}) + \\\\\n&& vec(V)'vec((\\mu + \\Phi x_t + \\Sigma^{1/2}\\varepsilon_{t+1}) (\\mu + \\Phi x_t + \\Sigma^{1/2}\\varepsilon_{t+1})'))] \\\\\n&=& \\exp[v' (\\mu + \\Phi x_t) + vec(V)'vec\\{(\\mu + \\Phi x_t)(\\mu + \\Phi x_t)'\\}] \\times \\\\\n&& \\mathbb{E}_t[\\exp(v'\\Sigma^{1/2}\\varepsilon_{t+1} +2\\underbrace{ vec(V)' vec\\{(\\mu + \\Phi x_t)(\\varepsilon_{t+1}'{\\Sigma^{1/2}}')\\}}_{=(\\mu + \\Phi x_t)'V\\Sigma^{1/2}\\varepsilon_{t+1}} +\\\\\n&& \\underbrace{vec(V)'vec\\{(\\Sigma^{1/2}\\varepsilon_{t+1})(\\Sigma^{1/2}\\varepsilon_{t+1})'}_{=\\varepsilon_{t+1}'{\\Sigma^{1/2}}'V\\Sigma^{1/2}\\varepsilon_{t+1}}\\}]\n\\end{eqnarray*}\\]\nLemma @ref(lemma:Quadr} can used compute previous conditional expectation, \\(\\lambda = {\\Sigma^{1/2}}'(v + 2 V'(\\mu + \\Phi x_t))\\). algebra leads result.Example 1.9  (Autoregressive gamma process, ARG(1)) ARG process defined follows:\n\\[\n\\frac{w_{t+1}}{\\mu} \\sim \\gamma(\\nu+z_t) \\quad \\mbox{} \\quad z_t \\sim \\mathcal{P} \\left( \\frac{\\rho w_t}{\\mu} \\right),\n\\]\n\\(\\nu\\), \\(\\mu\\), \\(\\rho > 0\\). (Alternatively \\(z_t \\sim {\\mathcal{P}}(\\beta w_t)\\), \\(\\rho = \\beta \\mu\\).):\n\\(\\varphi_t(u) = exp \\left[ \\begin{array}{l}  \\dfrac{\\rho u}{1-u \\mu} w_t - \\nu \\log(1-u \\mu)\\end{array} \\right], u < \\dfrac{1}{\\mu}\\).: \\(\\varphi_t(u) = \\exp[(u)'w_t+b(u)]\\) \n\\[\n\\left\\{\n\\begin{array}{ccc}\n(u) &=&  \\dfrac{\\rho u}{1-u \\mu}\\\\\nb(u) &=& -\\nu  \n\\log(1-u \\mu).\n\\end{array}\n\\right.\n\\]Proof. Given \\(\\underline{w_t}\\), \\(z_t \\sim {\\mathcal P}\\left( \\begin{array}{l} \\frac{\\rho w_t} {\\mu} \\end{array}\\right)\\). :\n\\[\\begin{eqnarray*}\n\\mathbb{E}[\\exp(u w_{t+1})|\\underline{w_t}] &=& \\mathbb{E}\\left\\{\\mathbb{E}\\left[\\exp \\left(u \\mu  \\frac{w_{t+1}}{\\mu}\\right)|\\underline{w_t}, \\underline{z}_t\\right]\\underline{w_t}\\right\\}\\\\\n&=& \\mathbb{E}[(1-u\\mu)^{-(\\nu+z_t)}|\\underline{w_t}] \\\\\n&=& (1-u\\mu)^{-\\nu}\\mathbb{E}\\{\\exp[-z_t   \\log(1-u\\mu)]|\\underline{w_t}\\} \\\\\n&=& (1-u\\mu)^{-\\nu} \\exp \\left\\{\\frac{\\rho w_t}{\\mu}[\\exp(-\\log(1-u\\mu)] -  \\frac{\\rho w_t}{\\mu}\\right\\}\\\\\n&=& exp\\left[ \\begin{array}{l}  \\frac{\\rho u w_t}{1-u\\mu} - \\nu   \\log(1-u\\mu)  \\end{array}\\right],\n\\end{eqnarray*}\\]\nusing fact L.T. \\(\\gamma(\\nu)\\) \\((1-u)^{-\\nu}\\)\nL.T. \\({\\mathcal P}(\\lambda)\\) \\(\\exp[\\lambda(exp(u)-1)]\\).Web-interface illustration (“ARG” panel)positive process.:\n\\[\n  \\left\\{\n  \\begin{array}{ccc}\n  \\mathbb{E}(w_{t+1}|\\underline{w_t}) &=& \\nu \\mu + \\rho w_t \\\\\n  \\mathbb{V}ar(w_{t+1}|\\underline{w_t}) &=& \\nu \\mu^2 + 2 \\mu \\rho w_t.\n  \\end{array}\n  \\right.\n  \\]:\n\\[\n  w_{t+1}=\\nu\\mu+\\rho w_t+\\varepsilon_{t+1},\n  \\]\n\\(\\varepsilon_{t+1}\\) martingale difference \\(\\Rightarrow\\) \\(w_{t+1}\\) weak \\(AR(1)\\).\n\\(ARG_0(1)\\) process (Monfort et al. 2017): \\(\\nu = 0\\) \\(\\beta w_t\\) replaced \\(\\alpha + \\beta w_t\\), .e.:\n\\[\\begin{equation}\n  \\frac{w_{t+1}}{\\mu} \\sim \\gamma(z_t),\\quad z_t \\sim {\\mathcal{P}}(\\alpha + \\beta w_t)\\tag{1.3}\n  \\end{equation}\\]\n\\[\n  \\Rightarrow \\varphi_t(u) = exp \\left[\\frac{\\beta \\mu u}{1-u \\mu} w_t + \\frac{\\alpha \\mu u}{1-u \\mu}\n\\right].\n\\]\nPoint mass zero conditional probability \\(exp(-\\alpha - \\beta w_t)\\), 0 absorbing \\(\\alpha = 0\\).\n\\(ARG_0(1)\\) process (Monfort et al. 2017): \\(\\nu = 0\\) \\(\\beta w_t\\) replaced \\(\\alpha + \\beta w_t\\), .e.:\n\\[\\begin{equation}\n  \\frac{w_{t+1}}{\\mu} \\sim \\gamma(z_t),\\quad z_t \\sim {\\mathcal{P}}(\\alpha + \\beta w_t)\\tag{1.3}\n  \\end{equation}\\]\n\\[\n  \\Rightarrow \\varphi_t(u) = exp \\left[\\frac{\\beta \\mu u}{1-u \\mu} w_t + \\frac{\\alpha \\mu u}{1-u \\mu}\n\\right].\n\\]\nPoint mass zero conditional probability \\(exp(-\\alpha - \\beta w_t)\\), 0 absorbing \\(\\alpha = 0\\).\nFigure 1.1: Simulation ARG0 processes.\nExample 1.10  (Compound Poisson process) Consider following process:\n\\[\\frac{w_{t+1}}{\\gamma} = z_{t+1} + \\varepsilon_{t+1},\n\\]\n:\n* \\(z_{t+1}\\) \\(\\varepsilon_{t+1}\\) conditionally independent,\n* \\(z_{t+1} \\sim {\\mathcal B} \\left( \\begin{array}{l}  \\frac{w_t}{\\gamma}, \\pi \\end{array} \\right)\\),\n* \\(\\varepsilon_{t+1} \\sim {\\mathcal P}(\\lambda)\\),\n* \\(\\gamma > 0\\), \\(0 < \\pi< 1\\), \\(\\lambda > 0\\).process valued \\(\\{j \\gamma, j \\\\mathbb{N}, \\gamma \\\\mathbb{R}^+\\}\\) :\n\\[\n\\varphi_t(u) = exp\\left\\{\n\\begin{array}{l}\n\\dfrac{w_t}{\\gamma}   \\log[\\pi  \nexp(u\\gamma)+1-\\pi]-\\lambda[1-exp(u \\gamma)]\n\\end{array}\n\\right\\},\n\\]\n\n\\[\n\\left\\{\n\\begin{array}{ccl}\n(u)&=& \\frac{1}{\\gamma}   \\log[\\pi   \\exp(u\n\\gamma)+1-\\pi],\\\\\nb(u) &=& -\\lambda[1-exp(u \\gamma)].\n\\end{array}\n\\right.\n\\]: \\(w_{t+1} = \\pi w_t + \\lambda \\gamma + \\eta_{t+1}\\), \\(\\eta_{t+1}\\) \nmartingale difference.Web-interface illustration (“Compound Poisson” panel)\nFigure 1.2: Simulation Compound Poisson process.\n","code":"\nlibrary(TSModels)\nW <- simul.ARG(300,mu=.5,nu=0,rho=.9,alpha=.1)\nplot(W,type=\"l\")\nlibrary(TSModels)\nW <- simul.compound.poisson(100,Gamma=.5,Pi=0.5,lambda=.9)\nplot(W,type=\"l\")"},{"path":"affine-processes.html","id":"CarProcesses","chapter":"1 Affine processes","heading":"1.5 Affine (or Car) processes","text":"Definition 1.2  (Affine process order p) multivariate process \\(w_{t+1}\\) affine order \\(p\\) [\\(Car(p)\\)] \n\\[\n\\varphi_t(u)=\\mathbb{E}_t[\\exp(u' w_{t+1})]=\\exp[a_1(u)'w_t+\\dots+a_p(u)'w_{t+1-p}+b(u)].\n\\]Remarks:\\(w_t\\) \\(Car(p)\\), \\(W_t = [w_t', w_{t-1}',\\dots,w_{t-p+1}']'\\) \\(Car(1)\\).\\(w_t\\) \\(Car(p)\\), \\(W_t = [w_t', w_{t-1}',\\dots,w_{t-p+1}']'\\) \\(Car(1)\\).Without loss generality can assume \\(p = 1\\).Without loss generality can assume \\(p = 1\\).Proof. :\n\\[\\begin{eqnarray*}\n\\mathbb{E}_t[\\exp(u'W_{t+1})] &=& \\mathbb{E}_t[\\exp(u'_1 w_{t+1}+u'_2 w_t+\\dots+u'_p w_{t-p+2})] \\\\\n&=& \\exp(u'_2 w_t+\\dots+u'_p w_{t-p+2})\\mathbb{E}_t[\\exp(u'_1 w_{t+1})] \\\\\n&=& \\exp(u'_2 w_t+\\dots+u'_p w_{t-p+2}+'_1(u_1)\nw_t  +\\dots+'_p(u_1)w_{t+1-p}+b(u_1)) \\\\\n&=& \\exp[(u)'W_t+B(u)],\n\\end{eqnarray*}\\]\\((u)' = [u'_2+'_1(u_1),\\dots,u'_p+'_{p-1}(u_1), '_p(u_1)]\\) \\(B(u) = b(u_1)\\).","code":""},{"path":"affine-processes.html","id":"an-important-particular-case","chapter":"1 Affine processes","heading":"1.5.1 An important particular case","text":"Definition 1.3  (Univariate Index Affine order p) Let \\(exp[(u)w+b(u)]\\) L.T. univariate Affine process order 1, process \\(w_{t+1}\\) {} process order \\(p\\) :\n\\[\n\\varphi_t(u)=\\mathbb{E}_t[\\exp(u w_{t+1})]=\\exp[(u)(\\beta_1 w_t+\\dots+\\beta_p\nw_{t+1-p})+b(u)].\n\\]Example 1.11  (Gaussian AR(p) process) Extends Example 1.6\n\\[\\begin{eqnarray*}\n\\varphi_t(u) &=& \\exp \\left[ u \\rho (\\beta_1 w_t+\\dots+\\beta_p w_{t+1-p})+u\\nu + u^2  \\frac{\\sigma^2}{2}\\right]\\\\\nw_{t+1} &=& \\nu + \\varphi_1 w_t +\\dots+ \\varphi_p w_{t+1-p}+\\sigma \\varepsilon_{t+1},\\quad \\varepsilon_{t+1} \\sim ..d. \\mathcal{N}(0,1),\n\\end{eqnarray*}\\]\n\\(\\varphi_i = \\rho \\beta_i\\).Example 1.12  (ARG(p) process (positive)) Extends Example 1.9\\[\\begin{eqnarray*}\n\\varphi_t(u) &=& \\exp\\left[\\frac{\\rho u}{1-u \\mu} (\\beta_1 w_t+\\dots+\\beta_p w_{t+1-p})-\\nu  \\log(1-u\\mu)\\right],\\\\\nw_{t+1} &=& \\nu\\mu + \\varphi_1 w_t +\\dots+ \\varphi_p w_{t+1-p}+\\varepsilon_{t+1},\n\\end{eqnarray*}\\]\n\\(\\varphi_i = \\rho \\beta_i\\) \\(\\varepsilon_{t+1}\\) martingale difference.","code":""},{"path":"affine-processes.html","id":"Markov","chapter":"1 Affine processes","heading":"1.6 Affine (or Car) processes, Markov Chains","text":"NotationsNotations\\(e_j\\) denotes \\(j^{th}\\) column \\(Id_J\\), \\(j=1,\\dots,J\\).\\(e_j\\) denotes \\(j^{th}\\) column \\(Id_J\\), \\(j=1,\\dots,J\\).\\(\\pi(e_i, e_j) = \\mathbb{P}(z_{t+1}=e_j | z_t=e_i)\\).\\(\\pi(e_i, e_j) = \\mathbb{P}(z_{t+1}=e_j | z_t=e_i)\\).notations:\n\\[\n\\mathbb{E}[\\exp(v'z_{t+1})|z_t=e_i,\\underline{z_{t-1}}] = \\sum^J_{j=1} \\exp(v'e_j)\\pi (e_i, e_j),\n\\]notations:\n\\[\n\\mathbb{E}[\\exp(v'z_{t+1})|z_t=e_i,\\underline{z_{t-1}}] = \\sum^J_{j=1} \\exp(v'e_j)\\pi (e_i, e_j),\n\\]:\n\\[\n\\varphi_t(v) = exp[a_z(v)'z_t],\n\\]\n\n\\[\na_z(v)= \\left[ \\begin{array}{l} \\log \\left(\n\\begin{array}{l}  \\sum^J_{j=1} \\exp(v'e_j)  \\pi(e_1,\ne_j) \\end{array} \\right)\\\\\n\\vdots\\\\\n\\log \\left(\n\\begin{array}{l}  \\sum^J_{j=1} \\exp(v'e_j)  \\pi(e_J,\ne_j) \\end{array} \\right)\n\\end{array}\\right].\n\\]:\n\\[\n\\varphi_t(v) = exp[a_z(v)'z_t],\n\\]\n\n\\[\na_z(v)= \\left[ \\begin{array}{l} \\log \\left(\n\\begin{array}{l}  \\sum^J_{j=1} \\exp(v'e_j)  \\pi(e_1,\ne_j) \\end{array} \\right)\\\\\n\\vdots\\\\\n\\log \\left(\n\\begin{array}{l}  \\sum^J_{j=1} \\exp(v'e_j)  \\pi(e_J,\ne_j) \\end{array} \\right)\n\\end{array}\\right].\n\\]Web-interface illustration (“Markov-Switching” panel)","code":""},{"path":"affine-processes.html","id":"stoch","chapter":"1 Affine processes","heading":"1.7 AFFINE (OR Car) PROCESSES, Stochastic parameters univariate affine processes","text":"univariate affine dynamics based :\n\\[\n\\mathbb{E}_t   \\exp(u y_{t+1}) = \\exp[a_0(u)y_t+b_0(u)\\delta],\n\\]\n\\(\\delta = (\\delta_1,\\dots,\\delta_m)' \\\\mathcal{D}\\), can generalized case stochastic \\(\\delta\\).univariate affine dynamics based :\n\\[\n\\mathbb{E}_t   \\exp(u y_{t+1}) = \\exp[a_0(u)y_t+b_0(u)\\delta],\n\\]\n\\(\\delta = (\\delta_1,\\dots,\\delta_m)' \\\\mathcal{D}\\), can generalized case stochastic \\(\\delta\\).precisely assuming:\n\\[\n\\mathbb{E}[\\exp(u y_{t+1})|\\underline{y_t}, \\underline{z_{t+1}}] = \\exp[a_0(u)y_t+b_0(u)'\\Lambda z_{t+1}],\n\\]\n\\(\\Lambda\\) \\((m\\times k)\\) matrix, \\(\\Lambda z_{t+1} \\\\mathcal{D}\\), :\n\\[\n\\mathbb{E}[\\exp(v' z_{t+1})|\\underline{y_t}, \\underline{z_{t}}] = \\exp[a_1(v)'z_t+b_1(v)],\n\\]\n\\(\\Rightarrow\\) \\(w_{t+1} = (y_{t+1}, z'_{t+1})'\\) affine.precisely assuming:\n\\[\n\\mathbb{E}[\\exp(u y_{t+1})|\\underline{y_t}, \\underline{z_{t+1}}] = \\exp[a_0(u)y_t+b_0(u)'\\Lambda z_{t+1}],\n\\]\n\\(\\Lambda\\) \\((m\\times k)\\) matrix, \\(\\Lambda z_{t+1} \\\\mathcal{D}\\), :\n\\[\n\\mathbb{E}[\\exp(v' z_{t+1})|\\underline{y_t}, \\underline{z_{t}}] = \\exp[a_1(v)'z_t+b_1(v)],\n\\]\n\\(\\Rightarrow\\) \\(w_{t+1} = (y_{t+1}, z'_{t+1})'\\) affine.Proof. :\n\\[\\begin{eqnarray*}\n&&\\mathbb{E}[\\exp(u y_{t+1}+v'z_{t+1})|\\underline{y_t}, \\underline{z_{t}}] \\\\\n&=& \\mathbb{E}\\{\\exp(v' z_{t+1})\\mathbb{E}[\\exp(u y_{t+1})|\\underline{y_t},\n\\underline{z_{t+1}}]|\\underline{y_t}, \\underline{z_{t}} \\} \\\\\n&=& \\mathbb{E}\\{\\exp[a_0(u) y_{t}+b_0(u)'\\Lambda z_{t+1}+v'z_{t+1}]|\\underline{y_t},\n\\underline{z_{t}} \\} \\\\\n&=& \\exp\\{ a_0(u) y_{t}+a_1[\\Lambda' b_0(u)+v]'z_t+b_1 [\\Lambda' b_0(u)+v]\\}.\n\\end{eqnarray*}\\]Example 1.13  (Gaussian AR(p)) Extends Example 1.11Notations: \\(b_0(u) = \\left(u, \\; \\frac{u^2}{2}\\right)'\\) \\(\\delta = (\\nu,\\sigma^2)' \\\\mathcal{D}=\\mathbb{R} \\times \\mathbb{R}^+\\).Notations: \\(b_0(u) = \\left(u, \\; \\frac{u^2}{2}\\right)'\\) \\(\\delta = (\\nu,\\sigma^2)' \\\\mathcal{D}=\\mathbb{R} \\times \\mathbb{R}^+\\).\\(\\delta\\) (vector conditional mean variance) can replaced …\\(\\delta\\) (vector conditional mean variance) can replaced …\\(\\left( \\begin{array}{l} z_{1,t+1} \\\\ z_{2,t+1} \\end{array} \\right)\\), \\(z_{1,t+1}\\) \\(z_{2,t+1}\\) independent AR(1) –see Example 1.6– \nARG(1) –see Example 1.9– processes respectively.\\(\\left( \\begin{array}{l} z_{1,t+1} \\\\ z_{2,t+1} \\end{array} \\right)\\), \\(z_{1,t+1}\\) \\(z_{2,t+1}\\) independent AR(1) –see Example 1.6– \nARG(1) –see Example 1.9– processes respectively.\\(\\left( \\begin{array}{ll} \\lambda'_1 & 0 \\\\ 0 & \\lambda'_2 \\end{array} \\right)\\)\\(\\left( \\begin{array}{l} z_{1,t+1} \\\\ z_{2,t+1} \\end{array} \\right)\\), \\(z_{1,t+1}\\) \\(z_{2,t+1}\\) \nindependent Markov\nchains.\\(\\left( \\begin{array}{ll} \\lambda'_1 & 0 \\\\ 0 & \\lambda'_2 \\end{array} \\right)\\)\\(\\left( \\begin{array}{l} z_{1,t+1} \\\\ z_{2,t+1} \\end{array} \\right)\\), \\(z_{1,t+1}\\) \\(z_{2,t+1}\\) \nindependent Markov\nchains.\\(\\left( \\begin{array}{l} \\lambda'_1 \\\\ \\lambda'_2 \\end{array}\\right)z_{t+1}\\), \\(z_{t+1}\\) Markov chai.\\(\\left( \\begin{array}{l} \\lambda'_1 \\\\ \\lambda'_2 \\end{array}\\right)z_{t+1}\\), \\(z_{t+1}\\) Markov chai.Example 1.12  (ARG(p) model) \\(b_0(u)= - \\nu \\log(1-u\\mu)\\), \\(\\delta=\\nu\\).\\(\\nu\\) (\\(\\ge 0\\)) can specified instance Markov chain ARG.","code":""},{"path":"affine-processes.html","id":"buildingmulti","chapter":"1 Affine processes","heading":"1.8 AFFINE (OR Car) PROCESSES, Building Multivariate Affine Processes","text":"Recursive approach (bivariate case): \\(w_t = \\left(\\begin{array}{c} w_{1,t}\\\\ w_{2,t} \\end{array} \\right)\\).Assume :\n\\[\\begin{eqnarray*}\n&&\\mathbb{E}[\\exp(u_1 w_{1,t+1}|\\underline{w_{1,t}}, \\underline{w_{2,t}})]\\\\\n&=& \\exp[a_{11}(u_1)w_{1,{\\color{red}{t}}}+a_{12}(u_1)w_{2,{\\color{red}{t}}}+b_{1}(u_1)],\n\\end{eqnarray*}\\]\n:\n\\[\\begin{eqnarray*}\n&& \\mathbb{E}[\\exp(u_2 w_{2,t+1}|\\underline{w_{1,t+1}}, \\underline{w_{2,t}})]\\\\\n&= & \\exp[a_0(u_2)w_{1,{\\color{red}{t+1}}}+a_{21}(u_2)w_{1,{\\color{red}{t}}}+a_{22}(u_2)w_{2,{\\color{red}{t}}}+b_2(u_2)].\n\\end{eqnarray*}\\]\\(\\Rightarrow\\) \\(w_t\\) affine process.Proof. :\n\\[\\begin{eqnarray*}\n&& \\mathbb{E}[\\exp(u_1 w_{1,t+1}+u_2 w_{2,t+1}|\\underline{w_{1,t}}, \\underline{w_{2,t}})]\\\\\n&= & \\mathbb{E}\\{\\exp(u_1 w_{1,t+1}) \\mathbb{E}[\\exp(u_{2}w_{2,t+1})|\\underline{w_{1,t+1}}, \\underline{w_{2,t}})]|\\underline{w_{1,t}}, \\underline{w_{2,t}})\\} \\\\\n&= & \\mathbb{E}\\{\\exp[u_1+a_0(u_2)w_{1,t+1}+a_{21}(u_2)w_{1,t} + a_{22}(u_2)w_{2,t}+b_2(u_2)]|\\underline{w_{1,t}}, \\underline{w_{2,t}})\\} \\\\\n&= & \\exp\\{a_{11}[u_1+a_0(u_2)]w_{1,t}+a_{12}[u_1+a_0(u_2)]w_{2,t}+b_1[u_1+a_0(u_2)] \\\\\n&&+  a_{21}(u_2)w_{1,t}+a_{22}(u_2)w_{2,t}+b_2(u_2)\\}.\n\\end{eqnarray*}\\]dynamics two components \\(w_t\\) form:\n\\[\\begin{eqnarray*}\nw_{1,t+1} &=& \\alpha_1 \\hspace{1.55cm} + \\alpha_{11}w_{1,t} + \\alpha_{12}w_{2,t} + \\varepsilon_{1,t+1} \\\\\nw_{2,t+1} &=& \\alpha_2 + \\alpha_{0}w_{1,t+1} + \\alpha_{21}w_{1,t} + \\alpha _{22} w_{2,t} + \\varepsilon_{2,t+1}\n\\end{eqnarray*}\\]\\(\\varepsilon_{1,t+1}\\) \\(\\varepsilon_{2,t+1}\\) non-correlated (conditionally heteroskedastic) martingale differences.Multivariate \\(AR\\) \\(VAR\\) models, multivariate \\(ARG\\) \n\\(VARG\\) models.","code":""},{"path":"affine-processes.html","id":"WAR","chapter":"1 Affine processes","heading":"1.9 AFFINE (OR Car) PROCESSES, Wishart autoregressive (WAR) processes","text":"WAR valued space \\((L \\times L)\\) symmetric positive\ndefinite matrices.Let \\(W_{t+1}\\) \\(WAR_L(K, M, \\Omega)\\) process. defined :\n\\[\\begin{eqnarray}\n&&\\mathbb{E}[\\exp   Tr(\\Gamma W_{t+1})|\\underline{W_t}] \\tag{1.4}\\\\\n&=& \\exp\\left\\{Tr[M'\\Gamma(Id-2\\Omega \\Gamma)^{-1}M W_t]  -  \\frac{K}{2}   \\log [det(Id-2\\Omega \\Gamma)]\\right\\}, \\nonumber\n\\end{eqnarray}\\]\n:\\(\\Gamma\\) symmetric matrix.Indeed, \\(Tr(\\Gamma W_{t+1})\\) equal :\n\\[\\begin{eqnarray*}\n\\sum^L_{=1}(\\Gamma W_{t+1})_{ii} = \\sum^L_{=1}  \\sum^L_{j=1} \\gamma_{ij} W_{t+1,ij} = \\sum^L_{=1} \\gamma_{ii} W_{t+1,ii} + \\sum^L_{<j} (\\gamma_{ij}+\\gamma_{ji}) W_{t+1,ij}.\n\\end{eqnarray*}\\]\\(K\\) positive scalar,\\(K\\) positive scalar,\\(M\\) \\((L \\times L)\\) matrix,\\(M\\) \\((L \\times L)\\) matrix,\\(\\Omega\\) \\((L \\times L)\\) symmetric positive definite matrix.\\(\\Omega\\) \\((L \\times L)\\) symmetric positive definite matrix.\\(K\\) integer, \\(W_{t+1}\\) obtained :\n\\[\\begin{eqnarray*}\n\\left\\{\n\\begin{array}{ccl}\nW_{t+1} & =&  \\sum^K_{k=1} x_{k,t+1} x'_{k,t+1}\\\\\n&&\\\\\nx_{k,t+1} & =& M x_{k,t} + \\varepsilon_{k,t+1},\\quad k \\\\{1,\\dots,K\\},\n\\end{array}\n\\right.\n\\end{eqnarray*}\\]\n\\(\\varepsilon_{k,t+1} \\sim ..d. \\mathcal{N}(0, \\Omega)\\) (independent across \\(k\\)’s).\\(K\\) integer, \\(W_{t+1}\\) obtained :\n\\[\\begin{eqnarray*}\n\\left\\{\n\\begin{array}{ccl}\nW_{t+1} & =&  \\sum^K_{k=1} x_{k,t+1} x'_{k,t+1}\\\\\n&&\\\\\nx_{k,t+1} & =& M x_{k,t} + \\varepsilon_{k,t+1},\\quad k \\\\{1,\\dots,K\\},\n\\end{array}\n\\right.\n\\end{eqnarray*}\\]\n\\(\\varepsilon_{k,t+1} \\sim ..d. \\mathcal{N}(0, \\Omega)\\) (independent across \\(k\\)’s).:\n\\[\n\\mathbb{E}(W_{t+1}|\\underline{W_t}) = MW_tM'+K \\Omega,\n\\]\n.e. \\(W_t\\) follows matrix weak AR(1).:\n\\[\n\\mathbb{E}(W_{t+1}|\\underline{W_t}) = MW_tM'+K \\Omega,\n\\]\n.e. \\(W_t\\) follows matrix weak AR(1).Proof. \\(K=1\\), \\(W_{t+1}=x_{t+1} x'_{t+1}\\), \\(x_{t+1} = M x_t + \\Omega^{1/2} u_{t+1}\\) \\(u_{t+1} \\sim ..d. \\mathcal{N}(0,Id_L)\\). :\n\\[\n\\mathbb{E}[\\exp(Tr \\Gamma W_{t+1})|\\underline{w_t}] = \\mathbb{E}\\{\\mathbb{E}[\\exp(Tr \\Gamma x_{t+1} x'_{t+1})|\\underline{x}_t]|\\underline{w_t}\\}\n\\]\n:\n\\[\\begin{eqnarray*}\n&& \\mathbb{E}[\\exp(Tr \\Gamma x_{t+1}x'_{t+1})|\\underline{x}_t] = \\mathbb{E}[\\exp(x'_{t+1}\\Gamma x_{t+1}|\\underline{x}_t] \\\\\n&=& \\mathbb{E}[\\exp(M x_t + \\Omega^{1/2} u_{t+1})'\\Gamma(M x_t + \\Omega^{1/2} u_{t+1})/x_t] \\\\\n&=& \\exp(x'_tM'\\Gamma M x_t)\\mathbb{E}[\\exp(2 x'_t M'\\Gamma \\Omega^{1/2}\nu_{t+1}+u'_{t+1}\\Omega^{1/2} \\Gamma \\Omega^{1/2} u_{t+1})/x_t] \\\\\n&=&  \\frac{exp(x'_tM'\\Gamma M x_t)}{(2\\pi)^{L/2}} \\times \\\\\n&& \\int_{\\mathbb{R}^L} \\exp\\left[2x'_tM'\\Gamma\n\\Omega^{1/2}u_{t+1}-u'_{t+1}\\left(\n\\frac{1}{2} Id_L-\\Omega^{1/2} \\Gamma \\Omega^{1/2}\\right)u_{t+1}\\right]  du_{t+1}.\n\\end{eqnarray*}\\]\nUsing Lemma 1.4 \\(\\mu' = 2 x'_t M'\\Gamma \\Omega^{1/2}, Q =  \\frac{1}{2} Id_L-\\Omega^{1/2}\\Gamma\\Omega^{1/2}\\) \\\nalgebra, RHS becomes:\n\\[\n\\frac{exp[x'_tM'\\Gamma(Id_L-2\\Omega\\Gamma)^{-1}M\nx_t]}{det[Id_L-2\\Omega^{1/2}\\Gamma\\Omega^{1/2}]} =  \\frac{exp Tr[M'\\Gamma(Id_L-2\\Omega^{-1}]M\nW_t]}{det[Id_L-2\\Omega \\Gamma]^{1/2}},\n\\]\ndepends \\(x_t\\) \\(W_t\\), gives result \n\\(K=1\\); result \\(K\\) integer follows.Particular case: \\(L=1\\) (univariate).\n\\[\\begin{eqnarray*}\n\\mathbb{E}[\\exp(u W_{t+1})|\\underline{W_t}] = \\exp\\left[\n\\frac{u m^2}{1-2\\omega u}W_t -\n\\frac{K}{2}   \\log(1-2\\omega u)\\right]\n\\end{eqnarray*}\\]\n\\(\\Leftrightarrow\\) \\(ARG(1)\\) process (Example 1.9) \\(\\rho = m^2\\), \\(\\mu = 2\\omega\\), \\(\\nu = \\frac{K}{2}\\).","code":""},{"path":"affine-processes.html","id":"affine-or-car-processes-multivariate-stochastic-parameters-processes","chapter":"1 Affine processes","heading":"1.10 AFFINE (OR Car) PROCESSES, Multivariate Stochastic Parameters Processes","text":"Consider framework Section 1.7 \\(y_t\\) \\(n\\)-dimensional vector. proof shows \\(w_{t+1}=(y_{t+1}',z_{t+1}')'\\) affine.Example 1.14  (Stochastic parameters Gaussian VAR(1)) Extends Example 1.7Using notations Example 1.7 Section 1.7, \n\\[\nb_0(u) = \\left(u', \\frac{1}{2} (u \\otimes u)'\\right)' \\quad \\mbox{} \\quad\\delta = (\\mu', vec(\\Sigma)')' \\\\mathbb{R}^n \\times vec(\\mathcal{S}),\n\\]\n\\(\\mathcal{S}\\) set symmetric positive semi-definite matrices. \\(\\delta\\) can replaced :\\(\\left( \\begin{array}{l} z_{1,t+1} \\\\ z_{2,t+1} \\end{array} \\right)\\),\n\\(z_{1,t+1}\\) , instance, Gaussian VAR process \\(z_{2,t+1}\\) obtained applying \\(vec\\) operator Wishart process, replaced \\(\\Lambda_2 z_{2,t+1}\\), \\(\\Lambda_2\\) \\((n^2 \\times J)\\) matrix whose columns \\(vec(\\Sigma_j)\\), \\(j \\\\{1,\\dots,J\\}\\), \\(\\Sigma_j\\) \\((n \\times n)\\) positive semi-definite, \\(z_{2,t+1}\\) , instance, standardized \\(J\\)-dimensional VARG process (multivariate extension Example 1.9).Example 1.14  (Stochastic parameters Gaussian VAR(1)) Extends Example 1.7.\\(\\left( \\begin{array}{ll} \\Lambda_1 & 0 \\\\ 0 & \\Lambda_2 \\end{array} \\right)\\)\\(\\left( \\begin{array}{l} z_{1,t+1} \\\\ z_{2,t+1} \\end{array} \\right)\\), \\(\\Lambda_1\\) \\((n \\times J_1)\\) matrix \\(z_{1,t+1}\\) Markov chain valued set selection vectors size \\(J_1\\) (see Slide @ref(slide:Markov}), \\(\\Lambda_2\\) matrix () \\(z_{2,t+1}\\) Markov chain valued set selection vectors size \\(J_2\\).\\(\\left( \\begin{array}{ll} \\Lambda_1 & 0 \\\\ 0 & \\Lambda_2 \\end{array} \\right)\\)\\(\\left( \\begin{array}{l} z_{1,t+1} \\\\ z_{2,t+1} \\end{array} \\right)\\), \\(\\Lambda_1\\) \\((n \\times J_1)\\) matrix \\(z_{1,t+1}\\) Markov chain valued set selection vectors size \\(J_1\\) (see Slide @ref(slide:Markov}), \\(\\Lambda_2\\) matrix () \\(z_{2,t+1}\\) Markov chain valued set selection vectors size \\(J_2\\).\\(\\left( \\begin{array}{l} \\Lambda_1 \\\\ \\Lambda_2 \\end{array}\\right)z_{t+1}\\), \\(\\Lambda_1\\) \\(\\Lambda_2\\) matrices \\(J_1=J_2=J\\), \\(z_{t+1}\\) Markov chain valued set selection vectors size \\(J\\).\\(\\left( \\begin{array}{l} \\Lambda_1 \\\\ \\Lambda_2 \\end{array}\\right)z_{t+1}\\), \\(\\Lambda_1\\) \\(\\Lambda_2\\) matrices \\(J_1=J_2=J\\), \\(z_{t+1}\\) Markov chain valued set selection vectors size \\(J\\).","code":""},{"path":"affine-processes.html","id":"affine-or-car-processes-first-key-property-multi-horizon-laplace-transform","chapter":"1 Affine processes","heading":"1.11 AFFINE (OR Car) PROCESSES, First Key Property: Multi-Horizon Laplace Transform","text":"\\(w_{t+1}\\): multivariate affine order 1 (contains order \\(p\\) case, functions \\((.)\\), \\(b(.)\\), possibly deterministic functions time, denoted case \\(a_{t+1}(.)\\) \\(b_{t+1}(.)\\):\n\\[\n\\mathbb{E}_t \\exp[(u'w_{t+1})] = \\exp['_{t+1}(u)w_t+b_{t+1}(u)].\n\\]want compute, pair \\((t,h)\\):\n\\[\\begin{equation}\n\\varphi_{t,h}(\\gamma_1,\\dots,\\gamma_h) = \\mathbb{E}_t[\\exp(\\gamma'_1w_{t+1}+\\dots+\\gamma'_h w_{t+h})].\\tag{1.5}\n\\end{equation}\\]Lemma 1.3  :\n\\[\n\\varphi_{t,h}(\\gamma_1,\\dots,\\gamma_h) = \\exp('_{t,h} w_t + B_{t,h}),\n\\]\n\\(A_{t,h} = ^h_{t,h}\\) \\(B_{t,h} = B^h_{t,h}\\), \\(^h_{t,}, B^h_{t,}\\) \\(= 1,\\dots,h\\), given recursively :\n\\[\n() \\left\\{\n\\begin{array}{ccl}\n^h_{t,} &=& a_{t+h+1-}(\\gamma_{h+1-} + ^h_{t,-1}), \\\\\nB^h_{t,} &=& b_{t+h+1-}(\\gamma_{h+1-} + ^h_{t,-1}) + B^h_{t,-1}, \\\\\n^h_{t,0} &=& 0, B^h_{t,0} = 0.\n\\end{array}\n\\right.\n\\]Proof. \\(j=1,\\dots,h\\) :\n\\[\n\\varphi_{t,h}(\\gamma_1,\\dots,\\gamma_h) = \\mathbb{E}_t[\\exp(\\gamma'_1 w_{t+1}+\\dots\\gamma'_j w_{t+j}+^{h'}_{t,h-j}w_{t+j}+B^h_{t,h-j})]\n\\]\n:\n\\[\n(ii) \\left\\{\n\\begin{array}{l}\n^h_{t,h-j+1} = a_{t+j}(\\gamma_{j} + ^h_{t,h-j}), \\\\\nB^h_{t,h-j+1} = b_{t+j}(\\gamma_{j} + ^h_{t,h-j}) + B^h_{t,h-j}, \\\\\n^h_{t,0} = 0, B^h_{t,0} = 0.\n\\end{array}\n\\right.\n\\]\nSince true \\(j=h\\), true \\(j\\), get:\n\\[\n\\begin{array}{ll}\n\\varphi_{t,h}(\\gamma_1,\\dots,\\gamma_h) & = \\mathbb{E}_t [\\exp(\\gamma'_1 w_{t+1}+\\dots+\\gamma'_{j-1}w_{t+j-1}+'_{t+j}(\\gamma_j+^h_{t,h-j})w_{t+j-1} \\\\\n& + b_{t+j}(\\gamma_j+^h_{t,h-j})+B^h_{t,h-j}],\n\\end{array}\n\\]\n, therefore, true \\(j-1\\), \\(^h_{t,h-j+1}\\) \\(B^h_{t,h-j+1}\\) given formulas (ii) .\\(j=1\\) get:\n\\[\\begin{eqnarray*}\n\\varphi_{t,h}(\\gamma_1,\\dots,\\gamma_h) &=& \\mathbb{E}_t \\exp(\\gamma'_1 w_{t+1}+^{h'}_{t,h-1}w_{t+1}+B^h_{t,h-1}) \\\\\n&=& \\exp('_{t,h} w_t+B_{t,h}),\n\\end{eqnarray*}\\]Finally note put \\(h-j+1 = \\), formulas (ii) become ().Remark: functions \\(a_{t}\\) \\(b_{t}\\) depend \\(t\\), recursive formulas depend \\(t\\), get \\(\\varphi_{t,h}(\\gamma_1,\\dots,\\gamma_h)\\), \\(t\\), one recursion \\(h\\).Proposition 1.1  (Reverse-order multi-horizon Laplace transform) functions \\(a_{t}\\) \\(b_{t}\\) depend \\(t\\), different sequences \\((\\gamma^h_1,\\dots,\\gamma^h_h), h=1,\\dots,H\\) (say) satisfy \\(\\gamma^h_{h+1-} = u_i\\), \n\\(=1,\\dots,h\\), \\(h \\leq H\\), want compute (“reverse order” case):\n\\[\n\\varphi_{t,h}(u_h,\\dots,u_1)=\\mathbb{E}_t[\\exp(u'_{{\\color{red}h}} w_{{\\color{red}t+1}}+\\dots+u'_{{\\color{red}1}} w_{{\\color{red}t+h}})],\n\\quad h=1,\\dots,H,\n\\]\ncan compute \\(\\varphi_{t,h}(u_h,\\dots,u_1)\\) \\(t\\) \\(h \\leq H\\), one recursion, .e. \\(\\varphi_{t,h}(u_h,\\dots,u_1)=\\exp('_hw_t+B_h)\\) :\n\\[\\begin{equation}\n\\left\\{\n\\begin{array}{ccl}\nA_{h} &=& (u_{h} + A_{h-1}), \\\\\nB_{h} &=& b(u_{h} + A_{h-1}) + B_{h-1}, \\\\\nA_{0} &=& 0,\\quad  B_{0} = 0.\n\\end{array}\n\\right.\\tag{1.6}\n\\end{equation}\\]Proof. According Lemma 1.3, , case:\n\\[\n\\left\\{\n\\begin{array}{ccl}\n^h_{} &=& (u_{} + ^h_{-1}), \\\\\nB^h_{} &=& b(u_{} + ^h_{-1}) + B^h_{-1}, \\\\\n^h_{0} &=& 0, \\quad B^h_{0} = 0.\n\\end{array}\n\\right.\n\\]\nprevious sequences dependent \\(h\\) given Eq. (1.6).Example 1.15  (Nominal interest rates) \\(B(t,h)\\) denotes date-\\(t\\) price nominal zero-coupon bon maturity \\(h\\), \n\\[\\begin{equation}\nB(t,h) = \\mathbb{E}^{\\mathbb{Q}}_t exp (-r_{t}-\\dots-r_{t+h-1}),\\tag{1.7}\n\\end{equation}\\]\n\\(r_{t}\\) nominal short rate \\(t\\) \\(t+1\\) (observed \\(t\\)), associated (continuously-compounded) yield--maturity given :\n\\[\\begin{equation}\nR(t,h) = -  \\frac{1}{h}   \\log   B(t,h), \\quad   h=1,\\dots,H.\n\\end{equation}\\]\\(r_t = \\omega'w_t\\) (say), :\n\\[\nB(t,h) = \\exp(-r_{t}) \\mathbb{E}^{\\mathbb{Q}}_t \\exp(-\\omega' w_{t+1} - \\dots - \\omega' w_{t+h-1})\n\\]\n\\[\n\\Rightarrow u_1 = 0,\\mbox{ } u_i = - \\omega, = 2,\\dots, H.\n\\]\\(B(t,h)\\) exponential affine \\(w_t\\), \\(R(t,h)\\) affine \\(w_t\\).Example 1.16  (Real interest rates) Denoting \\(q_t\\) price index date \\(t\\) \\(\\pi_{t+1} = log \\dfrac{q_{t+1}}{q_t}\\) inflation rate date \\(t+1\\), :\n\\[\\begin{eqnarray*}\n\\bar{R}(t,h) & =& -   \\frac{1}{h}   \\log   \\bar{B}(t,h), \\quad h=1,\\dots,H \\\\    \\\\\n\\bar{B}(t,h) & =&  \\mathbb{E}^{\\mathbb{Q}}_t   \\exp(-r_{t}-\\dots-r_{t+h-1} + \\pi_{t+1}+\\dots+\\pi_{t+h}),  \\\\      \\\\\n& =& \\exp(-r_{t}) \\times \\\\\n&& \\mathbb{E}^{\\mathbb{Q}}_t   \\exp(-r_{t+1}-\\dots-r_{t+h-1}+\\pi_{t+1}+\\dots+\\pi_{t+h})\n\\end{eqnarray*}\\]\\(r_t = \\omega'w_t\\) \\(\\pi_t = \\bar\\omega'w_t\\) \\(\\bar{B}(t,h)\\) given :\n\\[\\begin{eqnarray*}\n\\exp(-r_{t}) \\mathbb{E}^{\\mathbb{Q}}_t exp[(\\bar\\omega-\\omega)'w_{t+1}+\\dots+(\\bar\\omega-\\omega)'w_{t+h-1}+\\bar\\omega'\nw_{t+h}]\n\\end{eqnarray*}\\]\n\\(\\Rightarrow\\) \\(u_1 = \\bar\\omega\\) \\(u_i = \\bar\\omega-\\omega\\), \\(=2,\\dots,H\\).Example 1.17  (Futures) \\(F(t,h) = \\mathbb{E}^{\\mathbb{Q}}_t (S_{t+h})\\), \\(h=1,\\dots,H\\), \\(S_t\\) date-\\(t\\) price asset.\\(w_t = (\\log S_t, x'_t)'\\) \n\\[\nF(t,h) = \\mathbb{E}^{\\mathbb{Q}}_t \\exp(e'_1 w_{t+h}) \\Rightarrow u_1 = e_1,  \\mbox{}  u_i = 0,   =2,\\dots,H.\n\\]\\(w_t = (y_t, x'_t)'\\) \\(y_t = \\log \\frac{S_t}{S_{t-1}}\\), :\n\\[\nF(t,h) = S_t \\mathbb{E}^{\\mathbb{Q}}_t   \\exp(e'_1 w_{t+1}+\\dots+e'_1 w_{t+h}) \\Rightarrow u_i = e'_1,  =1,\\dots,H.\n\\]Example 1.18  (Exponential affine payoffs) Consider, \\(h \\\\{1,\\dots,H\\}\\), date-\\(t\\) price payoff \\(\\exp(\\nu' w_{t+h}\\)), settled date \\(h\\):\n\\[\nP(t,h;\\nu) = \\mathbb{E}^{\\mathbb{Q}}_t[\\exp(-r_{t}-\\dots-r_{t+h-1}) \\exp(\\nu' w_{t+h})].\n\\]\\(r_t = \\omega'w_t\\), get:\n\\[\nP(t,h;\\nu) = \\exp(-r_{t})\\mathbb{E}^{\\mathbb{Q}}_t \\left(exp[-\\omega' w_{t+1}-\\dots-\\omega' w_{t+h-1}+ \\nu' w_{t+h}]\\right)\n\\]\n\\(\\Rightarrow u_1 = \\nu\\) \\(u_i = -\\omega\\), \\(= 2,\\dots,H\\).\nprecedes can extended case payoff (settled date \\(t+h\\)) form:\n\\[\n  (\\nu_1'w_{t+h}) \\exp(\\nu_2' w_{t+h}).\n  \\]\nIndeed, \n\\[\n  \\left[\\frac{\\partial \\exp[(s \\nu_1+ \\nu_2)'w_{t+h}]}{\\partial s}\\right]_{s=0} = (\\nu_1'w_{t+h}) \\exp(\\nu_2' w_{t+h}).\n  \\]\nTherefore:\n\\[\\begin{eqnarray}\n  &&\\mathbb{E}_t^{\\mathbb{Q}}[\\exp(-r_t - \\dots - r_{t+h-1})(\\nu_1'w_{t+h}) \\exp(\\nu_2' w_{t+h})] \\nonumber\\\\\n  &=& \\left[\n  \\frac{\\partial P(t,h;s \\nu_1 + \\nu_2)}{\\partial s}\n  \\right]_{s=0}.\\tag{1.8}\n  \\end{eqnarray}\\]\nmethod easily extended price payoffs form \\((\\nu_1'w_{t+h})^k \\exp(\\nu_2' w_{t+h})\\), \\(k \\\\mathbb{N}\\).\nprecedes can extended case payoff (settled date \\(t+h\\)) form:\n\\[\n  (\\nu_1'w_{t+h}) \\exp(\\nu_2' w_{t+h}).\n  \\]Indeed, \n\\[\n  \\left[\\frac{\\partial \\exp[(s \\nu_1+ \\nu_2)'w_{t+h}]}{\\partial s}\\right]_{s=0} = (\\nu_1'w_{t+h}) \\exp(\\nu_2' w_{t+h}).\n  \\]Therefore:\n\\[\\begin{eqnarray}\n  &&\\mathbb{E}_t^{\\mathbb{Q}}[\\exp(-r_t - \\dots - r_{t+h-1})(\\nu_1'w_{t+h}) \\exp(\\nu_2' w_{t+h})] \\nonumber\\\\\n  &=& \\left[\n  \\frac{\\partial P(t,h;s \\nu_1 + \\nu_2)}{\\partial s}\n  \\right]_{s=0}.\\tag{1.8}\n  \\end{eqnarray}\\]method easily extended price payoffs form \\((\\nu_1'w_{t+h})^k \\exp(\\nu_2' w_{t+h})\\), \\(k \\\\mathbb{N}\\).","code":""},{"path":"affine-processes.html","id":"affine-or-car-processes-second-key-property-var-representation","chapter":"1 Affine processes","heading":"1.12 AFFINE (OR Car) PROCESSES, Second Key Property: VAR representation","text":"Proposition 1.2  (VAR representation affine process' dynamics) \\(w_t\\) affine process whose Laplace transform defined Def. 1.1, dynamics admits following vectorial autoregressive representation:\n\\[\\begin{equation}\n    w_{t+1} = \\mu + \\Phi w_{t} + \\Sigma^{\\frac{1}{2}}(w_t) \\varepsilon_{t+1},\\tag{1.9}\n    \\end{equation}\\]\n\\(\\varepsilon_{t+1}\\) difference martingale sequence whose conditional covariance matrix identity matrix \\(\\mu\\), \\(\\Phi\\) \\(\\Sigma(w_t) = \\Sigma^{\\frac{1}{2}}(w_t){\\Sigma^{\\frac{1}{2}}(w_t)}'\\) satisfy:\n\\[\\begin{equation}\n    \\mu =  \\left[\\frac{\\partial }{\\partial u}b(u)\\right]_{u=0}, \\quad \\Phi= \\left[\\frac{\\partial }{\\partial u}(u)'\\right]_{u=0}\\tag{1.10}\n    \\end{equation}\\]\n\\[\\begin{equation}\n    \\Sigma(w_t) =  \\left[\\frac{\\partial }{\\partial u\\partial u'}b(u)\\right]_{u=0} + \\left[\\frac{\\partial }{\\partial u\\partial u'}(u)'w_t\\right]_{u=0}.\\tag{1.11}\n    \\end{equation}\\]Proof. \\(w_t\\) affine, (conditional) cumulant generating function form \\(\\psi(u)=(u)'w_t+b(u)\\). result directly follows formulas given Section 1.3.","code":""},{"path":"affine-processes.html","id":"multi-horizon-conditional-means-and-variances","chapter":"1 Affine processes","heading":"1.13 Multi-horizon conditional means and variances","text":"Proposition 1.2 implies :\n\\[\\begin{eqnarray}\n\\mathbb{E}_t(w_{t+h}) &=& (- \\Phi)^{-1}(- \\Phi^h)\\mu + \\Phi^h w_t \\tag{1.12}\\\\\n\\mathbb{V}ar_t(w_{t+h}) &=& \\Sigma(\\mathbb{E}_t(w_{t+h-1}))+\\Phi \\Sigma(\\mathbb{E}_t(w_{t+h-2}))\\Phi' + \\nonumber \\\\\n&& \\dots + \\Phi^{h-1} \\Sigma(w_{t}){\\Phi^{h-1}}'. \\tag{1.13}\n\\end{eqnarray}\\]\nEq. (1.13) notably shows \\(\\mathbb{V}ar_t(w_{t+h})\\) affine function \\(w_t\\) (indeed \\(\\Sigma(.)\\) affine function conditional expectations \\(\\mathbb{E}_t(w_{t+h})\\) affine \\(w_t\\), shown Eq. (1.12).also :\n\\[\\begin{equation}\n\\left\\{\n\\begin{array}{ccl}\n\\mathbb{E}(w_t) &=& (- \\Phi)^{-1}\\mu\\\\\nvec[\\mathbb{V}ar(w_t)] &=& (I_{n^2} - \\Phi \\otimes \\Phi)^{-1} vec\\left(\\Sigma[(- \\Phi)^{-1}\\mu]\\right).\n\\end{array}\n\\right.\\tag{1.14}\n\\end{equation}\\]Proof. Eq. (1.12) easily deduced Eq. (1.9), using \\(\\mathbb{E}_t(\\varepsilon_{t+k})=0\\) \\(k>0\\).regards Eq. (1.13):\n\\[\\begin{eqnarray*}\n\\mathbb{V}ar_t(w_{t+h}) &=& \\mathbb{V}ar_t\\left(\\Sigma(w_{t+h-1})^{\\frac{1}{2}}\\varepsilon_{t+h}+\\dots + \\Phi^{h-1} \\Sigma(w_{t})^{\\frac{1}{2}}\\varepsilon_{t+1} \\right).\n\\end{eqnarray*}\\]\nconditional expectation \\(t\\) terms sum equal zero since, \\(\\ge 1\\):\n\\[\n\\mathbb{E}_t\\left[\\Sigma(w_{t+-1})^{\\frac{1}{2}}\\varepsilon_{t+}\\right] = \\mathbb{E}_t[\\underbrace{\\mathbb{E}_{t+-1}\\{\\Sigma(w_{t+-1})^{\\frac{1}{2}}\\varepsilon_{t+}\\}}_{=\\Sigma(w_{t+-1})^{\\frac{1}{2}}\\mathbb{E}_{t+-1}\\{\\varepsilon_{t+}\\}=0}\\}],\n\\]\n\\(\\forall <j\\),\n\\[\n\\mathbb{C}ov_t\\left[\\Sigma(w_{t+-1})^{\\frac{1}{2}}\\varepsilon_{t+},\\Sigma(w_{t+j-1})^{\\frac{1}{2}}\\varepsilon_{t+j}\\right] = \\mathbb{E}_t\\left[\\Sigma(w_{t+-1})^{\\frac{1}{2}}\\varepsilon_{t+}\\varepsilon_{t+j}'\\Sigma'(w_{t+j-1})^{\\frac{1}{2}}\\right],\n\\]\ncan seen equal zero conditioning information available date \\(t+j-1\\).Using conditioning, obtain :\n\\[\\begin{eqnarray*}\n\\mathbb{V}ar_t\\left[\\Phi^{h-j}\\Sigma(w_{t+j-1})^{\\frac{1}{2}}\\varepsilon_{t+j}\\right] &=& \\mathbb{E}_t\\left[\\Phi^{h-j}\\Sigma(w_{t+j-1})^{\\frac{1}{2}}\\varepsilon_{t+j}\\varepsilon_{t+j}'\\Sigma'(w_{t+j-1})^{\\frac{1}{2}}{\\Phi^{h-j}}'\\right] \\\\\n&=&  \\mathbb{E}_t\\left[\\Phi^{h-j}\\Sigma(w_{t+j-1})^{\\frac{1}{2}} \\mathbb{E}_{t+j-1}(\\varepsilon_{t+j}\\varepsilon_{t+j}')\\Sigma'(w_{t+j-1})^{\\frac{1}{2}}{\\Phi^{h-j}}'\\right] \\\\\n&=&  \\Phi^{h-j}\\mathbb{E}_t[\\Sigma(w_{t+j-1})]{\\Phi^{h-j}}' \\\\\n&=&  \\Phi^{h-j}\\Sigma(\\mathbb{E}_t[w_{t+j-1}]){\\Phi^{h-j}}',\n\\end{eqnarray*}\\]\nlast equality results fact fact \\(\\Sigma(.)\\) affine (see Eq. (1.11)).","code":""},{"path":"affine-processes.html","id":"AffineExtended","chapter":"1 Affine processes","heading":"1.14 Extended Affine Processes","text":"Definition 1.4  (Extended Affine Processes) process \\(w_{1,t}\\) extended affine exists process \\(w_{2,t} = g(\\underline{w_{1,t}})\\) \\((w'_{1,t}, w'_{2,t})'\\) affine (order 1).extended affine processes, \\(\\varphi_{1,t}(u) = \\mathbb{E}[\\exp(u'w_{1,t+1})|\\underline{w_{1,t}}]\\) can obtained :\n\\[\\begin{eqnarray*}\n\\varphi_t(u_1, u_2) &=& \\mathbb{E}[\\exp(u'_1w_{1,t+1}+u'_2 w_{2,t+1)}|\\underline{w_{1,t}}, \\underline{w_{2,t}}] \\\\\n&=& \\exp['_1(u_1,u_2)w_{1,t} + '_2(u_1,u_2)w_{2,t}+b(u_1,u_2)]\n\\end{eqnarray*}\\]\n:\n\\[\n\\varphi_{1,t}(u) = \\varphi_t(u, 0) = \\exp['_1(u,0)w_{1,t}+'_2(u,0)g(\\underline{w_{1,t}}) + b(u, 0)].\n\\]\nparticular \\(w_{1,t}\\) may non-Markovian.extended affine processes, \\(\\varphi_{1,t}(u) = \\mathbb{E}[\\exp(u'w_{1,t+1})|\\underline{w_{1,t}}]\\) can obtained :\n\\[\\begin{eqnarray*}\n\\varphi_t(u_1, u_2) &=& \\mathbb{E}[\\exp(u'_1w_{1,t+1}+u'_2 w_{2,t+1)}|\\underline{w_{1,t}}, \\underline{w_{2,t}}] \\\\\n&=& \\exp['_1(u_1,u_2)w_{1,t} + '_2(u_1,u_2)w_{2,t}+b(u_1,u_2)]\n\\end{eqnarray*}\\]\n:\n\\[\n\\varphi_{1,t}(u) = \\varphi_t(u, 0) = \\exp['_1(u,0)w_{1,t}+'_2(u,0)g(\\underline{w_{1,t}}) + b(u, 0)].\n\\]\nparticular \\(w_{1,t}\\) may non-Markovian.Similarly multi-horizon Laplace transform\n\\[\n\\mathbb{E}[\\exp(\\gamma'_{1}w_{1,t+1}+\\dots+\\gamma'_{h}w_{1,t+h})|\\underline{w_{1,t}}]\n\\]\ncan obtained :\n\\[\\begin{eqnarray*}\n\\mathbb{E}_t[\\exp(\\{\\gamma'_{1,1}w_{1,t+1}+\\gamma'_{2,1}w_{2,t+1}\\}+\\dots+ \\{\\gamma'_{1,h}w_{1,t+h}+\\gamma'_{2,h}w_{2,t+h}\\}] \\\\\n= exp['_{1,t,h}(\\gamma^h_1, \\gamma^h_2)w_{1,t}+'_{2,t,h}(\\gamma^h_1, \\gamma^h_2)w_{2,t}+B_{t,h}(\\gamma^h_1, \\gamma^h_2)],\n\\end{eqnarray*}\\]\n(\\(\\gamma^h_1 = (\\gamma'_{1,1},\\dots, \\gamma'_{1,h})', \\gamma^h_2 = (\\gamma'_{2,1},\\dots, \\gamma'_{2,h})'\\)) :\n\\[\n\\exp['_{1,t,h}(\\gamma^h,0) w_{1,t} + '_{2,t,h}(\\gamma^h,0)g (\\underline{w_{1,t}}) + B_{t,h}(\\gamma^h,0)],\n\\]\n\\(\\gamma^h = (\\gamma_1',\\dots,\\gamma_h')'\\).Similarly multi-horizon Laplace transform\n\\[\n\\mathbb{E}[\\exp(\\gamma'_{1}w_{1,t+1}+\\dots+\\gamma'_{h}w_{1,t+h})|\\underline{w_{1,t}}]\n\\]\ncan obtained :\n\\[\\begin{eqnarray*}\n\\mathbb{E}_t[\\exp(\\{\\gamma'_{1,1}w_{1,t+1}+\\gamma'_{2,1}w_{2,t+1}\\}+\\dots+ \\{\\gamma'_{1,h}w_{1,t+h}+\\gamma'_{2,h}w_{2,t+h}\\}] \\\\\n= exp['_{1,t,h}(\\gamma^h_1, \\gamma^h_2)w_{1,t}+'_{2,t,h}(\\gamma^h_1, \\gamma^h_2)w_{2,t}+B_{t,h}(\\gamma^h_1, \\gamma^h_2)],\n\\end{eqnarray*}\\]\n(\\(\\gamma^h_1 = (\\gamma'_{1,1},\\dots, \\gamma'_{1,h})', \\gamma^h_2 = (\\gamma'_{2,1},\\dots, \\gamma'_{2,h})'\\)) :\n\\[\n\\exp['_{1,t,h}(\\gamma^h,0) w_{1,t} + '_{2,t,h}(\\gamma^h,0)g (\\underline{w_{1,t}}) + B_{t,h}(\\gamma^h,0)],\n\\]\n\\(\\gamma^h = (\\gamma_1',\\dots,\\gamma_h')'\\).Example 1.19  (Affine process order p) \\(\\{w_{1,t}\\}\\) affine order \\(p\\), \\((w_{1,t},\\dots,w_{1,t-p+1})\\) affine order 1.\\(w_{2,t} = (w'_{1,t-1}, \\dots.w'_{1,t-p+1})'\\).Extreme case since \\(w_{2,t}\\) belongs information \\(t-1\\), implies \\(a_2(u_1, u_2) = u_2\\).Example 1.20  (Gaussian ARMA process) Consider \\(ARMA(1,1)\\) process\n\\[\nw_{1,t} - \\varphi w_{1,t-1} = \\varepsilon_t-\\theta \\varepsilon_{t-1}\n\\]\n\\[\n\\mbox{$|\\varphi | < 1$, $|\\theta| < 1$, $\\varepsilon_t \\sim   ..d.  \\mathcal{N}(0, \\sigma^2)$}.\n\\]\\(w_{1,t}\\) Markovian.Take \\(w_{2,t} = \\varepsilon_t = (1-\\theta L)^{-1}(1-\\varphi L)w_{1,t}\\).:\n\\[\n\\left(\n\\begin{array}{l}\nw_{1,t+1} \\\\\nw_{2,t+1}\n\\end{array}\n\\right) =\n\\left(\n\\begin{array}{ll}\n\\varphi & -\\theta \\\\\n0 &      0\n\\end{array}\n\\right)\n\\left(\n\\begin{array}{l}\nw_{1,t} \\\\\nw_{2,t}\n\\end{array}\n\\right) +\n\\left(\n\\begin{array}{l}\n1 \\\\\n1\n\\end{array}\n\\right) \\varepsilon_{t+1}\n\\]\n* Hence \\((w_{1,t}, w_{2,t})'\\) Gaussian \\(VAR(1)\\)\n, therefore, affine (order 1).\n* Easily extended \\(ARMA(p,q)\\) \\(VARMA(p,q).\\)Example 1.21  (GARCH type process) \\(w_{1,t}\\) defined :\n\\[\nw_{1,t+1}  = \\mu + \\varphi w_{1,t} + \\sigma_{t+1} \\varepsilon_{t+1},\n\\]\n\\(|\\varphi| < 1\\) \\(\\varepsilon_t \\sim ..d. \\mathcal{N}(0,1)\\), \n\\[\n\\sigma^2_{t+1} = \\omega + \\alpha \\varepsilon^2_t + \\beta \\sigma^2_t,\n\\]\n\\(0 < \\beta < 1\\).\\(w_{1,t}\\) defined :\n\\[\nw_{1,t+1}  = \\mu + \\varphi w_{1,t} + \\sigma_{t+1} \\varepsilon_{t+1},\n\\]\n\\(|\\varphi| < 1\\) \\(\\varepsilon_t \\sim ..d. \\mathcal{N}(0,1)\\), \n\\[\n\\sigma^2_{t+1} = \\omega + \\alpha \\varepsilon^2_t + \\beta \\sigma^2_t,\n\\]\n\\(0 < \\beta < 1\\).Consider \\(w_{2,t} = \\sigma^2_{t+1}\\) non-linear function \\(\\underline{w_{1,t}}\\).Consider \\(w_{2,t} = \\sigma^2_{t+1}\\) non-linear function \\(\\underline{w_{1,t}}\\).can shown (see ) :\n\\[\\begin{eqnarray*}\n&& \\mathbb{E}\\left[\\exp(u_1 w_{1,t+1} + u_2 w_{2,t+1})|\\underline{w_{1,t}}\\right] \\\\\n&=& \\exp\\left[u_1 \\mu + u_2 \\omega - \\frac{1}{2}   \\log(1-2 u_2 \\alpha) \\right. \\\\\n&&\\left. +  u_1 \\varphi w_{1,t} + (u_2\\beta +  \\frac{u^2_1}{2(1-2u_2\\alpha)}) w_{2,t}\\right],\n\\end{eqnarray*}\\]\nexponential affine \\((w_{1,t}, w_{2,t})\\).can shown (see ) :\n\\[\\begin{eqnarray*}\n&& \\mathbb{E}\\left[\\exp(u_1 w_{1,t+1} + u_2 w_{2,t+1})|\\underline{w_{1,t}}\\right] \\\\\n&=& \\exp\\left[u_1 \\mu + u_2 \\omega - \\frac{1}{2}   \\log(1-2 u_2 \\alpha) \\right. \\\\\n&&\\left. +  u_1 \\varphi w_{1,t} + (u_2\\beta +  \\frac{u^2_1}{2(1-2u_2\\alpha)}) w_{2,t}\\right],\n\\end{eqnarray*}\\]\nexponential affine \\((w_{1,t}, w_{2,t})\\).Proposition 1.3  (Affine property GARCH-type process) process \\(w_t = (w_{1,t}, w_{2,t})\\) defined :\n\\[\n\\left\\{\n\\begin{array}{ccl}\nw_{1, t+1} &=& \\mu + \\varphi w_{1,t} + \\sigma_{t+1} \\varepsilon_{t+1}    \\mid \\varphi \\mid < 1 \\\\\n\\sigma^2_{t+1} &=& \\omega + \\alpha \\varepsilon^2_t + \\beta \\sigma^2_t      0 < \\beta < 1, \\alpha > 0, \\omega > 0    \\\\\nw_{2,t} &=& \\sigma^2_{t+1}, \\quad \\varepsilon_t \\sim   ..d.   \\mathcal{N}(0,1)\n\\end{array}\n\\right.\n\\]\naffine.Proof. Note \\(w_{2,t}\\) function \\(\\underline{w_{1,t}}\\)\n\\[\\begin{eqnarray*}\n&& \\mathbb{E}[\\exp(u_1 w_{1, t+1} + u_2 w_{2, t+1})|\\underline{w_{1,t}}] \\\\\n&= & \\exp(u_1 \\mu + u_1 \\varphi w_{1,t} + u_2 \\omega + u_2 \\beta w_{2,t})  \\mathbb{E}[\\exp(u_1 \\sigma_{t+1} \\varepsilon_{t+1} + u_2 \\alpha \\varepsilon^2_{t+1})|\\underline{w_{1,t}}]\n\\end{eqnarray*}\\]\n, using Lemma 1.5:\n\\[\\begin{eqnarray*}\n&&\\mathbb{E}[\\exp(u_1 w_{1, t+1} + u_2 w_{2, t+1})|\\underline{w_{1,t}}] \\\\\n&= & \\exp(u_1 \\mu + u_1 \\varphi w_{1,t} + u_2 \\omega + u_2 \\beta w_{2t})  \\exp \\left[ -   \\frac{1}{2}   \\log(1-2 u_2 \\alpha) +\n\\frac{u^2_1 w_{2,t}}{2(1-2 u_2 \\alpha)} \\right]\\\\\n&= & \\exp \\left[ u_1 \\mu + u_2 \\omega -  \\frac{1}{2}   \\log(1-2u_2\\alpha)+  u_1 \\varphi w_{1,t} + \\left(u_2 \\beta +  \\frac{u^2_1}{2(1-2u_2\\alpha)}\\right)\nw_{2,t}\\right],\n\\end{eqnarray*}\\]\nexponential affine \\((w_{1,t}, w_{2,t})\\).","code":""},{"path":"affine-processes.html","id":"TransfAna","chapter":"1 Affine processes","heading":"1.15 Truncated Laplace Transforms of Affine Processes and Transform Analysis","text":"Let us introduce following notation:\n\\[\nw_{t+1,T} = (w'_{t+1}, w'_{t+2},\\dots, w'_T)'\n\\]\n\\(w_t\\) affine \\(n\\)-dimensional process.Let us introduce following notation:\n\\[\nw_{t+1,T} = (w'_{t+1}, w'_{t+2},\\dots, w'_T)'\n\\]\n\\(w_t\\) affine \\(n\\)-dimensional process.want compute:\n\\[\n\\tilde{\\varphi}_t(u ; v, \\gamma) = \\mathbb{E}_t[\\exp(u'w_{t+1,T})\\textbf{1}_{\\{v'w_{t+1,T<\\gamma}\\}}].\n\\]want compute:\n\\[\n\\tilde{\\varphi}_t(u ; v, \\gamma) = \\mathbb{E}_t[\\exp(u'w_{t+1,T})\\textbf{1}_{\\{v'w_{t+1,T<\\gamma}\\}}].\n\\]Consider complex untruncated conditional Laplace transform:\n\\[\n\\varphi_t(z) = \\mathbb{E}_t[\\exp(z'w_{t+1,T})],\\quad  z \\\\mathbb{C}^{nT},\n\\]\ncomputed using recursive algorithm real case.Consider complex untruncated conditional Laplace transform:\n\\[\n\\varphi_t(z) = \\mathbb{E}_t[\\exp(z'w_{t+1,T})],\\quad  z \\\\mathbb{C}^{nT},\n\\]\ncomputed using recursive algorithm real case.(Duffie, Pan, Singleton 2000):\n\\[\\begin{equation}\n\\tilde{\\varphi}_t(u ; v, \\gamma) =  \\frac{\\varphi_t(u)}{2} - \\frac{1}{\\pi}\n\\int^\\infty_0 \\frac{Im[\\varphi_t(u+ivx) \\exp(-\\gamma x)]}{x} dx.\\tag{1.15}\n\\end{equation}\\](Duffie, Pan, Singleton 2000):\n\\[\\begin{equation}\n\\tilde{\\varphi}_t(u ; v, \\gamma) =  \\frac{\\varphi_t(u)}{2} - \\frac{1}{\\pi}\n\\int^\\infty_0 \\frac{Im[\\varphi_t(u+ivx) \\exp(-\\gamma x)]}{x} dx.\\tag{1.15}\n\\end{equation}\\]\\(Im\\) means imaginary part.\\(Im\\) means imaginary part.Note integral Eq. (1.15) one dimensional (whatever dimension \\(w_t\\)).Note integral Eq. (1.15) one dimensional (whatever dimension \\(w_t\\)).Application: Option pricing.Application: Option pricing.typical problem compute conditional expectation type (\\(k > 0\\)):\n\\[\\begin{eqnarray*}\n&& \\mathbb{E}_t\\left([\\exp(u'_1 w_{t+1,T})-k   \\exp(u'_2 w_{t+1,T})]^+\\right) \\\\\n&= &  \\mathbb{E}_t\\left([\\exp(u'_1 w_{t+1,T})-k   \\exp(u'_2 w_{t+1,T})]\\textbf{1}_{\\{[\\exp(u_1-u_2)'w_{t+1,T}] > k \\}}\\right) \\\\\n&= & \\tilde{\\varphi}_t(u_1 ; u_2-u_1, - \\log   k) - k \\tilde{\\varphi}_t(u_2 ; u_2-u_1, - \\log   k).\n\\end{eqnarray*}\\]PROOFSWe want compute:\n\\[\n\\tilde{\\varphi}_t(u;v,\\gamma) = \\mathbb{E}_t[\\exp(u'w)\\textbf{1}_{(v'w<\\gamma})]\n\\]\n(noting \\(w=\\tilde{w}_{t+1,T}\\)) knowing function \\(\\varphi_t(z)=\\mathbb{E}_t[exp(z'w)],\\) \\(z\\): complex components.\\omit index \\(t\\) notational simplicity.Let us first note , given \\(u\\) \\(v\\), \\(\\tilde{\\varphi}_t(u;v,\\gamma)\\) positive increasing bounded function \\(\\gamma\\) therefore can seen c.d.f. positive finite measure \\(\\mathbb{R}\\), Fourier transform :\n\\[\n\\int_{\\mathbb{R}} \\exp(\\gamma x)d\\tilde{\\varphi}(u;v,\\gamma) = \\mathbb{E} \\int_{\\mathbb{R}} \\exp(\\gamma x)d\\tilde{\\varphi}_w(u;v,\\gamma),\n\\]\n, given \\(w, \\tilde{\\varphi}_w(u;v,\\gamma)\\) c.d.f. mass point \\(\\exp(u'w)\\) \\(v'w\\), get\nfunction \\(x\\):\n\\[\\begin{eqnarray*}\n\\displaystyle \\int_{\\mathbb{R}} \\exp(\\gamma x) d\\tilde{\\varphi}(u;v,\\gamma) &=& \\mathbb{E}[\\exp(ixv'w)exp(u'w)] \\\\\n& =& \\mathbb{E}[\\exp(u+ivx)'w] \\\\\n& =& \\varphi(u+ivx).\n\\end{eqnarray*}\\]Let us now compute real number \\(\\lambda\\):\n\\[\\begin{eqnarray*}\n&&(x_0,\\lambda) \\\\\n&=& \\displaystyle \\frac{1}{2\\pi} \\int^{x_0}_{-x_0}\n\\displaystyle \\frac{\\exp(\\lambda x)\\varphi(u-ivx)-\\exp(-\\lambda)\\varphi(u+ivx)}{ix}dx \\\\\n&=& \\displaystyle \\frac{1}{2\\pi} \\int^{x_0}_{-x_0}\\left[ \\begin{array}{l} \\displaystyle \\int_{\\mathbb{R}}\n\\displaystyle \\frac{\\exp[-ix(\\gamma-\\lambda)]-\\exp[ix(\\gamma-\\lambda)]}{ix}d\\tilde{\\varphi}(u;v,\\gamma)\n\\end{array} \\right]dx \\\\\n&=& \\displaystyle \\frac{1}{2\\pi} \\displaystyle \\int_{\\mathbb{R}}\n\\left[ \\begin{array}{l}  \\displaystyle \\int^{x_0}_{-x_0}  \\displaystyle \\frac{\\exp[-ix(\\gamma-\\lambda)]\n-\\exp[ix(\\gamma-\\lambda)]}{ix}dx \\end{array} \\right]d\\tilde{\\varphi}(u;v,\\gamma)\n\\end{eqnarray*}\\]Now :\n\\[\\begin{eqnarray*}\n\\displaystyle \\frac{1}{2\\pi} \\int^{x_o}_{-x_o}\n\\displaystyle \\frac{\\exp[-ix(\\gamma-\\lambda)]\n-\\exp[ix(\\gamma-\\lambda)]}{ix}dx \\\\ = \\displaystyle \\frac{-sign(\\gamma-\\lambda)}{\\pi}\n\\int^{x_o}_{-x_o}\\displaystyle \\frac{sin(x\\mid\\gamma-\\lambda\\mid)}{x}dx\n\\end{eqnarray*}\\]\ntends -sign\\((\\gamma-\\lambda)\\) \\(x_o\\rightarrow\\infty\\) (sign\\((\\omega)=1\\) \\(\\omega>0\\), sign\\((\\omega)=0\\) \\(\\omega=0\\), sign\\((\\omega)=-1\\) \\(\\omega<0\\)).Therefore:\n\\[\n(\\infty,\\lambda) = - \\displaystyle \\int_{\\mathbb{R}} sign(\\gamma-\\lambda)d\\tilde{\\varphi}(u;v,\\gamma) = -\\mathbb{E} \\displaystyle \\int_{\\mathbb{R}} sign(\\gamma-\\lambda)d\\tilde{\\varphi}_w(u;\\theta,\\gamma),\n\\]\n\\(\\tilde{\\varphi}_w(u;v,\\gamma)\\) c.d.f. mass point \\(exp(u'w)\\) \\(v'w\\) \n\\[\n\\displaystyle \\int_{\\mathbb{R}} sign(\\gamma-\\lambda)d\\tilde{\\varphi}_w(u;v,\\gamma)=\n\\left\\{\n\\begin{array}{ccl}\n\\exp(u'w) & & \\lambda<v'w \\\\\n     0 & & \\lambda=v'w \\\\\n    - exp(u'w) & & \\lambda>v'w\n    \\end{array}\n    \\right.\n\\]\n\n\\[\\begin{eqnarray*}\n(\\infty,\\lambda) & =& - \\mathbb{E}[\\exp(u'w)(1-\\textbf{1}_{(v'w<\\lambda)})-\\exp(u'w)\\textbf{1}_{(v'w<\\lambda)}] \\\\\n& =& - \\varphi(u) + 2\\tilde{\\varphi}(u;v,\\lambda)\n\\end{eqnarray*}\\]\ntherefore:\n\\[\n\\tilde{\\varphi}(u;,v,\\gamma) = \\displaystyle \\frac{\\varphi(u)}{2} + \\displaystyle \\frac{1}{2} (\\infty,\\gamma)\n\\]:\n\\[\\begin{eqnarray*}\n\\displaystyle \\frac{1}{2} (\\infty,\\gamma) & =& \\displaystyle \\frac{1}{4\\pi} \\int^{\\infty}_{-\\infty} \\displaystyle \\frac{\\exp(\\gamma x)\\varphi(u-ivx)-\\exp(-\\gamma x)\\varphi(u+ivx)}{ix} dx \\\\\n& =& \\displaystyle \\frac{1}{2\\pi} \\int^{\\infty}_{o} \\displaystyle \\frac{\\exp(\\gamma x)\\varphi(u-ivx)-\\exp(-\\gamma x)\\varphi(u+ivx)}{ix} dx \\\\\n& =& - \\displaystyle \\frac{1}{\\pi} \\int^{\\infty}_{o} \\displaystyle \\frac{{\\mathcal }m[\\exp(-\\gamma x)\\varphi(u+ivx)]}{x}dx\n\\end{eqnarray*}\\]\nfinally\n\\[\n\\tilde{\\varphi}(u;v,\\gamma) = \\displaystyle \\frac{\\varphi(u)}{2} - \\displaystyle \\frac{1}{\\pi} \\int^\\infty_o\n\\displaystyle \\frac{{\\mathcal }m[\\varphi(u+ivx)\\exp(-\\gamma x)]}{x}dx.\n\\]Example 1.22  (Exogenous short rate) Consider asset whose date-\\(t\\) price \\(p_t\\).Geometric asset return: \\(y_t = \\log(p_t/p_{t-1})\\).Consider option written asset. Strike: \\(k p_t\\). Deterministic (exogenous) interest rates. Residual maturity: \\(h\\).\n*[\\(\\Rightarrow\\)] Option price:\n\\[\np_t   \\exp(-r_{t}-\\dots-r_{t+h-1}) \\mathbb{E}^{\\mathbb{Q}}_t[\\exp   u'_1 w_{t+1, t+h} - k]^+\n\\]\n\\(u_1 = e \\otimes e_1\\), \\(e\\) \\(h\\)-dimensional vector components 1 \\(e_1\\) \\(n\\)-vector selecting 1st component (\\(y_t\\) 1st component \\(w_t\\), say).Example 1.23  (Endogenous short rate) Stochastic (endogenous) short-term rate: \\(r_{t+1} = \\omega_0 + \\omega'_1 w_t\\).price :\n\\[\\begin{eqnarray*}\n&& p_t \\mathbb{E}^{\\mathbb{Q}}_t  \\left[ \\exp(-\\omega_0 - \\omega'_1 w_t-\\dots- \\omega_0 - \\omega'_1 w_{t+h-1}) [\\exp(u'_1 w_{t+1,t+h})-k]^+ \\right]\\\\\n&= & p_t   \\exp(-h \\omega_0 - \\omega'_1 w_t)\\mathbb{E}^{\\mathbb{Q}}_t\\left(\\left[\\exp(\\tilde{u}'_1w_{t+1,t+h})-k   \\exp(u_2 w_{t+1, t+h})\\right]^+\\right),\n\\end{eqnarray*}\\]\n\\(\\tilde{u}'_1 = u_1 + u_2\\), [\\(u_1 = e \\otimes e_1\\) ], \\(u_2 = (-\\omega'_1,\\dots, -\\omega'_1, 0)'\\).","code":""},{"path":"affine-processes.html","id":"appendices","chapter":"1 Affine processes","heading":"1.16 APPENDICES","text":"Lemma 1.4  \\(\\mu \\\\mathbb{R}^L\\) \\(Q\\) \\((L \\times L)\\) matrix symmetric positive definite, :\n\\[\n\\int_{\\mathbb{R}^{L}} \\exp(-u'Q u + \\mu'u)du =\n\\frac{\\pi^{L/2}}{(det   Q)^{1/2}} exp \\left(\n\\begin{array}{l}  \\frac{1}{4} \\mu'Q^{-1}\\mu \\end{array} \\right).\n\\]Proof. integral :\n\\[\\begin{eqnarray*}\n&& \\int_{\\mathbb{R}^{L}} exp \\left[ \\begin{array}{l} - (u -\n\\frac{1}{2}  Q^{-1} \\mu)'  Q (u -\n\\frac{1}{2} Q^{-1} \\mu)'\n\\end{array}\n\\right] exp\\left(\n\\begin{array}{l}  \\frac{1}{4} \\mu'Q^{-1}\\mu \\end{array}\n\\right)du \\\\\n&=&  \\frac{\\pi^{L/2}}{(det Q)^{1/2}} exp\\left(\n\\begin{array}{l}  \\frac{1}{4} \\mu'Q^{-1}\\mu \\end{array}\n\\right)\n\\end{eqnarray*}\\]\n[using formula unit mass \\(\\mathcal{N}( 0.5Q^{-1}\\mu,(2Q)^{-1})\\)].Lemma 1.5  \\(\\varepsilon_{t+1} \\sim \\mathcal{N}(0,Id)\\), \n\\[\n\\mathbb{E}_t \\left(\\exp[\\lambda'\\varepsilon_{t+1}+\\varepsilon'_{t+1} V \\varepsilon_{t+1}]\\right) =  \\frac{1}{[\\det(-2V)]^{1/2}} \\exp\\left[\n\\frac{1}{2} \\lambda'(-2V)^{-1}\\lambda\n\\right].\n\\]Proof. \n\\[\n\\mathbb{E}_t   \\exp(\\lambda'\\varepsilon_{t+1}+\\varepsilon'_{t+1}V\\varepsilon_{t+1})\n=  \\frac{1}{(2\\pi)^{n/2}}  \\int_{\\mathbb{R}^{n}} \\exp\\left[\n\\begin{array}{l}\n-u'\\left(\n\\begin{array}{l}\n\\frac{1}{2} -V\n\\end{array}\n\\right)u+\\lambda'u\n\\end{array}\n\\right]du\n\\]\nLemma 1.4, \\(u\\\\mathbb{R}^n\\), \n\\[\n\\int_{\\mathbb{R}^{n}} \\exp(-u' Q u+\\mu'u) du =\n\\frac{\\pi^{n/2}}{(\\det Q)^{1/2}} \\exp\\left(\n\\begin{array}{l}\n\\frac{1}{4} \\mu'Q^{-1}\\mu\n\\end{array}\n\\right).\n\\]\nTherefore:\n\\[\n\\begin{array}{l}\n\\mathbb{E}_t   \\exp(\\lambda'\\varepsilon_{t+1}+\\varepsilon'_{t+1}V\\varepsilon_{t+1}) \\\\\n=  \\frac{1}{2^{n/2}\n\\left[\n\\begin{array}{l}\n\\det \\left(\n\\begin{array}{l}\n\\frac{1}{2} -V\n\\end{array}\n\\right)\n\\end{array}\n\\right]^{1/2}\n}\n\\exp\\left[\n\\begin{array}{l}\n   \\frac{1}{4}  \\lambda'\\left(\n\\begin{array}{l}\n\\frac{1}{2} -V\n\\end{array}\n\\right)^{-1}\\lambda\n\\end{array}\n\\right].\n\\end{array}\n\\]","code":""},{"path":"pricing-and-risk-neutral-dynamics.html","id":"pricing-and-risk-neutral-dynamics","chapter":"2 Pricing and risk-neutral dynamics","heading":"2 Pricing and risk-neutral dynamics","text":"","code":""},{"path":"pricing-and-risk-neutral-dynamics.html","id":"PricingEquilibrium","chapter":"2 Pricing and risk-neutral dynamics","heading":"2.1 SDF: Equilibrium Approach","text":"","code":""},{"path":"technical-details.html","id":"technical-details","chapter":"3 Technical Details","heading":"3 Technical Details","text":"Now ’ll teach crazy math, need work first…","code":""}]
