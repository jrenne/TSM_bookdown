[{"path":"index.html","id":"intro","chapter":"Introduction to Term Structure Models","heading":"Introduction to Term Structure Models","text":"Modeling dynamic term structures serves practical indispensable tool realm finance. enables investors, institutions, policymakers make informed decisions, manage risk effectively, allocate resources wisely. understanding interest rates yields evolve time, models offer clear lens assess market trends price financial instruments accurately.course developed Jean-Paul Renne Alain Monfort. illustrated R codes using various packages can obtained CRAN. TSModels package available GitHub. install , one need employ devtools library:Useful (R) links:Download R:\nR software: https://cran.r-project.org (basic R software)\nRStudio: https://www.rstudio.com (convenient R editor)\nDownload R:R software: https://cran.r-project.org (basic R software)RStudio: https://www.rstudio.com (convenient R editor)Tutorials:\nRstudio: https://dss.princeton.edu/training/RStudio101.pdf (Oscar Torres-Reyna)\nR: https://cran.r-project.org/doc/contrib/Paradis-rdebuts_en.pdf (Emmanuel Paradis)\ntutorial: https://jrenne.shinyapps.io/Rtuto_publiShiny/\nTutorials:Rstudio: https://dss.princeton.edu/training/RStudio101.pdf (Oscar Torres-Reyna)R: https://cran.r-project.org/doc/contrib/Paradis-rdebuts_en.pdf (Emmanuel Paradis)tutorial: https://jrenne.shinyapps.io/Rtuto_publiShiny/","code":"\ninstall.packages(\"devtools\") # in case this library has not been loaded yet\nlibrary(devtools)\ninstall_github(\"jrenne/TSModels\")\nlibrary(AEC)"},{"path":"ChapterAffine.html","id":"ChapterAffine","chapter":"1 Affine processes","heading":"1 Affine processes","text":"","code":""},{"path":"ChapterAffine.html","id":"Information","chapter":"1 Affine processes","heading":"1.1 Information in the Economy: The “factors”","text":"date \\(t=1,2,\\dots,T\\), agents receive new information observing factors, also called states. denote (\\(K\\)-dimensional) vector factors \\(w_t\\). Vector \\(w_t\\) usually random. date \\(t\\), vector \\(w_t\\) supposed perfectly observed agents (investors), can partially observed, unobserved econometrician.Naturally, \\(w_t\\) can decomposed different sub-vectors different natures. instance, can \\(w_t = (y_t', z_t')'\\) \n* \\(y_t\\): observable vector (geometric) returns,\n* \\(z_t\\): regime, unobserved econometrician.components \\(w_t\\) can prices. instance, one component short-term rate, stock return, exchange rate. can also include macroeconomic variables (inflation, GDP growth), agent-specific variables.","code":""},{"path":"ChapterAffine.html","id":"Dynamic","chapter":"1 Affine processes","heading":"1.2 Dynamic models and Laplace transform (L.T.)","text":"objective dynamic model describe random changes \\(w_t\\). dynamics can historical risk-neutral (see Chapter ??). dynamics consider parametric, sense conditional distribution \\(w_{t+1}|\\underline{w_t}\\) (\\(\\underline{w_t}=\\{w_t,w_{t-1},\\dots\\}\\)) depends vector parameters \\(\\theta\\). practice, may case \\(\\theta\\) unknown econometrician (see Chapter ??). choice (estimation) conditional distribution equivalent choice (estimation) conditional Laplace transforms:\n\\[\\begin{equation}\n\\varphi(u|\\underline{w_t},\\theta) =\n\\mathbb{E}_{\\theta}[\\exp(u'w_{t+1})|\\underline{w_t}], \\quad u \\\\mathbb{R}^K,\\tag{1.1}\n\\end{equation}\\]\nconditional log Laplace transforms:\n\\[\n\\psi(u|\\underline{w_t},\\theta) =\n\\log\\{\\mathbb{E}_{\\theta}[\\exp(u'w_{t+1})|\\underline{w_t}]\\}, \\quad u \\\n\\mathbb{R}^K.\n\\]Example 1.1  (Conditionally Bernoulli process) \\(w_{t+1}|\\underline{w_t} \\sim {\\mathcal{}} [p(\\underline{w_t},\\theta)]\\), :\n\\[\n\\varphi(u|w_t)=\n\\mathbb{E}[\\exp(u w_{t+1}) \\mid \\underline{w_t}] = p_t \\exp(u) + 1-p_t\n\\]\n\\(p_t = p(\\underline{w_t}, \\theta)\\).Example 1.2  (Conditionally Binomial process) \\(w_{t+1}|\\underline{w_t} \\{\\mathcal{B}}(n, p_t)\\), :\n\\[\n\\varphi(u|w_t)=[p_t   \\exp(u) + 1-p_t]^n.\n\\]Example 1.3  (Conditionally Poisson process) \\(w_{t+1}|\\underline{w_t} \\sim {\\mathcal{P}}(\\lambda_t)\\), :\n\\[\\begin{eqnarray*}\n\\varphi(u|w_t) & =&   \\sum^\\infty_{j=0}  \\dfrac{1}{j!}  \\exp(-\\lambda_t) \\lambda^j_t   \\exp(uj)  = \\exp(-\\lambda_t) exp[\\lambda_t \\exp(u)] \\\\\n& =& \\exp\\{\\lambda_t[\\exp(u)-1]\\}.\n\\end{eqnarray*}\\]Example 1.4  (Conditionally normal (Gaussian) process) \\(w_{t+1}|\\underline{w_t} \\sim \\mathcal{N}\\left(m(\\underline{w_t},\\theta), \\Sigma(\\underline{w_t},\\theta)\\right)\\), :\\[\nu'w_{t+1}|\\underline{w_t} \\sim \\mathcal{N}\\left(u'm(\\underline{w_t},\\theta), u'\\Sigma(\\underline{w_t},\\theta)u\\right).\n\\]\\[\n\\Rightarrow\n\\left\\{\n\\begin{array}{ccc}\n\\varphi(u|\\underline{w_t},\\theta) &=& \\exp\\left[\n\\begin{array}{l} u'm(\\underline{w_t},\\theta)+\n\\frac{1}{2} u'\\Sigma(\\underline{w_t},\\theta)u\\end{array}\n\\right]\\\\\n\\psi(u|\\underline{w_t},\\theta) &=&\nu'm(\\underline{w_t},\\theta) +  \\frac{1}{2}\nu'\\Sigma(\\underline{w_t},\\theta)u.\n\\end{array}\n\\right.\n\\]","code":""},{"path":"ChapterAffine.html","id":"AffineLaplace","chapter":"1 Affine processes","heading":"1.3 Laplace Transform and moments/cumulants","text":"properties Laplace transform (Eq. (1.1)):\\(\\varphi(0|\\underline{w_t},\\theta) = 1\\) \\(\\psi(0|\\underline{w_t},\\theta)=0\\).defined convex set \\(E\\) (containing \\(0\\)).interior \\(E\\) non empty, (conditional) moments exist.mentioned , knowing (conditional) Laplace transform equivalent knowing (conditional) moments—exist. scalar case, :moment order \\(n\\) closely relates \\(n^{th}\\) derivatives \\(\\varphi\\):\n\\[\n\\left[ \\begin{array}{l}  \\dfrac{\\partial^n\n\\varphi(u|\\underline{w_t},\\theta)}{\\partial u^n}\n\\end{array} \\right]_{u=0} = \\mathbb{E}_{\\theta}[w^n_{t+1}|\\underline{w_t}],\n\\]cumulant order \\(n\\) closely relates \\(n^{th}\\) derivatives \\(\\psi\\):\n\\[\n\\left[ \\begin{array}{l}  \\dfrac{\\partial^n\n\\psi(u|\\underline{w_t},\\theta)}{\\partial u^n}\n\\end{array} \\right]_{u=0} = K_n(\\underline{w_t},\\theta).\n\\]particular, precedes implies :\n\\[\n\\left\\{\n\\begin{array}{ccc}\nK_1(\\underline{w_t},\\theta) &=& \\mathbb{E}_{\\theta}[w_{t+1}|\\underline{w_t}]\\\\\nK_2(\\underline{w_t}, \\theta) &=& \\mathbb{V}ar_{\\theta}[w_{t+1}|\\underline{w_t}].\n\\end{array}\n\\right.\n\\]Accordingly, \\(\\varphi\\) \\(\\psi\\) respectively called conditional moment cumulant generating function.multivariate case, :\n\\[\\begin{eqnarray*}\n\\left[\\begin{array}{l}  \\dfrac{\\partial \\psi}{\\partial\nu} (u|\\underline{w_t},\\theta)  \\end{array} \\right]_{u=0} &=& \\mathbb{E}_{\\theta}[w_{t+1}|\\underline{w_t}] \\\\\n\\left[\\begin{array}{l}  \\dfrac{\\partial^2\n\\psi}{\\partial u\\partial u'} (u|\\underline{w_t},\\theta)  \\end{array}\n\\right]_{u=0} &=& \\mathbb{V}ar_{\\theta}[w_{t+1}|\\underline{w_t}].\n\\end{eqnarray*}\\]Example 1.4  (Conditionally normal (Gaussian) process) Consider Example 1.4. Applying previous formula, , scalar case:\\(\\psi(u|\\underline{w_t},\\theta)=u m(\\underline{w_t},\\theta) + \\frac{1}{2}u^2\\sigma^2(\\underline{w_t},\\theta)\\).\\(\\left[\\begin{array}{l} \\dfrac{\\partial \\psi}{\\partial u} (u|\\underline{w_t},\\theta) \\end{array} \\right]_{u=0} = m(\\underline{w_t},\\theta)\\).\\(\\left[\\begin{array}{l} \\dfrac{\\partial^2 \\psi}{\\partial u^2} (u|\\underline{w_t},\\theta) \\end{array} \\right]_{u=0} = \\sigma^2(\\underline{w_t},\\theta)\\)., multidimensional normal case:\\(\\psi(u|\\underline{w_t},\\theta)=u' m(\\underline{w_t},\\theta) + \\frac{1}{2}u'\\Sigma(\\underline{w_t},\\theta)u\\).\\(\\left[\\begin{array}{l} \\dfrac{\\partial \\psi}{\\partial u} (u|\\underline{w_t},\\theta) \\end{array} \\right]_{u=0} = m(\\underline{w_t},\\theta)\\).\\(\\left[\\begin{array}{l} \\dfrac{\\partial^2 \\psi}{\\partial u\\partial u'} (u|\\underline{w_t},\\theta) \\end{array} \\right]_{u=0} = \\Sigma(\\underline{w_t},\\theta)\\).cases, cumulants order \\(>2\\) equal \\(0\\).","code":""},{"path":"ChapterAffine.html","id":"additional-properties-of-the-laplace-transform","chapter":"1 Affine processes","heading":"1.4 Additional properties of the Laplace transform","text":"additional properties multivariate Laplace transform:\\(w_t=(w'_{1t},w'_{2t})'\\) \\(, u=(u'_1, u'_2)'\\):\n\\[\\begin{eqnarray*}\n\\mathbb{E}_{\\theta}[\\exp(u'_1 w_{1,t+1}|\\underline{w_t})&=&\\varphi(u_1,0|\\underline{w_t},\\theta)] \\\\\n\\mathbb{E}_{\\theta}[\\exp(u'_2 w\n_{2,t+1}|\\underline{w_t})&=&\\varphi(0,u_2|\\underline{w_t},\\theta)].\n\\end{eqnarray*}\\]\\(w_t=(w'_{1t},w'_{2t})'\\) \\(, u=(u'_1, u'_2)'\\):\n\\[\\begin{eqnarray*}\n\\mathbb{E}_{\\theta}[\\exp(u'_1 w_{1,t+1}|\\underline{w_t})&=&\\varphi(u_1,0|\\underline{w_t},\\theta)] \\\\\n\\mathbb{E}_{\\theta}[\\exp(u'_2 w\n_{2,t+1}|\\underline{w_t})&=&\\varphi(0,u_2|\\underline{w_t},\\theta)].\n\\end{eqnarray*}\\]\\(w_t=(w'_{1t},w'_{2t})'\\), \\(w_{1t}\\) \\(w_{2t}\\) conditionally independent:\n\\[\\begin{eqnarray*}\n\\varphi(u|\\underline{w_t},\\theta) &=&\n\\varphi(u_1,0|\\underline{w_t},\\theta)\\times\\varphi(0,u_2|\\underline{w_t},\\theta) \\\\\n\\psi(u|\\underline{w_t},\\theta) &=&\n\\psi(u_1,0|\\underline{w_t},\\theta)+\\psi(0,u_2|\\underline{w_t},\\theta).\n\\end{eqnarray*}\\]\\(w_t=(w'_{1t},w'_{2t})'\\), \\(w_{1t}\\) \\(w_{2t}\\) conditionally independent:\n\\[\\begin{eqnarray*}\n\\varphi(u|\\underline{w_t},\\theta) &=&\n\\varphi(u_1,0|\\underline{w_t},\\theta)\\times\\varphi(0,u_2|\\underline{w_t},\\theta) \\\\\n\\psi(u|\\underline{w_t},\\theta) &=&\n\\psi(u_1,0|\\underline{w_t},\\theta)+\\psi(0,u_2|\\underline{w_t},\\theta).\n\\end{eqnarray*}\\]\\(w_{1t}\\) \\(w_{2t}\\) size \n\\[\n\\varphi(u_1, u_2|\\underline{w_t},\\theta) = \\mathbb{E}_\\theta[\\exp(u'_1 w_{1, t+1} + u'_2 w_{2,t+1}|\\underline{w_t}],\n\\]\nconditional Laplace transform \\(w_{1, t+1} + w_{2, t+1}\\) given\n\\(\\underline{w_t}\\) \\(\\varphi(u, u|\\underline{w_t},\\theta)\\).\nparticular, \\(w_{1t}\\) \\(w_{2t}\\) conditionally independent \nsize, conditional Laplace transform Log-Laplace\ntransform \\(w_{1,t+1}+w_{2,t+1}\\) respectively:\n\\[\n\\varphi(u,0|\\underline{w_t},\\theta)\\times \\varphi(0,\nu|\\underline{w_t},\\theta), \\quad \\mbox{}\\quad \\psi(u,0|\\underline{w_t},\\theta)+ \\psi(0,\nu|\\underline{w_t},\\theta).\n\\]\\(w_{1t}\\) \\(w_{2t}\\) size \n\\[\n\\varphi(u_1, u_2|\\underline{w_t},\\theta) = \\mathbb{E}_\\theta[\\exp(u'_1 w_{1, t+1} + u'_2 w_{2,t+1}|\\underline{w_t}],\n\\]\nconditional Laplace transform \\(w_{1, t+1} + w_{2, t+1}\\) given\n\\(\\underline{w_t}\\) \\(\\varphi(u, u|\\underline{w_t},\\theta)\\).\nparticular, \\(w_{1t}\\) \\(w_{2t}\\) conditionally independent \nsize, conditional Laplace transform Log-Laplace\ntransform \\(w_{1,t+1}+w_{2,t+1}\\) respectively:\n\\[\n\\varphi(u,0|\\underline{w_t},\\theta)\\times \\varphi(0,\nu|\\underline{w_t},\\theta), \\quad \\mbox{}\\quad \\psi(u,0|\\underline{w_t},\\theta)+ \\psi(0,\nu|\\underline{w_t},\\theta).\n\\]Lemma 1.1  (Conditional zero probability non-negative processes) \\(w_t\\) univariate nonnegative (conditional)\nLaplace transform \\(\\varphi_t(u) = \\mathbb{E}_t[\\exp(u w_{t+1})]\\) defined\n\\(u \\leq 0\\) \n\\[\n\\mathbb{P}_t(w_{t+1} = 0) = \\lim_{u\\rightarrow - \\infty} \\varphi_t(u).\n\\]Proof. \\(\\varphi_t(u) = \\mathbb{P}_t(w_{t+1} = 0) + \\int_{w_{t+1}> 0} \\exp(u w_{t+1}) d\\mathbb{P}_t(w_{t+1})\\). Lebesgue theorem ensures last integral converges zero \\(u\\) goes \\(-\\infty\\).Lemma 1.2  (Conditional zero probability non-negative multivariate processes) Assume :\\(w_{1,t}\\) valued \\(\\mathbb{R}^{d}\\) (\\(d \\geq 1\\)),\\(w_{2,t}\\) valued \\(\\mathbb{R}^+ = [0, + \\infty )\\),\\(\\mathbb{E}_t \\left[ \\exp \\left( u_1 ' w_{1,t+1} + u_2 w_{2,t+1} \\right) \\right]\\) exists given \\(u_1\\) \\(u_2 \\leq 0\\)., :\n\\[\\begin{equation}\n\\mathbb{E}_t \\left[ \\exp( u_1 ' w_{1,t+1})  \\textbf{1}_{\\{w_{2,t+1} = 0 \\}} \\right] =  \\underset{u_2 \\rightarrow -\\infty}{\\lim} \\mathbb{E}_t \\left[ \\exp( u_1 ' w_{1,t+1} + u_2   w_{2,t+1} )  \\right].\\tag{1.2}\n\\end{equation}\\]Proof. \n\\[\\begin{eqnarray*}\n&&\\underset{u_2 \\rightarrow -\\infty}{\\lim} \\mathbb{E}_t \\left[ \\exp( u_1 ' w_{1,t+1} + u_2   w_{2,t+1} )  \\right] \\\\\n&=& \\mathbb{E}_t \\left[ \\exp( u_1 ' w_{1,t+1})   \\textbf{1}_{\\{w_{2,t+1} = 0 \\}} \\right] +\\\\\n&& \\underset{u_2 \\rightarrow -\\infty}{\\lim}   \\mathbb{E}_t \\left[ \\exp( u_1 ' w_{1,t+1} + u_2   w_{2,t+1} )  \\textbf{1}_{\\{w_{2,t+1} > 0 \\}}  \\right] ,\n\\end{eqnarray*}\\]\nsince second term right-hand side \\(\\exp(u_2 w_{2,t+1}) \\textbf{1}_{\\{w_{2,t+1} > 0 \\}} \\rightarrow 0\\) \\(u_2 \\rightarrow -\\infty\\), Eq. (1.2) consequence Lebesgue theorem.","code":""},{"path":"ChapterAffine.html","id":"AffineCar","chapter":"1 Affine processes","heading":"1.5 Affine (or Car) processes","text":"term structure applications, often consider affine processes (Definitions 1.1 1.2). processes indeed multi-horizon Laplace transform simple compute (Lemma 1.5 Proposition 1.5), key compute bond prices.","code":""},{"path":"ChapterAffine.html","id":"car-processes-of-order-one","chapter":"1 Affine processes","heading":"1.5.1 Car processes of order one","text":"definition compound auto-regressive (Car) process order one:Definition 1.1  (Affine process order 1) multivariate process \\(w_{t+1}\\) Affine order 1 [\\(Car(1)\\)] \n\\[\n\\varphi_t(u)=\\mathbb{E}_t[\\exp(u'w_{t+1})]=\\exp[(u)'w_t+b(u)]\n\\]\nfunctions \\((.)\\) \\(b(.)\\). functions univariate \\(w_{t+1}\\) (therefore \\(u\\)) scalar.Note \\((.)\\) \\(b(.)\\) may deterministic functions time (e.g., Chikhani Renne (2023)).first key example Gaussian auto-regressive processes:Example 1.5  (Univariate AR(1) Gaussian process) \\(w_{t+1}|\\underline{w_t} \\sim \\mathcal{N}(\\nu+\\rho w_t, \\sigma^2)\\), :\n\\[\n\\varphi_t(u) = \\exp\\left(\n\\begin{array}{l}\nu \\rho w_t + u \\nu + u^2  \\frac{\\sigma^2}{2}\n\\end{array}\n\\right) = \\exp[(u)'w_t+b(u)],\n\\]\n\\[\n\\mbox{}\\left\\{\n\\begin{array}{ccc}\n(u) &=& u \\rho\\\\\nb(u) &=& u \\nu + u^2  \\dfrac{\\sigma^2}{2}.\n\\end{array}\n\\right.\n\\]Example 1.6  (Gaussian VAR) \\(w_{t+1}|\\underline{w_t} \\sim \\mathcal{N}(\\mu+\\Phi w_t, \\Sigma)\\), :\n\\[\n\\varphi_t(u) = \\exp\\left(\n\\begin{array}{l}\nu' (\\mu + \\Phi  w_t)  +  \\frac{1}{2} u' \\Sigma u\n\\end{array}\n\\right) = \\exp[(u)'w_t+b(u)],\n\\]\n\\[\n\\mbox{}\\left\\{\n\\begin{array}{ccl}\n(u) &=& \\Phi'u\\\\\nb(u) &=& u' \\mu +  \\frac{1}{2} u' \\Sigma u = u' \\mu + \\frac{1}{2}(u \\otimes u)' vec(\\Sigma).\n\\end{array}\n\\right.\n\\]Example 1.7  (Quadratic Gaussian process) Consider vector \\(w_t = (x'_t,vec(x_t x_t')')'\\), \\(x_t\\) \\(n\\)-dimensional vector following Gaussian VAR(1), .e.\n\\[\nx_{t+1}|\\underline{w_t} \\sim \\mathcal{N}(\\mu+\\Phi x_t, \\Sigma).\n\\]\nProposition 1.2 shows \\(u = (v,V)\\) \\(v \\\\mathbb{R}^n\\) \\(V\\) square symmetric matrix size \\(n\\), :\n\\[\\begin{eqnarray*}\n\\varphi_t(u) &=& \\mathbb{E}_t\\big\\{\\exp\\big[(v',vec(V)')\\times w_{t+1}\\big]\\big\\} \\\\\n& =& \\exp \\left\\{a_1(v,V)'x_t +vec(a_2(v,V))' vec(x_t'x_t) + b(v,V) \\right\\},\n\\end{eqnarray*}\\]\n:\n\\[\\begin{eqnarray*}\na_2(u) & = & \\Phi'V (I_n - 2\\Sigma V)^{-1} \\Phi \\nonumber \\\\\na_1(u) & = & \\Phi'\\left[(I_n-2V\\Sigma)^{-1}(v+2V\\mu)\\right] \\nonumber \\\\\nb(u) & = & u'(I_n - 2 \\Sigma V)^{-1}\\left(\\mu + \\frac{1}{2} \\Sigma v\\right) +\\\\\n&& \\mu'V(I_n - 2 \\Sigma V)^{-1}\\mu - \\frac{1}{2}\\log\\big|I_n - 2\\Sigma V\\big|.\\tag{1.3}\n\\end{eqnarray*}\\]Quadratic processes can used construct positive process. Indeed, one can determine linear combinations components \\(w_t\\) (\\(\\alpha'w_t\\), say) \\(\\alpha'w_t \\ge 0\\). instance, \\(x_t\\) scalar, \\(\\alpha'w_t = x_t^2\\) \\(\\alpha = (0,1)'\\). illustrated Figure 1.1.\nFigure 1.1: Simulation quadratic processes \\(x_t\\).\nAnother example nonnegative process auto-regressive Gamma process (Christian Gourieroux Jasiak 2006) extension (Alain Monfort et al. 2017).Example 1.8  (Autoregressive gamma process, ARG(1)) ARG process defined follows:\n\\[\n\\frac{w_{t+1}}{\\mu} \\sim \\gamma(\\nu+z_t) \\quad \\mbox{} \\quad z_t \\sim \\mathcal{P} \\left( \\frac{\\rho w_t}{\\mu} \\right),\n\\]\n\\(\\nu\\), \\(\\mu\\), \\(\\rho > 0\\). (Alternatively \\(z_t \\sim {\\mathcal{P}}(\\beta w_t)\\), \\(\\rho = \\beta \\mu\\).)Proposition 1.3 shows \\(\\varphi_t(u) = \\exp[(u)'w_t+b(u)]\\) \n\\[\n\\left\\{\n\\begin{array}{ccc}\n(u) &=&  \\dfrac{\\rho u}{1-u \\mu}\\\\\nb(u) &=& -\\nu  \n\\log(1-u \\mu).\n\\end{array}\n\\right.\n\\]One can simulate ARG processes using web-interface (select “ARG” panel).can shown :\n\\[\n\\left\\{\n\\begin{array}{ccc}\n\\mathbb{E}(w_{t+1}|\\underline{w_t}) &=& \\nu \\mu + \\rho w_t \\\\\n\\mathbb{V}ar(w_{t+1}|\\underline{w_t}) &=& \\nu \\mu^2 + 2 \\mu \\rho w_t.\n\\end{array}\n\\right.\n\\]\n:\n\\[\nw_{t+1}=\\nu\\mu+\\rho w_t+\\varepsilon_{t+1},\n\\]\n\\(\\varepsilon_{t+1}\\) martingale difference \\(\\Rightarrow\\) \\(w_{t+1}\\) weak \\(AR(1)\\).Alain Monfort et al. (2017) porpose extended ARG process ARG\\(_0\\) process. latter \\(\\nu = 0\\) \\(\\beta w_t\\) replaced \\(\\alpha + \\beta w_t\\), .e.:\n\\[\\begin{equation}\n\\frac{w_{t+1}}{\\mu} \\sim \\gamma(z_t),\\quad z_t \\sim {\\mathcal{P}}(\\alpha + \\beta w_t).\\tag{1.4}\n\\end{equation}\\]\neasily seen :\n\\[\n\\varphi_t(u) = exp \\left[\\frac{\\beta \\mu u}{1-u \\mu} w_t + \\frac{\\alpha \\mu u}{1-u \\mu}\n\\right].\n\\]\nARG\\(_0\\) process features point mass zero, conditional probability \\(exp(-\\alpha - \\beta w_t)\\). Note 0 absorbing \\(\\alpha = 0\\).Figure 1.2 displays simulated path ARG\\(_0\\) process (since set \\(\\nu\\) zero). Note function simul.ARG included TSModels package.\nFigure 1.2: Simulation ARG0 processes.\nCertain affine processes valued specific sets (e.g., integers). case compound Poisson proceses:Example 1.9  (Compound Poisson process) compound Poisson process defined follows (\\(\\gamma > 0\\), \\(0 < \\pi< 1\\), \\(\\lambda > 0\\)):\n\\[\\frac{w_{t+1}}{\\gamma} = z_{t+1} + \\varepsilon_{t+1},\n\\]\n\\(z_{t+1}\\) \\(\\varepsilon_{t+1}\\) conditionally independent, \n\\(z_{t+1} \\sim {\\mathcal B} \\left(\\frac{w_t}{\\gamma},\\pi\\right)\\), \\(\\varepsilon_{t+1} \\sim {\\mathcal P}(\\lambda)\\).process valued \\(\\{j \\gamma, j \\\\mathbb{N}, \\gamma \\\\mathbb{R}^+\\}\\) :\n\\[\n\\varphi_t(u) = \\exp\\left\\{\n\\begin{array}{l}\n\\dfrac{w_t}{\\gamma}   \\log[\\pi\n\\exp(u\\gamma)+1-\\pi]-\\lambda[1-\\exp(u \\gamma)]\n\\end{array}\n\\right\\},\n\\]\n.e., \\(\\varphi_t(u) = \\exp\\left((u)w_t+b(u)\\right)\\) \n\\[\n\\left\\{\n\\begin{array}{ccl}\n(u)&=& \\frac{1}{\\gamma}   \\log[\\pi   \\exp(u\n\\gamma)+1-\\pi],\\\\\nb(u) &=& -\\lambda[1-\\exp(u \\gamma)].\n\\end{array}\n\\right.\n\\]also : \\(w_{t+1} = \\pi w_t + \\lambda \\gamma + \\eta_{t+1}\\), \\(\\eta_{t+1}\\) \nmartingale difference.One can simulate processes using web-interface (select “Compound Poisson” panel). Figure 1.3 makes use function simul.compound.poisson (package TSModels) simulate compound Poisson process.\nFigure 1.3: Simulation Compound Poisson process.\n","code":"\nT <- 200\nphi <- .9;sigma <- 1\nx.t <- 0; x <- NULL\nfor(t in 1:T){\n  x.t <- phi*x.t + sigma*rnorm(1)\n  x <- c(x,x.t)}\npar(mfrow=c(1,2),plt=c(.1,.95,.15,.85))\nplot(x,type=\"l\",xlab=\"\",ylab=\"\",main=\"x_t\")\nplot(x^2,type=\"l\",xlab=\"\",ylab=\"\",main=\"x_t^2\")\nlibrary(TSModels)\nW <- simul.ARG(300,mu=.5,nu=0,rho=.9,alpha=.1)\nplot(W,type=\"l\")\nlibrary(TSModels)\nW <- simul.compound.poisson(100,Gamma=.5,Pi=0.5,lambda=.9)\nplot(W,type=\"l\")"},{"path":"ChapterAffine.html","id":"SubCarp","chapter":"1 Affine processes","heading":"1.5.2 Car processes of order \\(p\\)","text":"Let us now define Car processes order \\(p\\):Definition 1.2  (Affine process order p) multivariate process \\(w_{t+1}\\) affine order \\(p\\) [\\(Car(p)\\)] exist functions \\(a_1(.),\\dots,a_p(.)\\), \\(b(.)\\) :\n\\[\n\\varphi_t(u)=\\mathbb{E}_t[\\exp(u' w_{t+1})]=\\exp[a_1(u)'w_t+\\dots+a_p(u)'w_{t+1-p}+b(u)].\n\\]can seen \\(w_t\\) \\(Car(p)\\), \\(W_t = [w_t', w_{t-1}',\\dots,w_{t-p+1}']'\\) \\(Car(1)\\).1 Therefore, without loss generality can assume \\(p = 1\\).standard Car(\\(p\\)) processes auto-regressive processes order \\(p\\). processes satisfy definition index affine processes:Definition 1.3  (Univariate index affine process order p) Let \\(\\exp[(u)w_t+b(u)]\\) conditional Laplace transform univariate affine process order 1, process \\(w_{t+1}\\) index-affine process order \\(p\\) :\n\\[\n\\varphi_t(u)=\\mathbb{E}_t[\\exp(u w_{t+1})]=\\exp[(u)(\\beta_1 w_t+\\dots+\\beta_p\nw_{t+1-p})+b(u)].\n\\]Examples 1.10 1.11 two examples index affine processes.Example 1.10  (Gaussian AR(p) process) example extends Example 1.5. Consider Gaussian AR(p) process \\(w_t\\); :\n\\[\nw_{t+1} = \\nu + \\varphi_1 w_t +\\dots+ \\varphi_p w_{t+1-p}+\\sigma \\varepsilon_{t+1},\\quad \\varepsilon_{t+1} \\sim ..d. \\mathcal{N}(0,1).\n\\]\n:\n\\[\n\\varphi_t(u) = \\exp \\left[ u \\rho (\\beta_1 w_t+\\dots+\\beta_p w_{t+1-p})+u\\nu + u^2  \\frac{\\sigma^2}{2}\\right]\n\\]\n\\(\\varphi_i = \\rho \\beta_i\\).Example 1.11  (ARG(p) process (positive)) example extends Example 1.8.\nARG process order \\(p\\) defined follows:\n\\[\n\\frac{w_{t+1}}{\\mu} \\sim \\gamma(\\nu+z_t) \\quad \\mbox{} \\quad z_t \\sim \\mathcal{P} \\left( \\beta_1 w_t+\\dots+\\beta_p w_{t+1-p} \\right),\n\\]\n\\(\\nu\\), \\(\\mu\\), \\(\\beta_i > 0\\). :\n\\[\n\\varphi_t(u) = \\exp\\left[\\frac{\\rho u}{1-u \\mu} (\\beta_1 w_t+\\dots+\\beta_p w_{t+1-p})-\\nu  \\log(1-u\\mu)\\right],\n\\]\nProcess \\(w_t\\) admits following AR(\\(p\\)) representation:\n\\[\nw_{t+1} = \\nu\\mu + \\varphi_1 w_t +\\dots+ \\varphi_p w_{t+1-p}+\\varepsilon_{t+1},\n\\]\n\\(\\varphi_i = \\beta_i\\mu\\) \\(\\varepsilon_{t+1}\\) martingale difference.","code":""},{"path":"ChapterAffine.html","id":"Markov","chapter":"1 Affine processes","heading":"1.6 Markov chains","text":"subsection, show family affine processes includes () regime-switching models. consider time-homogeneous Markov chain \\(z_t\\), valued set columns \\(Id_J\\), identity matrix dimension \\(J \\times J\\). transition probabilities denoted \\(\\pi(e_i, e_j)\\), \\(\\pi(e_i, e_j) = \\mathbb{P}(z_{t+1}=e_j | z_t=e_i)\\). notations:\n\\[\n\\mathbb{E}[\\exp(v'z_{t+1})|z_t=e_i,\\underline{z_{t-1}}] = \\sum^J_{j=1} \\exp(v'e_j)\\pi (e_i, e_j).\n\\]\nHence, :\n\\[\n\\varphi_t(v) = \\exp[a_z(v)'z_t],\n\\]\n\n\\[\na_z(v)= \\left[ \\begin{array}{c} \\log \\left(\\sum^J_{j=1} \\exp(v'e_j)  \\pi(e_1,e_j)\\right)\\\\\n\\vdots\\\\\n\\log \\left(\\sum^J_{j=1} \\exp(v'e_j)  \\pi(e_J,e_j)\\right)\n\\end{array}\\right].\n\\]\nproves \\(z_t\\) affine process.One can simulate two-regime Markov chain using web-interface (select “Markov-Switching” panel).","code":""},{"path":"ChapterAffine.html","id":"WAR","chapter":"1 Affine processes","heading":"1.7 Wishart autoregressive (WAR) processes","text":"WAR matrix processes, valued space \\((L \\times L)\\) symmetric positive\ndefinite matrices.Definition 1.4  (Wishart autoregressive (WAR) processes) Let \\(W_{t+1}\\) \\(WAR_L(K, M, \\Omega)\\) process. defined :\n\\[\\begin{eqnarray}\n&&\\mathbb{E}[\\exp   Tr(\\Gamma W_{t+1})|\\underline{W_t}] \\tag{1.5}\\\\\n&=& \\exp\\left\\{Tr[M'\\Gamma(Id-2\\Omega \\Gamma)^{-1}M W_t]  -  \\frac{K}{2}   \\log [det(Id-2\\Omega \\Gamma)]\\right\\}, \\nonumber\n\\end{eqnarray}\\]\n\\(\\Gamma\\) symmetric matrix,2 \\(K\\) positive scalar, \\(M\\) \\((L \\times L)\\) matrix, \\(\\Omega\\) \\((L \\times L)\\) symmetric positive definite matrix.\\(K\\) integer, Proposition 1.4 (appendix) shows \\(W_{t+1}\\) can obtained :\n\\[\\begin{eqnarray*}\n\\left\\{\n\\begin{array}{ccl}\nW_{t+1} & =&  \\sum^K_{k=1} x_{k,t+1} x'_{k,t+1}\\\\\n&&\\\\\nx_{k,t+1} & =& M x_{k,t} + \\varepsilon_{k,t+1},\\quad k \\\\{1,\\dots,K\\},\n\\end{array}\n\\right.\n\\end{eqnarray*}\\]\n\\(\\varepsilon_{k,t+1} \\sim ..d. \\mathcal{N}(0, \\Omega)\\) (independent across \\(k\\)’s).\nproposition also shows :\n\\[\n\\mathbb{E}(W_{t+1}|\\underline{W_t}) = MW_tM'+K \\Omega,\n\\]\n.e. \\(W_t\\) follows matrix weak AR(1) process.particular case, \\(L=1\\) (univariate case), :\n\\[\\begin{eqnarray*}\n\\mathbb{E}[\\exp(u W_{t+1})|\\underline{W_t}] = \\exp\\left[\n\\frac{u m^2}{1-2\\omega u}W_t -\n\\frac{K}{2}   \\log(1-2\\omega u)\\right].\n\\end{eqnarray*}\\]\nHence, \\(L=1\\), Wishart process boils \\(ARG(1)\\) process (Example 1.8) \\(\\rho = m^2\\), \\(\\mu = 2\\omega\\), \\(\\nu = \\frac{K}{2}\\).","code":""},{"path":"ChapterAffine.html","id":"building","chapter":"1 Affine processes","heading":"1.8 Building affine processes","text":"","code":""},{"path":"ChapterAffine.html","id":"stoch","chapter":"1 Affine processes","heading":"1.8.1 Univariate affine processes with stochastic parameters","text":"univariate affine processes can extended satisfy certain conditions. Specifically, consider univariate affine process whose conditional L.T. form:\n\\[\\begin{equation}\n\\mathbb{E}_t   \\exp(u y_{t+1}) = \\exp[a_0(u)y_t+b_0(u)\\delta],\\tag{1.6}\n\\end{equation}\\]\n\\(\\delta = (\\delta_1,\\dots,\\delta_m)' \\\\mathcal{D}\\). process can generalized making \\(\\delta\\) stochastic (staying affine family). precisely assume :\n\\[\n\\mathbb{E}[\\exp(u y_{t+1})|\\underline{y_t}, \\underline{z_{t+1}}] = \\exp[a_0(u)y_t+b_0(u)'\\Lambda z_{t+1}],\n\\]\n\\(\\Lambda\\) \\((m\\times k)\\) matrix, \\(\\Lambda z_{t+1} \\\\mathcal{D}\\). case, :\n\\[\n\\mathbb{E}[\\exp(v' z_{t+1})|\\underline{y_t}, \\underline{z_{t}}] = \\exp[a_1(v)'z_t+b_1(v)],\n\\]\n\\(w_{t+1} = (y_{t+1}, z'_{t+1})'\\) affine.3Example 1.12  (Gaussian AR(p)) Using notation Example 1.10, comes AR(p) processes satisfies Eq. (1.6) \\(b_0(u) = \\left(u, \\; \\frac{u^2}{2}\\right)'\\) \\(\\delta = (\\nu,\\sigma^2)' \\\\mathcal{D}=\\mathbb{R} \\times \\mathbb{R}^+\\). case, \\(\\delta\\) (vector conditional mean variance) can replaced …\\(\\left( \\begin{array}{l} z_{1,t+1} \\\\ z_{2,t+1} \\end{array} \\right)\\), \\(z_{1,t+1}\\) \\(z_{2,t+1}\\) independent AR(1) (see Example 1.5) ARG(1) (see Example 1.8) processes, respectively.\\(\\left( \\begin{array}{ll} \\lambda'_1 & 0 \\\\ 0 & \\lambda'_2 \\end{array} \\right)\\)\\(\\left( \\begin{array}{l} z_{1,t+1} \\\\ z_{2,t+1} \\end{array} \\right)\\), \\(z_{1,t+1}\\) \\(z_{2,t+1}\\) independent Markov chains.\\(\\left( \\begin{array}{l} \\lambda'_1 \\\\ \\lambda'_2 \\end{array}\\right)z_{t+1}\\), \\(z_{t+1}\\) Markov chain.Example 1.11  (ARG(p) model) \\(b_0(u)= - \\nu \\log(1-u\\mu)\\), \\(\\delta=\\nu\\).\\(\\nu\\) (\\(\\ge 0\\)) can specified instance Markov chain ARG.","code":""},{"path":"ChapterAffine.html","id":"buildingmulti","chapter":"1 Affine processes","heading":"1.8.2 Multivariate affine processes","text":"One can construct multivariate affine processes employing -called recursive approach. Let us illustrate considering bivariate case. (multivariate generalization straightforward.) Consider \\(w_t = \\left(\\begin{array}{c} w_{1,t}\\\\ w_{2,t} \\end{array} \\right)\\),assume :\n\\[\\begin{eqnarray*}\n&&\\mathbb{E}[\\exp(u_1 w_{1,t+1}|\\underline{w_{1,t}}, \\underline{w_{2,t}})]\\\\\n&=& \\exp[a_{11}(u_1)w_{1,{\\color{red}{t}}}+a_{12}(u_1)w_{2,{\\color{red}{t}}}+b_{1}(u_1)],\n\\end{eqnarray*}\\]\n:\n\\[\\begin{eqnarray*}\n&& \\mathbb{E}[\\exp(u_2 w_{2,t+1}|\\underline{w_{1,t+1}}, \\underline{w_{2,t}})]\\\\\n&= & \\exp[a_0(u_2)w_{1,{\\color{red}{t+1}}}+a_{21}(u_2)w_{1,{\\color{red}{t}}}+a_{22}(u_2)w_{2,{\\color{red}{t}}}+b_2(u_2)].\n\\end{eqnarray*}\\]\n\\(w_t\\) affine process.4\ndynamics two components \\(w_t\\) form:\n\\[\\begin{eqnarray*}\nw_{1,t+1} &=& \\alpha_1 \\hspace{1.55cm} + \\alpha_{11}w_{1,t} + \\alpha_{12}w_{2,t} + \\varepsilon_{1,t+1} \\\\\nw_{2,t+1} &=& \\alpha_2 + \\alpha_{0}w_{1,t+1} + \\alpha_{21}w_{1,t} + \\alpha _{22} w_{2,t} + \\varepsilon_{2,t+1}\n\\end{eqnarray*}\\]\nNote \\(\\varepsilon_{1,t+1}\\) \\(\\varepsilon_{2,t+1}\\) non-correlated martingale differences. general case, conditionally heteroskedastic. precedes play \\(VAR\\) model; Alain Monfort et al. (2017) employ approach build vector auto-regressive gamma (VARG) processes.","code":""},{"path":"ChapterAffine.html","id":"extending-multivariate-stochastic-processes","chapter":"1 Affine processes","heading":"1.8.3 Extending multivariate stochastic processes","text":"Consider framework Section 1.8.1 \\(y_t\\) \\(n\\)-dimensional vector. , replace Eq. (1.6) :\n\\[\\begin{equation}\n\\mathbb{E}_t   \\exp(u' y_{t+1}) = \\exp[a_0(u)'y_t+b_0(u)\\delta],\\tag{1.7}\n\\end{equation}\\]\nassume \\(\\delta\\) stochastic depends \\(z_t\\), :\n\\[\n\\mathbb{E}[\\exp(u y_{t+1})|\\underline{y_t}, \\underline{z_{t+1}}] = \\exp[a_0(u)y_t+b_0(u)'\\Lambda z_{t+1}],\n\\]\n\\(\\Lambda\\) \\((m\\times k)\\) matrix, \\(\\Lambda z_{t+1} \\\\mathcal{D}\\). case, :\n\\[\n\\mathbb{E}[\\exp(v' z_{t+1})|\\underline{y_t}, \\underline{z_{t}}] = \\exp[a_1(v)'z_t+b_1(v)],\n\\]\n\\(w_{t+1} = (y_{t+1}, z'_{t+1})'\\) affine.Example 1.13  (Stochastic parameters Gaussian VAR(1)) example extends Example 1.6. Using notations latter example 1.6, \n\\[\nb_0(u) = \\left(u', \\frac{1}{2} (u \\otimes u)'\\right)' \\quad \\mbox{} \\quad\\delta = (\\mu', vec(\\Sigma)')' \\\\mathbb{R}^n \\times vec(\\mathcal{S}),\n\\]\n\\(\\mathcal{S}\\) set symmetric positive semi-definite matrices. Vector \\(\\delta\\) can replaced :\n\\[\n\\left( \\begin{array}{l} z_{1,t+1}\n\\\\ z_{2,t+1}\n\\end{array} \\right),\n\\]\n\\(z_{1,t+1}\\) , instance, Gaussian VAR process.\\(z_{2,t+1}\\) isobtained applying \\(vec\\) operator Wishart process,replaced \\(\\Lambda_2 z_{2,t+1}\\), \\(\\Lambda_2\\) \\((n^2 \\times J)\\) matrix whose columns \\(vec(\\Sigma_j)\\), \\(j \\\\{1,\\dots,J\\}\\), \\(\\Sigma_j\\) \\((n \\times n)\\) positive semi-definite,standardized \\(J\\)-dimensional VARG process (multivariate extension Example 1.8).Example 1.14  (Regime-switching VAR(1)) One can also use approach construct (affine) regime-switching VAR processes (another extension Example 1.6 (see, e.g., Christian Gourieroux et al. (2014)). , replace \\(\\delta\\) \\(\\left( \\begin{array}{ll} \\Lambda_1 & 0 \\\\ 0 & \\Lambda_2 \\end{array} \\right)\\)\\(\\left( \\begin{array}{l} z_{1,t+1} \\\\ z_{2,t+1} \\end{array} \\right)\\), \\(\\Lambda_1\\) \\((n \\times J_1)\\) matrix \\(z_{1,t+1}\\) Markov chain valued set selection vectors size \\(J_1\\) (see Subsection 1.6), \\(\\Lambda_2\\) matrix Example 1.13 \\(z_{2,t+1}\\) Markov chain valued set selection vectors size \\(J_2\\).\\(\\left( \\begin{array}{l} \\Lambda_1 \\\\ \\Lambda_2 \\end{array}\\right)z_{t+1}\\), \\(\\Lambda_1\\) \\(\\Lambda_2\\) matrices \\(J_1=J_2=J\\), \\(z_{t+1}\\) Markov chain valued set selection vectors size \\(J\\).","code":""},{"path":"ChapterAffine.html","id":"AffineExtended","chapter":"1 Affine processes","heading":"1.8.4 Extended affine processes","text":"processes affine, may sub-components affine process. can useful compute conditional moments multi-horizon Laplace transform (one can use formulas presented , using enlarged—affine—vector).Let us formally define extended affine process:Definition 1.5  (Extended Affine Processes) process \\(w_{1,t}\\) extended affine exists process \\(w_{2,t} = g(\\underline{w_{1,t}})\\) \\((w'_{1,t}, w'_{2,t})'\\) affine (order 1).extended affine processes, \\(\\varphi_{1,t}(u) = \\mathbb{E}[\\exp(u'w_{1,t+1})|\\underline{w_{1,t}}]\\) can obtained :\n\\[\\begin{eqnarray*}\n\\varphi_t(u_1, u_2) &=& \\mathbb{E}[\\exp(u'_1w_{1,t+1}+u'_2 w_{2,t+1)}|\\underline{w_{1,t}}, \\underline{w_{2,t}}] \\\\\n&=& \\exp['_1(u_1,u_2)w_{1,t} + '_2(u_1,u_2)w_{2,t}+b(u_1,u_2)]\n\\end{eqnarray*}\\]\n:\n\\[\n\\varphi_{1,t}(u) = \\varphi_t(u, 0) = \\exp['_1(u,0)w_{1,t}+'_2(u,0)g(\\underline{w_{1,t}}) + b(u, 0)].\n\\]\nparticular \\(w_{1,t}\\) may non-Markovian.Similarly multi-horizon Laplace transform (see Section 1.9)\n\\[\n\\mathbb{E}[\\exp(\\gamma'_{1}w_{1,t+1}+\\dots+\\gamma'_{h}w_{1,t+h})|\\underline{w_{1,t}}]\n\\]\ncan obtained knowledge extended multi-horizon Laplace transform:\n\\[\\begin{eqnarray*}\n&&\\mathbb{E}_t[\\exp(\\{\\gamma'_{1,1}w_{1,t+1}+\\gamma'_{2,1}w_{2,t+1}\\}+\\dots+ \\{\\gamma'_{1,h}w_{1,t+h}+\\gamma'_{2,h}w_{2,t+h}\\}] \\\\\n&=& \\exp['_{1,t,h}(\\gamma^h_1, \\gamma^h_2)w_{1,t}+'_{2,t,h}(\\gamma^h_1, \\gamma^h_2)w_{2,t}+B_{t,h}(\\gamma^h_1, \\gamma^h_2)],\n\\end{eqnarray*}\\]\n(\\(\\gamma^h_1 = (\\gamma'_{1,1},\\dots, \\gamma'_{1,h})'\\), \\(\\gamma^h_2 = (\\gamma'_{2,1},\\dots, \\gamma'_{2,h})'\\)). indeed :\n\\[\\begin{eqnarray*}\n&& \\mathbb{E}[\\exp(\\gamma'_{1}w_{1,t+1}+\\dots+\\gamma'_{h}w_{1,t+h})|\\underline{w_{1,t}}]\\\\\n&=& \\exp['_{1,t,h}(\\gamma^h,0) w_{1,t} + '_{2,t,h}(\\gamma^h,0)g (\\underline{w_{1,t}}) + B_{t,h}(\\gamma^h,0)],\n\\end{eqnarray*}\\]\n\\(\\gamma^h = (\\gamma_1',\\dots,\\gamma_h')'\\).Example 1.15  (Affine process order p) \\(\\{w_{1,t}\\}\\) affine order \\(p>1\\), \\((w_{1,t},\\dots,w_{1,t-p+1})\\) affine order 1, \\(\\{w_{1,t}\\}\\) affine. , case, \\(w_{2,t} = (w'_{1,t-1}, \\dots.w'_{1,t-p+1})'\\).kind extreme case since \\(w_{2,t}\\) belongs information \\(t-1\\), implies \\(a_2(u_1, u_2) = u_2\\).Example 1.16  (Gaussian ARMA process) Consider \\(ARMA(1,1)\\) process\n\\[\nw_{1,t} - \\varphi w_{1,t-1} = \\varepsilon_t-\\theta \\varepsilon_{t-1},\n\\]\n\\(|\\varphi | < 1\\), \\(|\\theta| < 1\\), \\(\\varepsilon_t \\sim ..d. \\mathcal{N}(0, \\sigma^2)\\).\\(w_{1,t}\\) Markovian. Now, take \\(w_{2,t} = \\varepsilon_t = (1-\\theta L)^{-1}(1-\\varphi L)w_{1,t}\\). :\n\\[\n\\left(\n\\begin{array}{l}\nw_{1,t+1} \\\\\nw_{2,t+1}\n\\end{array}\n\\right) =\n\\left(\n\\begin{array}{ll}\n\\varphi & -\\theta \\\\\n0 &      0\n\\end{array}\n\\right)\n\\left(\n\\begin{array}{l}\nw_{1,t} \\\\\nw_{2,t}\n\\end{array}\n\\right) +\n\\left(\n\\begin{array}{l}\n1 \\\\\n1\n\\end{array}\n\\right) \\varepsilon_{t+1}.\n\\]\nHence \\((w_{1,t}, w_{2,t})'\\) Gaussian \\(VAR(1)\\), , therefore, affine order 1.easily extended \\(ARMA(p,q)\\) \\(VARMA(p,q)\\) processes.Example 1.17  (GARCH type process) Consider process \\(w_{1,t}\\), defined :\n\\[\nw_{1,t+1}  = \\mu + \\varphi w_{1,t} + \\sigma_{t+1} \\varepsilon_{t+1},\n\\]\n\\(|\\varphi| < 1\\) \\(\\varepsilon_t \\sim ..d. \\mathcal{N}(0,1)\\), \n\\[\n\\sigma^2_{t+1} = \\omega + \\alpha \\varepsilon^2_t + \\beta \\sigma^2_t,\n\\]\n\\(0 < \\beta < 1\\).Consider \\(w_{2,t} = \\sigma^2_{t+1}\\) (non-linear function \\(\\underline{w_{1,t}}\\)). Proposition 1.7 shows :\n\\[\\begin{eqnarray*}\n&& \\mathbb{E}\\left[\\exp(u_1 w_{1,t+1} + u_2 w_{2,t+1})|\\underline{w_{1,t}}\\right] \\\\\n&=& \\exp\\left[u_1 \\mu + u_2 \\omega - \\frac{1}{2}   \\log(1-2 u_2 \\alpha) \\right. \\\\\n&&\\left. +  u_1 \\varphi w_{1,t} + (u_2\\beta +  \\frac{u^2_1}{2(1-2u_2\\alpha)}) w_{2,t}\\right],\n\\end{eqnarray*}\\]\nexponential affine \\((w_{1,t}, w_{2,t})\\).","code":""},{"path":"ChapterAffine.html","id":"MHLT","chapter":"1 Affine processes","heading":"1.9 Multi-horizon Laplace transform","text":"","code":""},{"path":"ChapterAffine.html","id":"recursive-computation-and-direct-pricing-implications","chapter":"1 Affine processes","heading":"1.9.1 Recursive computation and direct pricing implications","text":"subsection, show multi-horizon Laplace transforms affine processes can calculated recursively. Various examples show can exploited price long-dated financial instruments.Let us consider multivariate process \\(w_{t}\\), affine order one. (explained Subsection 1.5.2, includes case order \\(p\\) case.) sake generality, consider case functions \\((.)\\), \\(b(.)\\) possibly deterministic functions time, denoted case \\(a_{t+1}(.)\\) \\(b_{t+1}(.)\\):\n\\[\n\\mathbb{E}_t \\exp[(u'w_{t+1})] = \\exp['_{t+1}(u)w_t+b_{t+1}(u)].\n\\]\nmulti-horizon Laplace transform associated date \\(t\\) horizon \\(h\\) defined :\n\\[\\begin{equation}\n\\varphi_{t,h}(\\gamma_1,\\dots,\\gamma_h) = \\mathbb{E}_t[\\exp(\\gamma'_1w_{t+1}+\\dots+\\gamma'_h w_{t+h})].\\tag{1.8}\n\\end{equation}\\]Lemma 1.5 (appendix) shows :\n\\[\n\\varphi_{t,h}(\\gamma_1,\\dots,\\gamma_h) = \\exp('_{t,h} w_t + B_{t,h}),\n\\]\n\\(A_{t,h} = ^h_{t,h}\\) \\(B_{t,h} = B^h_{t,h}\\), \\(^h_{t,}, B^h_{t,}\\) \\(= 1,\\dots,h\\), given recursively :\n\\[\n\\left\\{\n\\begin{array}{ccl}\n^h_{t,} &=& a_{t+h+1-}(\\gamma_{h+1-} + ^h_{t,-1}), \\\\\nB^h_{t,} &=& b_{t+h+1-}(\\gamma_{h+1-} + ^h_{t,-1}) + B^h_{t,-1}, \\\\\n^h_{t,0} &=& 0, B^h_{t,0} = 0.\n\\end{array}\n\\right.\n\\]functions \\(a_{t}\\) \\(b_{t}\\) depend \\(t\\), recursive formulas depend \\(t\\), get \\(\\varphi_{t,h}(\\gamma_1,\\dots,\\gamma_h)\\), \\(t\\), one recursion \\(h\\).Moreover, functions \\(a_{t}\\) \\(b_{t}\\) depend \\(t\\), different sequences \\((\\gamma^h_1,\\dots,\\gamma^h_h), h=1,\\dots,H\\) (say) satisfy \\(\\gamma^h_{h+1-} = u_i\\), \n\\(=1,\\dots,h\\), \\(h \\leq H\\), want compute (reverse-order case):\n\\[\\begin{equation}\n\\varphi_{t,h}(u_h,\\dots,u_1)=\\mathbb{E}_t[\\exp(u'_{{\\color{red}h}} w_{{\\color{red}t+1}}+\\dots+u'_{{\\color{red}1}} w_{{\\color{red}t+h}})],\n\\quad h=1,\\dots,H,\\tag{1.9}\n\\end{equation}\\]\nProposition 1.5 (appendix) shows can compute \\(\\varphi_{t,h}(u_h,\\dots,u_1)\\) \\(t\\) \\(h \\leq H\\) one recursion. \\(\\varphi_{t,h}(u_h,\\dots,u_1)=\\exp('_hw_t+B_h)\\) :\n\\[\\begin{equation*}\n\\left\\{\n\\begin{array}{ccl}\nA_{h} &=& (u_{h} + A_{h-1}), \\\\\nB_{h} &=& b(u_{h} + A_{h-1}) + B_{h-1}, \\\\\nA_{0} &=& 0,\\quad  B_{0} = 0.\n\\end{array}\n\\right.\n\\end{equation*}\\]mentioned , precedes useful implications price long-dated financial instruments nominal real bonds (Examples 1.18 1.20, respectively), futures (Example 1.21).Example 1.18  (Nominal interest rates) Let \\(B(t,h)\\) denote date-\\(t\\) price nominal zero-coupon bond maturity \\(h\\). :\n\\[\\begin{equation}\nB(t,h) = \\mathbb{E}^{\\mathbb{Q}}_t exp (-r_{t}-\\dots-r_{t+h-1}),\\tag{1.10}\n\\end{equation}\\]\n\\(r_{t}\\) nominal short rate \\(t\\) \\(t+1\\) (observed \\(t\\)), associated (continuously-compounded) yield--maturity given :\n\\[\\begin{equation}\nR(t,h) = -  \\frac{1}{h}   \\log   B(t,h), \\quad   h=1,\\dots,H.\n\\end{equation}\\]\n\\(r_t = \\omega'w_t\\) (say), :\n\\[\nB(t,h) = \\exp(-r_{t}) \\mathbb{E}^{\\mathbb{Q}}_t \\exp(-\\omega' w_{t+1} - \\dots - \\omega' w_{t+h-1}).\n\\]\nOne can price bond directly employing Eq. (1.9), \\(u_1 = 0\\) \\(u_i = - \\omega\\), \\(= 2,\\dots, H\\).\nprice \\(B(t,h)\\) exponential affine \\(w_t\\), associated yield--maturity \\(R(t,h)=-1/h\\log B(t,h)\\) affine \\(w_t\\).Example 1.19  (-arbitrage Nelson-Siegel model) example, employ results Example 1.18 context described Christensen, Diebold, Rudebusch (2009). Specifically, consider three factor model following Gaussian VAR (see Example 1.6):\n\\[\nw_t = \\left[\\begin{array}{c}X_{1,t}\\\\X_{2,t}\\\\X_{3,t}\\end{array}\\right] =\n\\left[\\begin{array}{ccc}\n1 & 0 & 0\\\\\n0&1-\\lambda&\\lambda\\\\\n0&0&1-\\lambda\\end{array}\\right]\n\\left[\\begin{array}{c}X_{1,t-1}\\\\X_{2,t-1}\\\\X_{2,t-1}\\end{array}\\right] +\n\\left[\\begin{array}{ccc}\n\\sigma_{11} & 0 & 0\\\\\n\\sigma_{21}&\\sigma_{22}&0\\\\\n\\sigma_{31}&\\sigma_{32}&\\sigma_{33}\\end{array}\\right]\n\\left[\\begin{array}{c}\\varepsilon_{1,t}\\\\\\varepsilon_{2,t}\\\\\\varepsilon_{3,t}\\end{array}\\right],\n\\]\n\\(\\left[\\begin{array}{c}\\varepsilon_{1,t}\\\\\\varepsilon_{2,t}\\\\\\varepsilon_{3,t}\\end{array}\\right] \\sim \\,..d.\\, \\mathcal{N}(0,Id)\\).nominal short-term rate given \\(r_t = X_{1,t}+X_{2,t}\\). case, can use results Example 1.18 \\(\\omega = (-1,-1,0)'\\). following lines code :\nFigure 1.4: Factor loadings context -arbitrage nelson-Siegel model (Christensen, Diebold Rudebusch, 2009). first factor (black solid line) level factor. second third factors (red dashed line blue dotted line, respectively) slope factors.\nprevious example, note use function reverse.MHLT (package TSModels), notably takes L.T. argument (psi). previous example, consider Gaussian VAR, therefore assign psi.GaussianVAR psi. need provide function reverse.MHLT arguments psi function. arguments provided form list (input psi.parameterization).Example 1.20  (Real interest rates) Denote \\(q_t\\) price index date \\(t\\) \\(\\pi_{t+1} = \\log \\dfrac{q_{t+1}}{q_t}\\) inflation rate date \\(t+1\\). :\n\\[\\begin{eqnarray*}\n\\bar{R}(t,h) & =& -   \\frac{1}{h}   \\log   \\bar{B}(t,h), \\quad h=1,\\dots,H \\\\    \\\\\n\\bar{B}(t,h) & =&  \\mathbb{E}^{\\mathbb{Q}}_t   \\exp(-r_{t}-\\dots-r_{t+h-1} + \\pi_{t+1}+\\dots+\\pi_{t+h}),  \\\\      \\\\\n& =& \\exp(-r_{t}) \\times \\\\\n&& \\mathbb{E}^{\\mathbb{Q}}_t \\exp(-r_{t+1}-\\dots-r_{t+h-1}+\\pi_{t+1}+\\dots+\\pi_{t+h})\n\\end{eqnarray*}\\]\n\\(r_t = \\omega'w_t\\) \\(\\pi_t = \\bar\\omega'w_t\\), \\(\\bar{B}(t,h)\\) given :\n\\[\\begin{eqnarray*}\n\\exp(-r_{t}) \\mathbb{E}^{\\mathbb{Q}}_t exp[(\\bar\\omega-\\omega)'w_{t+1}+\\dots+(\\bar\\omega-\\omega)'w_{t+h-1}+\\bar\\omega'\nw_{t+h}]\n\\end{eqnarray*}\\]\nOne can price bond directly employing Eq. (1.9), \\(u_1 = \\bar\\omega\\) \\(u_i = \\bar\\omega-\\omega\\), \\(= 2,\\dots, H\\).Example 1.21  (Futures) Denote \\(F(t,h)\\) date-\\(t\\) price future maturity \\(h\\) (see Section XXX). \\(F(t,h) = \\mathbb{E}^{\\mathbb{Q}}_t (S_{t+h})\\), \\(h=1,\\dots,H\\), \\(S_t\\) date-\\(t\\) price underlying asset.\\(w_t = (\\log S_t, x'_t)'\\) \\(F(t,h) = \\mathbb{E}^{\\mathbb{Q}}_t \\exp(e'_1 w_{t+h})\\). can calculated using Eq. (1.9) \\(u_1 = e_1\\), \\(u_i = 0\\), \\(=2,\\dots,H\\).\\(w_t = (\\log S_t, x'_t)'\\) \\(F(t,h) = \\mathbb{E}^{\\mathbb{Q}}_t \\exp(e'_1 w_{t+h})\\). can calculated using Eq. (1.9) \\(u_1 = e_1\\), \\(u_i = 0\\), \\(=2,\\dots,H\\).\\(w_t = (y_t, x'_t)'\\) \\(y_t = \\log\\frac{S_t}{S_{t-1}}\\), \\(F(t,h) = S_t \\mathbb{E}^{\\mathbb{Q}}_t \\exp(e'_1 w_{t+1}+\\dots+e'_1 w_{t+h})\\). can calculated using Eq. (1.9) \\(u_i = e'_1\\), \\(=1,\\dots,H\\).\\(w_t = (y_t, x'_t)'\\) \\(y_t = \\log\\frac{S_t}{S_{t-1}}\\), \\(F(t,h) = S_t \\mathbb{E}^{\\mathbb{Q}}_t \\exp(e'_1 w_{t+1}+\\dots+e'_1 w_{t+h})\\). can calculated using Eq. (1.9) \\(u_i = e'_1\\), \\(=1,\\dots,H\\).","code":"\nlibrary(TSModels)\nlambda <- .05\nPhi <- diag(c(1,1-lambda,1-lambda));Phi[2,3] <- lambda\nSigma <- .0005 * diag(3)\npsi.parameterization=list(mu=matrix(0,3,1),Phi=Phi,Sigma=Sigma)\nu1 <- matrix(0,3,1)\nu2 <- matrix(c(-1,-1,0),ncol=1)\nH <- 20\nAB <- reverse.MHLT(psi.GaussianVAR,u1 = u1,u2 = u2,H = H,\n                   psi.parameterization = psi.parameterization)\nAB$A[1:2,,] <- AB$A[1:2,,] - 1 # add terms corresponding to exp(-r_t)\na.yield <- - AB$A / array((1:H) %x% rep(1,3),c(3,1,H))\nb.yield <- - AB$B / array((1:H) %x% rep(1,3),c(1,1,H))\nplot(a.yield[1,,],type=\"l\",lwd=2,ylim=c(0,1),\n     xlab=\"Maturity\",ylab=\"Factor loadings\")\nlines(a.yield[2,,],col=\"red\",lwd=2,lty=2)\nlines(a.yield[3,,],col=\"blue\",lwd=2,lty=3)"},{"path":"ChapterAffine.html","id":"ExponentialPayoff","chapter":"1 Affine processes","heading":"1.9.2 Exponential payoff","text":"Consider asset providing payoff \\(\\exp(\\nu' w_{t+h})\\) date \\(t+h\\). price given :\n\\[\nP(t,h;\\nu) = \\mathbb{E}^{\\mathbb{Q}}_t[\\exp(-r_{t}-\\dots-r_{t+h-1}) \\exp(\\nu' w_{t+h})].\n\\]\n\\(r_t = \\omega'w_t\\), :\n\\[\nP(t,h;\\nu) = \\exp(-r_{t})\\mathbb{E}^{\\mathbb{Q}}_t \\left(exp[-\\omega' w_{t+1}-\\dots-\\omega' w_{t+h-1}+ \\nu' w_{t+h}]\\right),\n\\]\ncan calculated Eq. (1.9), \\(u_1 = \\nu\\) \\(u_i = -\\omega\\) \\(= 2,\\dots,H\\).precedes can extended case payoff (settled date \\(t+h\\)) form:\n\\[\n(\\nu_1'w_{t+h}) \\exp(\\nu_2' w_{t+h}).\n\\]\nIndeed, \n\\[\n\\left[\\frac{\\partial \\exp[(s \\nu_1+ \\nu_2)'w_{t+h}]}{\\partial s}\\right]_{s=0} = (\\nu_1'w_{t+h}) \\exp(\\nu_2' w_{t+h}).\n\\]\nTherefore:\n\\[\\begin{eqnarray}\n&&\\mathbb{E}_t^{\\mathbb{Q}}[\\exp(-r_t - \\dots - r_{t+h-1})(\\nu_1'w_{t+h}) \\exp(\\nu_2' w_{t+h})] \\nonumber\\\\\n&=& \\left[\n\\frac{\\partial P(t,h;s \\nu_1 + \\nu_2)}{\\partial s}\n\\right]_{s=0}.\\tag{1.11}\n\\end{eqnarray}\\]\nmethod easily extended price payoffs form \\((\\nu_1'w_{t+h})^k \\exp(\\nu_2' w_{t+h})\\), \\(k \\\\mathbb{N}\\).","code":""},{"path":"ChapterAffine.html","id":"var-representation-and-conditional-moments","chapter":"1 Affine processes","heading":"1.10 VAR representation and conditional moments","text":"important property affine processes dynamics can written vector-autoregressive process. useful compute conditional moments process.Proposition 1.1  (VAR representation affine process' dynamics) \\(w_t\\) affine process whose Laplace transform defined Def. 1.1, dynamics admits following vectorial autoregressive representation:\n\\[\\begin{equation}\nw_{t+1} = \\mu + \\Phi w_{t} + \\Sigma^{\\frac{1}{2}}(w_t) \\varepsilon_{t+1},\\tag{1.12}\n\\end{equation}\\]\n\\(\\varepsilon_{t+1}\\) difference martingale sequence whose conditional covariance matrix identity matrix \\(\\mu\\), \\(\\Phi\\) \\(\\Sigma(w_t) = \\Sigma^{\\frac{1}{2}}(w_t){\\Sigma^{\\frac{1}{2}}(w_t)}'\\) satisfy:\n\\[\\begin{equation}\n\\mu =  \\left[\\frac{\\partial }{\\partial u}b(u)\\right]_{u=0}, \\quad \\Phi= \\left[\\frac{\\partial }{\\partial u}(u)'\\right]_{u=0}\\tag{1.13}\n\\end{equation}\\]\n\\[\\begin{equation}\n\\Sigma(w_t) =  \\left[\\frac{\\partial }{\\partial u\\partial u'}b(u)\\right]_{u=0} + \\left[\\frac{\\partial }{\\partial u\\partial u'}(u)'w_t\\right]_{u=0}.\\tag{1.14}\n\\end{equation}\\]Proof. \\(w_t\\) affine, (conditional) cumulant generating function form \\(\\psi(u)=(u)'w_t+b(u)\\). result directly follows formulas given Section 1.3.Proposition 1.6 (appendix) shows conditional means variances \\(w_t\\) given :\n\\[\\begin{eqnarray}\n\\mathbb{E}_t(w_{t+h}) &=& (- \\Phi)^{-1}(- \\Phi^h)\\mu + \\Phi^h w_t \\tag{1.15}\\\\\n\\mathbb{V}ar_t(w_{t+h}) &=& \\Sigma(\\mathbb{E}_t(w_{t+h-1}))+\\Phi \\Sigma(\\mathbb{E}_t(w_{t+h-2}))\\Phi' + \\nonumber \\\\\n&& \\dots + \\Phi^{h-1} \\Sigma(w_{t}){\\Phi^{h-1}}'. \\tag{1.16}\n\\end{eqnarray}\\]\nEq. (1.16) notably implies \\(\\mathbb{V}ar_t(w_{t+h})\\) affine function \\(w_t\\). Indeed \\(\\Sigma(.)\\) affine function, conditional expectations \\(\\mathbb{E}_t(w_{t+h})\\) affine \\(w_t\\), shown Eq. (1.15).unconditional means variances given :\n\\[\\begin{equation}\n\\left\\{\n\\begin{array}{ccl}\n\\mathbb{E}(w_t) &=& (- \\Phi)^{-1}\\mu\\\\\nvec[\\mathbb{V}ar(w_t)] &=& (I_{n^2} - \\Phi \\otimes \\Phi)^{-1} vec\\left(\\Sigma[(- \\Phi)^{-1}\\mu]\\right).\n\\end{array}\n\\right.\\tag{1.17}\n\\end{equation}\\]","code":""},{"path":"ChapterAffine.html","id":"TransfAna","chapter":"1 Affine processes","heading":"1.11 Truncated Laplace transforms of affine processes","text":"section, show one can employ Fourier transforms compute truncated conditional moments affine processes. , let us introduce following notation:\n\\[\nw_{t+1,T} = (w'_{t+1}, w'_{t+2},\\dots, w'_T)'\n\\]\n\\(w_t\\) affine \\(n\\)-dimensional process.want compute:\n\\[\n\\tilde{\\varphi}_t(u ; v, \\gamma) = \\mathbb{E}_t[\\exp(u'w_{t+1,T})\\textbf{1}_{\\{v'w_{t+1,T}<\\gamma\\}}].\n\\]Consider complex untruncated conditional Laplace transform:\n\\[\n\\varphi_t(z) = \\mathbb{E}_t[\\exp(z'w_{t+1,T})],\\quad  z \\\\mathbb{C}^{nT},\n\\]\ncomputed using recursive algorithm real case (see Section 1.9).Darrell Duffie, Pan, Singleton (2000) shown (see also Proposition 1.8 appendix):\n\\[\\begin{equation}\n\\tilde{\\varphi}_t(u ; v, \\gamma) =  \\frac{\\varphi_t(u)}{2} - \\frac{1}{\\pi}\n\\int^\\infty_0 \\frac{Im[\\varphi_t(u+ivx) \\exp(-\\gamma x)]}{x} dx.\\tag{1.18}\n\\end{equation}\\]\n\\(Im\\) means imaginary part.Note integral Eq. (1.18) one dimensional (whatever dimension \\(w_t\\)). shown following example, can exploited price options.Example 1.22  (Option pricing) Pricing calls puts amounts conditional expectations type (\\(k > 0\\)):\n\\[\\begin{eqnarray*}\n&& \\mathbb{E}_t\\left([\\exp(u'_1 w_{t+1,T})-k   \\exp(u'_2 w_{t+1,T})]^+\\right) \\\\\n&= &  \\mathbb{E}_t\\left([\\exp(u'_1 w_{t+1,T})-k   \\exp(u'_2 w_{t+1,T})]\\textbf{1}_{\\{[\\exp(u_1-u_2)'w_{t+1,T}] > k \\}}\\right) \\\\\n&= & \\tilde{\\varphi}_t(u_1 ; u_2-u_1, - \\log   k) - k \\tilde{\\varphi}_t(u_2 ; u_2-u_1, - \\log   k).\n\\end{eqnarray*}\\]Example 1.23  (Exogenous short rate) Consider asset whose date-\\(t\\) price \\(p_t\\). Denote geometric asset return \\(y_t\\), .e., \\(y_t = \\log(p_t/p_{t-1})\\). Consider option written asset, strike equal \\(k p_t\\).interest rates deterministic, option price, maturity \\(h\\), given :\n\\[\np_t   \\exp(-r_{t}-\\dots-r_{t+h-1}) \\mathbb{E}^{\\mathbb{Q}}_t[\\exp   u'_1 w_{t+1, t+h} - k]^+\n\\]\n\\(u_1 = e \\otimes e_1\\), \\(e\\) \\(h\\)-dimensional vector components equal 1, \\(e_1\\) \\(n\\)-vector selecting 1st component (\\(y_t\\) 1st component \\(w_t\\), say).Example 1.24  (Endogenous short rate) Consider context Example 1.23, stochastic (endogenous) short-term rate. instance, assume \\(r_{t+1} = \\omega_0 + \\omega'_1 w_t\\). option price :\n\\[\\begin{eqnarray*}\n&& p_t \\mathbb{E}^{\\mathbb{Q}}_t  \\left[ \\exp(-\\omega_0 - \\omega'_1 w_t-\\dots- \\omega_0 - \\omega'_1 w_{t+h-1}) [\\exp(u'_1 w_{t+1,t+h})-k]^+ \\right]\\\\\n&= & p_t   \\exp(-h \\omega_0 - \\omega'_1 w_t)\\mathbb{E}^{\\mathbb{Q}}_t\\left(\\left[\\exp(\\tilde{u}'_1w_{t+1,t+h})-k   \\exp(u_2 w_{t+1, t+h})\\right]^+\\right),\n\\end{eqnarray*}\\]\n\\(\\tilde{u}'_1 = u_1 + u_2\\), [\\(u_1 = e \\otimes e_1\\) ], \\(u_2 = (-\\omega'_1,\\dots, -\\omega'_1, 0)'\\).Example 1.25  (Numerical example: Conditional cumulated distribution function (c.d.f.)) Let us use model used Example 1.19. Suppose want compute conditional distribution average interest rate next \\(H\\) periods, .e., \\(\\frac{1}{H}(r_{t+1}+\\dots+r_{t+H})\\). Hence, want compute \\(\\mathbb{E}_t[\\textbf{1}_{\\{v'w_{t+1,T}<\\gamma\\}}]\\) \\(v'w_{t+1,T}=\\frac{1}{H}(r_{t+1}+\\dots+r_{t+H})\\).\nFigure 1.5: Conditional cumulated distribution function (c.d.f.) \\(\\frac{1}{H}(r_{t+1}+\\dots+r_{t+H})\\).\n","code":"\nH  <- 10\nX  <- matrix(c(0.01,.02,0),3,1)\nx  <- exp(seq(-10,10,length.out=1000))\nu1 <- matrix(c(1/H,1/H,0),3,1) %*% matrix(1i*x,nrow=1);u2 <- u1\nAB <- reverse.MHLT(psi.GaussianVAR,u1 = u1,u2 = u2,H = H,\n                   psi.parameterization = psi.parameterization)\ns1 <- matrix(exp(t(X) %*% AB$A[,,H] + AB$B[,,H]),ncol=1)\ndx <- matrix(x-c(0,x[1:length(x)-1]),length(x),1)\ngamma <- seq(-.2,.3,length.out=1000)\nfx <- outer(x,gamma,function(r,c){Im(s1[,1]*exp(-1i*r*c))/r})*dx[,1]\nf  <- 1/2 - 1/pi * apply(fx,2,sum)\nplot(gamma,f,type=\"l\",xlab=\"\",lwd=2)"},{"path":"ChapterAffine.html","id":"appendices","chapter":"1 Affine processes","heading":"1.12 Appendices","text":"Lemma 1.3  \\(\\mu \\\\mathbb{R}^L\\) \\(Q\\) \\((L \\times L)\\) matrix symmetric positive definite, :\n\\[\n\\int_{\\mathbb{R}^{L}} \\exp(-u'Q u + \\mu'u)du =\n\\frac{\\pi^{L/2}}{(det   Q)^{1/2}} exp \\left(\n\\begin{array}{l}  \\frac{1}{4} \\mu'Q^{-1}\\mu \\end{array} \\right).\n\\]Proof. integral :\n\\[\\begin{eqnarray*}\n&& \\int_{\\mathbb{R}^{L}} exp \\left[ \\begin{array}{l} - (u -\n\\frac{1}{2}  Q^{-1} \\mu)'  Q (u -\n\\frac{1}{2} Q^{-1} \\mu)'\n\\end{array}\n\\right] exp\\left(\n\\begin{array}{l}  \\frac{1}{4} \\mu'Q^{-1}\\mu \\end{array}\n\\right)du \\\\\n&=&  \\frac{\\pi^{L/2}}{(det Q)^{1/2}} exp\\left(\n\\begin{array}{l}  \\frac{1}{4} \\mu'Q^{-1}\\mu \\end{array}\n\\right)\n\\end{eqnarray*}\\]\n[using formula unit mass \\(\\mathcal{N}( 0.5Q^{-1}\\mu,(2Q)^{-1})\\)].Lemma 1.4  \\(\\varepsilon_{t+1} \\sim \\mathcal{N}(0,Id)\\), \n\\[\n\\mathbb{E}_t \\left(\\exp[\\lambda'\\varepsilon_{t+1}+\\varepsilon'_{t+1} V \\varepsilon_{t+1}]\\right) =  \\frac{1}{[\\det(-2V)]^{1/2}} \\exp\\left[\n\\frac{1}{2} \\lambda'(-2V)^{-1}\\lambda\n\\right].\n\\]Proof. \n\\[\n\\mathbb{E}_t   \\exp(\\lambda'\\varepsilon_{t+1}+\\varepsilon'_{t+1}V\\varepsilon_{t+1})\n=  \\frac{1}{(2\\pi)^{n/2}}  \\int_{\\mathbb{R}^{n}} \\exp\\left[\n\\begin{array}{l}\n-u'\\left(\n\\begin{array}{l}\n\\frac{1}{2} -V\n\\end{array}\n\\right)u+\\lambda'u\n\\end{array}\n\\right]du\n\\]\nLemma 1.3, \\(u\\\\mathbb{R}^n\\), \n\\[\n\\int_{\\mathbb{R}^{n}} \\exp(-u' Q u+\\mu'u) du =\n\\frac{\\pi^{n/2}}{(\\det Q)^{1/2}} \\exp\\left(\n\\begin{array}{l}\n\\frac{1}{4} \\mu'Q^{-1}\\mu\n\\end{array}\n\\right).\n\\]\nTherefore:\n\\[\n\\begin{array}{l}\n\\mathbb{E}_t   \\exp(\\lambda'\\varepsilon_{t+1}+\\varepsilon'_{t+1}V\\varepsilon_{t+1}) \\\\\n=  \\frac{1}{2^{n/2}\n\\left[\n\\begin{array}{l}\n\\det \\left(\n\\begin{array}{l}\n\\frac{1}{2} -V\n\\end{array}\n\\right)\n\\end{array}\n\\right]^{1/2}\n}\n\\exp\\left[\n\\begin{array}{l}\n\\frac{1}{4}  \\lambda'\\left(\n\\begin{array}{l}\n\\frac{1}{2} -V\n\\end{array}\n\\right)^{-1}\\lambda\n\\end{array}\n\\right].\n\\end{array}\n\\]Proposition 1.2  (Quadratic Gaussian process) Consider vector \\(w_t = (x'_t,vec(x_t x_t')')'\\), \\(x_t\\) \\(n\\)-dimensional vector following Gaussian VAR(1), .e.\n\\[\nx_{t+1}|\\underline{w_t} \\sim \\mathcal{N}(\\mu+\\Phi x_t, \\Sigma).\n\\]\n\\(u = (v,V)\\) \\(v \\\\mathbb{R}^n\\) \\(V\\) square symmetric matrix size \\(n\\), :\n\\[\\begin{eqnarray*}\n\\varphi_t(u) &=& \\mathbb{E}_t\\big\\{\\exp\\big[(v',vec(V)')\\times w_{t+1}\\big]\\big\\} \\\\\n& =& \\exp \\left\\{a_1(v,V)'x_t +vec(a_2(v,V))' vec(x_t'x_t) + b(v,V) \\right\\},\n\\end{eqnarray*}\\]\n:\n\\[\\begin{eqnarray*}\na_2(u) & = & \\Phi'V (I_n - 2\\Sigma V)^{-1} \\Phi \\nonumber \\\\\na_1(u) & = & \\Phi'\\left[(I_n-2V\\Sigma)^{-1}(v+2V\\mu)\\right] \\nonumber \\\\\nb(u) & = & u'(I_n - 2 \\Sigma V)^{-1}\\left(\\mu + \\frac{1}{2} \\Sigma v\\right) +\\\\\n&& \\mu'V(I_n - 2 \\Sigma V)^{-1}\\mu - \\frac{1}{2}\\log\\big|I_n - 2\\Sigma V\\big|.\\tag{1.3}\n\\end{eqnarray*}\\]Proof. :\n\\[\\begin{eqnarray*}\n&&\\mathbb{E}_t(\\exp(v' x_{t+1} + vec(V)'vec(x_{t+1} x_{t+1}'))) \\\\\n&=& \\mathbb{E}_t[\\exp(v' (\\mu + \\Phi x_t + \\Sigma^{1/2}\\varepsilon_{t+1}) + \\\\\n&& vec(V)'vec((\\mu + \\Phi x_t + \\Sigma^{1/2}\\varepsilon_{t+1}) (\\mu + \\Phi x_t + \\Sigma^{1/2}\\varepsilon_{t+1})'))] \\\\\n&=& \\exp[v' (\\mu + \\Phi x_t) + vec(V)'vec\\{(\\mu + \\Phi x_t)(\\mu + \\Phi x_t)'\\}] \\times \\\\\n&& \\mathbb{E}_t[\\exp(v'\\Sigma^{1/2}\\varepsilon_{t+1} +2\\underbrace{ vec(V)' vec\\{(\\mu + \\Phi x_t)(\\varepsilon_{t+1}'{\\Sigma^{1/2}}')\\}}_{=(\\mu + \\Phi x_t)'V\\Sigma^{1/2}\\varepsilon_{t+1}} +\\\\\n&& \\underbrace{vec(V)'vec\\{(\\Sigma^{1/2}\\varepsilon_{t+1})(\\Sigma^{1/2}\\varepsilon_{t+1})'}_{=\\varepsilon_{t+1}'{\\Sigma^{1/2}}'V\\Sigma^{1/2}\\varepsilon_{t+1}}\\}]\n\\end{eqnarray*}\\]\nLemma 1.4 can used compute previous conditional expectation, \\(\\lambda = {\\Sigma^{1/2}}'(v + 2 V'(\\mu + \\Phi x_t))\\). algebra leads result.Proposition 1.3  () Consider following auto-regressive gamma process:\n\\[\n\\frac{w_{t+1}}{\\mu} \\sim \\gamma(\\nu+z_t) \\quad \\mbox{} \\quad z_t \\sim \\mathcal{P} \\left( \\frac{\\rho w_t}{\\mu} \\right),\n\\]\n\\(\\nu\\), \\(\\mu\\), \\(\\rho > 0\\). (Alternatively \\(z_t \\sim {\\mathcal{P}}(\\beta w_t)\\), \\(\\rho = \\beta \\mu\\).):\n\\(\\varphi_t(u) = exp \\left[ \\begin{array}{l} \\dfrac{\\rho u}{1-u \\mu} w_t - \\nu \\log(1-u \\mu)\\end{array} \\right], \\mbox{ } u < \\dfrac{1}{\\mu}\\).Proof. Given \\(\\underline{w_t}\\), \\(z_t \\sim {\\mathcal P}\\left( \\begin{array}{l} \\frac{\\rho w_t} {\\mu} \\end{array}\\right)\\). :\n\\[\\begin{eqnarray*}\n\\mathbb{E}[\\exp(u w_{t+1})|\\underline{w_t}] &=& \\mathbb{E}\\left\\{\\mathbb{E}\\left[\\exp \\left(u \\mu  \\frac{w_{t+1}}{\\mu}\\right)|\\underline{w_t}, \\underline{z}_t\\right]\\underline{w_t}\\right\\}\\\\\n&=& \\mathbb{E}[(1-u\\mu)^{-(\\nu+z_t)}|\\underline{w_t}] \\\\\n&=& (1-u\\mu)^{-\\nu}\\mathbb{E}\\{\\exp[-z_t   \\log(1-u\\mu)]|\\underline{w_t}\\} \\\\\n&=& (1-u\\mu)^{-\\nu} \\exp \\left\\{\\frac{\\rho w_t}{\\mu}[\\exp(-\\log(1-u\\mu)] -  \\frac{\\rho w_t}{\\mu}\\right\\}\\\\\n&=& \\exp\\left[ \\begin{array}{l}  \\frac{\\rho u w_t}{1-u\\mu} - \\nu   \\log(1-u\\mu)  \\end{array}\\right],\n\\end{eqnarray*}\\]\nusing fact L.T. \\(\\gamma(\\nu)\\) \\((1-u)^{-\\nu}\\)\nL.T. \\({\\mathcal P}(\\lambda)\\) \\(\\exp[\\lambda(\\exp(u)-1)]\\).Proposition 1.4  (Dynamics WAR process) \\(K\\) integer, \\(W_{t+1}\\) can obtained :\n\\[\\begin{eqnarray*}\n\\left\\{\n\\begin{array}{ccl}\nW_{t+1} & =&  \\sum^K_{k=1} x_{k,t+1} x'_{k,t+1}\\\\\n&&\\\\\nx_{k,t+1} & =& M x_{k,t} + \\varepsilon_{k,t+1},\\quad k \\\\{1,\\dots,K\\},\n\\end{array}\n\\right.\n\\end{eqnarray*}\\]\n\\(\\varepsilon_{k,t+1} \\sim ..d. \\mathcal{N}(0, \\Omega)\\) (independent across \\(k\\)’s).\nparticular, :\n\\[\n\\mathbb{E}(W_{t+1}|\\underline{W_t}) = MW_tM'+K \\Omega,\n\\]\n.e. \\(W_t\\) follows matrix weak AR(1) process.Proof. \\(K=1\\), \\(W_{t+1}=x_{t+1} x'_{t+1}\\), \\(x_{t+1} = M x_t + \\Omega^{1/2} u_{t+1}\\) \\(u_{t+1} \\sim ..d. \\mathcal{N}(0,Id_L)\\). :\n\\[\n\\mathbb{E}[\\exp(Tr \\Gamma W_{t+1})|\\underline{w_t}] = \\mathbb{E}\\{\\mathbb{E}[\\exp(Tr \\Gamma x_{t+1} x'_{t+1})|\\underline{x}_t]|\\underline{w_t}\\}\n\\]\n:\n\\[\\begin{eqnarray*}\n&& \\mathbb{E}[\\exp(Tr \\Gamma x_{t+1}x'_{t+1})|\\underline{x}_t] = \\mathbb{E}[\\exp(x'_{t+1}\\Gamma x_{t+1}|\\underline{x}_t] \\\\\n&=& \\mathbb{E}[\\exp(M x_t + \\Omega^{1/2} u_{t+1})'\\Gamma(M x_t + \\Omega^{1/2} u_{t+1})/x_t] \\\\\n&=& \\exp(x'_tM'\\Gamma M x_t)\\mathbb{E}[\\exp(2 x'_t M'\\Gamma \\Omega^{1/2}\nu_{t+1}+u'_{t+1}\\Omega^{1/2} \\Gamma \\Omega^{1/2} u_{t+1})/x_t] \\\\\n&=&  \\frac{exp(x'_tM'\\Gamma M x_t)}{(2\\pi)^{L/2}} \\times \\\\\n&& \\int_{\\mathbb{R}^L} \\exp\\left[2x'_tM'\\Gamma\n\\Omega^{1/2}u_{t+1}-u'_{t+1}\\left(\n\\frac{1}{2} Id_L-\\Omega^{1/2} \\Gamma \\Omega^{1/2}\\right)u_{t+1}\\right]  du_{t+1}.\n\\end{eqnarray*}\\]\nUsing Lemma 1.3 \\(\\mu' = 2 x'_t M'\\Gamma \\Omega^{1/2}, Q = \\frac{1}{2} Id_L-\\Omega^{1/2}\\Gamma\\Omega^{1/2}\\) \\\nalgebra, RHS becomes:\n\\[\n\\frac{exp[x'_tM'\\Gamma(Id_L-2\\Omega\\Gamma)^{-1}M\nx_t]}{det[Id_L-2\\Omega^{1/2}\\Gamma\\Omega^{1/2}]} =  \\frac{exp Tr[M'\\Gamma(Id_L-2\\Omega^{-1}]M\nW_t]}{det[Id_L-2\\Omega \\Gamma]^{1/2}},\n\\]\ndepends \\(x_t\\) \\(W_t\\), gives result \n\\(K=1\\); result \\(K\\) integer follows.Lemma 1.5  :\n\\[\n\\varphi_{t,h}(\\gamma_1,\\dots,\\gamma_h) = \\exp('_{t,h} w_t + B_{t,h}),\n\\]\n\\(A_{t,h} = ^h_{t,h}\\) \\(B_{t,h} = B^h_{t,h}\\), \\(^h_{t,}, B^h_{t,}\\) \\(= 1,\\dots,h\\), given recursively :\n\\[\n() \\left\\{\n\\begin{array}{ccl}\n^h_{t,} &=& a_{t+h+1-}(\\gamma_{h+1-} + ^h_{t,-1}), \\\\\nB^h_{t,} &=& b_{t+h+1-}(\\gamma_{h+1-} + ^h_{t,-1}) + B^h_{t,-1}, \\\\\n^h_{t,0} &=& 0, B^h_{t,0} = 0.\n\\end{array}\n\\right.\n\\]Proof. \\(j=1,\\dots,h\\) :\n\\[\n\\varphi_{t,h}(\\gamma_1,\\dots,\\gamma_h) = \\mathbb{E}_t[\\exp(\\gamma'_1 w_{t+1}+\\dots\\gamma'_j w_{t+j}+^{h'}_{t,h-j}w_{t+j}+B^h_{t,h-j})]\n\\]\n:\n\\[\n(ii) \\left\\{\n\\begin{array}{l}\n^h_{t,h-j+1} = a_{t+j}(\\gamma_{j} + ^h_{t,h-j}), \\\\\nB^h_{t,h-j+1} = b_{t+j}(\\gamma_{j} + ^h_{t,h-j}) + B^h_{t,h-j}, \\\\\n^h_{t,0} = 0, B^h_{t,0} = 0.\n\\end{array}\n\\right.\n\\]\nSince true \\(j=h\\), true \\(j\\), get:\n\\[\n\\begin{array}{ll}\n\\varphi_{t,h}(\\gamma_1,\\dots,\\gamma_h) & = \\mathbb{E}_t [\\exp(\\gamma'_1 w_{t+1}+\\dots+\\gamma'_{j-1}w_{t+j-1}+'_{t+j}(\\gamma_j+^h_{t,h-j})w_{t+j-1} \\\\\n& + b_{t+j}(\\gamma_j+^h_{t,h-j})+B^h_{t,h-j}],\n\\end{array}\n\\]\n, therefore, true \\(j-1\\), \\(^h_{t,h-j+1}\\) \\(B^h_{t,h-j+1}\\) given formulas (ii) .\\(j=1\\) get:\n\\[\\begin{eqnarray*}\n\\varphi_{t,h}(\\gamma_1,\\dots,\\gamma_h) &=& \\mathbb{E}_t \\exp(\\gamma'_1 w_{t+1}+^{h'}_{t,h-1}w_{t+1}+B^h_{t,h-1}) \\\\\n&=& \\exp('_{t,h} w_t+B_{t,h}),\n\\end{eqnarray*}\\]Finally note put \\(h-j+1 = \\), formulas (ii) become ().Proposition 1.5  (Reverse-order multi-horizon Laplace transform) functions \\(a_{t}\\) \\(b_{t}\\) depend \\(t\\), different sequences \\((\\gamma^h_1,\\dots,\\gamma^h_h), h=1,\\dots,H\\) (say) satisfy \\(\\gamma^h_{h+1-} = u_i\\), \n\\(=1,\\dots,h\\), \\(h \\leq H\\), want compute (“reverse order” case):\n\\[\n\\varphi_{t,h}(u_h,\\dots,u_1)=\\mathbb{E}_t[\\exp(u'_{{\\color{red}h}} w_{{\\color{red}t+1}}+\\dots+u'_{{\\color{red}1}} w_{{\\color{red}t+h}})],\n\\quad h=1,\\dots,H,\n\\]\ncan compute \\(\\varphi_{t,h}(u_h,\\dots,u_1)\\) \\(t\\) \\(h \\leq H\\), one recursion, .e. \\(\\varphi_{t,h}(u_h,\\dots,u_1)=\\exp('_hw_t+B_h)\\) :\n\\[\\begin{equation}\n\\left\\{\n\\begin{array}{ccl}\nA_{h} &=& (u_{h} + A_{h-1}), \\\\\nB_{h} &=& b(u_{h} + A_{h-1}) + B_{h-1}, \\\\\nA_{0} &=& 0,\\quad  B_{0} = 0.\n\\end{array}\n\\right.\\tag{1.19}\n\\end{equation}\\]Proof. According Lemma 1.5, , case:\n\\[\n\\left\\{\n\\begin{array}{ccl}\n^h_{} &=& (u_{} + ^h_{-1}), \\\\\nB^h_{} &=& b(u_{} + ^h_{-1}) + B^h_{-1}, \\\\\n^h_{0} &=& 0, \\quad B^h_{0} = 0.\n\\end{array}\n\\right.\n\\]\nprevious sequences dependent \\(h\\) given Eq. (1.19).Proposition 1.6  (Conditional means variances affine process) Consider affine process \\(w_t\\). Using notation Proposition 1.1, :\n\\[\\begin{eqnarray}\n\\mathbb{E}_t(w_{t+h}) &=& (- \\Phi)^{-1}(- \\Phi^h)\\mu + \\Phi^h w_t \\tag{1.20}\\\\\n\\mathbb{V}ar_t(w_{t+h}) &=& \\Sigma(\\mathbb{E}_t(w_{t+h-1}))+\\Phi \\Sigma(\\mathbb{E}_t(w_{t+h-2}))\\Phi' + \\nonumber \\\\\n&& \\dots + \\Phi^{h-1} \\Sigma(w_{t}){\\Phi^{h-1}}'. \\tag{1.21}\n\\end{eqnarray}\\]\nEq. (1.21) notably shows \\(\\mathbb{V}ar_t(w_{t+h})\\) affine function \\(w_t\\). Indeed \\(\\Sigma(.)\\) affine function, conditional expectations \\(\\mathbb{E}_t(w_{t+h})\\) affine \\(w_t\\), shown Eq. (1.20).unconditional mean variance \\(w_t\\) given :\n\\[\\begin{equation}\n\\left\\{\n\\begin{array}{ccl}\n\\mathbb{E}(w_t) &=& (- \\Phi)^{-1}\\mu\\\\\nvec[\\mathbb{V}ar(w_t)] &=& (I_{n^2} - \\Phi \\otimes \\Phi)^{-1} vec\\left(\\Sigma[(- \\Phi)^{-1}\\mu]\\right).\n\\end{array}\n\\right.\\tag{1.22}\n\\end{equation}\\]Proof. Eq. (1.20) easily deduced Eq. (1.12), using \\(\\mathbb{E}_t(\\varepsilon_{t+k})=0\\) \\(k>0\\).regards Eq. (1.21):\n\\[\\begin{eqnarray*}\n\\mathbb{V}ar_t(w_{t+h}) &=& \\mathbb{V}ar_t\\left(\\Sigma(w_{t+h-1})^{\\frac{1}{2}}\\varepsilon_{t+h}+\\dots + \\Phi^{h-1} \\Sigma(w_{t})^{\\frac{1}{2}}\\varepsilon_{t+1} \\right).\n\\end{eqnarray*}\\]\nconditional expectation \\(t\\) terms sum equal zero since, \\(\\ge 1\\):\n\\[\n\\mathbb{E}_t\\left[\\Sigma(w_{t+-1})^{\\frac{1}{2}}\\varepsilon_{t+}\\right] = \\mathbb{E}_t[\\underbrace{\\mathbb{E}_{t+-1}\\{\\Sigma(w_{t+-1})^{\\frac{1}{2}}\\varepsilon_{t+}\\}}_{=\\Sigma(w_{t+-1})^{\\frac{1}{2}}\\mathbb{E}_{t+-1}\\{\\varepsilon_{t+}\\}=0}\\}],\n\\]\n\\(\\forall <j\\),\n\\[\n\\mathbb{C}ov_t\\left[\\Sigma(w_{t+-1})^{\\frac{1}{2}}\\varepsilon_{t+},\\Sigma(w_{t+j-1})^{\\frac{1}{2}}\\varepsilon_{t+j}\\right] = \\mathbb{E}_t\\left[\\Sigma(w_{t+-1})^{\\frac{1}{2}}\\varepsilon_{t+}\\varepsilon_{t+j}'\\Sigma'(w_{t+j-1})^{\\frac{1}{2}}\\right],\n\\]\ncan seen equal zero conditioning information available date \\(t+j-1\\).Using conditioning, obtain :\n\\[\\begin{eqnarray*}\n\\mathbb{V}ar_t\\left[\\Phi^{h-j}\\Sigma(w_{t+j-1})^{\\frac{1}{2}}\\varepsilon_{t+j}\\right] &=& \\mathbb{E}_t\\left[\\Phi^{h-j}\\Sigma(w_{t+j-1})^{\\frac{1}{2}}\\varepsilon_{t+j}\\varepsilon_{t+j}'\\Sigma'(w_{t+j-1})^{\\frac{1}{2}}{\\Phi^{h-j}}'\\right] \\\\\n&=&  \\mathbb{E}_t\\left[\\Phi^{h-j}\\Sigma(w_{t+j-1})^{\\frac{1}{2}} \\mathbb{E}_{t+j-1}(\\varepsilon_{t+j}\\varepsilon_{t+j}')\\Sigma'(w_{t+j-1})^{\\frac{1}{2}}{\\Phi^{h-j}}'\\right] \\\\\n&=&  \\Phi^{h-j}\\mathbb{E}_t[\\Sigma(w_{t+j-1})]{\\Phi^{h-j}}' \\\\\n&=&  \\Phi^{h-j}\\Sigma(\\mathbb{E}_t[w_{t+j-1}]){\\Phi^{h-j}}',\n\\end{eqnarray*}\\]\nlast equality results fact fact \\(\\Sigma(.)\\) affine (see Eq. (1.14)).Proposition 1.7  (Affine property GARCH-type process) process \\(w_t = (w_{1,t}, w_{2,t})\\) defined :\n\\[\n\\left\\{\n\\begin{array}{ccl}\nw_{1, t+1} &=& \\mu + \\varphi w_{1,t} + \\sigma_{t+1} \\varepsilon_{t+1}    \\mid \\varphi \\mid < 1 \\\\\n\\sigma^2_{t+1} &=& \\omega + \\alpha \\varepsilon^2_t + \\beta \\sigma^2_t      0 < \\beta < 1, \\alpha > 0, \\omega > 0    \\\\\nw_{2,t} &=& \\sigma^2_{t+1}, \\quad \\varepsilon_t \\sim   ..d.   \\mathcal{N}(0,1)\n\\end{array}\n\\right.\n\\]\naffine.Proof. Note \\(w_{2,t}\\) function \\(\\underline{w_{1,t}}\\)\n\\[\\begin{eqnarray*}\n&& \\mathbb{E}[\\exp(u_1 w_{1, t+1} + u_2 w_{2, t+1})|\\underline{w_{1,t}}] \\\\\n&= & \\exp(u_1 \\mu + u_1 \\varphi w_{1,t} + u_2 \\omega + u_2 \\beta w_{2,t})  \\mathbb{E}[\\exp(u_1 \\sigma_{t+1} \\varepsilon_{t+1} + u_2 \\alpha \\varepsilon^2_{t+1})|\\underline{w_{1,t}}]\n\\end{eqnarray*}\\]\n, using Lemma 1.4:\n\\[\\begin{eqnarray*}\n&&\\mathbb{E}[\\exp(u_1 w_{1, t+1} + u_2 w_{2, t+1})|\\underline{w_{1,t}}] \\\\\n&= & \\exp(u_1 \\mu + u_1 \\varphi w_{1,t} + u_2 \\omega + u_2 \\beta w_{2t})  \\exp \\left[ -   \\frac{1}{2}   \\log(1-2 u_2 \\alpha) +\n\\frac{u^2_1 w_{2,t}}{2(1-2 u_2 \\alpha)} \\right]\\\\\n&= & \\exp \\left[ u_1 \\mu + u_2 \\omega -  \\frac{1}{2}   \\log(1-2u_2\\alpha)+  u_1 \\varphi w_{1,t} + \\left(u_2 \\beta +  \\frac{u^2_1}{2(1-2u_2\\alpha)}\\right)\nw_{2,t}\\right],\n\\end{eqnarray*}\\]\nexponential affine \\((w_{1,t}, w_{2,t})\\).Proposition 1.8  (Computation truncated conditional moments) \\(\\varphi(z)=\\mathbb{E}[exp(z'w)]\\), :\n\\[\\begin{equation}\n\\mathbb{E}[\\exp(u'w)\\textbf{1}_{(v'w<\\gamma})] = \\frac{\\varphi(u)}{2} -  \\frac{1}{\\pi} \\int^\\infty_o\n\\frac{{\\mathcal }m[\\varphi(u+ivx)\\exp(-\\gamma x)]}{x}dx.\\tag{1.23}\n\\end{equation}\\]Proof. want compute \\(\\tilde{\\varphi}_t(u;v,\\gamma) = \\mathbb{E}_t[\\exp(u'w)\\textbf{1}_{(v'w<\\gamma})]\\). Let us first note , given \\(u\\) \\(v\\), \\(\\tilde{\\varphi}_t(u;v,\\gamma)\\) positive increasing bounded function \\(\\gamma\\) therefore can seen c.d.f. positive finite measure \\(\\mathbb{R}\\), Fourier transform :\n\\[\n\\int_{\\mathbb{R}} \\exp(\\gamma x)d\\tilde{\\varphi}(u;v,\\gamma) = \\mathbb{E} \\int_{\\mathbb{R}} \\exp(\\gamma x)d\\tilde{\\varphi}_w(u;v,\\gamma),\n\\]\n, given \\(w, \\tilde{\\varphi}_w(u;v,\\gamma)\\) c.d.f. mass point \\(\\exp(u'w)\\) \\(v'w\\). get:\n\\[\\begin{eqnarray*}\n\\int_{\\mathbb{R}} \\exp(\\gamma x) d\\tilde{\\varphi}(u;v,\\gamma) &=& \\mathbb{E}[\\exp(ixv'w)exp(u'w)] \\\\\n& =& \\mathbb{E}[\\exp(u+ivx)'w] \\\\\n& =& \\varphi(u+ivx).\n\\end{eqnarray*}\\]\nLet us now compute \\((x_0,\\lambda)\\) real number \\(\\lambda\\), :\n\\[\\begin{eqnarray*}\n&&(x_0,\\lambda) \\\\\n&=&  \\frac{1}{2\\pi} \\int^{x_0}_{-x_0}\n\\frac{\\exp(\\lambda x)\\varphi(u-ivx)-\\exp(-\\lambda)\\varphi(u+ivx)}{ix}dx \\\\\n&=&  \\frac{1}{2\\pi} \\int^{x_0}_{-x_0}\\left[ \\begin{array}{l}  \\int_{\\mathbb{R}}\n\\frac{\\exp[-ix(\\gamma-\\lambda)]-\\exp[ix(\\gamma-\\lambda)]}{ix}d\\tilde{\\varphi}(u;v,\\gamma)\n\\end{array} \\right]dx \\\\\n&=&  \\frac{1}{2\\pi}  \\int_{\\mathbb{R}}\n\\left[ \\begin{array}{l}   \\int^{x_0}_{-x_0}   \\frac{\\exp[-ix(\\gamma-\\lambda)]\n-\\exp[ix(\\gamma-\\lambda)]}{ix}dx \\end{array} \\right]d\\tilde{\\varphi}(u;v,\\gamma).\n\\end{eqnarray*}\\]\nNow :\n\\[\\begin{eqnarray*}\n\\frac{1}{2\\pi} \\int^{x_o}_{-x_o}\n\\frac{\\exp[-ix(\\gamma-\\lambda)]\n-\\exp[ix(\\gamma-\\lambda)]}{ix}dx \\\\ =  \\frac{-sign(\\gamma-\\lambda)}{\\pi}\n\\int^{x_o}_{-x_o} \\frac{sin(x\\mid\\gamma-\\lambda\\mid)}{x}dx\n\\end{eqnarray*}\\]\ntends \\(-sign(\\gamma-\\lambda)\\) \\(x_0\\rightarrow\\infty\\) (\\(sign(\\omega)=1\\) \\(\\omega>0\\), \\(sign(\\omega)=0\\) \\(\\omega=0\\), \\(sign(\\omega)=-1\\) \\(\\omega<0\\)).\nTherefore:\n\\[\n(\\infty,\\lambda) = -  \\int_{\\mathbb{R}} sign(\\gamma-\\lambda)d\\tilde{\\varphi}(u;v,\\gamma) = -\\mathbb{E}  \\int_{\\mathbb{R}} sign(\\gamma-\\lambda)d\\tilde{\\varphi}_w(u;\\theta,\\gamma),\n\\]\n\\(\\tilde{\\varphi}_w(u;v,\\gamma)\\) c.d.f. mass point \\(\\exp(u'w)\\) \\(v'w\\) \n\\[\n\\int_{\\mathbb{R}} \\mbox{sign}(\\gamma-\\lambda)d\\tilde{\\varphi}_w(u;v,\\gamma)=\n\\left\\{\n\\begin{array}{ccc}\n\\exp(u'w) & \\mbox{} & \\lambda < v'w \\\\\n0 & \\mbox{}& \\lambda = v'w \\\\\n-\\exp(u'w) & \\mbox{} & \\lambda > v'w.\n\\end{array}\n\\right.\n\\]\nTherefore, :\n\\[\\begin{eqnarray*}\n(\\infty,\\lambda) & =& - \\mathbb{E}[\\exp(u'w)(1-\\textbf{1}_{(v'w<\\lambda)})-\\exp(u'w)\\textbf{1}_{(v'w<\\lambda)}] \\\\\n& =& - \\varphi(u) + 2\\tilde{\\varphi}(u;v,\\lambda)\n\\end{eqnarray*}\\]\n, ,:\n\\[\n\\tilde{\\varphi}(u;,v,\\gamma) =  \\frac{\\varphi(u)}{2} +  \\frac{1}{2} (\\infty,\\gamma),\n\\]\n\n\\[\\begin{eqnarray*}\n\\frac{1}{2} (\\infty,\\gamma) & =&  \\frac{1}{4\\pi} \\int^{\\infty}_{-\\infty}  \\frac{\\exp(\\gamma x)\\varphi(u-ivx)-\\exp(-\\gamma x)\\varphi(u+ivx)}{ix} dx \\\\\n& =&  \\frac{1}{2\\pi} \\int^{\\infty}_{o}  \\frac{\\exp(\\gamma x)\\varphi(u-ivx)-\\exp(-\\gamma x)\\varphi(u+ivx)}{ix} dx \\\\\n& =& -  \\frac{1}{\\pi} \\int^{\\infty}_{o}  \\frac{{\\mathcal }m[\\exp(-\\gamma x)\\varphi(u+ivx)]}{x}dx,\n\\end{eqnarray*}\\]\nleads Eq. (1.23).","code":""},{"path":"pricing-and-risk-neutral-dynamics.html","id":"pricing-and-risk-neutral-dynamics","chapter":"2 Pricing and risk-neutral dynamics","heading":"2 Pricing and risk-neutral dynamics","text":"brief: bla bla bla bla.","code":""},{"path":"pricing-and-risk-neutral-dynamics.html","id":"PricingEquilibrium","chapter":"2 Pricing and risk-neutral dynamics","heading":"2.1 Consumption-based Capital Asset Pricing Model (CCAPM) and stochastic discount factor (SDF)","text":"Consider economy featuring single good, whose date-\\(t\\) price \\(q_t\\). representative agent external income \\(R_t\\) \\(t\\), portfolio assets, allocation vector \\(\\alpha_{t-1}\\) (decided \\(t-1\\)). vector date-\\(t\\) prices \\(p_t\\). date \\(t+j\\), \\(j=0,1,...\\), agent face budget constraint:\n\\[\nq_{t+j}C_{t+j}+\\alpha'_{t+j}p_{t+j} = R_{t+j} +\n\\alpha'_{t+j-1}p_{t+j},\n\\]\n\\(C_{t+j}\\)consumption date \\(t+j\\). representative agent maximizes expected utility time-separable preferences \\(\\mathbb{E}_t \\sum^\\infty_{j=0} \\delta^j U(C_{t+j})\\) subject budget constraints \\(t+j\\), \\(j= 0,1,\\dots\\), \\(U\\) utility function \\(\\delta\\)time discount factor subjective discount factor. Note latter different SDF.Replacing \\(C_{t+j}\\) \\([R_{t+j}-(\\alpha'_{t+j}-\\alpha'_{t+j-1})p_{t+j}]/q_{t+j}\\), objective function becomes:\n\\[\n\\mathbb{E}_t  \\sum^\\infty_{j=0} \\delta^j U\n[R_{t+j}/q_{t+j}-(\\alpha'_{t+j}-\\alpha'_{t+j-1})p_{t+j}/q_{t+j}].\n\\]\nvector allocation \\(\\alpha_t\\) appears first two terms:\n\\[\nU[R_t/q_t-(\\alpha'_t-\\alpha'_{t-1})p_t/q_t] + \\delta \\mathbb{E}_t\nU[R_{t+1}/q_{t+1}-(\\alpha'_{t+1}-\\alpha'_t)p_{t+1}/q_{t+1}].\n\\]\nresult, first order condition associated vector \\(\\alpha_t\\) reads\n\\[\n\\frac{p_t}{q_t}  \\frac{d U(C_t)}{dC} = \\delta \\mathbb{E}_t \\left[\n\\begin{array}{l}\n\\frac{p_{t+1}}{q_{t+1}}  \\frac{dU(C_{t+1})}{dC}\n\\end{array}\n\\right],\n\\]\n\n\\[\\begin{equation}\np_t = \\mathbb{E}_t(p_{t+1} \\mathcal{M}_{t,t+1}),\\tag{2.1}\n\\end{equation}\\]\n\\(\\mathcal{M}_{t,t+1}\\) strictly positive scalar called stochastic discount factor (SDF) dates \\(t\\) \\(t+1\\). :\n\\[\n\\mathcal{M}_{t,t+1} \\equiv \\delta  \\frac{q_t}{q_{t+1}}\n\\frac{  \\frac{dU(C_{t+1})}{dC}} {\n\\frac{dU(C_t)}{dC}}.\n\\]Example 2.1  (Power utility function) standard case one power utility \\(U(C) = \\frac{C^{1-\\gamma}-1}{1-\\gamma}\\), \\(\\gamma>0\\) coefficient relative risk aversion.\\(U'(C) = C^{-\\gamma} > 0\\) \\(U''(C) = - \\gamma C^{-\\gamma-1} < 0\\). result, stochastic discount factor \n\\[\\begin{eqnarray}\n&& \\mathcal{M}_{t,t+1} \\nonumber \\\\\n&=&  \\frac{q_t}{q_{t+1}} \\delta \\left(\n\\frac{C_{t+1}}{C_t} \\right)^{-\\gamma} \\nonumber\\\\\n&=& \\exp(\\log\n\\delta + \\log q_t + \\gamma \\log  C_t - \\log  q_{t+1} - \\gamma\n\\log  C_{t+1}).\\tag{2.2}\n\\end{eqnarray}\\]\nvector prices \\(p_t\\) satisfies:\n\\[\np_t = \\delta q_t C^\\gamma_t \\mathbb{E}_t \\left(\n\\begin{array}{l}\n\\frac{C^{-\\gamma}_{t+1}}{q_{t+1}} p_{t+1}\n\\end{array}\n\\right),\n\\]\n(Euler equation):\n\\[\n\\mathbb{E}_t\\left[\n\\begin{array}{l}\n\\delta\\left(\n\\begin{array}{l}\n\\frac{C_{t+1}}{C_t}\n\\end{array}\n\\right)^{-\\gamma}  \\frac{q_t}{q_{t+1}}\n\\frac{p_{t+1}}{p_t} - 1\n\\end{array}\n\\right] = 0.\n\\]According Eq. (2.1), asset \\(j\\):\n\\[\\begin{equation}\np_{j,t} = \\mathbb{E}_t(\\mathcal{M}_{t,t+1} p_{j,t+1}).\\tag{2.3}\n\\end{equation}\\]\nUsing \\(p_{j,t+1} = \\mathbb{E}_t(\\mathcal{M}_{t+1,t+2} p_{j,t+2})\\), get:\n\\[\\begin{eqnarray*}\np_{j,t} &=& \\mathbb{E}_t[\\mathbb{E}_{t+1}(p_{j,t+2}\\mathcal{M}_{t+1,t+2})\\mathcal{M}_{t,t+1}] \\\\\n&=& \\mathbb{E}_t(\\mathcal{M}_{t,t+1} \\mathcal{M}_{t+1,t+2}p_{j,t+2}).\n\\end{eqnarray*}\\]\ncan generalized follows:\n\\[\np_{j,t} = \\mathbb{E}_t[\\mathcal{M}_{t,t+1} \\dots \\mathcal{M}_{t+h-1,t+h}p_{j,t+h}], \\; \\forall h.\n\\]","code":""},{"path":"pricing-and-risk-neutral-dynamics.html","id":"recursive-utilities","chapter":"2 Pricing and risk-neutral dynamics","heading":"2.2 Recursive utilities","text":"XXXX","code":""},{"path":"pricing-and-risk-neutral-dynamics.html","id":"PricingAAO","chapter":"2 Pricing and risk-neutral dynamics","heading":"2.3 SDF: Absence of Arbitrage Approach","text":"Consider period interest \\({\\mathcal T} = \\{0,1,2,...,T^*\\}\\). Chapter 1, vector \\(w_t\\) constitutes new information economy \\(t\\). historical, physical, dynamics \\(w_t\\), \\(f(\\underline{w_t})\\), defined \\(f(w_{t+1}|\\underline{w_t})\\). physical probability denoted \\(\\mathbb{P}\\). \\(L_{2t}, t \\{\\mathcal T}\\), (Hilbert) space square integrate functions \\(g(\\underline{w_t})\\), \\(L_{2t} \\subset L_{2s}, t< s\\).","code":""},{"path":"pricing-and-risk-neutral-dynamics.html","id":"existence-and-unicity-of-the-sdf","chapter":"2 Pricing and risk-neutral dynamics","heading":"2.3.1 Existence and unicity of the SDF","text":"Hypothesis 2.1  (Price existence uniqueness) \\(\\underline{w_t}\\), exists unique \\(p_t[g(\\underline{w_s})]\\),\nfunction \\(\\underline{w_t}\\), price \\(t\\) payoff\n\\(g(\\underline{w_s})\\) delivered \\(s, \\forall t \\le s\\).Hypothesis 2.2  (Linearity continuity) \\(t < s\\), \\(\\underline{w_t}\\), \\(g_1\\), \\(g_2\\), \\(p_t[\\lambda_1 g_1(\\underline{w_s}) + \\lambda_2g_2(\\underline{w_s})] = \\lambda_1p_t[g_1(\\underline{w_s})]+\\lambda_2 p_t[g_2(\\underline{w_s})]\\),\\(g_n(\\underline{w_s}) \\overset{L_{2s}}{\\underset{n\\rightarrow\\infty}{\\longrightarrow}} 0\\), \\(p_t[g_n(\\underline{w_s})] \\underset{n\\rightarrow\\infty}{\\longrightarrow} 0\\).Hypothesis 2.3  (Absence Arbitrage Opportunity (AAO)) \\(t\\), impossible constitute portfolio future payoffs, possibly modified subsequent dates, :price portfolio \\(t\\) zero,payoffs subsequent dates \\(\\ge 0\\),least one subsequent date \\(s\\) net payoff \\(s\\) strictly positive non zero conditional probability \\(t\\).Theorem 2.1  (Riesz representation theorem) Assumptions 2.1 2.2, \\(\\underline{w_t}\\), \\(s > t\\), exists \\(\\mathcal{M}_{t,s}(\\underline{w_s}) \\L_{2s}\\), unique , \\(\\forall g(\\underline{w_s}) \\L_{2s}\\),\n\\[\np_t[g(\\underline{w_s})] = \\mathbb{E}[\\mathcal{M}_{t,s}(\\underline{w_s})g(\\underline{w_s})|\\underline{w_t}].\n\\]\nparticular price \\(t\\) zero coupon bond maturing \\(s\\) \\(\\mathbb{E}(\\mathcal{M}_{t,s}|\\underline{w_t})\\).Proposition 2.1  (Positivity M) Assumption 2.3 satisfied, \\(t\\) \\(s\\), \\(\\mathbb{P}(\\mathcal{M}_{t,s}>0|\\underline{w_t})=1\\).Proof. \\(\\Leftarrow\\) obvious. \\(\\Rightarrow\\) true, payoff\n\\(\\textbf{1}_{\\{\\mathcal{M}_{t,s} \\le 0\\}}\\), \\(s\\), :\n\\(\\mathbb{P}[\\textbf{1}_{\\{\\mathcal{M}_{t,s} \\le 0\\}}=1|\\underline{w_t}] > 0\\) \\(p_t[\\textbf{1}_{\\{\\mathcal{M}_{t,s} \\le 0\\}}] = \\mathbb{E}_t[\\mathcal{M}_{t,s}\\textbf{1}_{\\{\\mathcal{M}_{t,s} \\le 0\\}}] \\le 0\\).Proposition 2.2  (Time consistency) \\(t < r < s\\), \\(\\mathcal{M}_{t,s} = \\mathcal{M}_{t,r} \\mathcal{M}_{r,s}\\), implies:\\(\\mathcal{M}_{t,s} = \\mathcal{M}_{t,t+1} \\mathcal{M}_{t+1,t+2}\\dots\\mathcal{M}_{s-1,s}\\)\\(\\mathcal{M}_{0,t} = \\Pi^{t-1}_{j=0} \\mathcal{M}_{j,j+1}\\) (\\(\\mathcal{M}_{0,t}\\) called pricing kernel).Proof. Using Lemma 2.1 :\n\\[\\begin{eqnarray*}\np_t(g_s) &=& \\mathbb{E}(\\mathcal{M}_{t,s}g_s|\\underline{w_t}) = \\mathbb{E}(\\mathcal{M}_{t,r} p_r(g_s)|\\underline{w_t}) \\\\\n&=& \\mathbb{E}[\\mathcal{M}_{t,r}\\mathbb{E}(\\mathcal{M}_{r,s} g_s|\\underline{w_r})|\\underline{w_t}] = \\mathbb{E}(\\mathcal{M}_{t,r} \\mathcal{M}_{r,s} g_s|\\underline{w_t}), \\forall g, \\forall \\underline{w}_{t}\n\\end{eqnarray*}\\]\n, therefore, \\(\\mathcal{M}_{t,s} = \\mathcal{M}_{t,r}\\mathcal{M}_{r,s}\\).Lemma 2.1  payoff \\(g_s\\) \\(s, p_t(g_s) = p_t[p_r(g_s)]\\).Proof. true, construct sequence portfolios strictly positive payoff \\(s\\) zero payoff future date price zero \\(t\\), contradicting Assumption 2.3. Indeed, assuming, instance, \\(p_t(g_s) > p_t[p_r(g_s)]\\), payoff \\(s\\) defined following strategy: () \\(t\\): buy \\(p_r(g_s)\\), (short) sell \\(g_s\\), buy\n\\(\\frac{p_t(g_s)-p_t[p_r(g_s)]}{\\mathbb{E}(\\mathcal{M}_{t,s}|\\underline{w_t})}\\) zero-coupon bonds maturing \\(s\\), global price zero, (ii) \\(r\\): buy \\(g_s\\) sell \\(p_r(g_s)\\), generating zero net payoff, (iii) \\(s\\), net payoff : \\(g_s-g_s+\\frac{p_t(g_s)-p_t[p_r(g_s)]}{\\mathbb{E}(\\mathcal{M}_{t,s}|\\underline{w_t})} > 0\\).Consider asset whose payoff, date \\(s\\), \\(g(\\underline{w_s})\\). , \\(\\forall t < s\\):\n\\[\\begin{equation}\n\\boxed{p_t[g(\\underline{w_s})] = \\mathbb{E}_t[\\mathcal{M}_{t,t+1}...\\mathcal{M}_{s-1,s}g(\\underline{w_s})].}\\tag{2.4}\n\\end{equation}\\]\nparticular, since \\(L_{2,t+1}\\) contains 1, price \\(t\\) zero-coupon residual maturity one given :\n\\[\nB(t,1) := \\mathbb{E}_t [\\mathcal{M}_{t,t+1}].\n\\]\nDenoting \\(r_t\\) continously-compounded interest rate, defined \\(B(t,1)=\\exp(-r_{t})\\), get\n\\[\nr_{t}=-\\log \\mathbb{E}_t [\\mathcal{M}_{t,t+1}].\n\\]Definition 2.1  (Bank account) bank account process \\(R_t\\) defined \\(R_{t} \\equiv \\exp(r_0+...+r_{t-1}) = \\frac{1}{\\mathbb{E}_0[ \\mathcal{M}_{0,1}]\\times ... \\times \\mathbb{E}_{t-1} [\\mathcal{M}_{t-1,t}]}\\).\\(R_t\\) price investment initiated date 0, worth one dollar, invested date risk-free rate (one period).price process \\(p_t\\), \\(p_t = \\mathbb{E}_t(\\mathcal{M}_{t,s} p_s)\\) (\\(s>t\\)), \\(\\mathcal{M}_{0,t} p_t = \\mathbb{E}_t(\\mathcal{M}_{0,s}p_s)\\). , \\(\\mathcal{M}_{0,t} p_t\\) martingale. particular \\(\\mathcal{M}_{0,t} R_t\\) martingale.","code":""},{"path":"pricing-and-risk-neutral-dynamics.html","id":"PricingAffine","chapter":"2 Pricing and risk-neutral dynamics","heading":"2.3.2 Exponential affine SDF","text":"specific (tractable) case exponential affine SDF. Assume \n\\[\n\\mathcal{M}_{t,t+1}(\\underline{w_{t+1}}) = \\exp[\\alpha_t(\\underline{w_t})'w_{t+1}+\\beta_t(\\underline{w_t})]\n\\]\n\\(\\alpha_t\\) defines prices risk sensitivity vector. Using \\(\\mathbb{E}_t[\\mathcal{M}_{t,t+1}]=\\exp(-r_{t})=\\exp[\\psi_t(\\alpha_t)+\\beta_t]\\), get:\n\\[\\begin{equation}\n\\mathcal{M}_{t,t+1} = \\exp[-r_{t}+\\alpha'_tw_{t+1}-\\psi_t(\\alpha_t)].\\tag{2.5}\n\\end{equation}\\]Example 2.2  (CCAPM/Power utility case) CCAPM-power-utility case (see Example 2.1), (Eq. (2.2)):\n\\[\n\\mathcal{M}_{t,t+1} = \\exp(\\log \\delta + \\log q_t + \\gamma \\log   C_t - \\log   q_{t+1} - \\gamma  \\log   C_{t+1}),\n\\]\n\\(q_t\\) price consumption good, \\(C_t\\) quantity consumed \\(t\\) \\(\\delta\\) intertemporal discount rate.Hence, case, \\(\\mathcal{M}_{t,t+1}\\) exponential affine \\(w_{t+1} = (\\log q_{t+1}, \\log C_{t+1})'\\) (first lag).","code":""},{"path":"pricing-and-risk-neutral-dynamics.html","id":"PricingRN","chapter":"2 Pricing and risk-neutral dynamics","heading":"2.4 The risk-neutral (R.N.) dynamics","text":"historical Dynamics characterized \\(f(\\underline{w_{T^*}})\\), \nsequence conditional p.d.f. \\(f_{t+1}(w_{t+1}|\\underline{w_t})\\), \n\\(f_{t+1}(w_{t+1})\\), respect (w.r.t.) measure \\(\\mu\\).define conditional risk-neutral p.d.f. w.r.t. conditional historical probability. , employ Radon-Nikodym derivative \\(d^{\\mathbb{Q}}_{t+1}(w_{t+1}|\\underline{w_t})\\):5\n\\[\nd^{\\mathbb{Q}}_{t+1}(w_{t+1}|\\underline{w_t}) =\n\\frac{\\mathcal{M}_{t,t+1}(\\underline{w_{t+1}})}{\\mathbb{E}[\\mathcal{M}_{t,t+1}(\\underline{w_{t+1}})|\\underline{w_t}]},\n\\]\n\n\\[\nd^{\\mathbb{Q}}_{t+1}(w_{t+1})=\n\\frac{\\mathcal{M}_{t,t+1}}{\\mathbb{E}_t(\\mathcal{M}_{t,t+1})}=\\exp(r_{t}) \\mathcal{M}_{t,t+1}.\n\\]\ncontext, risk neutral conditional p.d.f. :\n\\[\\begin{eqnarray}\nf^{\\mathbb{Q}}_{t+1}(w_{t+1}) &=& f_{t+1}(w_{t+1})d^{\\mathbb{Q}}_{t+1}(w_{t+1}) \\nonumber \\\\\n&=&f_{t+1} (w_{t+1}) \\mathcal{M}_{t,t+1} (\\underline{w_{t+1}}) \\exp [r_{t} (\\underline{w_t})].\\tag{2.6}\n\\end{eqnarray}\\]p.d.f. \\(\\mathbb{Q}\\) w.r.t. historical dynamics \\(\\mathbb{P}\\) :\n\\[\n\\xi_{T^*} =  \\frac{d\\mathbb{Q}}{d\\mathbb{P}} =\n\\Pi^{T^{*}-1}_{t=0} d^{\\mathbb{Q}}_{t+1}(w_{t+1}) =\n\\Pi^{T^{*}-1}_{t=0} \\exp(r_{t}) \\mathcal{M}_{t,t+1},\n\\]\np.d.f. R.N. distribution \\(\\underline{w_t}\\), w.r.t. corresponding historical distribution :\n\\[\n\\xi_t= \\Pi^{t-1}_{\\tau=1}\nd^{\\mathbb{Q}}_{\\tau+1}(w_{\\tau+1})=\\mathbb{E}_t\\left(\\frac{d\\mathbb{Q}}{d\\mathbb{P}}\\right) = \\mathbb{E}_t\\xi_{T^*}.\n\\]\nTherefore, \\(\\xi_t\\) \\(\\mathbb{P}\\)-martingale.6Consider date-\\(t\\) price payoff \\(g(\\underline{w_s})\\) time \\(s>t\\). equivalent form pricing formula (2.4) :\n\\[\\begin{eqnarray*}\np_t[g(\\underline{w_s})] &=& \\mathbb{E}_t[\\mathcal{M}_{t,t+1}...\\mathcal{M}_{s-1,s}g(\\underline{w_s})] \\\\\n&=& \\mathbb{E}^{\\mathbb{Q}}_t[\\exp(-r_{t}-...-r_{s-1})g(\\underline{w_s})],\n\\end{eqnarray*}\\]\n, simpler notations:\n\\[\np_t = \\mathbb{E}^{\\mathbb{Q}}_t[\\exp(-r_{t}-...-r_{s-1})p_s] = \\mathbb{E}^{\\mathbb{Q}}_t\\left(\\frac{R_t}{R_s} p_s\\right),\n\\]\n\\(R_t\\) bank account.also \\(p_t/R_t = \\mathbb{E}^{\\mathbb{Q}}_t\\left( p_s/R_s\\right)\\), , \\(p_t/R_t\\) \\(\\mathbb{Q}\\)-martingale. particular \\(p_t = \\exp(-r_{t})\\mathbb{E}^{\\mathbb{Q}}_t(p_{t+1})\\), , using arithmetic return payoff \\((p_{t+1}-p_t)/p_t\\), arithmetic return riskless asset \\(r_{,t+1}=\\exp(r_{t})-1\\), get:\n\\[\n\\mathbb{E}^{\\mathbb{Q}}_t\\left(\\frac{p_{t+1}-p_t}{p_t}\\right)=r_{,t}.\n\\]\nMoreover excess arithmetic return process \\((p_{t+1}-p_t)/p_t-r_{,t}\\) \\(\\mathbb{Q}\\)-martingale difference , therefore, \\(\\mathbb{Q}\\)-serially uncorrelated.Let us consider case exponential affine SDF \\(\\mathcal{M}_{t,t+1}=\\exp(\\alpha'_t w_{t+1}+\\beta_t)\\):\n\\[\nd^{\\mathbb{Q}}_{t+1}(w_{t+1}) = \\frac{\\mathcal{M}_{t,t+1}}{\\mathbb{E}_t(\\mathcal{M}_{t,t+1})} = \\frac{\\exp(\\alpha'_t\nw_{t+1}+\\beta_t)}{\\exp[\\psi_t(\\alpha_t)+\\beta_t]} = \\exp[\\alpha'_t w_{t+1}-\\psi_t(\\alpha_t)]\n\\]\n\\(d^{\\mathbb{Q}}_{t+1}(w_{t+1})\\) also exponential affine. Moreover:\n\\[\nf^{\\mathbb{Q}}_{t+1} (w_{t+1}) = \\frac{f_{t+1} (w_{t+1}) \\exp (\\alpha'_t w_{t+1})}{\\varphi_t (\\alpha_t)}.\n\\]\nprevious equation shows \\(f^{\\mathbb{Q}}_{t+1}\\) Esscher transform \\(f_{t+1}\\) evaluated \\(\\alpha_t\\).Let us know consider Laplace transform conditional R.N. probability, \\(\\varphi^{\\mathbb{Q}}_t(u|\\underline{w_t})\\), also denoted \\(\\varphi^{\\mathbb{Q}}_t(u)\\). :\n\\[\\begin{eqnarray*}\n\\varphi^{\\mathbb{Q}}_t(u) &=& \\mathbb{E}^{\\mathbb{Q}}_t \\exp(u' w_{t+1}) \\\\\n&=& \\mathbb{E}_t \\exp[(u+\\alpha_t)'w_{t+1}-\\psi_t(\\alpha_t)] \\\\\n&=& \\exp[\\psi_t(u+\\alpha_t)-\\psi_t(\\alpha_t)] =\n\\frac{\\varphi_t(u+\\alpha_t)}{\\varphi_t(\\alpha_t)}.\n\\end{eqnarray*}\\]\nHence:\n\\[\\begin{equation}\n\\boxed{\\psi^{\\mathbb{Q}}_t(u) = \\psi_t(u+\\alpha_t)-\\psi_t(\\alpha_t).}\\tag{2.7}\n\\end{equation}\\]\ncheck , \\(\\alpha_t=0\\), \\(\\psi^{\\mathbb{Q}}_t=\\psi_t\\) (since \\(\\psi_t(0)=0)\\).Moreover, putting \\(u=-\\alpha_t\\) expression \n\\(\\psi^{\\mathbb{Q}}_t(u)\\) get \\(\\psi^{\\mathbb{Q}}_t(-\\alpha_t)=-\\psi_t(\\alpha_t)\\),\n, replacing \\(u\\) \\(u-\\alpha_t\\), get:\n\\[\n\\boxed{\\psi_t(u) = \\psi^{\\mathbb{Q}}_t(u-\\alpha_t)-\\psi^{\\mathbb{Q}}_t(-\\alpha_t).}\n\\]\nAlso:\n\\[\\begin{equation*}\n\\left\\{\n\\begin{array}{ccl}\nd_{t+1}(w_{t+1}) &=& \\exp[-\\alpha'_t(w_{t+1})-\\psi^{\\mathbb{Q}}_t(-\\alpha_t)] \\\\\nd^{\\mathbb{Q}}_{t+1}(w_{t+1}) &=& \\exp[\\alpha'_t(w_{t+1})+\\psi^{\\mathbb{Q}}_t(-\\alpha_t)].\n\\end{array}\n\\right.\n\\end{equation*}\\]","code":""},{"path":"pricing-and-risk-neutral-dynamics.html","id":"PricingTypology","chapter":"2 Pricing and risk-neutral dynamics","heading":"2.5 Typology of econometric asset-pricing models","text":"Definition 2.2  (Econometric Asset Pricing Model (EAPM)) Econometric Asset Pricing Model (EAPM) defined following functions:\\(r_{t}(\\underline{w_t})\\),\\(f(w_{t+1}|\\underline{w_t}))\\) [\\(\\psi_t(u)\\)],\\(\\mathcal{M}_{t,t+1}(\\underline{w_{t+1}})\\),\\(f^{\\mathbb{Q}}(w_{t+1}|\\underline{w_t})\\) [\\(\\psi^{\\mathbb{Q}}_t(u)\\)].previous functions specified parameterized. linked :\n\\[\nf^{\\mathbb{Q}}(w_{t+1}|\\underline{w_t}) = f(w_{t+1}|\\underline{w_t}) \\mathcal{M}_{t,t+1}(\\underline{w_{t+1}}) \\exp[r_{t}(\\underline{w_t}))].\n\\]following, present three ways specifying EAPM:direct modelling,R.N.-constrained direct modelling (mixed modelling),back modelling.focus case \\(\\mathcal{M}_{t,t+1}\\) exponential affine, Eq. (2.5):\n\\[\n\\mathcal{M}_{t,t+1} (\\underline{w_{t+1}}) = \\exp\\left\\{ -r_{t} (\\underline{w_t}) + \\alpha'_t(\\underline{w_t})w_{t+1} - \\psi_t [\\alpha_t (w_t)]\\right\\}.\n\\]\nshort-term rate function \\(r_{t}(\\underline{w_t})\\) specified, specify \\(\\psi_t\\), \\(\\alpha_t\\), \\(\\psi^{\\mathbb{Q}}_t\\), linked Eq. (2.7).approaches, specify status short rate. short rate \\(r_{t}\\) function \\(\\underline{w_t}\\), function may known unknown econometrician. known two cases: () \\(r_{t}\\) exogenous (\\(r_{t}(\\underline{w_t})\\) depend \\(\\underline{w_t}\\)) (b) \\(r_{t}\\) component \\(w_t\\). contrast, function \\(r_{t} (\\underline{w_t})\\) unknown, specified parametrically:\n\\[\n\\left\\{ r_{t} (\\underline{w_t}, \\tilde{\\theta}), \\tilde{\\theta}\\\\tilde{\\Theta} \\right\\},\n\\]\n\\(r_{t}(\\bullet,\\bullet)\\) known function.Let us now detail three steps three ways defining EAPM based.","code":""},{"path":"pricing-and-risk-neutral-dynamics.html","id":"DirectModeling","chapter":"2 Pricing and risk-neutral dynamics","heading":"2.5.1 The direct modelling","text":"Step 1 – Specification historical dynamics. choose parametric family conditional historical Log-Laplace transform \\(\\psi_t(u|\\underline{w_t})\\): \\(\\left\\{ \\psi_t (u|\\underline{w_t} ; \\theta_1), \\theta_1 \\\\Theta_1 \\right\\}\\).Step 2 – Specification SDF. Considering affine specification Eq. (2.5), :\n\\[\n\\mathcal{M}_{t,t+1} (\\underline{w_{t+1}}) = \\exp\\left\\{ -r_{t}(\\underline{w_t}, \\tilde{\\theta}) + \\alpha'_t(\\underline{w_t})w_{t+1} - \\psi_t [\\alpha_t (w_t)|\\underline{w_t} ; \\theta_1]\\right\\},\n\\]\nneed specifiy functions \\(r_{t}(\\underline{w_t}, \\tilde{\\theta})\\) \\(\\alpha_t(\\underline{w_t})\\). Assume \\(\\alpha_t(\\underline{w_t})\\) belongs parametric family: \\(\\left\\{ \\alpha_t (\\underline{w_t} ; \\theta_2),\\theta_2 \\\\Theta_2 \\right\\}\\).\n:\n\\[\\begin{eqnarray*}\n\\mathcal{M}_{t,t+1}(\\underline{w_{t+1}}, \\theta) &=& \\exp \\left\\{ - r_{t}\n(\\underline{w_t}, \\tilde{\\theta}) + \\alpha'_t (\\underline{w_t},\\theta_2) w_{t+1} - \\psi_{t} \\left[ \\alpha_t (\\underline{w_t},\n\\theta_2) | \\underline{w_t} ; \\theta_1 \\right] \\right\\},\n\\end{eqnarray*}\\]\n\\(\\theta = (\\tilde{\\theta}', \\theta'_1,\\theta'_2)' \\\\tilde{\\Theta}\\times \\Theta_1 \\times \\Theta_2 = \\Theta\\).Step 3 – Internal consistency conditions (ICC). payoff \\(g(\\underline{w_s})\\) settled \\(s>t\\), price \\(p(\\underline{w_t})\\) \\(t\\) known function \n\\(\\underline{w_t}\\), must :\n\\[\\begin{equation*}\np(\\underline{w_t}) = \\mathbb{E} \\left\\{\\mathcal{M}_{t,t+1} (\\theta) \\dots \\mathcal{M}_{s-1,s} (\\theta) g(\\underline{w_s})  |  \\underline{w_t},\n\\theta_1 \\right\\}    \\forall \\; \\underline{w_t}, \\theta.\\tag{2.8}\n\\end{equation*}\\]\nICC pricing conditions may imply strong constraints \\(\\theta\\). instance, components \\(w_t\\) returns assets: \\(w_{1,t} = \\log(p_{1,t}/p_{1,t-1})\\), must \\(\\mathbb{E}_t [\\mathcal{M}_{t,t+1} \\exp (e'_1 w_{t+1})]= 1\\) (Euler equation). , case interest rates various maturities: \\(w_{1,t} = -1/h\\log B(t,h)\\), must \\(e'_1 w_{t} = - 1/h \\log \\mathbb{E}_t (\\mathcal{M}_{t,t+1}\\times \\dots \\times \\mathcal{M}_{t+h-1,t+h})\\).previous three steps imply specification R.N. dynamics (according Eq. (2.7)):\n\\[\\begin{equation*}\n\\psi^{\\mathbb{Q}} (u | \\underline{w_t}, \\theta_1, \\theta_2) =\n\\psi_t \\left[ u + \\alpha_t (\\underline{w_t}, \\theta_2) |\n\\underline{w_t}, \\theta_1 \\right] - \\psi_t \\left[ \\alpha_t\n(\\underline{w_t}, \\theta_2) | \\underline{w_t}, \\theta_1\n\\right].\n\\end{equation*}\\]","code":""},{"path":"pricing-and-risk-neutral-dynamics.html","id":"the-r.n.-constrained-direct-modelling-or-mixed-modelling","chapter":"2 Pricing and risk-neutral dynamics","heading":"2.5.2 The R.N.-constrained direct modelling (or mixed modelling)","text":"Step 1 – Specification physical dynamics. select family \\(\\{ \\psi_t (u | \\underline{w_t},\\theta_1), \\theta_1 \\\\Theta_1 \\}\\).Step 2 – Specification risk-neutral dynamics. select family \\(\\{\\psi^{\\mathbb{Q}}_t (u | \\underline{w_t}, \\theta^*),\\theta^* \\\\Theta^* \\}\\) , possibly, \\(\\{r_{t}(\\underline{w_t},\\tilde{\\theta}),\\tilde{\\theta}\\\\tilde{\\Theta}\\}\\).Step 3 – Internal Consistency Conditions (ICC). parameterization \\((\\tilde{\\theta}, \\theta_1, \\theta^*) \\\\tilde{\\Theta} \\times \\Theta^*_1\\) defined, ICCs may imposed. instance, \\(w_{1,t} = \\log(p_{1,t}/p_{1,t-1})\\), must \\(\\exp(-r_t)\\mathbb{E}^{\\mathbb{Q}}_t \\exp (e_{1}' w_{t+1}) = 1\\). \\(w_{1,t} = B(t,h)\\), \\(e_{1}' w_{t} = \\mathbb{E}_t^{\\mathbb{Q}} \\exp(-r_t - \\dots - r_{t+h-1})\\).SDF -product. want exponential affine SDF, pair \\((\\psi^{\\mathbb{Q}}_t, \\psi_t)\\) belonging families, must exist unique function \\(\\alpha_t (\\underline{w_t})\\) denoted \\(\\alpha_t (w_t ; \\theta_1, \\theta^*)\\), satisfying:\n\\[\\begin{equation*}\n\\psi^{\\mathbb{Q}}_t (u | \\underline{w_t}) = \\psi_t \\left[ u +\n\\alpha_t (w_t) | \\underline{w_t} \\right] - \\psi_t \\left[\n\\alpha_t (\\underline{w_t}) | \\underline{w_t} \\right].\n\\end{equation*}\\]","code":""},{"path":"pricing-and-risk-neutral-dynamics.html","id":"back-modelling-based-on-three-steps","chapter":"2 Pricing and risk-neutral dynamics","heading":"2.5.3 Back modelling (based on three steps)","text":"Step 1 – Specification R.N. dynamics, possibly \\(r_{t}(\\underline{w_t})\\)]: \\(\\psi^{\\mathbb{Q}}_t (u | \\underline{w_t}; \\theta^*_1)\\).Step 2 – Internal consistency conditions (ICC), relevant, taken account:\n\\[\\begin{equation*}\n\\begin{array}{lll}\n&& p(\\underline{w_t}) = \\mathbb{E}^{\\mathbb{Q}}_t \\left[ \\exp (-r_{t} (\\underline{w_t},\\tilde{\\theta}) - \\dots - r_{s-1} (\\underline{w_s}, \\tilde{\\theta}))g(\\underline{w_s}) | \\underline{w_t} , \\theta^*_1\\right] ,\\\\\n&& \\forall    \\underline{w_t} , \\tilde{\\theta} , \\theta^*_1.\n\\end{array}\n\\end{equation*}\\]Step 3 – Choice specification prices risk. One chooses function \\(\\alpha_t(\\underline{w_t})\\) without constraint; amounts defining family \\(\\{ \\alpha_t (\\underline{w_t}, \\theta^*_2), \\theta^*_2\\\\Theta^*_2 \\}\\).historical dynamics obtained -product. Indeed:\n\\[\\begin{equation*}\n\\psi_t(u | \\underline{w_t} ; \\theta^*_1, \\theta^*_2) = \\psi_t^{\\mathbb{Q}}\\left[ u -\\alpha_t (\\underline{w_t}, \\theta^*_2)|\\underline{w_t} ; \\theta^*_1 \\right] -\\psi^{\\mathbb{Q}}_t \\left[- \\alpha_t (\\underline{w_t}, \\theta^*_2) | \\underline{w_t},\\theta^*_1 \\right].\n\\end{equation*}\\]","code":""},{"path":"the-term-structure-or-risk-free-yields.html","id":"the-term-structure-or-risk-free-yields","chapter":"3 The term structure or risk-free yields","heading":"3 The term structure or risk-free yields","text":"","code":""},{"path":"the-term-structure-or-risk-free-yields.html","id":"RFIntroduction","chapter":"3 The term structure or risk-free yields","heading":"3.1 Introduction","text":"Risk-free yields yields--maturity associated bonds carry default /liquidity risks. Bonds issued sovereign entities top credit quality usually considered risk-free.important share term-structure literature pertains modelling risk-free yields. models involve macro factors \\(w_t\\) (Ang Piazzesi 2003); (Darrel Duffie Singleton 1997). latter sometimes called yield-models.basic pricing formula risk-free zero coupon bond (see Eq. (1.10) Example 1.18):\n\\[\\begin{eqnarray}\nB(t,h) &=& \\exp(-r_{t}) \\mathbb{E}^{\\mathbb{Q}}_t \\exp(-r_{t+1}-\\dots-r_{t+h-1})\\\\\nR(t,h) &=& - \\frac{1}{h} \\log B(t,h). \\tag{3.1}\n\\end{eqnarray}\\]Term structure models often used extract term premiums observed yields--maturity. Term premiums components yields exist investors risk-averse.agents risk averse, .e., Expectation Hypothesis (EH), \\(\\mathcal{M}_{t,t+1} = \\exp(- r_t)\\). ``\\(\\mathbb{P} \\equiv \\mathbb{Q}\\)’’ \\(B(t,h)\\) become:\n\\[\\begin{equation}\n\\exp(-r_{t}) \\mathbb{E}_t \\exp(-r_{t+1}-\\dots-r_{t+h-1}).\\tag{3.2}.\n\\end{equation}\\]\nmaturity-\\(h\\) yield--maturity :\n\\[\\begin{eqnarray}\nR^{EH}(t,h) &=& -\\frac{1}{h}\\log \\left( \\mathbb{E}_t \\exp(-r_t-\\dots-r_{t+h-1})\\right)\\nonumber\\\\\n&\\approx& \\frac{1}{h}\\mathbb{E}_t(r_t + \\dots + r_{t+h-1}).\\tag{3.3}\n\\end{eqnarray}\\]term premium given :\n\\[\\begin{eqnarray}\nTP_{t,h} &=& \\underbrace{- \\frac{1}{h} \\log  \\mathbb{E}^{\\mathbb{Q}}_t \\exp(-r_{t+1}-\\dots-r_{t+h-1})}_{=R(t,h)} - \\nonumber \\\\\n&& \\underbrace{- \\frac{1}{h}  \\log  \\mathbb{E}_t \\exp(-r_{t+1}-\\dots-r_{t+h-1}).}_{=R^{EH}(t,h)}\\tag{3.4}\n\\end{eqnarray}\\]economic meaning term premium? EH, investors willing buy maturity-\\(h\\) bond long expected return —Jensen’s inequality—equal average future short-term rates. (Hence definition \\(R^{EH}(t,h)\\), see Eq. (3.3).) \\(TP_{t,h}>0\\), investors willing buy maturity-\\(h\\) bond return , average, higher expected future short-term rates; corresponds situation investors consider long-term bonds tend lose value bad states world (.e., states high marginal utility).Risk premium: According Eq. (2.3), price asset \\(j\\) satisfies:\n\\[\np_{jt} = \\mathbb{E}_t(\\mathcal{M}_{t,t+1} p_{j,t+1}).\n\\]\nprevious equation rewrites:\n\\[\np_{jt} =  \\mathbb{C}ov_t(\\mathcal{M}_{t,t+1}, p_{j,t+1}) + \\mathbb{E}_t(\\mathcal{M}_{t,t+1})\\mathbb{E}_t( p_{j,t+1})\n\\]\n\n\\[\\begin{equation}\np_{jt} = \\underbrace{\\exp(-r_t)\\mathbb{E}_t( p_{j,t+1})}_{=p^{EH}_{jt}} + \\underbrace{\\mathbb{C}ov_t(\\mathcal{M}_{t,t+1}, p_{j,t+1})}_{\\mbox{Risk premium}}.\\tag{3.5}\n\\end{equation}\\]\ninvestors risk-averse, \\(p_{jt} = p^{EH}_{jt}\\). S.D.F. high (resp. low) bad (resp. good) states world (states high marginal utility equilibrium approach). Hence, \\(p_{jt}< p^{EH}_{jt}\\) asset \\(j\\) tends pay less bad states world (.e., \\(\\mathbb{C}ov_t(\\mathcal{M}_{t,t+1}, p_{j,t+1})<0\\)).","code":""},{"path":"the-term-structure-or-risk-free-yields.html","id":"swap-rates-and-forward-rates","chapter":"3 The term structure or risk-free yields","heading":"3.2 Swap rates and forward rates","text":"","code":""},{"path":"the-term-structure-or-risk-free-yields.html","id":"Swaps","chapter":"3 The term structure or risk-free yields","heading":"3.2.1 Swap rates","text":"Bonds issued top-rated (Aaa/AAA) countries often considered risk-free. call-margins mechanisms, swap rates also used risk-free benchmarks (Darrell Duffie Stein 2015).Definition 3.1  (Interest Rate Swap (IRS)) Interest Rate Swap (IRS), fixed-rate payer agrees provide fixed-rate receiver sequence cash flows determined negotiation date swap, predetermined dates. cash flows constitute fixed leg swap. Conversely, fixed-rate receiver provides fixed-rate payer cash-flows depend future values reference rate; floating rate swap.precisely, dates payment form \\(t+ \\tau\\), \\(t + 2\\tau\\), , \\(t + n\\tau\\), \\(\\tau\\) period expressed years (typically 1/2 1/4) \\(n\\) number payments. maturity, tenor, swap contract \\(h = n \\tau\\).payoffs fixed leg \\(\\tau S\\), \\(S\\) annualized payment (swap rate). date \\(t+j\\tau\\), payoff floating leg \\(\\tau L(t+(j-1)\\tau,\\tau)\\), \\(L\\), annualized linear rate given :\n\\[\nL(t+(j-1)\\tau,\\tau) = \\frac{1 - B(t+(j-1)\\tau,\\tau)}{\\tau B(t+(j-1)\\tau,\\tau)},\n\\]\n\\(B(t+(j-1)\\tau,\\tau)\\) price, date \\(t+(j-1)\\tau\\) bond maturity \\(\\tau\\).negotiation date, values fixed floating legs identical, value swap zero.\\(t\\), price fixed leg :\n\\[\n\\sum_{j=1}^n \\tau S B(t,j\\tau).\n\\]\nLet us turn price floating leg. payoff date \\(t+j\\tau\\), \\(\\frac{1 - B(t+(j-1)\\tau,\\tau)}{B(t+(j-1)\\tau,\\tau)}\\) known date \\(t+(j-1)\\tau\\), price date \\(t+(j-1)\\tau\\) \\(1 - B(t+(j-1)\\tau,\\tau)\\), price \\(t\\) therefore \\(B(t,(j-1)\\tau) - B(t,j\\tau)\\). Summing \\(j=1,\\dots,n\\), date-\\(t\\) price floating leg \\(1 - B(t,n\\tau)\\) (independent payment dates).Since price contract zero date \\(t\\) (definition swap), must :\n\\[\n\\sum_{j=1}^n \\tau S B(t,j\\tau) = 1 - B(t,n\\tau) \\Rightarrow S = \\frac{1 - B(t,n\\tau)}{ \\tau \\sum_{j=1}^n  B(t,j\\tau)},\n\\]\n\n\\[\n\\boxed{S(t,h) = \\frac{1 - B(t,h)}{\\tau \\sum_{j=1}^{h/\\tau}  B(t,j\\tau)}.}\n\\]Note terms appearing previous formula available closed-form context affine model (see Example 1.18).","code":""},{"path":"the-term-structure-or-risk-free-yields.html","id":"FWD","chapter":"3 The term structure or risk-free yields","heading":"3.2.2 Forward rates","text":"Definition 3.2  (Forward Rate Agreement (FRA)) interest rate forward contract contract rate paid received specific obligation set period, beginning future, set contract initiation.Denote \\(f(t,h_1,h_2)\\) forward interest rate, set date \\(t\\), period \\(t+h_1\\) \\(t+h_2\\). Let us relate \\(f(t,h_1,h_2)\\) bond rates. , consider two strategies (decided date \\(t\\)):Buy zero-coupon bond maturity \\(h_2\\) (price \\(B(t,h_2)\\)) sell zero-coupon bonds maturity \\(h_1\\) amount (yielding payoff \\(B(t,h_2)/B(t,h_1)\\) date \\(t+h_1\\)).Enter forward rate agreement dates \\(t+h_1\\) \\(t+h_2\\), whereby receive 1 date \\(t+h_2\\).two strategies deliver payoffs date \\(t\\) (payoff zero) date \\(t+h_2\\) (payoff 1). absence arbitrage, payoffs date \\(t+h_1\\) . Therefore\n\\[\\begin{eqnarray*}\n\\exp(-(h_2 - h_1)f(t,h_1,h_2)) &=& B(t,h_2)/B(t,h_1) \\\\\n\\Rightarrow f(t,h_1,h_2) &=& \\frac{1}{h_2 - h_1}(\\log[B(t,h_1)] - \\log[B(t,h_2)]),\n\\end{eqnarray*}\\]\ngives:\n\\[\\begin{equation}\n\\boxed{f(t,h_1,h_2) = \\frac{h_2 R(t,h_2) - h_1 R(t,h_1)}{h_2 - h_1}.}\\tag{3.6}\n\\end{equation}\\]\naffine model (\\(R(t,h)\\) affine function state vector \\(w_t\\)), forward rates linear state vector \\(w_t\\).","code":""},{"path":"the-term-structure-or-risk-free-yields.html","id":"RiskFreeAffine","chapter":"3 The term structure or risk-free yields","heading":"3.3 The Affine Case","text":"","code":""},{"path":"the-term-structure-or-risk-free-yields.html","id":"affine-yields","chapter":"3 The term structure or risk-free yields","heading":"3.3.1 Affine yields","text":"subsection, consider case state vector \\(w_t\\) affine \\(\\mathbb{P}\\) \\(\\mathbb{Q}\\). nominal short-term rate affine \\(w_t\\), .e., \\(r_t = \\omega_0 + \\omega'_1 w_t\\), :\n\\[\\begin{eqnarray*}\nB(t,h) &=& \\mathbb{E}^{\\mathbb{Q}}_t \\exp (-r_{t}-\\dots-r_{t+h-1})\\\\\n&=& \\exp(-h\\omega_0 - \\omega'_1 w_t) \\color{blue}{\\mathbb{E}^{\\mathbb{Q}}_t \\exp (- \\omega'_1 w_{t+1}-\\dots- \\omega'_1 w_{t+h-1})}.\n\\end{eqnarray*}\\]\n(blue) expectation easily computed using recursive equations Lemma 1.5 (see Example 1.18), leading :\n\\[\\begin{equation}\nR(t,h)= -  \\frac{1}{h}   \\log   B(t,h) = A_h'w_t + B_h.\\tag{3.7}\n\\end{equation}\\]\neasily seen can also get:\n\\[\\begin{equation}\nR^{EH}(t,h) = {^{EH}_h}'w_t + B^{EH}_h.\\tag{3.8}\n\\end{equation}\\]\nMoreover, inflation also affine \\(w_t\\), .e., \\(\\pi_{t} = \\bar\\omega_0 + \\bar\\omega'_1 w_t\\), real yields given :\n\\[\\begin{eqnarray*}\n\\bar{B}(t,h) &=& \\mathbb{E}^{\\mathbb{Q}}_t \\exp(-r_{t}-\\dots-r_{t+h-1}+\\pi_{t+1}+\\dots+\\pi_{t+h})\n\\end{eqnarray*}\\]\n(see Example 1.20) also leads :\n\\[\\begin{equation}\n\\bar{R}(t,h) = -  \\frac{1}{h}   \\log   \\bar{B}(t,h) = \\bar{}_h'w_t + \\bar{B}_h.\\tag{3.9}\n\\end{equation}\\]\nEqs. (3.7) (3.8) imply term premiums affine \\(w_t\\) (see Eq. (3.4)). Specifically:\n\\[\nTP(t,h) = R(t,h) - E^{EH}(t,h) = B_h - B_h^{EH} + (A_h - A_h^{EH})'w_t.\n\\]\nExpected excess returns resulting holding zero-coupon bonds also affine \\(w_t\\). Indeed, holding maturity-\\(h\\) zero-coupon bond one period provides following expected gross return:\n\\[\n\\mathbb{E}_t\\left(\\frac{B(t+1,h-1)}{B(t,h)}\\right) = \\mathbb{E}_t\\left(\\exp(B_{h-1} - B_h + A_{h-1}'w_{t+1} - A_h'w_{t})\\right),\n\\]\nclearly exponential affine \\(w_t\\) \\(w_t\\) affine process. Therefore, expected excess return, :\n\\[\n\\log \\mathbb{E}_t\\left(\\frac{B(t+1,h-1)}{B(t,h)}\\right) - r_t\n\\]\nalso affine \\(w_t\\) context. fact excess returns affine context exploited estimation approach proposed Adrian, Crump, Moench (2013).Moreover, conditional expectations future interest rates (real nominal) term premiums also affine \\(w_t\\). particular:\n\\[\\begin{equation}\n\\mathbb{E}_t[R(t+k,h)] = \\mathbb{E}_t[{A_h}'w_{t+k} + B_h] = {A_h}'\\mathbb{E}_t(w_{t+k}) + B_h,\\tag{3.10}\n\\end{equation}\\]\n\\(\\mathbb{E}_t(w_{t+k})\\) affine \\(w_t\\) (see Eq. (1.15)). can notably used estimation stage, one wants fit survey data (see Section XXX).Similarly, conditional variances future interest rates (real nominal) term premiums affine \\(w_t\\). particular:\n\\[\\begin{equation}\n\\mathbb{V}ar_t[R(t+k,h)] = \\mathbb{V}ar_t[{A_h}'w_{t+k} + B_h] = {A_h}'\\mathbb{V}ar_t(w_{t+k})A_h,\\tag{3.11}\n\\end{equation}\\]\ncomponents \\(\\mathbb{V}ar_t(w_{t+k})\\) (therefore \\(\\mathbb{V}ar_t[R(t+k,h)]\\)) affine \\(w_t\\) (see Eq. (1.16)). can also used estimation stage, one wants fit (proxies ) conditional variances (Alain Monfort et al. 2017).","code":""},{"path":"the-term-structure-or-risk-free-yields.html","id":"maximum-sharpe-ratio","chapter":"3 The term structure or risk-free yields","heading":"3.3.2 Maximum Sharpe ratio","text":"affine model, maximum Sharpe ratio easily computed. noted early Duffee (2010) Gaussian model; Christian Gourieroux et al. (2021) Pallara Renne (2023) use sophisticated affine models.Let us derive maximum Sharpe ratio context genral affine framework. Eq. (3.5) implies \n\\[\n\\mathbb{E}_t\\underbrace{\\left(\\frac{p_{j,t+1}}{p_{j,t}} - \\exp(r_t)\\right)}_{=xs_{j,t+1},\\mbox{ excess return}} =  - \\exp(r_t) \\mathbb{C}ov_t\\left(\\mathcal{M}_{t,t+1},\\frac{p_{j,t+1}}{p_{j,t}}\\right),\n\\]\n, using \\(|\\mathbb{C}ov(X,Y)| \\le \\sqrt{\\mathbb{V}ar(X)\\mathbb{V}ar(Y)}\\), get Hansen Jagannathan (1991) bound:\n\\[\\begin{equation}\n\\underbrace{\\frac{\\mathbb{E}_t(xs_{j,t+1})}{\\sqrt{\\mathbb{V}ar_t(xs_{j,t+1})}}}_{\\mbox{Sharpe ratio}} \\le \\underbrace{\\frac{\\sqrt{\\mathbb{V}ar_t(\\mathcal{M}_{t,t+1})}}{\\mathbb{E}_t(\\mathcal{M}_{t,t+1})}}_{\\mbox{Maximum Sharpe ratio}}.\n\\end{equation}\\]S.D.F. given \\(\\mathcal{M}_{t,t+1} = \\exp[-r_{t}+\\alpha'_tw_{t+1}-\\psi_t(\\alpha_t)]\\) (Eq. (2.5)), using \\(\\mathbb{E}_t(\\mathcal{M}_{t,t+1}^2)=\\exp(-2r_t+\\psi_t(2\\alpha_t)-2\\psi_t(\\alpha_t))\\) get:\n\\[\n\\mbox{Maximum Sharpe ratio} = \\sqrt{\\exp(\\psi_t(2\\alpha_t)-2\\psi_t(\\alpha_t)) - 1}.\n\\]","code":""},{"path":"the-term-structure-or-risk-free-yields.html","id":"RiskFreeGaussian","chapter":"3 The term structure or risk-free yields","heading":"3.4 Gaussian Affine Term Structure Model","text":"Gaussian Affine Term Structure Model (GATSM) Workhorse model, widely used academic economic-policy circles. GATSM, \\(w_t\\) follows Gaussian vector autoregressive model, therefore affine \\(\\mathbb{P}\\). S.D.F. exponential affine \\(w_t\\), implies also affine \\(\\mathbb{Q}\\) (see Subsection XXX). Since components \\(w_t\\) valued \\(\\mathbb{R}\\), one can easily introduce macro-factors among state variables.Let us specific. state vector \\(w_t\\) follows:\n\\[\\begin{equation}\nw_{t+1} = \\mu + \\Phi w_{t} + \\Sigma^{1/2} \\varepsilon_{t+1}, \\mbox{ } \\varepsilon_{t} \\sim  ..d. \\mathcal{N}(0,Id).\\tag{3.12}\n\\end{equation}\\]\n(fact consider VAR(1) process without loss generality since VAR(p) admits VAR(1) companion representation.)implies following Laplace transform \\(w_t\\) (see Example ??):\n\\[\n\\psi_t(u) = \\log \\mathbb{E}_t(\\exp(u'w_{t+1})|\\underline{w_t}) = \\color{blue}{u'\\mu + u'\\Phi w_t + \\frac{1}{2}u'\\Sigma'u}.\n\\]\nUsing notations Eq. (2.5), s.d.f. defined :\n\\[\n\\mathcal{M}_{t,t+1} = \\exp(- r_t + \\alpha_t'w_{t+1} - \\psi_t(\\alpha_t)), \\mbox{ } \\alpha_t = \\alpha_0 + \\alpha_1'w_t.\n\\]case, using Eq. (2.7), get:\n\\[\\begin{eqnarray*}\n\\psi_t^{\\mathbb{Q}}(u) &=& \\psi_t(u + \\alpha_t) - \\psi_t(\\alpha_t)\\\\\n&=& (u + \\alpha_t)'\\mu + (u + \\alpha_t)'\\Phi w_t + \\frac{1}{2}(u + \\alpha_t)'\\Sigma(u + \\alpha_t) \\\\\n&& - \\left(\\alpha_t'\\mu + \\alpha_t'\\Phi w_t + \\frac{1}{2}\\alpha_t'\\Sigma\\alpha_t\\right) \\\\\n&=& \\color{blue}{u' \\left(\\mu + \\Sigma \\alpha_0 \\right) + u'(\\Phi + \\Sigma \\alpha_1')w_t  + \\frac{1}{2}u'\\Sigma'u}.\n\\end{eqnarray*}\\]\n\\(\\mathbb{Q}\\)-dynamics \\(w_t\\) (Example ??):\n\\[\nw_{t+1} = \\mu + \\Sigma  \\alpha_0 + (\\Phi + \\Sigma \\alpha_1')  w_{t} + \\Sigma^{1/2} \\varepsilon^*_{t+1}, \\mbox{ } \\varepsilon^*_{t} \\sim  ..d. \\mathcal{N}^{\\mathbb{Q}}(0,Id).\n\\]\nHence, \\(w_t\\) also follows VAR process \\(\\mathbb{Q}\\) since previous equation rewrites:\n\\[\nw_{t+1} = \\mu^{\\mathbb{Q}} + \\Phi^{\\mathbb{Q}} w_{t} + \\Sigma^{1/2} \\varepsilon^*_{t+1},\n\\]\n\\(\\mu^{\\mathbb{Q}} = \\mu + \\Sigma \\alpha_0\\) \\(\\Phi^{\\mathbb{Q}}=\\Phi + \\Sigma \\alpha_1'\\).affine specifications nominal short term rate (\\(r_{t} = \\omega_0 + \\omega'_1 w_t\\)) inflation rate (\\(\\pi_{t} = \\bar\\omega_0 + \\bar\\omega'_1 w_t\\)), obtain affine formulas nominal real yields maturity (Eqs. (3.7) (3.9)).Example 3.1  (Kim Wright (2005)) model three-factor yield-model (macro variables, except inflation one variant model), short-term rate reads \\(r_t = \\omega_0 + \\omega_{1,1} w_{1,t} +\\omega_{1,2} w_{2,t} +\\omega_{1,3} w_{3,t}\\).model estimated Kalman filter (see Subsection,4.2; state-space model (Def. 4.1) includes survey-based variables (see Subsection 4.6).Outputs regularly updated Federal Reserve Board.Monthly data 6-month 12-month-ahead forecasts three-month T-Bill yield Blue Chip Financial Forecasts semiannual data average expected three-month T-Bill yield 6 11 years.\nFigure 3.1: Kim Wright (2005) outputs.\nExample 3.2  (Ang Piazzesi (2003)) Ang Piazzesi (2003) propose one first paper mixing latent macrovariables. set also form Eq. (3.12), except VAR features several lags.7 model, \\(w_t = [f^{o}_{1,t},f^{o}_{2,t},f^{u}_{1,t},f^{u}_{2,t},f^{u}_{3,t}]'\\) :\\(f^{o}_{1,t}\\) first Principal Component set 3 price indexes (growth rates)\\(f^{o}_{2,t}\\) first Principal Component set 4 real activity proxies (HELP, EMPLOY, IP, UE).\\(f^{u}_{,t}\\) unobserved, latent, factors.nominal short-term rate follows Taylor rule. latent factors estimated via inversion techniques (Subsection 4.5).\nFigure 3.2: Source: Ang Piazzesi (1998). Impulse response functions.\nExample 3.3  (Joslin, Priebsch Singleton (2014)) Joslin, Priebsch, Singleton (2014) first note affine models stating short term rate affine macro factors imply macro-factors spanned yield curve: macro-factors perfectly explained yields different maturities. , show case data. (, regressing macro factors yields provides \\(R^2\\) far one.)propose model macro factors unspanned yield curve, can still help predict yields. model, \\(w_t = [\\mathcal{P}_t',M_t']'\\), \\(\\mathcal{P}_t\\) yield factors (\\(\\approx\\) principal components) \\(M_t\\) macro factors. model follows:\n\\[\\begin{eqnarray*}\nr_t &=& \\omega_{0} + \\omega_{\\mathcal{P}}'\\mathcal{P}_t \\\\\n\\left[\\begin{array}{c}\\mathcal{P}_t \\\\ M_t \\end{array}\\right]\n&=&\n\\left[\\begin{array}{cc}\\Phi_{\\mathcal{P}\\mathcal{P}}&\\Phi_{\\mathcal{P}M} \\\\\n\\Phi_{M\\mathcal{P}}&\\Phi_{MM} \\end{array}\\right]\n\\left[\\begin{array}{c}\\mathcal{P}_{t-1} \\\\ M_{t-1} \\end{array}\\right] + \\Sigma \\varepsilon_t \\\\\n\\left[\\begin{array}{c}\\mathcal{P}_t \\\\ M_t \\end{array}\\right] &=& \\mu +\n\\left[\\begin{array}{cc}\\Phi^{\\mathbb{Q}}_{\\mathcal{P}\\mathcal{P}}&{\\color{red}0} \\\\\n\\Phi^{\\mathbb{Q}}_{M\\mathcal{P}}&\\Phi^{\\mathbb{Q}}_{MM} \\end{array}\\right]\n\\left[\\begin{array}{c}\\mathcal{P}_{t-1} \\\\ M_{t-1} \\end{array}\\right] + \\Sigma \\varepsilon^{\\mathbb{Q}}_t,\n\\end{eqnarray*}\\]\n\\(\\varepsilon_t\\) \\(\\varepsilon^{\\mathbb{Q}}_t\\) \\(\\mathcal{N}(0,Id)\\) \\(\\mathbb{P}\\) \\(\\mathbb{Q}\\), respectively.\\(M_t\\) Granger-cause \\(\\mathcal{P}_t\\) \\(\\mathbb{Q}\\) \\(r_t\\) affine \\(\\mathcal{P}_t\\) ().context, yields \\(R(t,h)\\) affine \\(\\mathcal{P}_t\\) (). However \\(M_t\\) Granger-cause \\(\\mathcal{P}_t\\) \\(\\mathbb{P}\\), , macro-shocks affect yield curve.\nFigure 3.3: Source: Joslin, Priebsch, Singleton (2014). Impulse response functions.\nExample 3.4  (Ang, Boivin, Dong Loo-Kung (2011)) Ang et al. (2011) propose macro-finance model based quadratic framework. short-term rate follows Taylor rule time-varying parameters:\n\\[\nr_t = \\omega_0 + a_t g_t + b_t \\pi_t,\n\\]\n\\(x_t=(g_t,\\pi_t,a_t,b_t)'\\) follows Gaussian VAR. context described Example 1.7. previous equation shows \\(r_t\\) linear \\(w_t = (x_t,vec(x_t x_t')')'\\). Specifically:\n\\[\nr_t = \\omega_0 + \\omega_1'w_t,\n\\]\n\\(\\omega_1 = [v,vec(V)]'\\), \n\\[\nv = \\left[\n\\begin{array}{c}\n0\\\\\n0\\\\\n0\\\\\n0\n\\end{array}\n\\right] \\quad \\mbox{} \\quad V = \\left[\n\\begin{array}{cccc}\n0 & 0& 1/2&0\\\\\n0& 0& 0&1/2\\\\\n1/2& 0& 0&0\\\\\n0&1/2 &0 &0\n\\end{array}\n\\right].\n\\]\nFigure 3.4: Source: Ang, Boivin, Dong, Loo-Kung (2011). Estimated factor loadings (\\(a_t\\) \\(b_t\\)).\n","code":""},{"path":"the-term-structure-or-risk-free-yields.html","id":"RiskFreeNonNegative","chapter":"3 The term structure or risk-free yields","heading":"3.5 Non-Negative Affine Term Structure Model","text":"presence physical currency, absence arbitrage opportunity storing cost cash, nominal interest rates nonnegative. Many standard models (e.g. Gaussian ATSM) non consistent non-negative nominal yields. period extremely low interest rates challenged models. backdrop, approaches developed accommodate zero (effective) lower bounds. provide two examples; second affine model.","code":""},{"path":"the-term-structure-or-risk-free-yields.html","id":"the-shadow-rate-approach","chapter":"3 The term structure or risk-free yields","heading":"3.5.1 The shadow-rate approach","text":"shadow-rate model originally due Black (1995). model, short term rate given :\n\\[\\begin{equation}\nr_t = \\max(s_t,\\underline{r}),\\tag{3.13}\n\\end{equation}\\]\n\\(s_t\\) shadow short-term interest rate \\(\\underline{r}\\) effective lower bound (\\(\\le 0\\)). \\(s_t\\) can real-valued, short term rate nonnegative (3.13). shadow-rate models, shadow rate \\(s_t\\) usually linear combination vector \\(w_t\\) follows Gaussian auto-regressive model. \\(s_t\\) linear combination components affine process, case \\(r_t\\). result, pricing formula available closed-form. Approximation formula proposed , e.g., Krippner (2013), Priebsch (2013), Wu Xia (2016).Let us describe latter approach (Wu Xia 2016). Subsection 3.4, S.D.F. defined :\n\\[\n\\mathcal{M}_{t,t+1} = \\exp(- r_t + \\alpha_t'w_{t+1} - \\psi_t(\\alpha_t)), \\mbox{ } \\alpha_t = \\alpha_0 + \\alpha_1'w_t,\n\\]\n(Eq. (2.5)), short-term rate \\(r_t\\) given \\(r_t = \\max(s_t,0)\\), \n\\[\ns_t = \\delta_0 + \\delta_1' w_t.\n\\]approximation approach proposed Wu Xia (2016) based approximation conditional expectations forward rates. Using results Subsection 3.2.2, (Eq. (3.6)):\n\\[\nf_{n-1,n,t} = n R_{t,n} - (n-1) R_{t,n-1}.,\n\\]\n\\(n>0\\) (using \\(R_{t,0}=0\\)). implies :\n\\[\nR_{t,h} =  \\frac{1}{h}(f_{t,0,1}+f_{t,1,2}+\\dots+f_{t,h-1,h}).\n\\]approximation Wu Xia (2016) consists finding approximations forward rates \\(f_{t,n-1,n}\\) (denoted \\(\\tilde{f}_{t,n-1,n}\\), say) use previous equation get:\n\\[\\begin{equation}\n\\boxed{R_{t,h} \\approx  \\frac{1}{h}\\left(\\tilde{f}_{t,0,1}+\\tilde{f}_{t,1,2}+\\dots+\\tilde{f}_{t,h-1,h}\\right).}\\tag{3.14}\n\\end{equation}\\]Using , random variable \\(Z\\), \\(\\log(\\mathbb{E}[e^Z]) \\approx \\mathbb{E}[Z] + \\frac{1}{2} \\mathbb{V}ar[Z]\\) (based second order Taylor expansion), Wu Xia (2016) show :\n\\[\\begin{eqnarray}\nf_{t,n,n+1} &=& -\\log\\left(\\mathbb{E}_t^{\\mathbb{Q}}\\left(e^{-\\sum_{j=0}^n r_{t+j}}\\right)\\right) + \\log\\left(\\mathbb{E}_t^{\\mathbb{Q}}\\left(e^{-\\sum_{j=0}^{n-1} r_{t+j}}\\right)\\right)\\\\\n&\\approx& \\mathbb{E}_t^{\\mathbb{Q}}[r_{t+n}] - \\frac{1}{2}\\left(\\mathbb{V}ar_t^{\\mathbb{Q}}\\left(\\sum_{j=0}^n r_{t+j}\\right)-\\mathbb{V}ar_t^{\\mathbb{Q}}\\left(\\sum_{j=0}^{n-1} r_{t+j}\\right)\\right).\n\\end{eqnarray}\\]expectation can computed analytically:\n\\[\n\\mathbb{E}_t^{\\mathbb{Q}}[r_{t+n}] = \\underline{r} + \\sigma_n^{\\mathbb{Q}}g\\left(\\frac{\\bar{}_n + b_n'X_t - \\underline{r}}{\\sigma_n^{\\mathbb{Q}}}\\right),\n\\]\n\\(g(x)= x\\Phi(x)-\\phi(x)\\), \\(\\Phi\\) \\(\\phi\\) c.d.f. p.d.f. standard normal distribution, respectively, \n\\[\\begin{eqnarray*}\n\\bar{}_n &=& \\delta_0 + \\delta_1'\\left(\\sum_{j=0}^{n-1} \\left[\\Phi^{\\mathbb{Q}}\\right]^j\\right)\\mu^{\\mathbb{Q}}\\\\\nb_n' &=& \\delta_1'\\left(\\Phi^{\\mathbb{Q}}\\right)^n.\n\\end{eqnarray*}\\]\nalso show \n\\[\n\\frac{1}{2}\\left(\\mathbb{V}ar_t^{\\mathbb{Q}}\\left(\\sum_{j=0}^n r_{t+j}\\right)-\\mathbb{V}ar_t^{\\mathbb{Q}}\\left(\\sum_{j=0}^{n-1} r_{t+j}\\right)\\right) \\approx \\Phi\\left(\\frac{\\bar{}_n + b_n'X_t - \\underline{r}}{\\sigma_n^{\\mathbb{Q}}}\\right)\\times(\\bar{}_n - a_n),\n\\]\n\n\\[\na_n = \\bar{}_n - \\frac{1}{2}\\sigma_n^{\\mathbb{Q}},\n\\]\n\n\\[\n\\sigma_n^{\\mathbb{Q}} := \\mathbb{V}ar^{\\mathbb{Q}}_t\\left(s_{t+n}\\right)= \\delta_1'\\left(\\sum_{j=0}^{n-1} \\left[\\Phi^{\\mathbb{Q}}\\right]^j\\right)\\Sigma \\Sigma' \\left(\\sum_{j=0}^{n-1} \\left[\\Phi^{\\mathbb{Q}}\\right]^j\\right)'\\delta_1.\n\\]\nfinally obtain:\n\\[\n\\boxed{f_{t,n,n+1} \\approx \\tilde{f}_{t,n,n+1} = \\underline{r} + \\sigma_n^{\\mathbb{Q}}g\\left(\\frac{a_n + b_n'X_t - \\underline{r}}{\\sigma_n^{\\mathbb{Q}}}\\right),}\n\\]\nused (3.14) obtain approximation \\(R_{t,h}\\).\nFigure 3.5: bla bla bla.\n","code":"\nlibrary(TSModels)\n# Specify model:\nn <- 2 # number of factors\nrho <- matrix(0,n,n)\ndiag(rho) <- .97\nmu <- matrix(0,n,1)\nSigma <- diag(n)\ndelta.0 <- 0;delta.1 <- rep(.01,n)\nr.bar <- 0 # r = max(s,r.bar) [i.e., r.bar=0 in standard model]\nModel <- list(rho = rho,mu = mu,Sigma = Sigma,\n  delta.0 = delta.0,delta.1 = delta.1,r.bar = r.bar)\n# Simulate model and compute shadow rate:\nX <- simul.var(Model,nb.sim = 200) # simulated path\ns <- delta.0 + X %*% delta.1\n# Compute yields:\nres <- compute.price.WX(Model,X,max.H=100)\n# Prepare plots:\npar(plt=c(.1,.95,.2,.75))\npar(mfrow=c(2,1))\nplot(s,type=\"l\",xlab=\"time\",ylab=\"\",lwd=2,main=\"(a) Shadow rate\")\nt <- 50 #t <- which(s==min(s))\nabline(v=t,col=\"dark grey\",lwd=2,lty=3)\nplot(res$vec.f[t,],type=\"l\",xlab=\"maturity\",ylab=\"\",\n     lwd=2,main=\"(b) yields and forward rates\")\nlines(res$vec.y[t,],col=\"red\",lwd=2)\nlegend(\"topright\", \n       c(\"forward rates\",\"yields to maturity\"),lwd=c(2),lty=1,\n       col=c(\"black\",\"red\"),bg = \"white\")"},{"path":"the-term-structure-or-risk-free-yields.html","id":"the-auto-regressive-gamma-approach","chapter":"3 The term structure or risk-free yields","heading":"3.5.2 The auto-regressive gamma approach","text":"Alain Monfort et al. (2017) introduce affine framework short-term rate can stay zero prolonged period time stochastic lift-probability.\\(\\mathbb{P}\\) \\(\\mathbb{Q}\\), state vector \\(w_t\\) follows multi-variate auto-regressive gamma (VARG) process—multivariate extension Example 1.8. Conditionally \\(\\underline{w_t}\\), \\(n\\) components \\(w_{t+1}\\) independent distributed follows:\n\\[\\begin{equation}\n\\frac{w_{,t+1}}{\\mu_i} \\sim \\gamma(\\nu_i+z_{,t}) \\quad \\mbox{} \\quad z_{,t} \\sim {\\mathcal P} \\left( \\alpha_i + \\beta_i' w_t \\right).\\tag{3.15}\n\\end{equation}\\]\n\\(\\mu = (\\mu_1,\\dots,\\mu_n)'\\), \\(\\alpha = (\\alpha_1,\\dots,\\alpha_n)'\\), \\(\\nu = (\\nu_1,\\dots,\\nu_n)'\\) \\(\\beta = (\\beta_1,\\dots,\\beta_n)\\), \n\\[\\begin{eqnarray*}\n\\varphi_t(u) &=& \\exp\\left[\\left(\\frac{u \\odot \\mu}{1 - u \\odot \\mu}\\right)'\\beta' w_t \\right.\\\\\n&& \\left. + \\alpha'\\left(\\frac{u \\odot \\mu}{1 - u \\odot \\mu}\\right) - \\nu'\\log(1 - u \\odot \\mu)\\right],\n\\end{eqnarray*}\\]\n\\(\\odot\\) denotes element--element multiplication , , abuse notation, division log operators work element--element applied vectors.baseline model, Alain Monfort et al. (2017) use four factors. set \\(\\nu_1 = \\nu_2 = 0\\), implying \\(w_{1,t}\\) \\(w_{2,t}\\) can stay zero (see Example 1.8). short-term rate \\(r_t\\) posited affine combination \\(w_{1,t}\\) \\(w_{2,t}\\), :\n\\[\nr_t = \\omega'w_t = \\omega_{1} w_{1,t} + \\omega_{2} w_{2,t},\n\\]\nhence, can stay zero.Factors \\(w_{3,t}\\) \\(w_{4,t}\\) Granger-cause \\(w_{1,t}\\) \\(w_{2,t}\\), thereby causing \\(r_t\\). result, \\(h \\ge 2\\), \\(R(t,h)\\) non-zero combination four components \\(w_t\\).reason, \\(r_t=0\\), lift-probability depends \\(w_{3,t}\\) \\(w_{4,t}\\). framework offers closed-form solutions lift-probabilities. Indeed, using Lemma ??:\n\\[\n\\mathbb{P}_t(\\alpha'w_{t+h}=0) = \\lim_{u \\rightarrow -\\infty} \\varphi_{t,h}(0,\\dots,0,u\\alpha),\n\\]\n\\(\\varphi_{t,h}\\) multi-horizon Laplace transform defined Eq. (1.8), can computed using Proposition 1.5. :\n\\[\\begin{equation}\n\\left\\{\n\\begin{array}{l}\n\\mathbb{P}_t(r_{t+h}>0) = 1 - \\lim_{u \\rightarrow -\\infty} \\varphi_{t,h}(0,\\dots,0,u\\omega) \\\\ \\\\\n\\mathbb{P}_t(r_{t+1}=0,\\dots,r_{t+h}=0) = \\lim_{u \\rightarrow -\\infty} \\varphi_{t,h}(u\\omega,\\dots,u\\omega,u\\omega) \\equiv p_{h}\\\\ \\\\\n\\mathbb{P}_t(r_{t+1}=0,\\dots,r_{t+h-1}=0,r_{t+h}>0) = p_{h-1} - p_h.\n\\end{array}\n\\right.\n\\end{equation}\\]\nlift-probabilities, type \\(\\mathbb{P}_t[R(t+h,k)>threshold]\\), can derived Eq. (1.18).Alain Monfort et al. (2017) esitmate model means Kalman filtering techniques (see Subsection ??). Observed variables include (levels ) yields, well survey-based forecasts yields (see Subsection 4.6 (e-GARCH-based) proxies conditional variances (see Eq. (1.16)).\nFigure 3.6: Source: Monfort et al. (2017). Model fit conditional variances surveys professional forecasters.\n\nFigure 3.7: Source: Monfort et al. (2017). Lift-probabilities.\n","code":""},{"path":"estimation-of-affine-asset-pricing-models.html","id":"estimation-of-affine-asset-pricing-models","chapter":"4 Estimation of affine asset-pricing models","heading":"4 Estimation of affine asset-pricing models","text":"","code":""},{"path":"estimation-of-affine-asset-pricing-models.html","id":"EstimationSSModel","chapter":"4 Estimation of affine asset-pricing models","heading":"4.1 State-space model","text":"nature, dynamic asset-pricing models state-space models: dynamics variables, gathered vector \\(y_t\\) (yields, equity returns, macroeconomic variables, survey-based variables) accounted state variables (\\(w_t\\)). equations defining relationship variables state variables called measurement equations (Eq. (4.1)). equations defining dynamics state variables called transition equations (Eq. (4.2)).case \\(w_t\\) affine process (see Definition 1.1), transition equations admit VAR(1) representation (Proposition 1.1). case, state-space model said linear, formalized following definition. defintion introduces, particular, notion measurement errors.Definition 4.1  (Linear State-Space Model) linear state-space model writes follows:\n\\[\\begin{eqnarray}\n\\underset{(m \\times 1)}{y_t}  &=& + Bw_t + \\eta_t  \\quad \\mbox{}  \\eta_t \\sim ..d. \\mathcal{N}(0,\\Omega) \\tag{4.1} \\\\\n\\underset{(n \\times 1)}{w_t} & =& \\mu + \\Phi w_{t-1} + \\Sigma^{\\frac{1}{2}}(w_{t-1}) \\varepsilon_t,\\tag{4.2}\n\\end{eqnarray}\\]\n\\(\\varepsilon_t\\) martingale difference sequence satisfying \\(\\mathbb{V}ar_t(\\varepsilon_{t+1}) = Id\\). components \\(\\eta_t\\) measurement errors.Note: Eq. (4.2) derives Proposition 1.1 (Eq. (1.12)).practice, one can distinguish two situations: () state variables (components \\(w_t\\)) observed (b) variables latent. mean model estimation case (b)? different situations:(b.) know model parameters want recover latent factors—instance compute model-implied prices.(b.ii) know neither model parameters latent variables, want estimate .(b.iii) know neither model parameters latent variables, just interested model parameters.case (): One can resort standard estimation techniques (GMM, Maximum Likelihood) estimate model parameters. Take instance maximum-likelihood case, :\n\\[\\begin{eqnarray*}\nf(y_t,w_t|\\underline{y_{t-1}},\\underline{w_{t-1}}) &=& f(y_t|\\underline{y_{t-1}},\\underline{w_{t}}) \\times \\underbrace{f(w_t|\\underline{y_{t-1}},\\underline{w_{t-1}})}_{= f(w_t|\\underline{w_{t-1}})}\\\\\n&=& \\mathbf{n}(y_t;+ Bw_t,\\Omega) f(w_t|\\underline{w_{t-1}}),\n\\end{eqnarray*}\\]\n\\(\\mathbf{n}(x;\\mu,\\Omega)\\) denotes evaluation, vector \\(x\\), p.d.f. multivariate normal distribution \\(\\mathcal{N}(\\mu,\\Omega)\\). , \\(x\\) \\(m\\)-dimensional vector:\n\\[\\begin{equation}\n\\mathbf{n}(x;\\mu,\\Omega) = \\frac{1}{\\sqrt{(2 \\pi)^{m}|\\Omega|}} \\exp\\left(-\\frac{1}{2}\\{x - \\mu\\}'\\Omega^{-1}\\{x-\\mu\\}\\right).\\tag{4.3}\n\\end{equation}\\]\nconditional p.d.f. known, total likelihood given (conditional \\(y_0\\) \\(w_0\\)):\n\\[\n\\prod_{t=1}^T f(y_t,w_t|\\underline{y_{t-1}},\\underline{w_{t-1}}).\n\\]\ncourse, \\(f(w_t|\\underline{w_{t-1}})\\) depends process chosen \\(w_t\\). complicated compute, one can employ Pseudo Maximum Likelihood (C. Gourieroux, Monfort, Trognon 1984). p.d.f. may involve, instance, infinite sum, case ARG case Example 1.8. \\(w_t\\) affine, Pseudo Maximum Likelihood approach consists replacing \\(f(w_t|\\underline{w_{t-1}})\\) :\n\\[\n\\mathbf{n}(w_t;\\mu + \\Phi w_{t-1},\\Sigma(w_t)),\n\\]\n\\(\\mu\\), \\(\\Phi\\) \\(\\Sigma(w_t)\\) introduced Eqs. (1.13) (1.14) Proposition 1.1.case (b.iii), one can estimate model Generalized Method Moments (GMM), fitting sample moments computed using observed variables (prices, yields, returns). context affine processes, conditional unconditional moments state vector \\(w_t\\) available closed , shown Eqs. (1.15), (1.16) (1.17). model-implied moments available closed-form, one may resort Simulated Method Moments (SMM) (see, e.g., Gouriéroux Monfort (1997) Darrell Duffie Singleton (1993)).cases (b.) (b.ii), one implement filtering methods, focus following.","code":""},{"path":"estimation-of-affine-asset-pricing-models.html","id":"Estimation:KF","chapter":"4 Estimation of affine asset-pricing models","heading":"4.2 Kalman-filter-based approach","text":"","code":""},{"path":"estimation-of-affine-asset-pricing-models.html","id":"the-gaussian-linear-state-space-case","chapter":"4 Estimation of affine asset-pricing models","heading":"4.2.1 The Gaussian linear state-space case","text":"Let us start particular case state-space model (Def. 4.1) \\(\\varepsilon_t\\) Gaussian \\(\\Sigma^{\\frac{1}{2}}\\) depend \\(w_t\\), .e.homoskedastic linear Gaussian state-space model.Let’s denote \\(\\theta\\) vector parameters defines model. given \\(\\theta\\) sequence observations \\(\\{y_1,\\dots,y_T\\}\\), Kalman filter computes distribution \\(w_t\\) given \\(\\{y_1,\\dots,y_t\\}\\) (see Def. 4.2). distribution Gaussian, obtained recursive algorithm. byproduct algorithm likelihood function associated \\(\\theta\\) \\(\\{y_1,\\dots,y_T\\}\\). opens door estimation \\(\\theta\\) MLE, maximizing function. sense, Kalman-filter techniques can address Objective (b.ii).Let us first introduce notion filtered smoothed estimates latent variable (vector variables) \\(w_t\\):Definition 4.2  (Filtered versus smoothed estimates) filtering smoothing problems consist computing following conditional moments:\n\\[\\begin{equation*}\n\\begin{array}{lccllllll}\n\\mbox{Filtering:} & w_{t|t} & = & \\mathbb{E}(w_t|\\underline{y_t}) & \\mbox{}  & P_{t|t} &=& \\mathbb{V}ar(w_t|\\underline{y_t})\\\\\n\\mbox{Smoothing:} & w_{t|T} & = & \\mathbb{E}(w_t|\\underline{y_T}) & \\mbox{} & P_{t|T} &=& \\mathbb{V}ar(w_t|\\underline{y_T}).\n\\end{array}\n\\end{equation*}\\]following proposition outlines Kalman algorithm (see, e.g. Nelson Kim (1999)).Proposition 4.1  (Kalman filter smoother) \\(\\varepsilon_t \\sim \\mathcal{N}(0,)\\) state-space defined Def. 4.1, (filtering):\n\\[\nw_t|y_1,\\dots,y_t \\sim  \\mathcal{N}(w_{t|t}|P_{t|t}),\n\\]\n\\(w_{t|t}\\) \\(P_{t|t}\\) result following recursive equations:\n\\[\n\\boxed{\n\\begin{array}{ccl}\nw_{t|t} &=& w_{t|t-1} + K_t \\lambda_t\\\\\nP_{t|t} &=& (- K_t B)P_{t|t-1} \\\\ \\\\\n\\mbox{(updating step)} \\\\\n\\lambda_t &=& y_t - - Bw_{t|t-1}  \\quad \\mbox{(forecast error)}\\\\\nS_{t|t-1} &=& \\mathbb{V}ar(y_t|\\underline{y_{t-1}}) = B P_{t|t-1} B' + \\Omega\\\\\nK_t &=& P_{t|t-1}B'S_{t|t-1}^{-1} \\quad \\mbox{(Kalman gain)} \\\\ \\\\\n\\mbox{(forecasting step)} \\\\\nw_{t|t-1} &=& \\mu + \\Phi w_{t-1|t-1} \\\\\nP_{t|t-1} &=& \\Sigma + \\Phi P_{t-1|t-1} \\Phi' \\quad (\\Sigma = \\Sigma^{\\frac{1}{2}}{\\Sigma^{\\frac{1}{2}}}').\n\\end{array}\n}\n\\]\nlog likelihood (recursively) computed follows:\n\\[\\begin{eqnarray}\n\\log \\mathcal{L}(\\theta;\\underline{y_T}) &=& \\frac{mT}{2}\\log\\left(2\\pi\\right) \\tag{4.4}\\\\\n&  & -\\frac{1}{2}\\sum_{t=1}^{T}\\left(\\log\\left|S_{t | t-1}(\\theta)\\right|+\\lambda'_{t}(\\theta)S_{t\\mid t-1}^{-1}(\\theta)\\lambda{}_{t}(\\theta)\\right). \\nonumber\n\\end{eqnarray}\\]Moreover, (smoothing):\n\\[\nw_t|y_1,\\dots,y_T \\sim  \\mathcal{N}(w_{t|T}|P_{t|T}),\n\\]\n\\(w_{t|T}\\) \\(P_{t|T}\\) result following recursive equations:\n\\[\n\\boxed{\n\\begin{array}{ccl}\nw_{t|T} & = & w_{t|t}+F_{t}(w_{t+1|T}-w_{t+1|t})\\\\\nP_{t|T} & = & P_{t|t}+F_{t}(P_{t+1|T}-P_{t+1|t})F'_{t}\\\\ \\\\\n\\mbox{} \\\\\nF_{t} &=& P_{t|t}\\Phi'_{t+1}P_{t+1|t}^{-1}.\n\\end{array}\n}\n\\]following figure illustrates updating step Kalman algorithm:\nFigure 4.1: Updating Kalman filter.\nrecursive equations Kalman filter need initialized. , one needs provide initial values \\(w_{0|0}\\), \\(P_{0|0}\\). Different possibilities proposed. One can instance:Include elements (\\(w_{0|0}\\), \\(P_{0|0}\\)) among parameters estimate;Set \\(w_{0|0}\\) \\(P_{0|0}\\) unconditional values (using, e.g., Eq. (1.17));Set \\(w_{0|0}\\) prior value take either arbitrary large value \\(P_{0\\mid0}\\) prior value uncertain (depicts situation diffuse prior) small value \\(P_{0\\mid0}\\) confident prior value \\(w_{0|0}\\).Example 4.1  (Kalman filtering smoothing) illustrate, consider following model:\n\\[\\begin{eqnarray}\n\\left[\\begin{array}{c}\ny_{1,t}\\\\\ny_{2,t}\n\\end{array}\\right] & = &\n\\left[\\begin{array}{cc}\n\\alpha_{1} & 0\\\\\n0 & \\alpha_{2}\n\\end{array}\\right]\n\\left[\\begin{array}{c}\ny_{1,t-1}\\\\\ny_{2,t-2}\n\\end{array}\\right]+\\left[\\begin{array}{c}\n\\gamma_{1}\\\\\n\\gamma_{2}\n\\end{array}\\right]w_{t}+ D\\eta_t\\label{eq_measur}\\\\\nw_{t} & = & \\phi w_{t-1}+\\varepsilon_{t},\\label{eq_trans}\n\\end{eqnarray}\\]\n\\(\\eta_t \\sim \\mathcal{N}(0,Id)\\).following lines, specify one version previous model. simulate trajectories \\(y_{1,t}\\), \\(y_{2,t}\\) \\(w_t\\) 100 periods (Figure 4.2) call Kalman_filter Kalman_filter (TSModels package) compute filtered smoothed estimates \\(w_t\\) (Figure 4.3).\nFigure 4.2: Simulated trajectories \\(y_{1,t}\\), \\(y_{2,t}\\), \\(w_t\\).\n\nFigure 4.3: Filtered smoothed estimates \\(w_t\\).\n","code":"\nlibrary(TSModels) # Kalman filter procedure in there.\n# Set model specifications:\nalpha1 <- .5;alpha2 <- .95;Alpha <- diag(c(alpha1,alpha2))\nd_11 <- 1;d_12 <- .5;d_21 <- .5;d_22 <- 2\nD <- matrix(c(d_11,d_21,d_12,d_22),2,2)\ngamma1 <- 1;gamma2 <- 2;Gamma <- matrix(c(gamma1,gamma2),2,1)\nphi <- .8\n# Simulate model:\nT <- 100\nY <- NULL;X <- NULL\nAlpha.Y_1 <- NULL\ny <- c(0,0);x <- 0\nfor(i in 1:T){\n  Alpha.Y_1 <- rbind(Alpha.Y_1,c(Alpha %*% y))\n  y <- Alpha %*% y + Gamma * x + D %*% rnorm(2)\n  x <- phi * x + rnorm(1)\n  Y <- rbind(Y,t(y));X <- rbind(X,x)}\n# Define matrices needed in the Kalman_filter procedures:\nnu_t <- matrix(0,T,1)\nH <- phi;G <- Gamma\nmu_t <- Alpha.Y_1\nN <- 1;M <- D\nSigma_0 <- 1/(1-phi^2) # unconditional variance of w\nrho_0 <- 0 # unconditional mean of w\nfilter.res   <- Kalman_filter(Y,nu_t,H,N,mu_t,G,M,Sigma_0,rho_0,indic_pos=0)\nsmoother.res <- Kalman_smoother(Y,nu_t,H,N,mu_t,G,M,Sigma_0,rho_0,indic_pos=0)"},{"path":"estimation-of-affine-asset-pricing-models.html","id":"missing-observations","chapter":"4 Estimation of affine asset-pricing models","heading":"4.2.2 Missing observations","text":"many application, one observe entries \\(y_t\\) every date. arises instance situations () measurement variables feature different frequencies, (ii) unreliable data period (prefer include among observations), (iii) measurement variables observed shorter time span.situations easily addressed Kalman filtering/smoothing (e.g., Chow Lin (1971) Harvey Pierse (1984)). accommodate missing observations \\(y_t\\)’s, one simply change size vector (\\(\\lambda_t\\), \\(S_{t|t-1}\\), \\(\\) \\(B\\)) relevant dates. course, accuracy \\(w_{t|t}\\) tend lower periods one several () entries \\(y_t\\) unobserved. (apparent resulting covariance matrix \\(w_{t|t}\\), namely \\(P_{t|t}\\).) log-likelihood computation (Eq. (4.4)) still valid case; one simply adjust number observed variables iteration; , \\(m\\) depends time.Example 4.2  (Kalman filtering smoothing) example extends Example 4.2. take simulated path obeerved variables \\(y_{1,t}\\) \\(y_{2,t}\\) remove observations \\(y_{1,t}\\) (respectively \\(y_{2,t}\\)) periods \\(t=30\\) \\(t=50\\) (resp. periods \\(t=40\\) \\(t=70\\)), use Kalman filter smother recover states \\(w_t\\) situation missing observations.\nFigure 4.4: Situation missing observations.\n\nFigure 4.5: Filtered smoothed estimates \\(w_t\\) situation missing observations. lower plot shows standard errors associated filtered smoothed estimates. expected, undertainty larger dates observations missing.\n","code":"\nY.modif <- Y\nY.modif[30:50,1] <- NaN\nY.modif[40:70,2] <- NaN\n# Call of Kalman filter and smoother:\nfilter.res   <- Kalman_filter(Y.modif,nu_t,H,N,mu_t,G,M,Sigma_0,rho_0,indic_pos=0)\nsmoother.res <- Kalman_smoother(Y.modif,nu_t,H,N,mu_t,G,M,Sigma_0,rho_0,indic_pos=0)"},{"path":"estimation-of-affine-asset-pricing-models.html","id":"about-non-constant-conditional-matrix-sigma","chapter":"4 Estimation of affine asset-pricing models","heading":"4.3 About non-constant conditional matrix \\(\\Sigma\\)","text":"Proposition 4.1 valid \\(\\varepsilon_t\\) Gaussian \\(\\Sigma^{\\frac{1}{2}}\\) depend \\(w_t\\). However, general case (\\(w_t\\) affine process), \\(\\Sigma(w_{t-1}) \\equiv \\mathbb{V}ar(w_{t+1}|\\underline{w_t})\\) affine \\(w_t\\) (see Prop. 1.1). order deal , Kalman filter algorithm can modified. Specifically, prediction step (see Prop. 4.1), \\(P_{t|t-1}\\) can approximated :\n\\[\nP_{t|t-1} = \\Sigma\\color{red}{(w_{t-1|t-1})} + \\Phi P_{t-1|t-1} \\Phi',\n\\]\n.e. replace \\(\\Sigma(w_{t-1})\\) \\(\\Sigma(w_{t-1|t-1})\\).Though approach necessarily optimal, shows good empirical properties (Jong (2000) Duan Simonato (1999)). order test validity approach specific context, one can resort Monte-Carlo simulations (Alain Monfort et al. 2017).","code":""},{"path":"estimation-of-affine-asset-pricing-models.html","id":"nonlinear","chapter":"4 Estimation of affine asset-pricing models","heading":"4.4 Non-linear models","text":"soon \\(w_t\\) follows affine process, admits VAR dynamics presented Prop. 1.1, .e., features linear transition equation. However, measurement equations may non-linear (affine) functions \\(w_t\\). particular case observed variables include Swaps rates (see Remark SWAPS XXXX), CDS rates (see Subsection ??, particular Eq. (6.35)) prices tranche products (see Example 6.5).context non-linear measurement equations, one can instance resort Extended Kalman Filter (linearizing measurement equations) , higher-order Taylor. Alain Monfort, Renne, Roussellet (2015) develop Quadratic Kalman Filter (QKF), measurement equations quadratic functions state vector.","code":""},{"path":"estimation-of-affine-asset-pricing-models.html","id":"EstimationInversion","chapter":"4 Estimation of affine asset-pricing models","heading":"4.5 The inversion technique","text":"inversion technique introduced Chen Scott (1993). used, e.g., Ang Piazzesi (2003) Liu, Longstaff, Mandell (2006). Contrary Kalman-type approaches, approach recursive. can therefore faster, especially long sample.approach works assumption observed variables perfectly priced (modelled).(Recall \\(y_t\\) \\(w_t\\) respectively dimension \\(m\\) \\(n\\), see Eqs. (4.1) (4.2) Def. 4.1.) Formally:Hypothesis 4.1  (Perfectly-modelled variables) \\(n\\) components \\(m\\)-dimensional vector \\(y_t\\) (\\(n \\le m\\)) perfectly modelled. , measurement errors associated measurement equations.Without loss generality, perfectly-modelled variables first \\(n\\) components \\(y_t\\), :\n\\[\ny_t =\n\\left(\\begin{array}{c}\n\\underbrace{y_{1,t}}_{(n \\times 1)} \\\\\n\\underbrace{y_{2,t}}_{(m-n)\\times1}\n\\end{array}\\right).\n\\]Assumption 4.1, measurement equation (Eq. (4.1)) becomes:\n\\[\n\\left[\n\\begin{array}{c}\ny_{1,t}\\\\\ny_{2,t}\n\\end{array}\n\\right]\n=\n\\left[\n\\begin{array}{c}\nA_{1}\\\\\nA_{2}\n\\end{array}\n\\right]+\n\\left[\n\\begin{array}{c}\nB_{1}\\\\\nB_{2}\n\\end{array}\n\\right]w_t +\n\\left[\n\\begin{array}{c}\n0\\\\\n\\eta_{2,t}\n\\end{array}\n\\right],\n\\]\n\\(\\eta_{2,t} \\sim \\mathcal{N}(0,\\Omega_2)\\) (say). notably implies \n\\[\\begin{equation}\nw_t = B_{1}^{-1}(y_{1,t} - A_1).\\tag{4.5}\n\\end{equation}\\]assumption, conditional distribution \\(w_t\\) available closed form, Proposition 4.2 shows (exact) likelihood model can computed. proposition shows particular conditional p.d.f. \\(f_{Y_t|\\underline{Y_{t-1}}}(y_t;\\underline{y_{t-1}})\\) involves three terms:first term (blue (4.6)) stems conditional distribution \\(w_t|\\underline{w_{t-1}}\\).second term (red (4.6)) associated measurement errors pertaining \\(y_{2,t}\\), components \\(\\eta_{2,t}\\).third term (brown (4.6)) determinant Jacobian matrix associated linear transformation \\(w_t\\) \\(y_{1,t}\\) (Eq. (4.5)), \\(|B_1|\\).one knows compute \\(f_{Y_t|\\underline{Y_{t-1}}}(y_t;\\underline{y_{t-1}})\\), total likelihood easily obtained since:\n\\[\nf_{Y_1,\\dots,Y_T}(y_1,y_2,\\dots,y_T) = f_{Y_1}(y_1) \\prod_{t=2}^T f_{Y_t|\\underline{Y_{t-1}}}(y_t;\\underline{y_{t-1}}).\n\\]Proposition 4.2  (Log-likelihood inversion context) context linear state-space model defined Def. 4.1, Assumption 4.1, \\(w_t\\) Markovian process, :\n\\[\\begin{eqnarray}\nf_{Y_t|\\underline{Y_{t-1}}}(y_t;\\underline{y_{t-1}}) &=& \\color{blue}{f_{w_t|w_{t-1}}(w(y_{1,t});w(y_{t-1}))} \\times \\nonumber\\\\\n&& \\color{red}{\\mathbf{n}(y_{2,t}; A_2 + B_2w(y_{1,t}),\\Omega_2)} \\times \\color{brown}{|B_1|^{-1}}.\\tag{4.6}\n\\end{eqnarray}\\]\n\\(w(y_{1,t}) = B_{1}^{-1}(y_{1,t} - A_1)\\) \\(\\mathbf{n}\\) denotes multivariate normal p.d.f. (Eq. (4.3)).Proof. Since \\(w_t\\) Markov, \\(y_{1,t}\\) since \\(y_{2,t} = A_2 + B_2 w(y_{1,t}) + \\eta_{2,t}\\), \\(w(y_{1,t}) = B_{1}^{-1}(y_{1,t} - A_1)\\), :\n\\[\\begin{eqnarray*}\nf(y_t|y_{t-1}) &=& f_1(y_{1,t}|y_{1,t-1}) f_2(y_{2,t}|y_{1,t}) \\\\\n&=& |B_1|^{-1} f_w(w(y_{1,t})|w(y_{1,t-1})) \\mathbf{n}(y_{2,t}; A_2 + B_2w(y_{1,t}),\\Omega_2),\n\\end{eqnarray*}\\]\n\\(f_1(y_{1,t}|y_{1,t-1})= |B_1|^{-1} f_w(w(y_{1,t})|w(y_{1,t-1}))\\) comes fact , \\(U\\) \\(V\\) two random variables \\(V = g(U)\\), \\(g\\) bijective differentiable function, \\(f_V(v)=\\left|\\frac{\\partial g^{-1}(v)}{\\partial v'}\\right| f_U(g^{-1}(v))\\),\\(f_2(y_{2,t}|y_{1,t}) = \\mathbf{n}(y_{2,t}; A_2 + B_2w(y_{1,t}),\\Omega_2)\\) comes fact \\(y_{2,t}|y_{1,t} \\sim \\mathcal{N}(A_2 + B_2 w(y_{1,t}),\\Omega_2)\\).","code":""},{"path":"estimation-of-affine-asset-pricing-models.html","id":"EstimationRS","chapter":"4 Estimation of affine asset-pricing models","heading":"4.5.1 Dealing with unobserved regimes","text":"Kalman inversion techniques suited case components \\(w_t\\) valued discrete set. typically case \\(w_t\\) form:\n\\[\nw_t = \\left(\\begin{array}{c}\nz_t \\\\\nx_t\n\\end{array}\\right),\n\\]\n\\(z_t\\) valued \\(\\{e_1,\\dots,e_J\\}\\), \\(e_j\\) \\(j^{th}\\) column \\(Id_J\\), case prsence regime switching features (see Subsection 1.6).Assume \\(z_t\\) exogenous homogenous Markov chain whose dynamics defined \\(\\pi(e_i,e_j)\\)’s :\n\\[\\begin{equation}\n\\pi(e_i, e_j) = \\mathbb{P}(z_{t+1}=e_j | z_t=e_i).\\tag{4.7}\n\\end{equation}\\]\nDenote \\(\\Pi\\) matrix transition probabilities, .e., \\((,j)\\) component \\(\\Pi\\) \\(\\pi(e_i, e_j)\\). Assume :\n\\[\\begin{equation}\nx_t = m(z_t,x_{t-1}) + \\varepsilon_t,\\tag{4.8}\n\\end{equation}\\]\n\\(\\mathbb{E}(\\varepsilon_t|\\underline{z_t},\\underline{x_{t-1}})=0\\).denote conditional distribution \\(\\varepsilon_t\\) w.r.t. \\((z_t,x_{t-1})\\) \\(f_{\\varepsilon}(.;z_t,x_{t-1})\\).Hypothesis 4.2  (Measurement equations) measurement equation form:\n\\[\\begin{equation}\ny_t = z_t + B x_t + \\eta_t,  \\quad \\mbox{}  \\eta_t \\sim ..d. \\mathcal{N}(0,\\Omega).\\tag{4.9}\n\\end{equation}\\]Example 4.3  (Regime-Switching Gaussian VAR) Building Example 1.13, know \n\\[\\begin{equation}\nx_t = \\mu z_t + \\Phi x_{t-1} +  \\varepsilon_t,\\tag{4.10}\n\\end{equation}\\]\n\\(\\varepsilon_t|\\underline{x_t},z_t \\sim \\mathcal{N}(0,\\Sigma(z_t))\\) \\(z_t\\) exogenous independent Markov chain, \\(w_t = (x_t',z_t')'\\) affine. Using notations Eq. (4.8), :\n\\[\nm(z_t,x_{t-1}) = \\mu z_t + \\Phi x_{t-1}.\n\\]\n\\(r_t\\) s.d.f. respectively affine exponential \\(w_t\\), , particular, yields also affine \\(w_t\\), .e. form \\(R(t,h)= A_h'z_t + B_{h}'x_t\\) (see Eq. (3.7)). Therefore, components \\(y_t\\) yields different maturities, measurement equations consistent Assumption 4.2.estimate model regimes \\(z_t\\) unobservable? distinguish two distinct situations:Case 1. \\(x_t\\) factors observable. probabilities different regimes date can estimated employing Kitagawa-Hamilton filter, (using notations Proposition ??): \\(F_t = (y_t',x_t')'\\) \n\\[\\begin{eqnarray*}\nf(F_t|z_t=e_j,\\underline{F_{t-1}}) &=& f(y_t|x_t,z_t=e_j,\\underline{F_{t-1}})f(x_t|z_t=e_j,\\underline{F_{t-1}}) \\\\\n&=& \\mathbf{n}(y_t;z_t + B x_t,\\Omega) \\times \\\\\n&&f_{\\varepsilon}(x_t - m(z_t,x_{t-1});z_t,x_{t-1}),\n\\end{eqnarray*}\\]\n\\(\\mathbf{n}(u;\\mu,\\Omega)\\) denotes evaluation, vector \\(u\\) p.d.f. multivariate normal distribution \\(\\mathcal{N}(\\mu,\\Omega)\\) (see eq. (4.3)). -product Kitagawa-Hamilton filter likelihood function associated dataset. result, model parameterization can estimated maximum llikelihood approach.Case 2. \\(x_t\\) factors observable. two sub-cases:(2.) components \\(y_t\\) perfectly modelled (.e. \\(\\Omega \\ne 0\\), \\(\\Omega\\) defined Eq. (4.9). One resort filters dealing two types uncertainty: hidden discrete values (\\(z_t\\)) continuously distributed latent variables (\\(x_t\\)). C.-J. Kim (1994)’s filter can employed state-space model form (4.9)-(4.10) (see, e.g., Alain Monfort Renne (2014)), detailed Example 6.2).(2.ii) \\(n_x\\) components \\(y_t\\) perfectly modelled (\\(n_x\\) dimension \\(x_t\\)). One can resort inversion technique, complemented Kitagawa-Hamilton filter, estimate model (see Alain Monfort Renne (2013) Renne (2017) applications).Proposition 4.3  (Kitagawa-Hamilton filter) Consider \\(q\\)-dimensional vector variables \\(F_t\\) exogenous homogenous Markov chain \\(z_t\\). make use following notations:\\(\\eta_t\\) \\(J\\)-dimensional vector whose \\(j^{th}\\) component p.d.f. \\(F_t\\) conditional \\((z_t = e_j,\\underline{F_{t-1}})\\), .e. \\(f(F_t|z_t=e_j,\\underline{F_{t-1}})\\)\\(\\xi_{t}\\) \\(J\\)-dimensional vector whose \\(j^{th}\\) component \\(\\mathbb{P}(z_t = e_j|\\underline{F_t})\\).sequence \\(\\xi_{t}\\) can computed recursively follows:\n\\[\\begin{equation}\n\\xi_t = \\frac{(\\Pi' \\xi_{t-1}) \\odot \\eta_t}{\\mathbf{1}'(\\Pi' \\xi_{t-1} \\odot \\eta_t)},\\tag{4.11}\n\\end{equation}\\]\n\\(\\odot\\) denotes element--element (Hadamard) product \\(\\mathbf{1}\\) denotes \\(J\\)-dimensional vector ones.Moreover, previous formulas also show compute likelihood model since:\n\\[\\begin{equation}\nf(F_t|\\underline{F_{t-1}})=\\mathbf{1}'(\\Pi' \\xi_{t-1} \\odot \\eta_t).\\tag{4.12}\n\\end{equation}\\]","code":""},{"path":"estimation-of-affine-asset-pricing-models.html","id":"MixedKitagawaHamilton","chapter":"4 Estimation of affine asset-pricing models","heading":"4.5.2 Mixed use of Kitagawa-Hamilton and inversion techniques","text":"Without loss generality, assume \\(n_x\\) first components \\(y_t\\) observed without error, .e. Assumption 4.2 becomes\n\\[\n\\left[\n\\begin{array}{c}\ny_{1,t}\\\\\ny_{2,t}\n\\end{array}\n\\right]\n=\n\\left[\n\\begin{array}{c}\nA_{1}z_t\\\\\nA_{2}z_t\n\\end{array}\n\\right]+\n\\left[\n\\begin{array}{c}\nB_{1}\\\\\nB_{2}\n\\end{array}\n\\right]x_t +\n\\left[\n\\begin{array}{c}\n0\\\\\n\\eta_{2,t}\n\\end{array}\n\\right],\n\\]\n\\(\\varepsilon_2 \\sim \\mathcal{N}(0,\\Omega_2)\\).Since \\(y_{1,t} = A_1 z_t + B_1 x_t\\), :\n\\[\\begin{equation}\nx_t \\equiv x(y_{t},z_t) = B_1^{-1}(y_{1,t} - A_1 z_t).\\tag{4.13}\n\\end{equation}\\]order employ Kitagawa-Hamilton filter (Proposition 4.3), one need define extended Markov chain:\n\\[\n\\mathcal{Z}_t = z_{t-1} \\otimes z_t,\n\\]\nwhose matrix transition probabilities detailed Proposition 4.4.Proposition 4.4  (Kitagawa-Hamilton inversion techniques) matrix transition probabilities \\(\\mathcal{Z}_t\\) form \\(\\mathbf{1}_{n \\times 1} \\otimes \\widetilde{\\Pi}\\), \n\\[\n\\widetilde{\\Pi} =\n\\left[\n\\begin{array}{ccccc}\n\\pi_{1,\\bullet} & 0_{1 \\times n} \\dots & & & 0_{1 \\times n} \\\\\n0_{1 \\times n} & \\pi_{2,\\bullet} & 0_{1 \\times n} & \\dots & 0_{1 \\times n} \\\\\n&& \\ddots \\\\\n& &  0_{1 \\times n} & \\pi_{n-1,\\bullet} & 0_{1 \\times n} \\\\\n0_{1 \\times n} &\\dots && 0_{1 \\times n} & \\pi_{n,\\bullet}\n\\end{array}\n\\right],\n\\]\n\\(\\pi_{,\\bullet}\\) denotes \\(^{th}\\) row \\(\\Pi\\) (\\(\\Pi\\) defined Slide XXX).last term appearing Eq. (4.14) can computed follows:\n\\[\\begin{eqnarray*}\n&&f\\left(\\left[\\begin{array}{c}x(y_t,z(\\mathcal{Z}_t))\\\\y_{2,t}\\end{array}\\right]|\\mathcal{Z}_t,\\underline{y_{t-1}}\\right) \\\\\n&=& f\\left(y_{2,t}|x_t=x(y_t,z(\\mathcal{Z}_t)),\\mathcal{Z}_t,\\underline{y_{t-1}}\\right) \\times\\\\\n&& f\\left(x(y_t,z(\\mathcal{Z}_t))|\\mathcal{Z}_t,\\underline{y_{t-1}}\\right) \\\\\n&=& \\mathbf{n}(y_{2,t};A_2z_t + B_2x_t,\\Omega_2) \\times\\\\\n&& f_\\varepsilon\\left(\\varepsilon_t|z_t = z(\\mathcal{Z}_t),x_{t-1}=x(y_{t-1},z_{-1}(y_{t-1},\\mathcal{Z}_t))\\right),\n\\end{eqnarray*}\\]\n\\(\\mathbf{n}\\) p.d.f. multivariate normal distri, (Prop. 4.2, \\(\\varepsilon_t = x_t - m[z(\\mathcal{Z}_t),x(y_{t-1},z_{-1}(y_{t-1},\\mathcal{Z}_t))]\\) (\\(m\\) defined Eq. (4.8)).Note :\n\\[\n\\left\\{\n\\begin{array}{cclll}\nz_t &\\equiv& z(\\mathcal{Z}_t) &=& (\\mathbf{1}' \\otimes Id_{n}) \\mathcal{Z}_t \\\\\nz_{t-1} &\\equiv& z_{-1}(\\mathcal{Z}_t) &=& (Id_{n} \\otimes \\mathbf{1}') \\mathcal{Z}_t.\n\\end{array}\n\\right.\n\\]Kitagawa-Hamilton filter (Proposition 4.3) can employed, \\(F_t = y_t\\) :\n\\[\\begin{eqnarray}\nf(y_t|\\mathcal{Z}_t,\\underline{y_{t-1}}) &=&|B_1^{-1}| \\times \\nonumber \\\\\n&& f\\left(\\left[\\begin{array}{c}x(y_t,z(\\mathcal{Z}_t))\\\\ y_{2,t}\\end{array}\\right]|\\mathcal{Z}_t,\\underline{y_{t-1}}\\right),\\tag{4.14}\n\\end{eqnarray}\\]\ncomputation last term detailed Proposition 4.4.Example 4.4  (Interest-rate model monetary policy-related regimes) Renne (2017) porposes model regimes monetary-policy interpretations. model estimated daily data. short-term rate euro-area overnight interbank rate (EONIA). modeled follows:\n\\[\\begin{equation}\n\\boxed{r_{t}=\\underset{\\mbox{Target}}{\\underbrace{\\bar{r}_{t}}}+\\underset{\\mbox{EONIA spread}}{\\underbrace{x_{t}}}.}\n\\end{equation}\\]\ntarget rate \\(\\bar{r}_{t}\\) step-like path \\(\\bar{r}_{t}=\\Delta'z_{r,t}\\),\n\\(\\Delta=[\\begin{array}{ccccc} 0 & 0.25 & 0.50 & \\ldots & \\bar{r}_{max}\\end{array}]'\\) \\(z_{r,t}=[\\begin{array}{ccccccc} 0 & \\ldots & 0 & 1 & 0 & \\ldots & 0\\end{array}]'\\)EONIA spread (\\(x_t\\)) persistent mean-reverting fluctuations (AR process).\\(z_t = z_{r,t}\\otimes z_{m,t}\\) \\(z_{m,t}\\) monetary-policy regime:Easing (\\(z_{m,t}=[\\begin{array}{ccc} 1 & 0 & 0\\end{array}]\\)),Status Quo (\\(z_{m,t}=[\\begin{array}{ccc} 0 & 1 & 0\\end{array}]\\)),Tightening (\\(z_{m,t}=[\\begin{array}{ccc} 0 & 0 & 1\\end{array}]\\)).One can simulate model using web-interface.terms observability, \\(z_{r,t}\\) observed (since policy rate osberved), \\(z_{m,t}\\). Hence, filtering procedure needed. Renne (2017) adapts approach presented Subsection 4.5.2 case \\(z_{t}\\) partially observed.model, results Example 4.3 imply :\n\\[\nR(t,h) = A_h' z_t + B_h x_t.\n\\]\nDenote \\(\\mathcal{}_h\\) \\((3 \\times n_r)\\) matrix \\(A_h = vec(\\mathcal{}_h)\\). \\(A_h' z_t = (\\mathcal{}_h z_{r,t})' z_{m,t}\\) , therefore:\n\\[\nR(t,h) = A_{t,h}' z_t + B_h x_t, \\quad \\mbox{$A_{t,h} = \\mathcal{}_h z_{r,t}$.}\n\\]\nmodel estimated combination Kitagawa-Hamilton inversion techniques, assuming linear combination yields modeled without errors (gives \\(x_t = x(y_t,z_{m,t},z_{r,t})\\)).\nFigure 4.6: Source: Renne (2017).\n","code":""},{"path":"estimation-of-affine-asset-pricing-models.html","id":"EstimationPersistency","chapter":"4 Estimation of affine asset-pricing models","heading":"4.6 A typical small-sample issue","text":"Interest rates particularly persistent variables. Since affine models eventually lead linear relationships state variables interest rates (see Eq. (3.7)), state variables also necessarily highly persistent. Accordingly, small sample, maximum-likelihood estimates model parameters likely suffer downward bias (see, e.g., Michael D. Bauer Wu (2012) Jardet, Monfort, Pegoraro (2013)). relates well-known econometric problem illustrated Figure 4.7.\nFigure 4.7: 1000 random walk samples size \\(T\\) (\\(T=50\\) left plot \\(T=400\\) right plot) simulated. sample, run OLS regression \\(y_t = \\phi y_{t-1} + \\varepsilon_t\\) estimate \\(\\phi\\) (whose true value 1). plots show distributions (kernel-based estimation) estimated \\(\\phi\\). vertical red bar indicate means distributions; vertical blue line shows usual bias approximation (\\(1-5.3/T\\)).\nsmall-sample downward bias dramatic consequences terms term premium estimates. sake illustration, consider following process short-term interest rate physical measure (monthly frequency):\n\\[\ni_{t+1} = \\bar{} + \\phi (i_{t}-\\bar{}) + \\sigma \\varepsilon_{t+1}, \\quad \\varepsilon_t \\sim \\mathcal{N}(0,1).\n\\]\nfollowing risk-neutral measure:\n\\[\ni_{t+1} = \\bar{}^* + \\phi^* (i_{t}-\\bar{}^*) + \\sigma \\varepsilon_{t+1}, \\quad \\varepsilon_t \\sim \\mathcal{N}(0,1).\n\\]\n\\(\\bar{} = 3\\%/12\\), \\(\\bar{}^* = 5\\%/12\\), \\(\\phi = 0.98\\), \\(\\phi^*=0.99\\), \\(\\sigma = 0.2\\%\\).\nAssume estimate \\(\\phi\\) downward biased (\\(\\hat\\phi=0.9\\)). influence bias 10-year term premium illustrated Figure 4.8.\nFigure 4.8: figure illustrates influence downward bias estimated term premiums, see text details.\nD. H. Kim Orphanides (2005) proposed simple approach deal problem. approach consists adding measurement equations impose model-implied forecasts —measurement errors—equal survey-based ones. empirical exercise, use Blue Chip Financial Forecasts. Alternative (publicly available) surveys : Philly Fed Survey Professional Forecasters ECB SPF.D. H. Kim Orphanides (2005) exploit fact , context affine models, model-implied forecasts yields affine state vector (see see Eq. (3.10)); implies mesurement equations affine state vector, facilitates estimation latent factors. shown Figure 4.9, model able satisfyingly fit survey-based forecasts market yields.\nFigure 4.9: Source: Kim Orphanides (2005).\n","code":""},{"path":"forward-futures-dividends-commodity-pricing-and-convenience-yields.html","id":"forward-futures-dividends-commodity-pricing-and-convenience-yields","chapter":"5 Forward, futures, dividends, commodity pricing, and convenience yields","heading":"5 Forward, futures, dividends, commodity pricing, and convenience yields","text":"","code":""},{"path":"forward-futures-dividends-commodity-pricing-and-convenience-yields.html","id":"FCFPForwards","chapter":"5 Forward, futures, dividends, commodity pricing, and convenience yields","heading":"5.1 Forward contracts","text":"Let us denote \\(\\underline{w_{t}}\\) information available \\(t\\), .e., \\(\\underline{w_{t}}= \\{w_t,w_{t-1},\\dots\\}\\).Forward contract defined agreement, signed \\(t\\), buy/sell asset (commodity) given delivery date \\(T>t\\) price \\(\\Phi_{t,T}\\), called delivery price forward price, decided \\(t\\). denote \\(S_T\\) value asset (commodity) \\(T\\); function \\(\\underline{w_{T}}\\). buyer, payoff contract \\(T\\) \\(S_T - \\Phi_{t,T}\\).chapter, denote \\(r_t\\) interest rate \\(t\\) \\(t+1\\) (known \\(t\\)), assumed function \\(\\underline{w_{t}}\\). also denote \\(B(t_1,t_2-t_1)\\) date-\\(t_1\\) price zero-coupon bond whose value 1 \\(t_2\\).following proposition provides expression forward price \\(\\Phi_{t,T}\\):Proposition 5.1  (Forward price) :\n\\[\\begin{eqnarray*}\n\\Phi_{t,T} & = & \\frac{\\mathbb{E}_t (\\mathcal{M}_{t,t+1}, \\ldots, \\mathcal{M}_{t-1,T} S_T)}{B(t,T-t)}\\\\\n& = & \\frac{\\mathbb{E}^{\\mathbb{Q}}_t [\\exp (-r_t - \\ldots - r_{T-1}) S_T]}{B(t,T-t)}.\n\\end{eqnarray*}\\]Proof. price \\(t\\) \\(S_T - \\Phi_{t,T}\\) zero. Therefore:\n\\(\\mathbb{E}_t (\\mathcal{M}_{t,t+1}, \\ldots, \\mathcal{M}_{t-1,T} S_T) - \\Phi_{t,T} \\mathbb{E}_t (\\mathcal{M}_{t,t+1} \\ldots \\mathcal{M}_{t-1,T}) = 0\\), gives result.processes \\((r_t)\\) \\((S_t)\\) \\(\\mathbb{Q}\\)-independent, \n\\[\n\\Phi_{t,T} = \\mathbb{E}^{\\mathbb{Q}}_t (S_T),\n\\]\n\\(\\Phi_{t,T}\\) therefore \\(\\mathbb{Q}\\)-martingale.asset generate payoff \\(T\\) (case shares, dividends), \n\\[\n\\Phi_{t,T} = \\frac{S_t}{B(t,T-t)}.\n\\]\nprice \\(s\\), \\(t<s<T\\), forward contract signed \\(t\\) :\n\\[\n(\\Phi_{s,T} - \\Phi_{t,T}) B (s,T-s),\n\\]\nsince payoff \\(S_T - \\Phi_{t,T}\\) \\(T\\) price \\(s\\).formulas affected presence dividends? investigate , let us introduce additional notations. Denote \\(\\tilde{S}_t\\) ex-dividend price \\(t\\), \\(S_t\\): cum-dividend price \\(t\\). \\(S_t = \\tilde{S}_t \\exp (\\delta_t)\\), \\(\\delta_t\\) dividend yield (rate), observed date \\(t\\). get:\n\\[\\begin{eqnarray*}\n\\tilde{S}_{T-1} & = & \\mathbb{E}_{T-1} (\\mathcal{M}_{t-1,T} S_T) \\\\\n\\mbox{} \\\\\nS_{T-1} & = & \\mathbb{E}_{T-1} [\\mathcal{M}_{t-1,T} \\exp (\\delta_{T-1})\nS_T],\n\\end{eqnarray*}\\]\n, recursively:\n\\[\\begin{eqnarray*}\nS_t & = & \\mathbb{E}_t [\\mathcal{M}_{t,t+1} \\ldots \\mathcal{M}_{t-1,T} \\exp (\\delta_t + \\ldots + \\delta_{T-1}) S_T] \\\\\n&=& \\mathbb{E}^{\\mathbb{Q}}_t [\\exp (-r_t \\ldots - r_{T-1} + \\delta_t + \\ldots + \\delta_{T-1}) S_T].\n\\end{eqnarray*}\\]\nshows formulas non-dividend case, except \\(r_t\\) replaced \\(r_t - \\delta_t\\).Replacing \\(S_t\\) \\(\\tilde{S} \\exp(\\delta_t)\\) \\(S_T\\) \\(\\tilde{S}_T \\exp (\\delta_T)\\), get\n\\[\n\\tilde{S}_t = \\mathbb{E}^{\\mathbb{Q}}_t [\\exp (-r_t -\\ldots-r_{T-1} + \\delta_{t+1} + \\ldots + \\delta_T) \\tilde{S}_T.\n\\]\ndividend rate \\(\\delta_t\\) deterministic, :\n\\[\n\\Phi_{t,T} = \\frac{S_t \\exp (-\\delta_t - \\ldots - \\delta_{T-1})}{B(t,T-t)}.\n\\]\n\\(r_t\\) deterministic , :\n\\[\n\\Phi_{t,T} = S_t \\exp   (r_t + \\ldots + r_{T-1} - \\delta_t - \\ldots - \\delta_{T-1}).\n\\]","code":""},{"path":"forward-futures-dividends-commodity-pricing-and-convenience-yields.html","id":"FCFPFutures","chapter":"5 Forward, futures, dividends, commodity pricing, and convenience yields","heading":"5.2 Futures contracts, futures prices","text":"futures contract agreement, signed \\(t\\), buy/sell asset (commodity) given delivery date \\(T>t\\) price \\(F_{t,T}\\), called futures price, decided \\(t\\). difference forward contract counterparties required deposit margin account, every trading day \\(s>t\\), resettlement payment (margin call). latter equal :\n\\[\n\\Delta_{s,T} = F_{s,T} - F_{s-1,T} \\quad \\mbox{(buyer)}.\n\\]Hence, futures contract actually closed every day, starts afresh next day. value therefore zero.following proposition values futures contract.Proposition 5.2  (Pricing futures) :\n\\[\nF_{t,T} = \\mathbb{E}^{\\mathbb{Q}}_t (S_T),\n\\]\n\\(F_{t,T}\\) \\(\\mathbb{Q}\\)-martingale, \\(\\Delta_{t,T}\\) \\(\\mathbb{Q}\\)-martingale difference.Proof. date \\(s\\ge t\\), deposit resettlement payment, new contract valued zero paying \\(F_{s+1,T} - F_{s,T}\\) \\(s+1\\) (providing another zero valued contract \\(s+1\\)). Therefore \\(0 = \\mathbb{E}^{\\mathbb{Q}}_s [\\exp (-r_s) (F_{s+1,T} - F_{s,T})]\\), \\(0 = \\mathbb{E}^{\\mathbb{Q}}_s (F_{s+1,T} - F_{s,T})\\) since \\(\\exp (-r_s)\\) known \\(s\\). Hence \\(F_{s,T} = \\mathbb{E}^{\\mathbb{Q}}_s (F_{s+1,T})\\), results follows \\(F_{T,T} = S_T\\).Proposition 5.3  (Forward-Futures deviation) :\n\\[\n\\Phi_{t,T} - F_{t,T} = \\frac{\\mathbb{C}ov^{\\mathbb{Q}}_t \\left[\\prod^{T-1}_{s=t} \\exp (-r_s), S_T\\right]}{B(t,T-t)}.\n\\]Proof. :\n\\[\\begin{eqnarray*}\n\\Phi_{t,T} - F_{t,T} & = & \\mathbb{E}^{\\mathbb{Q}}_t \\left[\\frac{\\prod^{T-1}_{s=t} \\exp (-r_s) S_T }{B(t,T-t)}- S_T\\right] \\\\\n&=& \\frac{\\mathbb{E}^{\\mathbb{Q}}_t \\left[\\prod^{T-1}_{s=t} \\exp (-r_s) S_T\\right] - \\mathbb{E}^{\\mathbb{Q}}_t \\left[\\prod^{T-1}_{s=t} \\exp (-r_s)\\right] \\mathbb{E}^{\\mathbb{Q}}_t (S_T)}{B(t,T-t)} \\\\\n&=&\\frac{cov^{\\mathbb{Q}}_t \\left[\\prod^{T-1}_{s=t} \\exp (-r_s), S_T)\\right]}{B(t,T-t)}. \\end{eqnarray*}\\]Hence, \\(\\Phi_{t,T} = F_{t,T}\\) , , \\(\\prod^{T-1}_{s=t} \\exp (-r_s)\\) \\(S_T\\) conditionally uncorrelated \\(\\mathbb{Q}\\). true, particular, case deterministic short rates.","code":""},{"path":"forward-futures-dividends-commodity-pricing-and-convenience-yields.html","id":"FCFPConvenience","chapter":"5 Forward, futures, dividends, commodity pricing, and convenience yields","heading":"5.3 Convenience yields","text":"convenience yield defined net benefit associated holding physical asset (rather forward futures contract). net sense equal positive gain holding minus potential storage costs.notion convenience yield relevant storable commodities (, e.g., electricity). can positive negative. notion convenience yield mathematically similar dividend yield (can \\(<0\\), often latent).following, denote convenience yield \\(c_t\\). price cum-convenience yield price.Let us first consider case \\(r_t\\) \\(c_t\\) deterministic. :\n\\[\n\\Phi_{t,T} = F_{t,T} = S_t \\exp (r_t + \\ldots + r_{T-1} - c_t - \\ldots - c_{T-1}).\n\\]\nMoreover, \\(r_t\\) \\(c_t\\) time independent, get:\n\\[\n\\Phi_{t,T} = F_{t,T} = S_t \\exp [(T-t)(r-c)].\n\\]\n\\(r>c\\), forward curve increasing function matuerity \\(T\\); known situation contango. \\(r<c\\), forward curve decreasing function maturity \\(T\\), know situation backwardation.Let us turn situation \\(c_t\\) stochastic. :\n\\[\\begin{eqnarray}\n\\Phi_{t,T} &=& \\mathbb{E}^{\\mathbb{Q}}_t [\\exp (-r_t - \\ldots - r_{T-1}) S_T]/B(t,T-t) \\tag{5.1}\\\\\nF_{t,T} &=& \\mathbb{E}^{\\mathbb{Q}}_t (S_T) \\tag{5.2}\\\\\nS_t &=& \\mathbb{E}^{\\mathbb{Q}}_t [\\exp (-r_t - \\ldots - r_{T-1} + c_t + \\ldots + c_{T-1}) S_T] \\tag{5.3}.\n\\end{eqnarray}\\]\nGoing necessitates joint modelling—least \\(\\mathbb{Q}\\)—\\(S_t\\) (\\(s_t = \\log S_t\\)), \\(c_t\\) (convenience yield), \\(r_t\\) (short rate).case nonstorable commodity, convenience yield. , moreover \\(r_t\\) deterministic, \\(\\Phi_{t,T} = F_{t,T} = \\mathbb{E}^{\\mathbb{Q}}_t (S_T)\\), since Eq. (5.3) valid \\(S_t = B(t,T) \\mathbb{E}^{\\mathbb{Q}}_t (S_T)\\) therefore \\(\\Phi_{t,T} = S_t / B(t,T)\\).case storable commodity, price ex-convenience yield \\(t\\), .e. \\(S_t \\exp (-c_t)\\), price \\(t\\) \\(S_{t+1}\\):\n\\[\\begin{eqnarray}\nS_t \\exp (-c_t) &=& \\exp (-r_t) \\mathbb{E}^{\\mathbb{Q}}_t (S_{t+1}) \\nonumber\\\\\n\\mathbb{E}^{\\mathbb{Q}}_t (S_{t+1}) & = & S_t \\exp (r_t - c_t) \\tag{5.4} \\\\\n\\mathbb{E}^{\\mathbb{Q}}_t \\exp (s_{t+1}) &=& \\exp(s_t+r_t-c_t). \\nonumber\n\\end{eqnarray}\\]\n\\(y_{t+1} = \\log \\frac{S_{t+1}}{S_t}\\) denotes (geometric) return, :\n\\[\n\\mathbb{E}^{\\mathbb{Q}}_t \\exp (y_{t+1}) = \\exp (r_t - c_t).\n\\]\nEq. (5.3) automatically satisfied (using Eq. (5.4) recursively).","code":""},{"path":"forward-futures-dividends-commodity-pricing-and-convenience-yields.html","id":"FCFPPricingRN","chapter":"5 Forward, futures, dividends, commodity pricing, and convenience yields","heading":"5.4 Pricing with affine models","text":"section, consider storable commodity. state vector follows:\n\\[\nw_t = (s_t, c_t, r_t, x'_t)',\n\\]\n\\(s_t = \\log S_t\\), \\(x_t\\) vector additional factors. assume \\(w_t\\) \\(\\mathbb{Q}\\)-affine process, :\n\\[\n\\mathbb{E}^{\\mathbb{Q}}_t \\exp (u' w_{t+1}) = \\exp [' (u) w_t + b(u)].\n\\]\nSince \\(S_{t+1} = \\exp (e_1' w_{t+1})\\), Internal Consistency Constraints (ICCs) apply (see Subsection 2.5.1), :\n\\[\\begin{eqnarray*}\n&&\\mathbb{E}^{\\mathbb{Q}}_t \\exp (s_{t+1}) = \\exp (s_t-c_t+r_t)\\\\\n&\\Leftrightarrow& \\mathbb{E}^{\\mathbb{Q}}_t \\exp (e_1' w_{t+1}) = \\exp [(e_1 - e_2 + e_3)' w_t]\\\\\n&\\Leftrightarrow& \\left\\{\\begin{array}{lcl}\n(e_1) &=& e_1 - e_2 + e_3 \\\\\nb(e_1) &=&0.\n\\end{array} \\right.\n\\end{eqnarray*}\\]commodity non-storable, \\(c_t\\), ICCs.Eqs. (5.1) (5.2) give:\n\\[\\begin{eqnarray*}\n\\Phi_{t,T} & = & \\frac{\\mathbb{E}^{\\mathbb{Q}}_t [\\exp (-r_t - \\ldots - r_{t-1} + s_T)]}{\\mathbb{E}^{\\mathbb{Q}}_t [\\exp (-r_t - \\ldots - r_{T-1})]} \\\\\nF_{t,T} & = & \\mathbb{E}^{\\mathbb{Q}}_t [\\exp (s_T)].\n\\end{eqnarray*}\\]\nUsing multi-horizon Laplace transforms \\(w_t = (s_t, c_t, r_t, x^{'}_t)'\\), get quasi explicit formulas prices (exponential affine future values \\(w_t\\), affine process).","code":""},{"path":"forward-futures-dividends-commodity-pricing-and-convenience-yields.html","id":"historical-dynamics","chapter":"5 Forward, futures, dividends, commodity pricing, and convenience yields","heading":"5.5 Historical dynamics","text":"Using notation Subsection 2.3.2, assume s.d.f. form:\n\\[\n\\mathcal{M}_{t,t+1} (\\underline{w_{t+1}}) = \\exp \\left[-r_t + \\alpha'_t w_{t+1} + \\psi^{\\mathbb{Q}}_t (-\\alpha_t)\\right],\n\\]\n\n\\[\n\\mathbb{E}^{\\mathbb{Q}}_t (\\mathcal{M}_{t,t+1}^{-1}) = \\exp (r_t).\n\\]historical dynamics \\(w_t\\) defined :\n\\[\n\\psi_t (u) = \\psi^{\\mathbb{Q}}_t (u-\\alpha_t) - \\psi^{\\mathbb{Q}}_t(-\\alpha_t).\n\\]constraint \\(\\alpha_t\\), can used, e.g., specify forms seasonality (see Example 5.1).Example 5.1  (Gaussian VAR model) Consider state vector \\(w_t = (s_t, c_t, r_t)'\\), whose R.N. dynamics reads:\n\\[\nw_{t+1} = A_0 + A_1 w_t + \\varepsilon_{t+1}, \\quad \\varepsilon_{t+1} \\sim  ..d. \\mathcal{N}(0,\\Sigma) \\mbox{ }\\mathbb{Q}.\n\\]\n(see Example 1.5):\n\\[\\begin{eqnarray*}\n\\mathbb{E}_t \\exp (u' w_{t+1}) &=& \\exp \\left[u' (A_0 + A_1 w_t) + \\frac{1}{2} u' \\Sigma u\\right] \\\\\n\\Rightarrow &&\n\\left\\{\n\\begin{array}{ccl}\n(u) &=&^{'}_1 u \\\\\nb(u) & =& '_0 u + \\frac{1}{2} u' \\Sigma u. \\end{array} \\right.\n\\end{eqnarray*}\\]\nDecompose \\(A_0\\) \\(A_1\\) follows:\n\\[\\begin{eqnarray*}\nA_0 &=& \\left(\n\\begin{array}{c} A_{01} \\\\ \\tilde{}_0\n\\end{array}\n\\right), \\quad A_1 = \\left(\n\\begin{array}{c} A_{11} \\\\\n\\tilde{}_1\n\\end{array}\n\\right).\n\\end{eqnarray*}\\]\nconsidered commodity storable, following ICCs (constraint otherwise):\n\\[\n\\left\\{\n\\begin{array}{ccl}\n(e_1) & = & e_1 - e_2 + e_3 \\\\\nb (e_1) &=& 0. \\end{array}\n\\right.\n\\]\nTherefore, first row \\(A_1\\) \\(A_{11} = e_1'- e_2' + e_3'\\), first element \\(A_0\\) \\(A_{01} = -\\frac{1}{2}\\sigma^2_1\\) (\\(\\sigma^2_1\\) conditional variance \\(s_{t+1}\\)).words \\(\\mathbb{Q}\\)-VAR :\n\\[\n\\left\\{\\begin{array}{cclcc} s_{t+1} & = & -\\frac{1}{2}\n\\sigma^2_1 + s_t - c_t + r_t &+& \\varepsilon_{1,t+1} \\\\\n\\left(\\begin{array}{c} c_{t+1} \\\\ r_{t+1} \\end{array} \\right) & = &\n\\tilde{}_0 + \\tilde{}_1 w_t &+& \\left(\\begin{array}{c} \\varepsilon_{2,t+1} \\\\\n\\varepsilon_{3,t+1} \\end{array} \\right),\n\\end{array} \\right.\n\\]\n\\(\\tilde{}_0\\) \\(\\tilde{}_1\\) constrained.Noting \\(y_{t+1} = \\log (S_{t+1}/S_t) = s_{t+1} - s_t\\), implies \n\\[\n\\mathbb{E}^{\\mathbb{Q}}_t y_{t+1} = r_t - c_t - \\frac{1}{2} \\sigma^2_1.\n\\]\nHence, \\(y_{t+1} - r_t + c_t + \\frac{1}{2} \\sigma^2_1\\) \\(\\mathbb{Q}\\)-martingale difference.historical dynamics state vector follows:\n\\[\n\\begin{array}{lcl}\n\\psi_t (u) & = & \\psi^{\\mathbb{Q}}_t (u-\\alpha_t) - \\psi^{\\mathbb{Q}}_t (- \\alpha_t) \\\\\n&=& u' (A_0 + A_1 w_t) + \\frac{1}{2} (u-\\alpha_t)' \\Sigma (u-\\alpha_t)- \\frac{1}{2} \\alpha'_t\n\\Sigma \\alpha_t \\\\\n&=&u' (A_0 + A_1 w_t) - u' \\Sigma \\alpha_t + \\frac{1}{2} u' \\Sigma u.\n\\end{array}\n\\]\ntake \\(\\alpha_t = \\alpha_0 + \\alpha_1 w_t\\), get:\n\\[\\begin{eqnarray*}\n\\psi_t (u) &=& u' [A_0 - \\Sigma \\alpha_0 + (A_1 - \\Sigma \\alpha_1) w_t] + \\frac{1}{2} u' \\Sigma u \\\\\n\\Rightarrow  w_{t+1} &=& A_0 - \\Sigma \\alpha_0 + (A_1 - \\Sigma \\alpha_1) w_t + \\xi_t,\\\\\n&& \\xi_t \\sim  ..d.   \\mathcal{N}(0,\\Sigma)\\; \\mbox{}\\;\\mathbb{P}.\n\\end{eqnarray*}\\]\nHence, VAR(1), \\(\\Sigma\\), can reached.can also take time-varying specification \\(\\alpha_t\\), form \\(\\alpha_t = \\alpha_{0t} + \\alpha_1 w_t\\). get historical dynamics:\n\\[\nw_{t+1} = A_{0} - \\Sigma \\alpha_{0t} + (A_1 - \\Sigma \\alpha_1) w_t + \\xi_{t+1}\n\\]\ncan instance choose \\(\\alpha_{0t}\\) : \\(A_{0} - \\Sigma \\alpha_{0t} = \\left( \\begin{array}{c} \\mu_{1t} \\\\ \\mu_2 \\\\ \\mu_3 \\end{array}\\right)\\), \\(\\mu_{1t}\\), \\(\\mu_2\\), \\(\\mu_3\\) given.\nparticular:\n\\[\\begin{eqnarray*}\ns_{t+1} & = & \\mu_{1t} + (A_{11} - \\Sigma_1 \\alpha_1) w_t + \\xi_{1,t+1} \\\\\n& = & \\mu_{1t} + \\bar{}_{11} w_t + \\xi_{1,t+1}\\; \\mbox{(say)}, \\;\n\\end{eqnarray*}\\]\n\\(\\bar{}_{11}\\) constrained, :\n\\[\ns_{t+1} - \\nu_{t+1} = \\mu_1 + \\bar{}_{11,1} (s_t - \\nu_t) + \\bar{}_{11,2} c_t + \\bar{}_{11,3} r_t + \\xi_{1,t+1}\n\\]\n\n\\[\n\\mu_{1t} = \\mu_1 + \\nu_{t+1} - \\bar{}_{11,1} \\nu_t.\n\\]\nwords historical seasonal function \\(\\nu_t\\) can reached choosing \\(\\mu_{1t}\\), .e., \\(\\alpha_{0t}\\).Example 5.2  (Schwartz (1997)) Schwartz (1997) proposes three models whose discrete-time versions :Model 1:\n\\[\\begin{eqnarray*}\n\\mathbb{P}&:& s_{t+1} = a_0 + a_1 s_t + \\sigma \\varepsilon_{t+1}, \\; \\; \\; \\varepsilon_t \\stackrel{\\mathbb{P}}{\\sim}  ..d. \\mathcal{N}(0,1) \\\\\n\\mathbb{Q} &:& s_{t+1} = ^*_0 + a_1 s_t + \\sigma \\xi_{t+1}, \\; \\; \\; \\xi_{t} \\stackrel{\\mathbb{Q}}{\\sim}  ..d. \\mathcal{N}(0,1).\n\\end{eqnarray*}\\]Model 2:\n\\[\\begin{eqnarray*}\n\\mathbb{P}&:& s_{t+1} = a_{10} + s_t - c_t + \\sigma_1 \\varepsilon_{1,t+1}\\\\\n&& c_{t+1} = a_{20} + a_{21} c_t + \\sigma_2 \\varepsilon_{2,t+1}\\hspace{1cm} corr (\\varepsilon_{1t}, \\varepsilon_{2,t}) = \\rho \\\\\n\\mathbb{Q}&:& s_{t+1} = r - \\frac{\\sigma^2_1}{2} + s_t - c_t + \\sigma_1  \\xi_{1,t+1} \\\\\n&& c_{t+1} = ^*_{20} + a_{21} c_t + \\sigma_2 \\xi_{2,t+1} \\hspace{1cm} corr (\\xi_{1t}, \\xi_{2t}) = \\rho.\n\\end{eqnarray*}\\]Model 3:\n\\[\\begin{eqnarray*}\n\\mathbb{P}&:& s_{t+1} = a_{10} + s_t - c_t + r_t + \\sigma_1 \\varepsilon_{1,t+1} \\\\\n&& c_{t+1}= a_{20} + a_{21} c_t + \\sigma_2 \\varepsilon_{2,t+1} \\\\\n&& r_{r+1} = a_{30} + a_{31} r_t + \\sigma_3 \\varepsilon_{3,t+1} \\\\\n\\mathbb{Q}&:& s_{t+1} = -\\frac{\\sigma^2_1}{2} + s_t - c_t + r_t + \\sigma_1 \\xi_{1,t+1}\\\\\n&&c_{t+1} = ^*_{20} + a_{21} c_t + \\sigma_2 \\xi_{2,t+1} \\\\\n&&r_{t+1} = a_{30} + a_{31} r_t + \\sigma_3 \\xi_{3,t+1},\n\\end{eqnarray*}\\]\n\\(\\mathbb{C}orr(\\varepsilon_{1t}, \\varepsilon_{2t}) = \\rho_1\\), \\(\\mathbb{C}orr(\\varepsilon_{2t}, \\varepsilon_{3t}) = \\rho_2\\), \\(\\mathbb{C}orr(\\varepsilon_{1t}, \\varepsilon_{3t}) = \\rho_3\\), idem \\(\\xi_{}\\)’s. (shocks \\(\\mathcal{N}(0,1)\\).)models, \\(\\log F_{t,T}\\) affine function \\(\\{s_t, c_t, r_t\\}\\).estimation point view, \\(s_t\\) \\(c_t\\) latent. parameters estimated ML method, likelihood functions computed Kalman filter (see Subsection 4.2). state variable \\(s_t\\) Model 1, \\(\\{s_t, c_t\\}\\) Models 2 3. (\\(\\mathbb{P}\\) \\(\\mathbb{Q}\\) dynamics \\(r_t\\) estimated separately.)can seen previous equations, constraints imposed \\(\\mathbb{P}\\) \\(\\mathbb{Q}\\) parameters; help identification model parameters.\nFigure 5.1: sample means maturities used estimation stage. F1 contract : closest maturity F2 : second contract maturity one. Source: Schwartz (1997).\n","code":""},{"path":"credit-and-liquidity-risks.html","id":"credit-and-liquidity-risks","chapter":"6 Credit and liquidity risks","heading":"6 Credit and liquidity risks","text":"","code":""},{"path":"credit-and-liquidity-risks.html","id":"CreditNotations","chapter":"6 Credit and liquidity risks","heading":"6.1 Notations","text":"information investor date \\(t\\) still denoted \\(\\underline{w_t} = (w_t',w_{t-1}',\\dots, w_1 ') '\\), \\(w_t\\) now comprises new subsector, namely \\(d_t\\), keeps track “default” status creditors. Formally, \\(w_t = (y_t',d_t')'\\), \\(y_t\\) \\(n_y\\)-dimensional vector common factors, \\(d_t = (d_{1, t} , \\dots, d_{E, t}) '\\) \\(E\\)-dimensional vector binary variables representing possible default entities \\(e \\\\{1, \\dots,E\\}\\). Vector \\(w_t\\) \\(K\\)-dimensional, \\(K = n_y + E\\).convention:\\(d_{e, t} = 1\\) entity \\(e\\) default status time \\(t\\),\\(d_{e, t} = 0\\) entity \\(e\\) default status time \\(t\\).assume process \\(\\{w_t\\}\\) Markov. Formally, historical (\\(\\mathbb{P}\\)) dynamics defined conditional densities:\n\\[\nf (y_t  |  w_{t-1}) \\mbox{ }p ( d_t  |  y_t, w_{t-1} ).\n\\]follows, assume default state absorbing:Hypothesis 6.1  (absorbing defaults) default event absorbing state. Formally: \\(p_e ( 0 | y_t, w_{t-1}, d_{e,t-1}=1 ) = 0\\).survival probability defined follows:\n\\[\\begin{equation}\np_e ( 0  |  y_t, w_{t-1}, d_{e,t-1}=0 ) = \\exp[-\\underbrace{\\lambda_e ( y_t, w_{t-1})}_{\\color{blue}{\\mbox{default intensity}}}].\\tag{6.1}\n\\end{equation}\\]easily checked \\(\\lambda_e ( y_t, w_{t-1})\\) close conditional probability default small.","code":""},{"path":"credit-and-liquidity-risks.html","id":"CreditStandard","chapter":"6 Credit and liquidity risks","heading":"6.2 Pricing under standard assumptions","text":"start , consider pricing defaultable bonds assumptions standard literature, framework call classical credit-risk framework. assumptions—namely 6.2 6.3—lead simple formulas. investigate happens assumptions relaxed (Subsection 6.4).Hypothesis 6.2  (Non-systemic entity) \\(\\{d_t\\}\\) Granger-cause \\(\\{y_t\\}\\), sense :\n\\[\nf(y_t|w_{t-1}) = f(y_t|y_{t-1}).\n\\]words, Hypothesis 6.2, \\(y_t\\) exogenous \\(d_t\\).Hypothesis 6.3  (Unpriced credit events) default events (credit events) priced, sense :\n\\[\\begin{equation*}\n\\mathcal{M}_{t-1, t}( w_t, w_{t-1}) = \\mathcal{M}_{t-1, t}( y_t, y_{t-1}) .\n\\end{equation*}\\]words, Hypothesis 6.3, defaults affect SDF (conditionally \\(\\underline{y_t}\\)).Hypothesis 6.3 also implies short-term risk-free rate \\(r_t\\) (\\(=-\\log\\mathbb{E}_t(\\mathcal{M}_{t,t+1})\\)) depends \\(\\underline{y_t}\\) (\\(d_t\\)).Figure 6.1 provides graphical representation causality scheme classical credit-risk framework.\nFigure 6.1: Graphical representation causality scheme classical credit-risk framework.\nProposition 6.1  (Risk-neutral exogeneity factors) Hypotheses 6.2 6.3, :\n\\[\nf^{\\mathbb{Q}}(y_t|w_{t-1}) = f^{\\mathbb{Q}}(y_t|y_{t-1}),\n\\]\n, \\(\\{d_t\\}\\) Granger-cause \\(\\{y_t\\}\\) risk-neutral measure.Proof. :\n\\[\\begin{eqnarray}\nf^{\\mathbb{Q}}(y_t|w_{t-1}) &=& f(y_t|w_{t-1})\\mathcal{M}_{t-1,t}\\exp(r_{t-1})\\\\\n&=& f(y_t|y_{t-1})\\mathcal{M}_{t-1,t}\\exp(r_{t-1}),\n\\end{eqnarray}\\]\ngives results, using \\(\\mathcal{M}_{t-1,t}\\) \\(\\exp(r_{t-1})\\) depend \\(y_{t-1}\\) (\\(d_t\\)).simplify, let us focus single entity (\\(d_t \\equiv d_{1,t}\\)), alive date \\(t\\) (\\(d_t=0\\)). Consider date-\\(t\\) price bond issued defaultable entity. residual maturity bond denoted \\(h\\), consider zero recovery rate (case default, pyoff zero). price bond writes:\n\\[\nB(t,h) = \\mathbb{E}_t^{\\mathbb{Q}}[\\exp(-r_t-\\dots-r_{t+h-1})(1-d_{t+h})].\n\\]following proposition core classical credit-risk framework (Darrell Duffie Singleton 1999):Proposition 6.2  (Defaultabe zero-coupon bond pricing classical credit-risk framework) Hypotheses 6.2 6.3, default intensity defined—(6.1)—:\n\\[\\begin{equation}\n\\exp[-\\lambda_t^{\\mathbb{P}}]:=\\mathbb{P} ( d_t=0  |  \\underline{y_{t}}, d_{t-1}=0 ),\n\\end{equation}\\]\n:\n\\[\\begin{equation}\n\\lambda_t^{\\mathbb{Q}} = \\lambda_t^{\\mathbb{P}}\\;(=\\lambda_t),\\tag{6.2}\n\\end{equation}\\]\n\n\\[\\begin{equation}\n\\boxed{B(t,h) = \\mathbb{E}_t^{\\mathbb{Q}}\\left[\\exp\\left(-r_t-\\dots-r_{t+h-1}- \\lambda_{t+1} - \\dots - \\lambda_{t+h}\\right)\\right].}\\tag{6.3}\n\\end{equation}\\]\nrewrites, using \\(\\tilde{r}_t = r_t + \\lambda_{t+1}\\):\n\\[\\begin{equation}\nB(t,h) = \\mathbb{E}_t^{\\mathbb{Q}}\\left[\\exp\\left(-\\tilde{r}_t-\\dots-\\tilde{r}_{t+h-1}\\right)\\right],\\tag{6.4}\n\\end{equation}\\]Proof. (Eq. (2.6)):\n\\[\\begin{equation}\nf^{\\mathbb{Q}}(d_t,y_t|d_{t-1},y_{t-1}) = \\exp(r_{t-1})\\mathcal{M}_{t-1,t} f^{\\mathbb{P}}(d_t,y_t|d_{t-1},y_{t-1}).\\tag{6.5}\n\\end{equation}\\]\nUsing Hypothesis 6.3, obtain, integrating sides w.r.t. \\(d_t\\):\n\\[\\begin{eqnarray}\nf^{\\mathbb{Q}}(y_t|d_{t-1},y_{t-1}) &=& \\exp(r_{t-1})\\mathcal{M}_{t-1,t} f^{\\mathbb{P}}(y_t|d_{t-1},y_{t-1})\\nonumber\\\\\n&=& \\exp(r_{t-1})\\mathcal{M}_{t-1,t} \\underbrace{f^{\\mathbb{P}}(y_t|y_{t-1})}_{\\mbox{hypothesis}}. \\tag{6.6}\n\\end{eqnarray}\\]\nBayes, :\n\\[\nf^{\\mathbb{Q}}(d_t|d_{t-1},y_t,y_{t-1}) = \\frac{f^{\\mathbb{Q}}(d_t,y_t|d_{t-1},y_{t-1})}{f^{\\mathbb{Q}}(y_t|d_{t-1},y_{t-1})}.\n\\]\nUsing Eq. (6.5) (numerator) Eq. (6.6) (denominator), get:\n\\[\\begin{eqnarray*}\n&& f^{\\mathbb{Q}}(d_t|d_{t-1},y_t,y_{t-1}) = f^{\\mathbb{P}}(d_t|d_{t-1},y_t,y_{t-1}),\n\\end{eqnarray*}\\]\ngives (6.2).Conditioning w.r.t. \\(\\underline{y_{t+h}}\\), bond price given :\n\\[\\begin{eqnarray*}\n&& \\mathbb{E}_t^{\\mathbb{Q}}[\\mathbb{E}_t^{\\mathbb{Q}}\\{\\exp(-r_t-\\dots-r_{t+h-1})(1-d_{t+h})|\\underline{y_{t+h}}\\}]\\\\\n&=& \\mathbb{E}_t^{\\mathbb{Q}}[\\exp(-r_t-\\dots-r_{t+h-1})\\mathbb{E}_t^{\\mathbb{Q}}\\{(1-d_{t+h})|\\underline{y_{t+h}}\\}]\\\\\n&=& \\mathbb{E}_t^{\\mathbb{Q}}[\\exp(-r_t-\\dots-r_{t+h-1})\\mathbb{Q}\\{d_{t+h}=0|\\underline{y_{t+h}}\\}]\\\\\n&=& \\mathbb{E}_t^{\\mathbb{Q}}\\left[\\exp(-r_t-\\dots-r_{t+h-1})\\prod_{j=1}^h\\mathbb{Q}\\{d_{t+j}=0|d_{t+j-1}=0,\\underline{y_{t+h}}\\}\\right],\n\\end{eqnarray*}\\]\nGranger Sims non-causalities equivalent, since \\(d_t\\) Granger-cause \\(y_t\\) risk-neutral measure (see Proposition 6.1), :\n\\[\n\\mathbb{Q}\\{d_{t+j}=0|d_{t+j-1}=0,\\underline{y_{t+{\\color{red}h}}}\\} = \\underbrace{\\mathbb{Q}\\{d_{t+j}=0|d_{t+j-1}=0,\\underline{y_{t+{\\color{red}j}}}\\}}_{=\\exp(-\\lambda_{t+j}^{\\mathbb{Q}})}.\n\\]\nresult:\n\\[\\begin{equation}\nB(t,h) = \\mathbb{E}_t^{\\mathbb{Q}}\\left[\\exp\\left(-r_t-\\dots-r_{t+h-1}- \\lambda_{t+1}^{\\mathbb{Q}} - \\dots - \\lambda_{t+h}^{\\mathbb{Q}}\\right)\\right].\\tag{6.7}\n\\end{equation}\\]\nUsing (6.2) (6.7), obtain (6.3).Although \\(\\mathbb{P}\\) \\(\\mathbb{Q}\\) intensities functions \\(y_t\\) \\(y_{t-1}\\), historical risk-neutral dynamics general different since \\(y_t\\)’s \\(\\mathbb{P}\\) \\(\\mathbb{Q}\\) dynamics different.Eq. (6.4) reminiscent Eq. (1.10), risk-free short-term rate \\(r_t\\) replaced credit-adjusted short-term rate \\(\\tilde{r}_t\\).Importantly, \\(r_t\\) \\(\\lambda_t\\) affine \\(y_t\\), latter affine process, bond prices easily computed means recursive formulas (case context Eq. (1.10), see Example 1.18.case, \\(B(t,h)\\) exponential affine \\(y_t\\), , form:\n\\[\\begin{equation}\nB(t,h) = \\exp({^d_h}'y_t + B^d_h)\\quad (say).\\tag{6.8}\n\\end{equation}\\]previous framework can adapted order accommodate non-zero recovery rates. framework, default intensity replaced pseudo, recovery-adjusted default intensity denoted \\(\\tilde\\lambda_t\\). go , need specifiy payoff taking place upon default. exist different modelling conventions ; one -called Recovery Market Value (RMV) (Darrell Duffie Singleton 1999). Loosely speaking, RMV, recovery payoff fraction \\(\\zeta \\[0,1]\\), called Recovery Rate (RR) price prevailed, absent default. Proposition 6.3 makes definition precise gives bond price stemming .Proposition 6.3  (Bond pricing RMV classical framework) Hypotheses 6.2 6.3, , case default date \\(t+\\), recovery payment \\(\\zeta \\widetilde{B}(t+,h-)\\), \\(\\zeta \\[0,1]\\), \n\\[\\begin{equation}\nB(t,h) =  (1-d_t)\\widetilde{B}(t,h),\\tag{6.9}\n\\end{equation}\\]\n\\(\\widetilde{B}(t,h)\\) pseudo-price given :\n\\[\\begin{equation}\n\\widetilde{B}(t,h) = \\mathbb{E}_t^{\\mathbb{Q}} [\\exp(-r_{t}-\\tilde\\lambda_{t+1}-\\dots -r_{t+h-1}-\\tilde\\lambda_{t+h}],\\tag{6.10}\n\\end{equation}\\]\npseudo-intensity \\(\\tilde\\lambda_{t}\\) defined :\n\\[\\begin{eqnarray}\n\\exp(-\\tilde\\lambda_{t+1}) &=&  \\mathbb{E} [\\{1 - d_{t+1} (1-\\zeta)\\}|\\underline{y_{t+1}},d_t=0] \\nonumber\\\\\n&=&  1 - (1-\\zeta) (1-\\exp(-\\lambda_{t+1})).\\tag{6.11}\n\\end{eqnarray}\\]Proof. Relation (6.9) true \\(B(t+h, 0)\\) since \\(\\widetilde{B}(t+h, 0) = 1\\) \\(B(t+h, 0) = 1 - d_{t+h}\\).\nAssuming \\(B(t++1, h--1) = (1 - d_{t++1} ) \\widetilde{B}(t++1, h--1)\\) (valid \\(=h-1\\)), get:\n\\[\\begin{eqnarray*}\nB(t+, h-) &=& \\left(1 - d_{t+} \\right)  \\mathbb{E}_{t+}^{\\mathbb{Q}} \\left\\{ \\exp(- r_{t+})   \\left[ \\left(1 - d_{t++1} \\right) \\widetilde{B}(t++1, h--1) \\right. \\right. \\\\\n&& \\left. \\left. +  d_{t++1}\\zeta\\widetilde{B}(t++1, h--1) \\right] \\right\\},\n\\end{eqnarray*}\\]\nsince, case default date \\(t+\\), value bond date \\(t++1\\) either \\(\\zeta B(t++1, h--1) = \\zeta \\widetilde{B}(t++1, h--1)\\) default happens, \\(B(t++1, h--1) = \\widetilde{B}(t++1, h--1)\\) otherwise. Hypotheses 6.2 6.3 imply \\(\\widetilde{B}(t++1, h--1)\\) depend \\(d_{t++1}\\) taking first conditional expectation given \\(w_{t+}\\) \\(y_{t++1}\\) obtain:\n\\[\\begin{equation}\n\\begin{array}{lll}\nB(t+, h-) &=& \\left(1 - d_{t+} \\right) \\mathbb{E}_{t+}^{\\mathbb{Q}} \\left\\{ \\exp(- r_{t+})  \\widetilde{B}(t++1, h--1) \\times \\right. \\\\\n&& \\quad\\left. \\mathbb{E}^{\\mathbb{Q}} \\left[ \\left(1 - d_{t++1} \\right) +  \\zeta d_{t++1}  | y_{t++1}, w_{t+} \\right] \\right\\} .\n\\end{array}\\tag{6.12}\n\\end{equation}\\]\nUsing definition \\(\\widetilde{\\lambda}_{t}\\) (Eq. (6.11)) get:\n\\[\\begin{equation*}\n\\begin{array}{lll}\nB(t+, h-) &=& \\left(1 - d_{t+} \\right)  \\mathbb{E}_{t+}^{\\mathbb{Q}} \\left\\{ \\exp \\left( - r_{t+} - \\widetilde{\\lambda}_{t++1} \\right)  \\widetilde{B}(t++1, h--1) \\right\\}\\\\\n&=& \\left(1 - d_{t+} \\right)   \\widetilde{B}(t+, h-) .\n\\end{array}\n\\end{equation*}\\]\nTherefore also true \\(=0\\)., \\(r_t\\) \\(\\tilde\\lambda_t\\) affine combinations affine process \\(y_t\\), (exponential affine) bond prices easily computed means recursive formulas. formalized .Hypothesis 6.4  (Affine process) process \\(\\{ y_t \\}\\) affine \\(\\mathbb{Q}\\) measure:\n\\[\\begin{equation}\n\\begin{array}{lll}\n\\varphi^{\\mathbb{Q}}_{y, t-1} (u_y) = \\mathbb{E}^{\\mathbb{Q}} \\left[\\exp( u_y ' y_t )   |   \\underline{y_{t-1}} \\right]\n= \\exp \\left[ ^{\\mathbb{Q}}_{y} (u_{y}) ' y_{t-1} + b^{\\mathbb{Q}}_{y} (u_{y}) \\right],\n\\end{array}\\tag{6.13}\n\\end{equation}\\]\n\\(r_t\\) \\(\\widetilde{\\lambda}_{e, t}\\) affine \\((y_t, y_{t-1})\\), (say):\n\\[\\begin{eqnarray}\nr_{t} &=& \\omega_0 + \\omega_{1} ' y_{t} \\\\\n\\widetilde{\\lambda}_{e, t} &=& \\kappa_{0} + \\kappa_{1}' y_t.\n\\end{eqnarray}\\]Proposition 6.4  (Standard affine bond pricing, RMV convention) Assumptions Proposition 6.3 Hypothesis 6.4, , \\(h \\ge 1\\):\n\\[\\begin{equation}\nB(t, h) = \\left(1 - d_{t} \\right)\\exp(- h[\\omega_0 + \\kappa_{0}] - \\omega_{1} ' y_{t} + A_h'y_t + B_h),\\tag{6.14}\n\\end{equation}\\]\n\\(A_h\\) \\(B_h\\) given following recursive equations:\n\\[\\begin{equation}\n\\left\\{\n\\begin{array}{ccl}\nA_{h} &=& (u_{h} + A_{h-1}), \\\\\nB_{h} &=& b(u_{h} + A_{h-1}) + B_{h-1}, \\\\\nA_{0} &=& 0,\\quad  B_{0} = 0,\n\\end{array}\n\\right.\\tag{6.15}\n\\end{equation}\\]\n\\(u_1 = -\\kappa_{1}\\) \\(u_i = -(\\kappa_{1} + \\omega_{1})\\) \\(>1\\).Proof. results directly follows Proposition 6.3.precedes estiablished assumption state vector \\(w_t\\) comprises single defaultable entity (\\(E=1\\)). different entities considered (\\(E = 2\\))? can demonstrate similar pricing formulas obtained assumption -contagion (Hypothesis 6.5):Hypothesis 6.5  (contagion) instantaneous lagged contagion entities, .e.:\n\\[\\begin{equation*}\np ( d_t  |  y_t, w_{t-1} ) = p_1 ( d_{1, t}  |  y_t, y_{t-1}, d_{1, t-1})   \\times   p_2 ( d_{2, t}  |  y_t, y_{t-1}, d_{2, t-1}) .\n\\end{equation*}\\]Hypothesis 6.5 satisfied, instance, contagion effect \\(e = 1\\) towards \\(e = 2\\):\n\\[\\begin{eqnarray*}\np(d_t|y_t, w_{t-1} ) &=& p_1 ( d_{1, t}  |  y_t, y_{t-1}, d_{1, t-1}) \\times \\\\\n&&  p_2 ( d_{2, t}  |  y_t, y_{t-1}, \\color{blue}{d_{1, t}}, \\color{blue}{d_{1, t-1}}, d_{2, t-1}),\n\\end{eqnarray*}\\]\n:Proposition 6.3 still valid entities;affine framework, computation \\(\\widetilde{B}_1 (t, h)\\) (\\(B_1 (t, h)\\)) straightforward;formulas \\(\\widetilde{B}_2 (t, h)\\) \\(B_2 (t, h)\\) explicit anymore even \\(\\widetilde{\\lambda}_{2, t}\\) affine \\((y_t, y_{t-1}, d_{1, t}, d_{1, t-1})\\).Proposition 6.5  (Absence contagion) Hypotheses 6.1, 6.2, 6.3 6.5, risk-neutral (\\(\\mathbb{Q}\\)) dynamics :\n\\[\nf^{\\mathbb{Q}} ( y_t  |  w_{t-1}) = f^{\\mathbb{Q}} ( y_t  |  y_{t-1}) \\propto \\mathcal{M}_{t-1, t}( y_t, y_{t-1}) f (y_t  |  y_{t-1})\n\\]\n(exogeneity \\(y_t\\) preserved \\(\\mathbb{Q}\\)) \\[\np_t^{\\mathbb{Q}} ( d_{t}  |  y_t, w_{t-1} ) = p_1 ( d_{1, t}  |  y_t, y_{t-1}, d_{1, t-1} )   \\times   p_2 ( d_{2, t}  |  y_t, y_{t-1}, d_{2, t-1}),\n\\]\n(absence contagion preserved \\(\\mathbb{Q}\\)).Denoting \\(\\lambda^{\\mathbb{Q}}_e \\left( y_t, y_{t-1} \\right) \\equiv - \\log \\left[ p_e^{\\mathbb{Q}} ( 0 | y_t, y_{t-1}, 0 ) \\right]\\) risk-neutral default intensity entity\n\\(e\\), comes :\n\\[\n\\lambda^{\\mathbb{Q}}_e \\left( y_t, y_{t-1} \\right) = \\lambda_e \\left( y_t, y_{t-1} \\right)\n\\]\n(default intensities \\(\\mathbb{P}\\) \\(\\mathbb{Q}\\)).Proof. \\(\\mathbb{Q}\\) conditional density \\(w_t\\) given \\(w_{t-1}\\), namely \\(f^{\\mathbb{Q}} (y_t | w_{t-1}) p^{\\mathbb{Q}} ( d_t | y_t, w_{t-1} )\\), proportional \\(\\mathcal{M}_{t-1, t}( w_t, w_{t-1}) f (y_t | w_{t-1}) p ( d_t | y_t, w_{t-1} )\\), thus proportional \\(\\mathcal{M}_{t-1, t}( y_t, y_{t-1}) f (y_t | y_{t-1}) p_1 ( d_{1, t} | y_t, y_{t-1}, d_{1, t-1}) p_2 ( d_{2, t} | y_t, y_{t-1}, d_{2, t-1})\\). result follows immediately.","code":""},{"path":"credit-and-liquidity-risks.html","id":"CreditIlliq","chapter":"6 Credit and liquidity risks","heading":"6.3 Pricing illiquid bonds","text":"subsection shows similar approach can used price illiquid assets. idea consists replacing Loss Given Default (\\(LGD = 1-RR^{(e)}\\)) Loss Given Liquidity Shock (\\(1-\\theta_\\ell^{(e)}\\)). structural interpretation approach provided Ericsson Renault (2006) (see Example 6.1).Let us introduce novel binary variable: \\(\\ell_t\\), represents liquidity shocks. bondholder hit liquidity shock, needs liquidate portfolio (reflecting cash constraints needs rebalance portfolio). distressed conditions, sell bonds discount (therefore face losses, akin credit losses). Formally: \\(\\ell_{t}=1\\) bondholder hit, \\(\\ell_{t}=0\\) otherwise.liquidity-shock intensity \\(\\lambda_\\ell(y_t)\\)—defines probability occurence liquidity shocks—defined :\n\\[\n\\underbrace{1- \\exp[-\\lambda_\\ell(y_t)]}_{\\approx \\lambda_\\ell(y_t)\\mbox{ small}} = \\mathbb{P}(\\ell_t = 1|\\underline{w_{t-1}},y_t).\n\\]\nbinary variable \\(\\ell_t\\) assumed Granger-cause \\(y_t\\) (Hypothesis 6.2) priced (Hypothesis 6.3). Proposition 6.2 (precisely Eq. (6.2)), implies \n\\[\n\\lambda_\\ell^{\\mathbb{Q}}(y_t) = \\lambda_\\ell(y_t),\n\\]\n\n\\[\n1- \\exp[-\\lambda^{\\mathbb{Q}}_\\ell(y_t)] = \\mathbb{Q}(\\ell_t = 1|\\underline{w_{t-1}},y_t).\n\\]Upon arrival liquidity shock (\\(\\ell_{t}=1\\)), investor exit selling bond holdings. limited number traders can call , result, get fraction (\\(\\theta_\\ell^{(e)}\\), say) price get normal-liquidity times, .e., \\(\\ell_{t}=0\\) (see structural interpretation Example 6.1).context, following approach used Proposition 6.3, one can define pseudo-illiquidity intensity follows (mimicking Eq. (6.11)):\n\\[\\begin{eqnarray}\n\\widetilde{\\lambda}_{e,\\ell, t} \\left( y_t, y_{t-1} \\right) &=& - \\log \\left\\{ \\exp \\Big[ -\n\\lambda_{e,\\ell} \\left( y_t\\right) \\Big] \\right. + \\tag{6.16}\\\\\n&& \\left. \\Big( 1 - \\exp \\Big[ - \\lambda_{e,\\ell} \\left( y_t \\right) \\Big]\n\\Big) \\theta_\\ell^{(e)}  \\right\\} \\nonumber\n\\end{eqnarray}\\]Still consiering credit risk (top liquidity risk), following payoff date \\(t\\) (assuming default date \\(t-1\\)):\n\\[\\begin{equation}\n\\widetilde{B}_e (t, h) = \\mathbb{E}^{\\mathbb{Q}}_t \\left\\{ \\exp \\left[ - \\sum_{=1}^{h} \\left( r_{t+-1} + \\widetilde{\\lambda}_{e,c, t+} + \\widetilde{\\lambda}_{e,\\ell, t+} \\right) \\right] \\right\\}.\\tag{6.17}\n\\end{equation}\\]Example 6.1  (Structural interpretation illiquidity intensity) structural interpretation illiquidity intensity due Ericsson Renault (2006).hit liquidity shock, bondholder liquidate bond small amount time (\\(t\\) \\(t+\\varepsilon\\), \\(\\varepsilon \\ll 1\\)). collects offers market; offer random fraction \\(\\omega_{}\\) (\\(\\\\{1,\\ldots,\\kappa\\}\\)) \\(\\widetilde{B}_e (t, h)\\) (see Eq. (6.17)), \\(\\omega_{}\\)’s uniformly distributed \\([0,1]\\).\\(t+\\varepsilon\\), bond sold trader offered highest price. Formally, \\(\\ell_{t}=1\\), selling price :\n\\[\n\\left(\\max_{\\\\{1,\\ldots,\\kappa\\}}\\omega_{}\\right)\\tilde{P}_{t,h}^{(e)}.\n\\]\nConditional \\(\\kappa\\), expectation \\(\\max_{}(\\omega_{})\\) \\(\\kappa/(\\kappa+1)\\). (\\(\\omega_{}\\) ..d., c.d.f. \\(\\max(\\omega_{1},\\ldots,\\omega_{\\kappa})\\) \\(x\\mapsto F(x)^{\\kappa}\\), \\(F\\) c.d.f. \\(\\omega_{}\\).)\nHence, \\(\\theta_\\ell^{(e)}\\)—unconditional expectation \\(\\max_{}(\\omega_{})\\)—given :\n\\[\\begin{eqnarray*}\n\\sum_{k=1}^{\\infty}\\frac{e^{-\\varepsilon\\gamma^{(e)}}k}{k+1}\\frac{\\left(\\varepsilon\\gamma^{(e)}\\right)^{k}}{k!} & = & \\left[\\left(1-e^{-\\varepsilon\\gamma^{(e)}}\\right)\\frac{\\varepsilon\\gamma^{(e)}-1}{\\varepsilon\\gamma^{(e)}}+e^{-\\varepsilon\\gamma^{(e)}}\\right]\\\\\n& = & g(\\varepsilon\\gamma^{(e)})\\qquad\\mbox{(say).}\n\\end{eqnarray*}\\]\nFunction \\(g\\) increasing valued \\([0,1]\\). addition \\(\\lim_{x\\rightarrow\\infty}g(x)\\rightarrow1\\).Example 6.2  (Euro area sovereign credit spreads) . Monfort Renne (2011) Alain Monfort Renne (2014) propose credit/liquidity decompositions euro-area sovereign spreads. emply different estimation approaches: C.-J. Kim (1994)’s filter MR2014, Kitagawa-Hamilton filter . Monfort Renne (2011) (see Subsection 4.5.1).papers, \\(y_t\\) part state vector \\(w_t\\) form \\(y_t = (x_t',z_t')'\\); follows Regime-Switching Gaussian VAR (see Example 4.3). time-homogenous Markov chain \\(z_t\\) tracks crisis status (crisis versus normal times).total intensity form:\n\\[\n\\widetilde{\\lambda}_{e,t} = \\underbrace{\\alpha_{e,c}'z_t + \\beta_{e,c}'y_t}_{\\mbox{credit intensity $\\widetilde{\\lambda}_{e,c,t}$}} + \\underbrace{\\alpha_{e,\\ell}'z_t + \\beta_{e,\\ell}'y_t.}_{\\mbox{liquidity intensity $\\widetilde{\\lambda}_{e,\\ell,t}$}}\n\\]\npapers, identification credit versus liquidity components based :\n\\[\n\\mbox{KfW-Bund spreads} =  \\mbox{liquidity spreads}.\n\\]\nKfW (Kreditanstalt für Wiederaufbau) German agency whose bonds guaranteed Federal Republic Germany. Therefore, benefit credit quality sovereign counterparts—Bunds—less liquid; accordingly, KfW-Bund spread beessentially liquidity-driven.Alain Monfort Renne (2014), \n\\[\n\\widetilde{\\lambda}_{e,t} = \\underbrace{x_{e,t}}_{=\\widetilde{\\lambda}_{e,c,t}} + \\underbrace{(1-\\theta^{(e)}_\\ell)x_{E+1,t}}_{=\\widetilde{\\lambda}_{e,\\ell,t}},\n\\]\nhence \\(x_t\\) dimension \\(E+1 = 12\\) (11 countries involved).9 Markovian regimes: \\(z_t = z_{c,t} \\otimes z_{\\ell,t}\\), \\(z_{,t}\\) (\\(\\\\{c,\\ell\\}\\)) 3-dimensional:\\(z_{,t}=[1,0,0]'\\): low stress,\\(z_{,t}=[0,1,0]'\\): medium stress,\\(z_{,t}=[0,0,1]'\\): high stress.\\(z_{c,t}\\) \\(z_{\\ell,t}\\) independent: instance, probability transit low-credit-stress regime medium/high-credit-stress regimes depends liquidity-stress regime.intensity \\(x_{,t}\\) (simulation XXX):\n\\[\nx_{,t} = \\mu_i'z_t + \\phi x_{,t-1} + \\sigma_i \\varepsilon_{,t},\n\\]\n\\(\\varepsilon_{t} \\sim ..d. \\mathcal{N}(0,\\Sigma)\\), \\(\\Sigma\\) diagonal, \\(\\mu_{,1} < \\mu_{,2} < \\mu_{,3}\\).\nMarkov chain \\(z_t\\) source correlation across \\(x_{,t}\\)’s.Figure 6.2 shows simulation process, :\n\\[\n\\mu=\\left[\\begin{array}{c}\n0.01 \\\\ 0.03 \\\\ 0.10\\end{array}\\right],\\quad \\phi=.8 ,\\quad P=\\left[\\begin{array}{ccc}\n0.98 & 0.02 & 0\\\\\n0.05 & 0.90 & 0.05\\\\\n0 & 0.20 & 0.80\n\\end{array}\\right],\\quad \\sigma = 0.002.\n\\]SDF exponential affine \\((z_t',x_t')'\\). type dynamics \\(\\mathbb{Q}\\) (risk-asjusted parameters, particular risk-adjusted transition probabilities).\nFigure 6.2: Simulation process following \\(x_{t} = \\mu'z_t + \\phi x_{t-1} + \\sigma \\varepsilon_{t}\\), \\(z_t\\) follows three-state time-homogenous Markov process. See text exact parameterization. light-grey shaded area corresponds second regime (\\(z_t = [0,1,0]'\\)); dark-grey shaded area corresponds third regime (\\(z_t = [0,0,1]'\\))\nExample 6.3  (IBOR-OIS spreads) Dubecq et al. (2016) decompose EURIBOR versus Overnight Index Swap (OIS) spreads credit liquidity component. (See Subsection ?? definition swap contract.)point view bank \\(j\\), EURIBOR rate rate unsecured loan one bank (\\(e\\), say) panel. Assume panel \\(N\\) constituting EURIBOR homogenous. :\n\\[\\begin{equation}\nR^{IBOR}_{t,h} = - \\frac{1}{h} \\log \\mathbb{E}^{\\mathbb{Q}}_t \\left\\{ \\exp \\left[ - \\sum_{=1}^{h} \\left( r_{t+-1} + \\widetilde{\\lambda}_{e,c, t+} + \\widetilde{\\lambda}_{j,\\ell, t+} \\right) \\right] \\right\\}.\\tag{6.18}\n\\end{equation}\\]\nNote liquidity intensity refers lending bank (\\(j\\)) default intensity relates borrowing bank (\\(e\\)).constrast, Overnight-Index Swap (OIS) rate satisfies:8\n\\[\\begin{equation}\nR^{OIS}_{t,h} = - \\frac{1}{h} \\log \\mathbb{E}^{\\mathbb{Q}}_t \\left\\{ \\exp \\left( - \\sum_{=1}^{h}  r_{t+-1} \\right) \\right\\}.\\tag{6.19}\n\\end{equation}\\]Assuming \\(r_t\\), short-term risk-free rate (.e., reference rate OIS, EONIA ) independent intensities homogeneity assumption, obtain:9\n\\[\nR^{IBOR}_{t,h} - R^{OIS}_{t,h} = - \\frac{1}{h} \\log \\mathbb{E}^{\\mathbb{Q}}_t \\left\\{ \\exp \\left[ - \\sum_{=1}^{h} \\left( \\widetilde{\\lambda}_{c, t+} + \\widetilde{\\lambda}_{\\ell, t+} \\right) \\right] \\right\\}.\n\\]Dubecq et al. (2016) employ quadratic specification \\(\\widetilde{\\lambda}_{c, t}\\) \\(\\widetilde{\\lambda}_{\\ell, t}\\):\n\\[\n\\widetilde{\\lambda}_{c, t} = x_{c,t}^2 \\quad \\mbox{} \\quad  \\widetilde{\\lambda}_{\\ell, t} = x_{\\ell,t}^2,\n\\]\n\\(X_t = (x_{c,t},x_{\\ell,t})'\\) follows Gaussian VAR(1) process. (quandratic Gaussian framework presented Example 1.7.)state vector \\(X_t\\) latent. estimation involves Quadratic Kalman Filter (Alain Monfort, Renne, Roussellet 2015). measurement equations include equations stating observed proxies credit liquidity risks relate quadratic functions \\(x_{c,t}\\) \\(x_{\\ell,t}\\), respectively.\nFigure 6.3: Source: Dubecq et al. (2016).\n","code":""},{"path":"credit-and-liquidity-risks.html","id":"Creditrelaxing","chapter":"6 Credit and liquidity risks","heading":"6.4 Relaxing the classical framework assumptions","text":"Formula (6.14) tractability key feature numerous credit-risk term-structure models, e.g., D. Duffie Singleton (2003), Pan Singleton (2008), Longstaff et al. (2011) among many others. formula valid Assumptions 6.2 non-systemic entities, also called -jump condition, 6.3 unpriced credit risk events, 6.5 absence contagion. hypotheses define called classical credit-risk models. lose high degree tractability Formula (6.14) previous assumptions relaxed:\\(f (y_t | w_{t-1}) = f (y_t | y_{t-1} , d_{1, t-1})\\) (entity \\(e = 1\\) systemic) :\npseudo-price \\(\\widetilde{B}_e (t, h)\\) now depends \\(y_t\\) \\(d_{1, t}\\);\nEq. (6.3) valid entity \\(e = 2\\) ;\ncomputation \\(\\widetilde{B}_2 (t, h)\\) straightforward: \\(\\{ y_t \\}\\)\nautonomous autonomous process \\(\\{ y_t, d_{1,t} \\}\\) affine.\n\\(f (y_t | w_{t-1}) = f (y_t | y_{t-1} , d_{1, t-1})\\) (entity \\(e = 1\\) systemic) :pseudo-price \\(\\widetilde{B}_e (t, h)\\) now depends \\(y_t\\) \\(d_{1, t}\\);Eq. (6.3) valid entity \\(e = 2\\) ;computation \\(\\widetilde{B}_2 (t, h)\\) straightforward: \\(\\{ y_t \\}\\)\nautonomous autonomous process \\(\\{ y_t, d_{1,t} \\}\\) affine.contagion effect \\(e = 1\\) towards \\(e = 2\\), .e., \n\\[\\begin{eqnarray*}\np ( d_t  |  y_t, w_{t-1} ) &=& p_1 ( d_{1, t}  |  y_t, y_{t-1}, d_{1, t-1}) \\\\\n&&  p_2 ( d_{2, t}  |  y_t, y_{t-1}, d_{1, t}, d_{1, t-1}, d_{2, t-1}),\n\\end{eqnarray*}\\]\n:\nEq. (6.3) still valid entities;\naffine framework, computation \\(\\widetilde{B}_1 (t, h)\\) (\\(B_1 (t, h)\\)) straightforward; formulas \\(\\widetilde{B}_2 (t, h)\\) \\(B_2 (t, h)\\) explicit anymore even \\(\\widetilde{\\lambda}_{2, t}\\) affine \\((y_t, y_{t-1}, d_{1, t}, d_{1, t-1})\\).\ncontagion effect \\(e = 1\\) towards \\(e = 2\\), .e., \n\\[\\begin{eqnarray*}\np ( d_t  |  y_t, w_{t-1} ) &=& p_1 ( d_{1, t}  |  y_t, y_{t-1}, d_{1, t-1}) \\\\\n&&  p_2 ( d_{2, t}  |  y_t, y_{t-1}, d_{1, t}, d_{1, t-1}, d_{2, t-1}),\n\\end{eqnarray*}\\]\n:Eq. (6.3) still valid entities;affine framework, computation \\(\\widetilde{B}_1 (t, h)\\) (\\(B_1 (t, h)\\)) straightforward; formulas \\(\\widetilde{B}_2 (t, h)\\) \\(B_2 (t, h)\\) explicit anymore even \\(\\widetilde{\\lambda}_{2, t}\\) affine \\((y_t, y_{t-1}, d_{1, t}, d_{1, t-1})\\).default event first entity (\\(d_{1,t}\\)) source risk priced: \\(\\mathcal{M}_{t-1, t}( w_t, w_{t-1}) = \\mathcal{M}_{t-1, t}( y_t, y_{t-1}, d_{1, t}, d_{1, t-1})\\), \n\\(\\lambda^{\\mathbb{Q}}_{1, t} \\neq \\lambda_{1, t}\\) \\(\\lambda^{\\mathbb{Q}}_{2, t} = \\lambda_{2, t}\\);\nexogeneity \\(\\{ y_t \\}\\) longer preserved \\(\\mathbb{Q}\\);\nEq. (6.3) longer valid entity \\(e = 1\\). remains valid \\(e=2\\) computation \\(\\widetilde{B}_{2} (t, h)\\) straightforward: even \\(y_t\\) \\(\\mathbb{P}\\)-autonomous, true \\(\\mathbb{Q}\\).\ndefault event first entity (\\(d_{1,t}\\)) source risk priced: \\(\\mathcal{M}_{t-1, t}( w_t, w_{t-1}) = \\mathcal{M}_{t-1, t}( y_t, y_{t-1}, d_{1, t}, d_{1, t-1})\\), \\(\\lambda^{\\mathbb{Q}}_{1, t} \\neq \\lambda_{1, t}\\) \\(\\lambda^{\\mathbb{Q}}_{2, t} = \\lambda_{2, t}\\);exogeneity \\(\\{ y_t \\}\\) longer preserved \\(\\mathbb{Q}\\);Eq. (6.3) longer valid entity \\(e = 1\\). remains valid \\(e=2\\) computation \\(\\widetilde{B}_{2} (t, h)\\) straightforward: even \\(y_t\\) \\(\\mathbb{P}\\)-autonomous, true \\(\\mathbb{Q}\\).","code":""},{"path":"credit-and-liquidity-risks.html","id":"CreditGeneral","chapter":"6 Credit and liquidity risks","heading":"6.4.1 General affine credit-risk framework","text":"Exploiting Vector Auto-Regressive Gamma (VARG) processes, Alain Monfort et al. (2021) propose general affine credit-risk pricing model jointly allowing :systemic entities (breaking -jump condition; see Collin-Dufresne, Goldstein, Hugonnier (2004));contagion effects entities (economic/financial linkages; see Ait-Sahalia, Laeven, Pelizzon (2014));pricing credit events (credit spread puzzle; see C. Gourieroux, Monfort, Renne (2014));stochastic recovery rates (RR) (Altman et al. 2005).general framework, state vector \\(w_t\\) form \\([y_t',\\delta_t']'\\), \\(\\delta_t\\) \\(E\\)-dimensional vector credit-event variables (see Hypothesis 6.6).\nFigure 6.4: Schematic comparison classical general credit-risk frameworks.\nHypothesis 6.6  (Credit events) default date \\(\\tau^{(e)}\\) (say) entity \\(e\\) defined :\n\\[\\begin{equation}\n\\tau^{(e)} = \\inf \\left\\{ t > 0 : \\delta^{(e)}_t > 0 \\right\\},\\tag{6.20}\n\\end{equation}\\]\n\\(\\delta^{(e)}_t\\) non-negative variable called credit-event variable. default indicator function can equivalently written \\(d^{(e)}_t = \\textbf{1}_{ \\{ \\tau^{(e)} \\leq t \\} }\\) \\(d^{(e)}_t = 1 - \\textbf{1}_{ \\{ \\underline{\\delta^{(e)}_t} ' {\\bf 1} = 0 \\} }\\), \\(\\underline{\\delta^{(e)}_t} = (\\delta^{(e)}_t, \\ldots, \\delta^{(e)}_1)\\) \n\\({\\bf 1} = (1, \\ldots, 1)'\\) conformable dimension.Hypothesis 6.7  (State-vector dynamics) stochastic process \\(\\{w_t\\}\\) affine historical probability measure \\(\\mathbb{P}\\). historical Laplace transform \\(w_t\\), conditional \\(\\underline{w}_{t-1}\\), denoted :\n\\[\\begin{eqnarray}\n\\varphi^{\\mathbb{P}}_{w, t-1} (u_w) &=& \\mathbb{E} \\left[\\exp( u_w ' w_t )   |   \\underline{w_{t-1}} \\right] \\nonumber \\\\\n&=& \\exp \\left[ a_{w} (u_{w}) ' w_{t-1} + b_{w} (u_{w}) \\right],\\tag{6.21}\n\\end{eqnarray}\\]\n\\(u_w = (u_y ', u_{\\delta} ')'\\).Example 6.4  (Vector Autoregressive Gamma process) Alain Monfort et al. (2021), \\(w_t\\) follows VARG (positive affine) process, satisfies Hypthesis 6.7 (Example 1.8 presents univariate version process.):\n\\[\\begin{equation}\n\\begin{array}{lll}\ny_{t}  |  \\underline{w_{t-1}}  &\\overset{\\mathbb{P}}{\\sim}&   \\otimes_{j=1}^{N_y}   \\gamma_{\\nu_{j}^{(y)}}\n\\left( \\alpha_{j}^{(y)} + \\overbrace{\\beta_{j, y}^{(y)}   y_{t-1}}^{\\mbox{factors}}     +  \\underbrace{ \\overbrace{\\color{blue}{ \\beta^{(y)}_{j, \\delta} \\delta_{t-1}}}^{\\begin{array}{c}\\mbox{credit-event}\\\\\\mbox{variables}\\end{array}}}_{\\begin{array}{c}\\color{red}{\\mbox{kills -jump}}\\\\\\color{red}{\\mbox{condit.}}\\end{array}} , \\mu_j^{(y)} \\right) \\\\\n\\delta_t  |  y_t, \\underline{w_{t-1}}  &\\overset{\\mathbb{P}}{\\sim}&  \\otimes_{e = 1}^{E}  \\gamma_{0}\n\\left( \\alpha_e^{(\\delta)} + \\color{blue}{\\beta^{(\\delta)}_{e, y}  y_{t}} +  \\underbrace{\\color{blue}{\\beta^{(\\delta)}_{e, \\delta}   \\delta_{t-1}}}_{\\color{red}{\\mbox{contagion}}},\n\\mu_e^{(\\delta)} \\right) ,\n\\end{array}\\tag{6.22}\n\\end{equation}\\]\n\\(\\delta_t = (\\delta^{(1)}_t, \\ldots, \\delta^{(E)}_t)'\\) \\(\\gamma_{\\nu} \\left(\\lambda, \\mu \\right)\\): non-central Gamma distribution.\nFigure 6.5: potential causality scheme Monfort et al. (2021).\nHypothesis 6.8  (Stochastic discount factor) one-period positive SDF \\(\\mathcal{M}_{t-1, t}\\) given (Eq. (2.5), \\(\\alpha_t \\equiv \\alpha_w\\)):\n\\[\\begin{equation}\n\\mathcal{M}_{t,t+1} = exp[-r_{t}+\\alpha'_w w_{t+1}-\\psi_t(\\alpha_w)],\n\\end{equation}\\]\nrisk-free short rate (\\(t\\) \\(t+1\\)) given following affine function factors:\n\\[\\begin{equation}(\\#eq:short_rate)\n\\begin{array}{lll}\nr_{t}(\\underline{w_{t}}) = \\xi_0 + \\xi_1 ' w_{t}.\n\\end{array}\n\\end{equation}\\]\n\\(\\alpha_w = (\\alpha_y ' , \\alpha_x ' , \\alpha_{\\delta} ') '\\) vector prices risk.Hypotheses 6.7 6.8, comes :\n\\[\\begin{eqnarray}\n\\varphi^{\\mathbb{Q}}_{w, t-1} (u_w) &=& \\mathbb{E}^{\\mathbb{Q}} \\left[\\exp( u_w ' w_t )   |   \\underline{w_{t-1}} \\right] \\nonumber \\\\\n&=& \\exp \\left[ ^{\\mathbb{Q}}_{w} (u_{w}) ' w_{t-1} + b^{\\mathbb{Q}}_{w} (u_{w}) \\right],\\tag{6.23}\n\\end{eqnarray}\\]\n, using Eq. (2.7):\n\\[\\begin{equation}\n\\left\\{\n\\begin{array}{ccl}\n^{\\mathbb{Q}}_{w} (u_{w}) &=& a_{w} (u_{w} + \\alpha_w) - a_{w} (\\alpha_w) \\\\\nb^{\\mathbb{Q}}_{w} (u_{w}) &=& b_{w} (u_{w} + \\alpha_w) - b_{w} (\\alpha_w).\n\\end{array}\n\\right.\\tag{6.24}\n\\end{equation}\\]Hypothesis 6.9  (General recovery payment) Recovery Paymentof defaultable ZCB, case default date \\(t+= \\tau^{(e)}\\), given :\n\\[\\begin{equation}\n\\begin{array}{lll}\nRR^{(e)}_{t+}   \\times   \\mathcal{V}^{(e)}_{t+, h-}\n\\end{array}\\tag{6.25}\n\\end{equation}\\]\nRecovery Rate \\(RR^{(e)}_{t+}\\) \n\\[\\begin{equation}\nRR^{(e)}_{t+} = \\exp \\left( - a_{e} - a_{w, e} '   w_{t+} \\right),\\tag{6.26}\n\\end{equation}\\]\n\\(\\mathcal{V}^{(e)}_{t+, h-}\\) denotes Recovery Value (Exposure--Default) \\(t+\\)}.general framework allows flexible specifications recovery payment. can :fraction pre-default value claim (Recovery Market Value, RMV) [see Prop. 6.7];fraction par (Recovery Face Value, RFV) [see Proposition 6.6];fraction -default version claim (Recovery Treasury, RT). case, recovery payment fraction (risk-free) present value principal.Proposition 6.6  (General pricing RFV convention) price, date \\(t < \\tau^{(e)}\\), ZCB issued entity \\(e\\) maturing \\(h\\) periods given :\n\\[\\begin{equation}\n\\begin{array}{lll}\n\\boxed{B_{e} (t, h) = \\sum_{= 1}^{h} \\left( \\Lambda^{\\mathbb{Q}}_{(1, t, )} - \\Lambda^{\\mathbb{Q}}_{(2, t, )} \\right) + \\Lambda^{\\mathbb{Q}}_{(3, t, h)} ,}\n\\end{array}\\tag{6.27}\n\\end{equation}\\]\n:\n\\[\\begin{equation}\n\\begin{array}{lll}\n\\Lambda_{(1,t,)}^{\\mathbb{Q}} &:=& \\underset{u \\rightarrow - \\infty}{\\lim} \\Psi^{\\mathbb{Q}}_{(t, )} (a_e , u \\widetilde{e}_\\delta - \\xi_1, - a_{w,e}) \\\\\n\\Lambda_{(2,t,)}^{\\mathbb{Q}} &:=& \\underset{u \\rightarrow - \\infty}{\\lim} \\Psi^{\\mathbb{Q}}_{(t, )} (a_e , u \\widetilde{e}_\\delta - \\xi_1,u \\widetilde{e}_\\delta - a_{w,e} ) \\\\\n\\Lambda_{(3,t,)}^{\\mathbb{Q}} &:=& \\underset{u \\rightarrow - \\infty}{\\lim} \\Psi^{\\mathbb{Q}}_{(t, )} (0 , u \\widetilde{e}_\\delta - \\xi_1,u \\widetilde{e}_\\delta)\n\\end{array}\\tag{6.28}\n\\end{equation}\\]\n\\(u \\\\mathbb{R}\\) [denoting \\(\\varphi^{\\mathbb{Q}}_{w, t, } \\left(u_2, \\ldots, u_2 , u_1 \\right) = \\varphi^{\\mathbb{Q}}_{w, t, } \\left( u_2 , u_1 \\right)\\)]:\n\\[\\begin{equation}\n\\begin{array}{lll}\n\\Psi^{\\mathbb{Q}}_{(t, )} (\\kappa , u_1, u_2) &:=& \\exp \\left[ -\\xi_0 + \\kappa + u_2 ' w_t \\right]   \\varphi_{w,t,}^{\\mathbb{Q}}(u_2, u_1)\n\\end{array}\\tag{6.29}\n\\end{equation}\\]Proof. See Alain Monfort et al. (2021).Proposition 6.7  (General pricing RMV convention) recovery value date \\(t+\\) (defined 6.9) form:\n\\[\\begin{equation}\n\\mathcal{V}^{(e)}_{t+, h-} =\n\\mathbb{E}^{\\mathbb{Q}} \\left\\{ \\exp \\left[ - \\sum_{j = }^{h-1} \\left(r_{t+j} + \\delta^{(e)}_{t+j+1} \\right) \\right]  \\Big|  \\underline{w_{t+}} \\right\\},\\tag{6.30}\n\\end{equation}\\]\n\\(RR_t^{(e)} = \\exp(-\\delta_t^{(e)})\\), Hypothesis 6.6 6.8, price \\(B_{e} (t, h)\\) date \\(t < \\tau^{(e)}\\) given :\n\\[\\begin{equation}\nB_{e} (t, h) = \\mathcal{V}^{(e)}_{t, h},\\tag{6.31}\n\\end{equation}\\]\n\n\\[\\begin{equation}\n\\begin{array}{lll}\n\\mathcal{V}^{(e)}_{t, h} = \\exp \\left[ \\left( \\mathcal{}_h - \\xi_1 \\right) ' w_t + \\left( \\mathcal{B}_h - h   \\xi_0 \\right) \\right].\n\\end{array}\\tag{6.32}\n\\end{equation}\\]\n\\(\\mathcal{}_h\\) \\(\\mathcal{B}_h\\) obtained recursively employing Eqs. (1.19) Proposition 1.5, replacing functions \\(\\) \\(b\\) \\(^{\\mathbb{Q}}\\) \\(b^{\\mathbb{Q}}\\) (see Eq. (6.24)) \\(u_{1} = - \\widetilde{e}_{\\delta}\\) , \\(>1\\), \\(u_i = - (\\widetilde{e}_{\\delta} + \\xi_1)\\) \\(\\widetilde{e}_{\\delta} = (0',e_{\\delta}')'\\) \\(N\\)-dimensional vector, \\(e_{\\delta}\\) \\(e^{th}\\) column \\((N_{\\delta}, N_{\\delta})\\)-dimensional identity matrix.Proof. See Appendix .4 Alain Monfort et al. (2021).Eq. (6.31) key result. reads:\n\\[\\begin{equation}\n\\boxed{B_{e} (t, h) = \\mathbb{E}^{\\mathbb{Q}} \\left\\{ \\exp \\left[ -  \\left( \\sum_{= 1}^{h}{\\color{red}r_{t+-1} + \\delta^{(e)}_{t+}} \\right) \\right]  \\Big|  \\underline{w_{t}} \\right\\}.}\\tag{6.33}\n\\end{equation}\\]\nreminiscent Eq. (6.3), \\(\\lambda\\) (default intensity) replaced \\(\\delta\\) (credit-event variable). However, contrary classical framework, credit events priced sources risk, -jump condition relaxed, contagion allowed, recovery rate stochastic. formula can therefore seen generalization setting Darrell Duffie Singleton (1999).","code":""},{"path":"credit-and-liquidity-risks.html","id":"CreditCDS","chapter":"6 Credit and liquidity risks","heading":"6.4.2 CDS pricing in the general framework","text":"subsection shows CDS can priced context general credit-risk model. consider two types CDS. first standard one; second CDS whose payoffs expressed foreign currency (typical sovereign CDSs). Figures 6.6 6.7 show payoffs associated two types CDSs.\nFigure 6.6: CDS payoffs.\n\nFigure 6.7: CDS payoffs payoffs expressed foreign currency.\nSince domestic-currency case special case multi-currency one, focus latter case following.Pricing CDS amounts determining \\(\\mathcal{S}_{t,t+h}^{(e)}\\), CDS spread, \\(t < \\tau^{(e)}\\). spread \\(\\mathcal{S}_{t,t+h}^{(e)}\\) date-\\(t\\) value fixed leg’s payoffs equal date-\\(t\\) value floating leg’s payoffs. payoffs assets issued reference entity assumed expressed domestic currency.(logarithmic) exchange rate denoted \\(s_t = \\ln ( FX_t )\\). convention, increase \\(s_t\\) corresponds depreciation domestic currency. (words, \\(FX_t\\) value one unit foreign currency expressed domestic currency.) consider CDS whose notional equal one unit foreign currency\n(.e. \\(\\exp (s_t)\\) units domestic currency).Let us determine value fixed leg. entity \\(e\\) defaulted date \\(t+\\) (\\(\\le t+h\\)), cash flow date, expressed domestic currency, :\n\\[\\begin{equation*}\n\\begin{array}{lll}\n\\mathcal{S}^{(e) f}_{t,t+h} \\exp(s_{t+}).\n\\end{array}\n\\end{equation*}\\]\nHence, present values fixed-leg payments, expressed domestic currency :\n\\[\\begin{equation*}\n\\begin{array}{lll}\n\\mathcal{S}^{(e) f}_{t, t+h}  \\sum_{=1}^{h}   \\mathbb{E}^{\\mathbb{Q}}\n\\left[\\exp \\left( s_{t+} - \\sum_{j = 1}^{} r_{t + j - 1} \\right) \\textbf{1}_{\\{ \\delta^{(e) '}_{t : t+} {\\bf 1} = 0 \\} }\n\\Big|  \\underline{w_t} \\right],\n\\end{array}\n\\end{equation*}\\]Let us turn floating leg. RFV convention, protection seller make payment \\((1 - RR^{(e)}_{t+}) \\exp(s_{t+})\\) (loss-given-default. LGD) date \\(t+\\) case default time interval \\(] t + - 1, t+]\\). present values floating leg, expressed domestic currency, :\n\\[\\begin{equation*}\n\\begin{array}{lll}\n&& \\sum_{=1}^{h}   \\mathbb{E}^{\\mathbb{Q}} \\left[ \\exp \\left( s_{t+} - \\sum_{j = 1}^{} r_{t + j - 1}\n\\right)   (1 - RR^{(e)}_{t+})\\right. \\\\ \\\\\n&& \\hspace{7em} \\left.   \\left( \\textbf{1}_{\\{ \\delta^{(e) '}_{t : t+-1} {\\bf 1} = 0 \\} } - \\textbf{1}_{\\{ \\delta^{(e) '}_{t : t+}\n{\\bf 1} = 0 \\} } \\right)  \\Big|  \\underline{w_t}   \\right],\\tag{6.34}\n\\end{array}\n\\end{equation*}\\]assume \\(RR^{(e)}_{t} = \\exp \\left( - a_{e} - a_{w, e} ' w_t \\right)\\) \\(s_t = \\chi + u_s ' w_t\\).Proposition 6.8  (Price multi-currency CDS) context described , :\n\\[\\begin{equation}\n\\boxed{\\mathcal{S}^{(e) f}_{t, t+h} = \\frac{\\sum_{=1}^{h} \\Lambda^{\\mathbb{Q}}_{(t, )} }{\\sum_{=1}^{h} \\lim_{u \\- \\infty} \\Psi^{\\mathbb{Q}}_{(t, )} \\left( \\chi, u \\tilde{e}_{\\delta} - \\xi_1 , u \\tilde{e}_{\\delta} + u_s \\right)},}\\tag{6.35}\n\\end{equation}\\]\n:\n\\[\\begin{eqnarray*}\n\\Lambda^{\\mathbb{Q}}_{(t, )} & = & \\underset{u \\- \\infty}{\\lim} \\Big[ \\Psi^{\\mathbb{Q}}_{(t, )} \\left( \\chi , u \\widetilde{e}_{\\delta} - \\xi_1 , u_s \\right) -\n\\Psi^{\\mathbb{Q}}_{(t, )} \\left( \\chi , u \\widetilde{e}_{\\delta} - \\xi_1 , u \\widetilde{e}_{\\delta} + u_s \\right) \\\\\n&& \\hspace{7em} - \\Psi^{\\mathbb{Q}}_{(t, )} \\left(\\chi - a_e, u \\widetilde{e}_{\\delta} - \\xi_1 , u_s - a_w \\right) \\\\\n&& \\hspace{7em} + \\Psi^{\\mathbb{Q}}_{(t, )} \\left(\\chi - a_e, u \\widetilde{e}_{\\delta} - \\xi_1 , u \\widetilde{e}_{\\delta} + u_s - a_w \\right) \\Big] ,\n\\end{eqnarray*}\\]\n\\(\\Psi^{\\mathbb{Q}}_{(t, )} \\left(\\kappa, u_2 , u_1 \\right)\\) given Eq. (6.29).Proof. See Online Appendix .4 Alain Monfort et al. (2021). proof notably makes use Lemma ?? (Subsection 1.3).price standard CDS (payments domestic currency), one simply set \\(\\chi=0\\) \\(u_s=0\\), gives \\(s_t=0\\) (since \\(s_t = \\chi + u_s ' w_t\\)).Alain Monfort et al. (2021) exploit formulas model quanto CDSs euro area. Quanto CDSs spread differentials two types CDS. exploit framework estimate “depreciations upon default”. Indeed, model, \\(s_t\\) (log EURUSD exchange rate) affected credit event variables \\(\\delta_t\\).","code":""},{"path":"credit-and-liquidity-risks.html","id":"CreditDD","chapter":"6 Credit and liquidity risks","heading":"6.5 Top-down approach","text":"Relaxing assumptions underlying classical framework can also done context top-approaches. Top-models focus default counting (loss) processes (see, e.g., Azizpour, Giesecke, Kim (2011) Giesecke, Goldberg, Ding (2011)), contrary (bottom-) approaches presented . latter consider default processes individual firms model primitives (e.g., Lando (1998), Darrell Duffie Singleton (1999), Darrell Duffie Garleanu (2001)).top-approach shown satisfactorily capture existence default clustering (e.g., Brigo, Pallavicini, Torresetti (2007), Errais, Giesecke, Goldberg (2010)).Building C. Gourieroux, Monfort, Renne (2014), Christian Gourieroux et al. (2021) propose affine top-model consistent : presence systemic entities, contagion, pricing default events (see Example 6.5).Example 6.5  (Disastrous Defaults) Christian Gourieroux et al. (2021) porpose equilibrium model different credit derivatives, including CDSs tranch products (iTraxx), can priced. framework, default large firms (included iTraxx index) can systemic consequences sense : () result decrease consumption (b) increase probability default systemic firms.Let \\(n^s_{t}\\) denote number systemic defaults date \\(t\\), let \\(N^s_{t}\\) denote number systemic entities default date \\(t\\) (\\(N^s_{t}=n^s_{t} + N^s_{t-1}\\)).conditional distribution number systemic defaults given :\n\\[\\begin{eqnarray}\nn^s_{t+1}| \\underline{x_{t+1}}, \\underline{y_{t+1}}, \\underline{N^s_{t}}  &\\sim& \\mathcal{P}oisson(\\beta y_{t+1}+c n^s_{t}),\\tag{6.36}\n\\end{eqnarray}\\]\n\\(y_t\\) nonnegative factor fluctuating around low-frequency component \\(x_t\\). Vector \\((y_t,x_t)'\\) follows VARG dynamics (Eq. (3.15)) admits following VAR representation (using Prop. 1.1):\n\\[\\begin{equation}\n\\left\\{\n\\begin{array}{ccl}\ny_t - x_t &=& \\rho_y (y_{t-1} - x_{t-1}) + \\sigma_{y,t}\\varepsilon_{y,t}\\\\\nx_t - \\mu_x  &=& \\rho_x (x_{t-1} - \\mu_x) + \\sigma_{x,t}\\varepsilon_{x,t},\n\\end{array}\n\\right.\\tag{6.37}\n\\end{equation}\\]\n\\(0<\\rho_y<\\rho_x<1\\).\\(c>0\\), defaults date \\(t\\) increases conditional probability additional defaults next date \\(\\Rightarrow\\) Systemic defaults infectious (Davis Lo 2001}), contagious.log growth rate per capita consumption (\\(\\Delta c_t = \\log(C_t/C_{t-1})\\)) given :\n\\[\\begin{equation}\n\\Delta c_t = \\mu_{c,0} + \\mu_{c,x} x_t + \\mu_{c,y} y_t + {\\mu_{c,z}} z_{t},\\tag{6.38}\n\\end{equation}\\]\n\\(z_t\\) depends systemic defaults:\n\\[\\begin{equation}\nz_t|  \\underline{x_{t}}, \\underline{y_{t}}, \\underline{N^s_{t}}  \\sim \\gamma_0(\\xi_{z}n^s_{t-1},\\mu_z).\\tag{6.39}\n\\end{equation}\\]\n\\(\\gamma_0\\) distribution featuring point mass zero (see Eq. (1.4) Example 1.8). context, conditional probability \\(z_t=0\\) \\(\\exp(-\\xi_{z}n^s_{t-1})\\). \\(z_{t}=0\\) long systemic defaults previous period, rather frequent.\\(\\mu_{c,z}<0\\) \\(|\\mu_{c,z}|\\) large \\(c\\) (contamination) large, systemic defaults can give rise disastrous decreases \\(C_t\\).Christian Gourieroux et al. (2021) consider agents featuring Epstein-Zin preferences, unit elasticity intertemporal substitution (EIS). context, SDF exponential affine (Eq. (2.5)), \\(w_t = (x_t,y_t,z_t,n^{s}_t)'\\) affine \\(\\mathbb{P}\\) \\(\\mathbb{Q}\\).\nFigure 6.8: Causality scheme Gourieroux et al. (2021).\ncontext, wide range credit derivatives can priced. particular whose payoffs depend default status constituents reference portfolio: Credit Index swaps (CIS) synthetic CDO.CDS: protection payoff \\(>0\\), entity CDS written defaults.CIS: protection payoff \\(>0\\), one entity underlying portfolio defaults.CDO: protection payoff \\(>0\\), one entity underlying portfolio defaults, given losses given interval \\([,b]\\) (e.g. \\([,b]=[3\\%,6\\%]\\)). See Figure ??.Typical credit indices iTraxx (Europe) CDX (U.S.); indices track default status 125 large firms.pricing CDO formula make intensive use truncated Laplace transform (see Eq. (1.18), Darrell Duffie, Pan, Singleton (2000)). model estimation infeasible without tractability provided affine processes.","code":""},{"path":"references.html","id":"references","chapter":"7 References","heading":"7 References","text":"","code":""}]
